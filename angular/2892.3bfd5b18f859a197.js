"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[2892],{88135:(Y,P,a)=>{a.d(P,{Y:()=>F});var e=a(29023),l=a(56223),B=a(73445),L=a(23680),o=a(19347),t=a(44683),m=a(13217),g=a(72164),d=a(76359),E=a(84003),D=a(47180),y=a(19743),n=a(65879),J=a(59467),K=a(94690),w=a(90592),Z=a(96814),C=a(95545),b=a(67679),M=a(69741),R=a(71646),T=a(50121),W=a(36727);function x(k,G){1&k&&(n.TgZ(0,"div",5)(1,"span",6),n._UZ(2,"azt-loading-ui"),n.qZA()())}function z(k,G){if(1&k&&(n.TgZ(0,"div",29)(1,"div",30),n._UZ(2,"azt-list-classroom-checkbox-new",31),n.qZA()()),2&k){const v=n.oxw(2);n.xp6(2),n.Q6J("form",v.form)("classroomGroupData",v.classroomWithGroup)("examClassroomObjs",v.examClassroomObjs)("permissionName",v.permissionTypes.exam)}}const c=function(k){return{"h-56-important":k}};function O(k,G){if(1&k&&(n.TgZ(0,"div",29)(1,"div",32)(2,"div",33)(3,"h3",34),n._uU(4),n.ALo(5,"mytranslate"),n.qZA()(),n.TgZ(6,"div",35)(7,"ng-scrollbar",36),n._UZ(8,"list-student-checkbox",37),n.qZA()()()()),2&k){const v=n.oxw(2);n.xp6(4),n.hij(" ",n.lcZ(5,9,"lang_test_config_student_list")," "),n.xp6(3),n.Q6J("visibility","hover")("autoHeightDisabled",!1)("ngClass",n.VKq(11,c,v.isMobileWebView)),n.xp6(1),n.Q6J("form",v.form)("formArrayName","studentIds")("objs",v.classroomObjs)("examStudentObjs",v.data.examStudents)("permissionName",v.permissionTypes.exam)}}function u(k,G){1&k&&(n.TgZ(0,"div",38)(1,"div",39),n._uU(2),n.ALo(3,"mytranslate"),n.qZA()()),2&k&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"lang_testbank_test_config_you_not_yet_student")," "))}function p(k,G){if(1&k){const v=n.EpF();n.TgZ(0,"div",7)(1,"form",8)(2,"div",9)(3,"div",10)(4,"div",11)(5,"div",12),n._uU(6),n.ALo(7,"mytranslate"),n.qZA()(),n.TgZ(8,"div",13)(9,"div",14)(10,"div",15)(11,"input",16),n.NdJ("change",function(){n.CHM(v);const h=n.oxw();return n.KtG(h.clearAllCheckBox(0))}),n.qZA(),n.TgZ(12,"label",17),n._uU(13),n.ALo(14,"mytranslate"),n.qZA()(),n.TgZ(15,"div",18)(16,"input",19),n.NdJ("change",function(){n.CHM(v);const h=n.oxw();return n.KtG(h.clearAllCheckBox(2))}),n.qZA(),n.TgZ(17,"label",20),n._uU(18),n.ALo(19,"mytranslate"),n.qZA()(),n.TgZ(20,"div",21)(21,"input",22),n.NdJ("change",function(){n.CHM(v);const h=n.oxw();return n.KtG(h.clearAllCheckBox(3))}),n.qZA(),n.TgZ(22,"label",23),n._uU(23),n.ALo(24,"mytranslate"),n.qZA()()()(),n.YNc(25,z,3,4,"div",24),n.YNc(26,O,9,13,"div",24),n.YNc(27,u,4,3,"div",25),n.qZA()()()(),n.TgZ(28,"div",26)(29,"button",27),n.NdJ("click",function(){n.CHM(v);const h=n.oxw();return n.KtG(h.closeDialog())}),n._uU(30),n.ALo(31,"mytranslate"),n.qZA(),n.TgZ(32,"button",28),n.NdJ("click",function(){n.CHM(v);const h=n.oxw();return n.KtG(h.savePublishExam("save"))}),n._uU(33),n.ALo(34,"mytranslate"),n.qZA()()}if(2&k){const v=n.oxw();n.xp6(1),n.Q6J("formGroup",v.form),n.xp6(5),n.hij(" ",n.lcZ(7,14,"lang_testbank_test_config_who_tested")," "),n.xp6(5),n.Q6J("value",0),n.xp6(2),n.hij(" ",n.lcZ(14,16,"lang_testbank_test_config_all_people")," "),n.xp6(3),n.Q6J("value",2),n.xp6(2),n.hij(" ",n.lcZ(19,18,"lang_testbank_test_config_assigne_class")," "),n.xp6(3),n.Q6J("value",3),n.xp6(2),n.hij(" ",n.lcZ(24,20,"lang_testbank_test_config_assigne_student")," "),n.xp6(2),n.Q6J("ngIf",2===v.form.controls.whoAllow.value),n.xp6(1),n.Q6J("ngIf",3===v.form.controls.whoAllow.value),n.xp6(1),n.Q6J("ngIf",3==v.form.controls.whoAllow.value&&v.form.controls.studentIds.errors),n.xp6(3),n.hij(" ",n.lcZ(31,22,"lang_auto_huy")," "),n.xp6(2),n.Q6J("disabled",3==v.form.controls.whoAllow.value&&v.form.controls.studentIds.errors||2==v.form.controls.whoAllow.value&&v.form.controls.classroomFormArray.errors),n.xp6(1),n.hij(" ",n.lcZ(34,24,"lang_auto_luu")," ")}}let F=(()=>{class k extends g.e{clearAllCheckBox(v){1==v?this.isSelectClassroom=!1:2==v&&(this.isSelectClassroom=!0)}closeDialog(v){this.dialogRef.close(v)}get hasClassroomIdChecked(){var v=this.form.getRawValue();let N=!1;for(let h=0;h<v.classroomIds.length;h++)if(v.classroomIds[h]){N=!0;break}return N}savePublishExam(v){this.initStatusObj();let N="publish"===v?1:void 0;var h=this.form.getRawValue();const U=this.sAztClassroomCheckboxService.getClassroomIdsCheckedInGroup(this.form.controls.classroomFormArray);let _=[];3==h.whoAllow&&h.studentIds&&h.studentIds.length?h.studentIds.forEach(H=>{let q={classroomId:H.classroomId??0,assignStudentIds:[]};H.listStudents?.forEach(V=>{V.id&&V.choose&&q.assignStudentIds?.push(V.id)}),q.assignStudentIds?.length&&_?.push(q)}):_=void 0;let A={whoAllow:h.whoAllow,isPublished:N??void 0,classroomIds:U,assignStudents:_,isSaveConfig:0};var I=this.permissionService.hasEditPermission("exam",this.obj)?this.documentConfigService.apiDocumentConfigSaveExamConfigPost(this.hashId,A):this.documentConfigService.apiDocumentConfigSaveExamDataForConfigClassroomPost(this.hashId,A);this.waitDestroy(I.subscribe(Q=>{1==Q.success?(this.successStatusObj(),this.showSuccessSnack("lang_auto_luu_thanh_cong"),this.closeDialog(Q.data?.obj)):this.errorStatusObj(Q.message??"",!0)}))}getExamDataByHashId(v){this.initStatusObj(),this.waitDestroy(this.documentConfigService.apiDocumentConfigGetExamDataForConfigClassroomV2Get(v).subscribe(N=>{if(1==N.success){if(null!=N.data){var U,h=N.data?.examObj;if(!(U=this.castObj(h)))return;U.limitQuestionGroupsParse=this.commonService.myParseJson(h.limitQuestionGroups??""),this.obj=U,this.hashId=this.obj.hashId??"",this.classroomWithGroup=N.data.classroomGroupObjs??new Array,this.classroomObjs=this.commonService.concatMultipleArray(N.data.classroomGroupObjs.map(_=>_.classroomObjs)),this.examClassroomObjs=N.data.examClassroomObjs??[],this.form.patchValue({whoAllow:this.obj.whoAllow}),this.isSelectClassroom=2==this.obj.whoAllow,this.successStatusObj()}}else this.errorStatusObj(N.message??"",!0)}))}ngOnInit(){super.ngOnInit(),this.getExamDataByHashId(this.hashId)}constructor(v,N,h,U,_){super(U,h),this.documentConfigService=v,this.permissionService=N,this.dialogRef=h,this.data=U,this.sAztClassroomCheckboxService=_,this.permissionTypes=d.y,this.checkDialogFastContent=[],this.prevData="",this.classroomObjs=[],this.examClassroomObjs=[],this.isSelectClassroom=!1,this.hashId="",this.classroomWithGroup=[],this.hashId=U.hashId,this.form=new l.cw({whoAllow:new l.NI(0,{nonNullable:!0}),classroomIds:new l.Oe([]),classroomFormArray:new l.Oe([]),studentIds:new l.Oe([]),isShowCheckClass:new l.NI(!1,{nonNullable:!0})},{validators:[D.h.classroomInGroupCheckBoxValidator,y.M.studentCheckBoxValidator]})}}return k.\u0275fac=function(v){return new(v||k)(n.Y36(J.C),n.Y36(K.j),n.Y36(o.so,8),n.Y36(o.WI,8),n.Y36(w.f))},k.\u0275cmp=n.Xpm({type:k,selectors:[["config-online-exam-dialog"]],features:[n._Bn([{provide:e.fM,useClass:t.WG,deps:[L.Ad,B.o8]},{provide:e.ab,useFactory:m.hx,deps:[E.D]}]),n.qOj],decls:6,vars:2,consts:[[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],["class","loading flex items-center justify-center",4,"ngIf","ngIfElse"],["doneLoading",""],[1,"loading","flex","items-center","justify-center"],[1,"w-4","h-4","inline-block"],[1,"col-md-12","setting"],[3,"formGroup"],[1,"setting-base"],["id","azt-config-who-allow",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12","lg:col-span-3","pr-2"],[1,"mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-9"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-5"],["id","config-who-all","formControlName","whoAllow","type","radio",1,"form-check-input",3,"value","change"],["for","config-who-all",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0","mr-5"],["id","config-who-class","formControlName","whoAllow","type","radio",1,"form-check-input",3,"value","change"],["for","config-who-class",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0"],["id","config-who-student","formControlName","whoAllow","type","radio",1,"form-check-input",3,"value","change"],["for","config-who-student",1,"form-check-label"],["class","col-span-12 mt-4 intro-y",4,"ngIf"],["class","col-span-12 mt-2 intro-y",4,"ngIf"],[1,"text-right","mt-4"],["azt-track-service","config-exam-classroom-6-a-m4KztM",1,"btn","w-24","btn-secondary","mr-3",3,"click"],["azt-track-service","config-exam-classroom-brv1ZZTsfLY",1,"btn","w-24","btn-primary",3,"disabled","click"],[1,"col-span-12","mt-4","intro-y"],[1,"azt-list-classroom"],[3,"form","classroomGroupData","examClassroomObjs","permissionName"],[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","items-center"],[1,"mr-auto"],[1,"classroom_list"],["pointerEventsMethod","scrollbar",1,"w-full",3,"visibility","autoHeightDisabled","ngClass"],[3,"form","formArrayName","objs","examStudentObjs","permissionName"],[1,"col-span-12","mt-2","intro-y"],[1,"text-xs","text-danger"]],template:function(v,N){if(1&v&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2),n.YNc(3,x,3,0,"div",3),n.YNc(4,p,35,26,"ng-template",null,4,n.W1O),n.qZA()()()),2&v){const h=n.MAs(5);n.xp6(3),n.Q6J("ngIf",N.statusObj.loading)("ngIfElse",h)}},dependencies:[Z.mk,Z.O5,C.KC,l._Y,l.Fj,l._,l.JJ,l.JL,l.sg,l.u,l.CE,b.M,M._,R.n,T.V,W.JV],encapsulation:2}),k})()},50121:(Y,P,a)=>{a.d(P,{V:()=>R});var e=a(65879),l=a(56223),B=a(65592),L=a(76359),o=a(47496),t=a(76718),m=a(2783),g=a(4021),d=a(96814),E=a(92596),D=a(37722),y=a(36727);function n(T,W){if(1&T&&(e.TgZ(0,"span",11),e._uU(1),e.ALo(2,"slice"),e.qZA()),2&T){const x=e.oxw().$implicit;e.s9C("matTooltip",x.controls.classroomName.value),e.xp6(1),e.hij(" ",e.Dn7(2,2,x.controls.classroomName.value,0,30)+"..."," ")}}function J(T,W){if(1&T&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&T){const x=e.oxw().$implicit;e.xp6(1),e.hij(" ",x.controls.classroomName.value," ")}}function K(T,W){1&T&&(e.TgZ(0,"span",12),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&T&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"lang_testbank_test_config_share")," "))}const w=function(T){return{"text-primary font-medium":T}},Z=function(T){return{permissionObj:T}};function C(T,W){if(1&T){const x=e.EpF();e.TgZ(0,"div",4)(1,"div",5),e.NdJ("click",function(){const O=e.CHM(x).$implicit,u=e.oxw(2);return e.KtG(u.showListStudentInClassroomDialog(O.controls.classroomId.value,O.controls.classroomName.value))}),e.TgZ(2,"span",6),e._UZ(3,"lucide-icon",7),e.qZA(),e.YNc(4,n,3,6,"span",8),e.YNc(5,J,2,1,"span",0),e.YNc(6,K,3,3,"span",9),e.ALo(7,"fullPermission"),e.TgZ(8,"span",10),e._uU(9),e.qZA()()()}if(2&T){const x=W.$implicit;e.xp6(1),e.Q6J("ngClass",e.VKq(8,w,x.controls.countSelect.value)),e.xp6(3),e.Q6J("ngIf",x.controls.classroomName.value.length>30),e.xp6(1),e.Q6J("ngIf",x.controls.classroomName.value.length<=30),e.xp6(1),e.Q6J("ngIf",!e.xi3(7,5,e.VKq(10,Z,x.controls.permissionObjs.value),"classroom")),e.xp6(3),e.hij(" (",x.controls.countSelect.value+"/"+x.controls.countStudents.value,") ")}}const b=function(){return[]};function M(T,W){if(1&T&&(e.TgZ(0,"div")(1,"form",1)(2,"div",2),e.YNc(3,C,10,12,"div",3),e.qZA()()()),2&T){const x=e.oxw();let z;e.xp6(1),e.Q6J("formGroup",x.form),e.xp6(2),e.Q6J("ngForOf",null!==(z=x.form.controls.studentIds.controls)&&void 0!==z?z:e.DdM(2,b))}}let R=(()=>{class T extends o.Q{initClassroomCheckbox(){this.formArray.clear(),this.objs.forEach(c=>{let O=new l.cw({classroomId:new l.NI(c.id,{nonNullable:!0}),classroomName:new l.NI(c.name,{nonNullable:!0}),permissionObjs:new l.NI(c.permissionObj,{nonNullable:!0}),listStudents:new l.Oe([]),countStudents:new l.NI(c.countStudents,{nonNullable:!0}),loadingStudents:new l.NI(!1,{nonNullable:!0}),selectAll:new l.NI(!1,{nonNullable:!0}),countSelect:new l.NI(0,{nonNullable:!0}),isShowCheckStudent:new l.NI(!1,{nonNullable:!0})});this.formArray.push(O)});let x=this.commonService.uniqueArray(this.examStudentObjs.map(c=>c.classroomId)),z=this.commonService.uniqueArray(this.examStudentObjs.map(c=>c.studentId));for(let c=0;c<x.length;c++)this.getListStudentFromApiAndShow(x[c],z)}getStudentListByClassroomIdFromApi(x){return new B.y(z=>{this.waitDestroy(this.studentProfileV2Service.apiStudentProfileV2GetObjsByClassroomIdGet(x).subscribe(c=>{1==c.success?(z.next(c.data?.studentObjs),z.complete()):(z.next([]),z.complete())}))})}getListStudentFromApiAndShow(x,z){let c=this.formArray.controls.find(O=>O.controls.classroomId.value==x&&!O.controls.listStudents.length);c&&(c.controls.loadingStudents.setValue(!0),this.getStudentListByClassroomIdFromApi(x).subscribe(O=>{O.length&&this.addStudentToFormArr(O,x,z),c?.controls.loadingStudents.setValue(!1)}))}addStudentToFormArr(x,z,c){let O=this.formArray.controls.find(u=>u.controls.classroomId.value==z);O&&(x.forEach(u=>{let p=this.commonService.isExistInArray(c,u.id),F=new l.cw({id:new l.NI(u.id,{nonNullable:!0}),name:new l.NI(u.fullName??"",{nonNullable:!0}),choose:new l.NI(p,{nonNullable:!0})});O?.controls.listStudents.push(F)}),O?.controls.countSelect.setValue(O?.controls.listStudents.value.filter(u=>u.choose).length??0),O?.controls.countSelect.value==O?.controls.listStudents.length&&O.controls.selectAll.setValue(!0))}showListStudentInClassroomDialog(x,z){this.getListStudentFromApiAndShow(x,[]),this.sAztDialogService.open(t.V,{data:{form:this.form,classroomId:x,classroomName:z,permissionName:this.permissionName,formArrayOfStudentIds:this.formArray},width:"1000px",autoFocus:!1})}ngOnInit(){super.ngOnInit(),this.objs.map(x=>x.name=this.commonService.myTranslateInstant(x.name)??""),this.formArray=this.form.controls.studentIds,this.initClassroomCheckbox()}constructor(x,z){super(),this.sAztDialogService=x,this.studentProfileV2Service=z,this.changeCheckboxEvent=new e.vpe,this.formArray=new l.Oe([]),this.objs=[],this.examStudentObjs=[],this.permissionName=L.y.exam,this.listPermissionTypes=L.y}}return T.\u0275fac=function(x){return new(x||T)(e.Y36(m.C),e.Y36(g.LU))},T.\u0275cmp=e.Xpm({type:T,selectors:[["list-student-checkbox"]],inputs:{form:"form",objs:"objs",examStudentObjs:"examStudentObjs",permissionName:"permissionName"},outputs:{changeCheckboxEvent:"changeCheckboxEvent"},features:[e.qOj],decls:1,vars:1,consts:[[4,"ngIf"],[3,"formGroup"],[1,"grid","grid-cols-12","gap-3","p-3"],["class","col-span-12 md:col-span-6 mt-2","formArrayName","studentIds",4,"ngFor","ngForOf"],["formArrayName","studentIds",1,"col-span-12","md:col-span-6","mt-2"],[1,"flex","cursor-pointer","items-center","icon-align-justify",2,"vertical-align","middle",3,"ngClass","click"],[1,"w-4","h-4","inline-block","mr-2"],["name","align-justify"],[3,"matTooltip",4,"ngIf"],["class","ml-2 py-0.5 px-2 rounded-full text-xs bg-primary text-white cursor-pointer font-medium",4,"ngIf"],[1,"ml-2"],[3,"matTooltip"],[1,"ml-2","py-0.5","px-2","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium"]],template:function(x,z){1&x&&e.YNc(0,M,4,3,"div",0),2&x&&e.Q6J("ngIf",z.form)},dependencies:[d.mk,d.sg,d.O5,E.gM,l._Y,l.JL,l.sg,l.CE,D.Nh5,d.OU,y.JV,y.NK],encapsulation:2}),T})()},76718:(Y,P,a)=>{a.d(P,{V:()=>z});var e=a(19347),l=a(72164),B=a(76359),L=a(63278),o=a(65879);function t(c,O){1&c&&(o.ynx(0),o._uU(1),o.ALo(2,"mytranslate"),o.BQk()),2&c&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"lang_remove_all")," "))}function m(c,O){1&c&&(o._uU(0),o.ALo(1,"mytranslate")),2&c&&o.hij(" ",o.lcZ(1,1,"lang_select_all")," ")}function g(c,O){if(1&c){const u=o.EpF();o.TgZ(0,"div",19)(1,"div",20)(2,"input",21),o.NdJ("change",function(){o.CHM(u);const F=o.oxw(5);return o.KtG(F.selectAllStudentOfClass())}),o.qZA(),o.TgZ(3,"label",22),o.YNc(4,t,3,3,"ng-container",17),o.YNc(5,m,2,3,"ng-template",null,23,o.W1O),o.qZA()(),o.TgZ(7,"div",24),o._UZ(8,"input",25),o.TgZ(9,"label",26),o._uU(10),o.ALo(11,"mytranslate"),o.qZA()()()}if(2&c){const u=o.MAs(6),p=o.oxw(3).$implicit;o.xp6(4),o.Q6J("ngIf",p.controls.selectAll.value)("ngIfElse",u),o.xp6(6),o.hij(" ",o.lcZ(11,3,"lang_testbank_selected_students")," ")}}function d(c,O){1&c&&(o.ynx(0),o.TgZ(1,"div",27)(2,"div",28),o._UZ(3,"azt-loading-ui"),o.qZA()(),o.BQk())}function E(c,O){1&c&&(o.ynx(0),o.TgZ(1,"div",27)(2,"span"),o._uU(3),o.ALo(4,"mytranslate"),o.qZA()(),o.BQk()),2&c&&(o.xp6(3),o.Oqu(o.lcZ(4,1,"lang_core_class_has_no_student")))}function D(c,O){1&c&&(o.ynx(0),o.TgZ(1,"div",27)(2,"span",32),o._uU(3),o.ALo(4,"mytranslate"),o.qZA()(),o.BQk()),2&c&&(o.xp6(3),o.Oqu(o.lcZ(4,1,"lang_testbank_no_students_selected")))}function y(c,O){if(1&c&&(o.TgZ(0,"div",38)(1,"div",39),o._UZ(2,"input",40),o.TgZ(3,"label",41,42),o.ALo(5,"mytranslate"),o._uU(6),o.ALo(7,"mytranslate"),o.qZA()()()),2&c){const u=o.MAs(4),p=o.oxw().$implicit;o.xp6(1),o.Q6J("formGroup",p),o.xp6(1),o.s9C("id","azt-checkbox-student-"+p.controls.id.value),o.xp6(1),o.s9C("for","azt-checkbox-student-"+p.controls.id.value),o.Q6J("matTooltip",o.lcZ(5,8,p.controls.name.value))("isDisabledTooltip",!1)("matTooltipDisabled",u.isDisabled)("matTooltipShowDelay",500),o.xp6(3),o.hij(" ",o.lcZ(7,10,p.controls.name.value)," ")}}function n(c,O){if(1&c&&(o.ynx(0),o.YNc(1,y,8,12,"div",37),o.BQk()),2&c){const u=O.$implicit,p=o.oxw(7).$implicit;o.xp6(1),o.Q6J("ngIf",null==p.controls.isShowCheckStudent||!p.controls.isShowCheckStudent.value||p.controls.isShowCheckStudent.value&&u.controls.choose.value)}}const J=function(){return["name"]};function K(c,O){if(1&c&&(o.TgZ(0,"div",35),o.YNc(1,n,2,1,"ng-container",36),o.ALo(2,"appSearchStudentForm"),o.qZA()),2&c){const u=o.oxw(6).$implicit,p=o.oxw(2);o.xp6(1),o.Q6J("ngForOf",o.Dn7(2,1,u.controls.listStudents.controls,p.searchContentObj.searchContent,o.DdM(5,J)))}}function w(c,O){1&c&&(o.TgZ(0,"div",27),o._uU(1),o.ALo(2,"mytranslate"),o.qZA()),2&c&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"lang_student_classroom_list_detail_not_student")," "))}function Z(c,O){if(1&c&&(o.YNc(0,K,3,6,"div",33),o.YNc(1,w,3,3,"div",34),o.ALo(2,"appSearchStudentForm")),2&c){const u=o.oxw(5).$implicit,p=o.oxw(2);o.Q6J("ngIf",u.controls.listStudents.controls.length),o.xp6(1),o.Q6J("ngIf",0==o.Dn7(2,2,u.controls.listStudents.controls,p.searchContentObj.searchContent,o.DdM(6,J)).length)}}function C(c,O){if(1&c&&(o.TgZ(0,"azt-mat-dialog-content",30),o.YNc(1,D,5,3,"ng-container",17),o.YNc(2,Z,3,7,"ng-template",null,31,o.W1O),o.qZA()),2&c){const u=o.MAs(3),p=o.oxw(4).$implicit;o.Q6J("defaultHeight",40),o.xp6(1),o.Q6J("ngIf",!p.controls.countSelect.value&&p.controls.isShowCheckStudent.value)("ngIfElse",u)}}function b(c,O){if(1&c&&(o.YNc(0,E,5,3,"ng-container",17),o.YNc(1,C,4,3,"ng-template",null,29,o.W1O)),2&c){const u=o.MAs(2),p=o.oxw(3).$implicit;o.Q6J("ngIf",!p.controls.listStudents.length)("ngIfElse",u)}}function M(c,O){if(1&c){const u=o.EpF();o.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"span"),o._uU(4),o.ALo(5,"mytranslate"),o.qZA(),o.TgZ(6,"div",13)(7,"azt-search-box",14),o.NdJ("onSearch",function(F){o.CHM(u);const k=o.oxw(4);return o.KtG(k.onSearchBox(F.searchObj))}),o.ALo(8,"mytranslate"),o.qZA()()(),o.YNc(9,g,12,5,"div",15),o.qZA(),o.TgZ(10,"div",16),o.YNc(11,d,4,0,"ng-container",17),o.YNc(12,b,3,2,"ng-template",null,18,o.W1O),o.qZA()()}if(2&c){const u=o.MAs(13),p=o.oxw(2).$implicit,F=o.oxw(2);o.Q6J("formGroup",p),o.xp6(4),o.hij(" ",F.data.classroomName+(p.controls.countSelect.value?" ("+o.lcZ(5,8,"lang_auto_da_chon")+": "+p.controls.countSelect.value+")":"")," "),o.xp6(3),o.Q6J("isServerSearch",!1)("styleInput","form-control-sm ")("placeholder",o.lcZ(8,10,"lang_student_classroom_list_detail_search_name_student")),o.xp6(2),o.Q6J("ngIf",p.controls.listStudents.controls.length),o.xp6(2),o.Q6J("ngIf",p.controls.loadingStudents.value)("ngIfElse",u)}}const R=function(c){return{permissionObj:c}};function T(c,O){if(1&c&&(o.TgZ(0,"div"),o.YNc(1,M,14,12,"div",9),o.ALo(2,"createPermission"),o.qZA()),2&c){const u=o.oxw().$implicit,p=o.oxw(2);o.xp6(1),o.Q6J("ngIf",o.xi3(2,1,o.VKq(4,R,u.controls.permissionObjs.value),p.listPermissionTypes[p.data.permissionName]))}}function W(c,O){if(1&c&&(o.ynx(0,7),o.YNc(1,T,3,6,"div",8),o.BQk()),2&c){const u=O.$implicit,p=o.oxw(2);o.xp6(1),o.Q6J("ngIf",u.controls.classroomId.value==p.data.classroomId)}}function x(c,O){if(1&c){const u=o.EpF();o.TgZ(0,"div",1)(1,"div",2)(2,"div",3),o.YNc(3,W,2,1,"ng-container",4),o.qZA()(),o.TgZ(4,"div",5)(5,"button",6),o.NdJ("click",function(){o.CHM(u);const F=o.oxw();return o.KtG(F.btnCloseDialog())}),o._uU(6),o.ALo(7,"mytranslate"),o.qZA()()()}if(2&c){const u=o.oxw();o.xp6(2),o.Q6J("formGroup",u.data.form),o.xp6(1),o.Q6J("ngForOf",u.data.form.controls.studentIds.controls),o.xp6(3),o.hij(" ",o.lcZ(7,3,"lang_auto_dong")," ")}}let z=(()=>{class c extends l.e{btnCloseDialog(){this.dialogRef.close()}selectAllStudentOfClass(){let u=this.formArray.controls.find(p=>p.controls.classroomId.value==this.data.classroomId);if(u){let p=u.controls.selectAll.value;u.controls.listStudents.controls.forEach(F=>{F.controls.choose.setValue(p)}),this.calculateCheckAllAndTotalSelected()}}calculateCheckAllAndTotalSelected(){let u=this.formArray.controls.find(p=>p.controls.classroomId.value==this.data.classroomId);u&&(u?.controls.listStudents.value.filter(k=>k.choose).length??0)!=u.controls.countSelect.value&&(u.controls.countSelect.setValue(u?.controls.listStudents.value.filter(k=>k.choose).length??0),u.controls.selectAll.setValue(u?.controls.countSelect.value==u?.controls.listStudents.length))}onSearchBox(u){this.searchContentObj=u}ngOnInit(){this.formArray.valueChanges.subscribe(()=>{this.calculateCheckAllAndTotalSelected()})}constructor(u,p){super(p,u),this.dialogRef=u,this.data=p,this.listPermissionTypes=B.y,this.searchContentObj=new L.h,this.formArray=p.formArrayOfStudentIds}}return c.\u0275fac=function(u){return new(u||c)(o.Y36(e.so,8),o.Y36(e.WI,8))},c.\u0275cmp=o.Xpm({type:c,selectors:[["azt-list-student-dialog"]],features:[o.qOj],decls:1,vars:1,consts:[["class","box",4,"ngIf"],[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-0",3,"formGroup"],["formArrayName","studentIds",4,"ngFor","ngForOf"],[1,"p-3","text-right"],["azt-track-service","azt-dialog-warning-3FIn9IaXN",1,"btn","w-24","btn-primary",3,"click"],["formArrayName","studentIds"],[4,"ngIf"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","flex-col","sm:flex-row","sm:h-auto","sm:items-center"],[1,"font-medium","mr-auto"],[1,"w-full","relative","flex","items-center","mt-2"],[3,"isServerSearch","styleInput","placeholder","onSearch"],["class","flex items-center mt-2 sm:mt-0",4,"ngIf"],[2,"height","320px"],[4,"ngIf","ngIfElse"],["doneLoadStudents",""],[1,"flex","items-center","mt-2","sm:mt-0"],[1,"form-check","mr-3"],["id","selected-all","type","checkbox","formControlName","selectAll",1,"form-check-input",3,"change"],["for","selected-all",1,"form-check-label"],["elseTemplate",""],[1,"form-check"],["id","show-student-checked","type","checkbox","formControlName","isShowCheckStudent",1,"form-check-input"],["for","show-student-checked",1,"form-check-label"],[1,"h-full","flex","items-center","justify-center","p-5"],[1,"w-5","h-5"],["hasStudents",""],[3,"defaultHeight"],["checkedBox",""],[1,"mx-auto"],["class","grid grid-cols-12 gap-3 p-3","formArrayName","listStudents",4,"ngIf"],["class","h-full flex items-center justify-center p-5",4,"ngIf"],["formArrayName","listStudents",1,"grid","grid-cols-12","gap-3","p-3"],[4,"ngFor","ngForOf"],["class","col-span-12 md:col-span-4 mt-2",4,"ngIf"],[1,"col-span-12","md:col-span-4","mt-2"],[1,"azt-checkbox-item",3,"formGroup"],["type","checkbox","formControlName","choose",1,"form-check-input",3,"id"],[1,"form-check-label","truncate",2,"vertical-align","middle",3,"matTooltip","isDisabledTooltip","matTooltipDisabled","matTooltipShowDelay","for"],["c","isDisabled"]],template:function(u,p){1&u&&o.YNc(0,x,8,5,"div",0),2&u&&o.Q6J("ngIf",p.data.form)},encapsulation:2}),c})()},20254:(Y,P,a)=>{a.d(P,{Q:()=>d});var e=a(65592),l=a(73311),B=a(62836),L=a(88135),o=a(20760),t=a(65879),m=a(46558),g=a(2783);let d=(()=>{class E{doExamAction(y,n){switch(n){case o.F.CONFIG_EXAM_CLASSROOM:return this.showConfigExamClassroomDialog(y);case o.F.SHOW_EXAM_DETAIL:this.showExamDetailDialog(y);break;case o.F.SHARE_OFFLINE_RESULT:this.showOfflineShareDialog(y);break;case o.F.COPY_EXAM_LINK:this.copyExamLink()}return this.returnUndefinedOutput()}copyExamLink(){this.commonService.snackSuccess("lang_auto_sao_chep_thanh_cong")}showConfigExamClassroomDialog(y){return new e.y(n=>{this.sAztDialogService.open(L.Y,{width:"900px",data:{hashId:y.examObj.hashId,examStudents:y.examObj?.examStudents??[]},restoreFocus:!1}).afterClosed().subscribe(K=>{K?(n.next({reloadData:!0}),n.complete()):(n.next(void 0),n.complete())})})}showExamDetailDialog(y){let n={obj:{...y.examObj,countQuestion:0,showFrontend:1,editable:!0,allowStudentView:!0},globalLadingPage:y.globalLadingPage,curCateId:y.categoryId,isOnLib:0,isShow:!0,showDelete:!0};this.sAztDialogService.open(B.H,{width:"800px",maxWidth:"90vw",enterAnimationDuration:"0ms",exitAnimationDuration:"0ms",data:n,restoreFocus:!1}).afterClosed().subscribe(K=>{})}showOfflineShareDialog(y){this.sAztDialogService.open(l.h,{width:"600px",data:{examHashId:y.examObj.hashId,useDialog:!0},restoreFocus:!1})}returnUndefinedOutput(){return new e.y(y=>{y.next(void 0),y.complete()})}constructor(y,n){this.commonService=y,this.sAztDialogService=n}}return E.\u0275fac=function(y){return new(y||E)(t.LFG(m.z),t.LFG(g.C))},E.\u0275prov=t.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()},27722:(Y,P,a)=>{a.d(P,{d:()=>L});var e=a(25690),l=a(65879),B=a(46558);let L=(()=>{class o{sortExamByColumn(m,g,d){return g==e.H.BY_NAME?this.sortExamByName(m,d):g==e.H.BY_PUBLISH_STATUS?this.sortExamByPublishStatus(m,d):g==e.H.BY_UPDATED_DATE?this.sortExamByDateUpdated(m,d):g==e.H.BY_ATTENDED?this.sortExamByAttended(m,d):this.sortExamByName(m,d)}sortExamByName(m,g){var d=[...m.rootCategoryObjs??[]],E=[...m.rootDocumentObjs??[]];return 1==g?{categoryObjs:this._sortCateByName(d),documentObjs:this._sortDocumentByName(E)}:{categoryObjs:this._sortCateByName(d).reverse(),documentObjs:this._sortDocumentByName(E).reverse()}}sortExamByPublishStatus(m,g){var d=[...m.rootDocumentObjs??[]];return 1==g?{categoryObjs:m.currentCategoryObjs,documentObjs:this._sortDocumentByPublish(d,d?.length)}:{categoryObjs:m.currentCategoryObjs,documentObjs:this._sortDocumentByPublish(d,d?.length).reverse()}}sortExamByDateUpdated(m,g){var d=this.commonService.castObj(m.rootCategoryObjs),E=this.commonService.castObj(m.rootDocumentObjs);return 1==g?{categoryObjs:this._sortCateByDateUpdateExam(d??[]),documentObjs:this._sortDocumentByUpdateTime(E??[])}:{categoryObjs:this._sortCateByDateUpdateExam(d??[]).reverse(),documentObjs:this._sortDocumentByUpdateTime(E??[]).reverse()}}sortExamByAttended(m,g){var d=this.commonService.castObj(m.rootDocumentObjs);return 1==g?{categoryObjs:m.currentCategoryObjs,documentObjs:this._sortDocumentByAttended(d??[])}:{categoryObjs:m.currentCategoryObjs,documentObjs:this._sortDocumentByAttended(d??[]).reverse()}}_sortCateByName(m){return m?.sort((g,d)=>(g.name?.trim()??"").localeCompare(d.name?.trim()??""))??[]}_sortDocumentByName(m){return m?.sort((g,d)=>(g.name?.trim()??"").localeCompare(d.name?.trim()??""))??[]}_sortDocumentByPublish(m,g){let d=[],E=[];for(let D=0;D<(g??0);D++)0==m?.[D].isPublished&&d.push(m[D]),1==m?.[D].isPublished&&E.push(m[D]);return d.concat(E)}_sortCateByDateUpdateExam(m){return m.sort((g,d)=>Number(new Date(g.updatedAt??""))-Number(new Date(d.updatedAt??""))),m}_sortDocumentByUpdateTime(m){return m?.sort((g,d)=>Number(new Date(g.updatedAt??""))-Number(new Date(d.updatedAt??"")))}_sortDocumentByAttended(m){return m?.sort((g,d)=>Number(g.attended)-Number(d.attended))}constructor(m){this.commonService=m}}return o.\u0275fac=function(m){return new(m||o)(l.LFG(B.z))},o.\u0275prov=l.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},20760:(Y,P,a)=>{a.d(P,{F:()=>e});var e=function(l){return l[l.CONFIG_EXAM_CLASSROOM=0]="CONFIG_EXAM_CLASSROOM",l[l.SHOW_EXAM_DETAIL=1]="SHOW_EXAM_DETAIL",l[l.SHARE_OFFLINE_RESULT=2]="SHARE_OFFLINE_RESULT",l[l.COPY_EXAM_LINK=3]="COPY_EXAM_LINK",l}(e||{})},31810:(Y,P,a)=>{a.d(P,{T:()=>e});var e=function(l){return l[l.OFFLINE_CONFIG=0]="OFFLINE_CONFIG",l[l.CONFIG_EXAM=1]="CONFIG_EXAM",l[l.EDIT_EXAM=2]="EDIT_EXAM",l[l.POWER_POINT=3]="POWER_POINT",l[l.STATISTIC=4]="STATISTIC",l[l.TESTED_LIST=5]="TESTED_LIST",l}(e||{})},25690:(Y,P,a)=>{a.d(P,{H:()=>e});var e=function(l){return l[l.BY_NAME=0]="BY_NAME",l[l.BY_PUBLISH_STATUS=1]="BY_PUBLISH_STATUS",l[l.BY_UPDATED_DATE=2]="BY_UPDATED_DATE",l[l.BY_ATTENDED=3]="BY_ATTENDED",l}(e||{})},1028:(Y,P,a)=>{a.d(P,{X:()=>e});var e=function(l){return l[l.multipleChoice=1]="multipleChoice",l[l.essay=3]="essay",l[l.trueFalse=5]="trueFalse",l[l.fill=4]="fill",l}(e||{})},31225:(Y,P,a)=>{a.d(P,{h:()=>e});var e=function(l){return l.COPY="copy",l.CUT="cut",l.DELETE="delete",l}(e||{})},94145:(Y,P,a)=>{a.d(P,{Y:()=>e});var e=function(l){return l[l.EXAM_CATEGORY=0]="EXAM_CATEGORY",l[l.EXAM=1]="EXAM",l}(e||{})},55948:(Y,P,a)=>{a.d(P,{e:()=>L});var e=a(31225),l=a(94145),B=a(65879);let L=(()=>{class o{constructor(){this.clipboardObjs=[]}setActionToClipboard(m,g,d,E){var D={id:m,name:E,type:g,action:d};this.clipboardObjs.filter(n=>n.id==D.id&&n.type==D.type).length>0?this.clipboardObjs.forEach(n=>{n.id==D.id&&n.type==D.type&&(n.action=D.action)}):this.clipboardObjs.push(D)}hasInClipboard(m,g){return this.clipboardObjs.filter(E=>E.id==m&&E.type==g).length>0}hasCopyFolderActionInClipboard(){var m=!1;return this.clipboardObjs.forEach(g=>{g.type==l.Y.EXAM_CATEGORY&&g.action==e.h.COPY&&(m=!0)}),m}getActionOfDocumentObj(m,g){var d=this.clipboardObjs.filter(E=>E.id==m&&E.type==g);if(d&&d.length>0)return d[0].action}removeDocumentInClipboard(m,g){for(var d=0;d<this.clipboardObjs.length;d++)this.clipboardObjs[d].id==m&&this.clipboardObjs[d].type==g&&this.clipboardObjs.splice(d,1)}isPasteToSelfFolder(m){var g=!1;return this.clipboardObjs.forEach(d=>{d.id==m&&d.type==l.Y.EXAM_CATEGORY&&d.action==e.h.COPY&&(g=!0)}),g}getCurrentClipBoard(){return this.clipboardObjs}resetClipBoardAfterPasteOrCancelAllActions(){this.clipboardObjs=[]}}return o.\u0275fac=function(m){return new(m||o)},o.\u0275prov=B.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},19743:(Y,P,a)=>{a.d(P,{M:()=>e});class e{static studentCheckBoxValidator(B){const o=B.controls.whoAllow,t=B.controls.studentIds;return o&&t?3!=o.value||e.countCheckBox(t)>=1?(t.setErrors(null),null):(t.setErrors({studentCheckBoxValidator:!0}),{identityRevealed:!0}):null}static countCheckBox(B){var L=0;return B.value.forEach(o=>{L+=o.listStudents?.filter(t=>t.choose).length??0}),L}}},52467:(Y,P,a)=>{a.d(P,{S:()=>K});var e=a(65879),l=a(1028),B=a(47496),L=a(38228),o=a(96814),t=a(36727);const m=["table"];function g(w,Z){if(1&w&&(e.TgZ(0,"td",6),e._uU(1),e.ALo(2,"formatOfflineExamHashIdToNumber"),e.qZA()),2&w){const C=Z.$implicit,b=Z.index;e.uIk("excelRow",1)("excelColumn",b+1),e.xp6(1),e.hij(" ",e.lcZ(2,3,null==C?null:C.offlineMixQuestionHashId)," ")}}function d(w,Z){if(1&w&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&w){const C=e.oxw(2).$implicit,b=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,C.offlineQuestionObjs[b].answer)," ")}}function E(w,Z){1&w&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&w&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"lang_core_essay_question")," "))}function D(w,Z){if(1&w&&(e.TgZ(0,"span"),e.YNc(1,d,3,3,"span",7),e.YNc(2,E,3,3,"span",7),e.qZA()),2&w){const C=e.oxw().$implicit,b=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!(null!=C.offlineQuestionObjs&&null!=C.offlineQuestionObjs[b]&&C.offlineQuestionObjs[b].isEssay)),e.xp6(1),e.Q6J("ngIf",null==C.offlineQuestionObjs||null==C.offlineQuestionObjs[b]?null:C.offlineQuestionObjs[b].isEssay)}}function y(w,Z){if(1&w&&(e.TgZ(0,"td",6),e.YNc(1,D,3,2,"span",7),e.qZA()),2&w){const C=Z.$implicit,b=Z.index,M=e.oxw().$implicit;let R;e.uIk("excelRow",M+2)("excelColumn",b+1),e.xp6(1),e.Q6J("ngIf",(null!==(R=null==C.offlineQuestionObjs?null:C.offlineQuestionObjs.length)&&void 0!==R?R:0)>M)}}const n=function(){return[]};function J(w,Z){if(1&w&&(e.TgZ(0,"tr")(1,"td",3),e._uU(2),e.qZA(),e.YNc(3,y,2,3,"td",4),e.qZA()),2&w){const C=Z.$implicit,b=e.oxw();let M;e.xp6(1),e.uIk("excelRow",C+2)("excelColumn",0),e.xp6(1),e.hij(" ",C+b.startQuestionIndex," "),e.xp6(1),e.Q6J("ngForOf",null!==(M=null==b.obj?null:b.obj.offlineMixQuestionObjs)&&void 0!==M?M:e.DdM(4,n))}}let K=(()=>{class w extends B.Q{calculateMaxQuestion(){let C=0;return this.obj.offlineMixQuestionObjs&&this.obj.offlineMixQuestionObjs.forEach(b=>{C<(b.offlineQuestionObjs?.length??0)&&(C=b.offlineQuestionObjs?.length??0)}),C}processData(){for(let C=0;C<this.obj.offlineMixQuestionObjs.length;C++)for(let b=0;b<this.obj.offlineMixQuestionObjs[C].offlineQuestionObjs.length;b++)this.obj.offlineMixQuestionObjs[C].offlineQuestionObjs[b].answerType===this.offlineAnswerType.trueFalse&&(this.obj.offlineMixQuestionObjs[C].offlineQuestionObjs[b].answer=this.convertAnswerTrueFalse(this.obj.offlineMixQuestionObjs[C].offlineQuestionObjs[b].answer))}convertAnswerTrueFalse(C){const b=C.split(","),M=this.commonService.myClone(this.answerChoiceMap),R=this.commonService.myTranslateInstant("lang_testbank_correct_answer_to_offline_exam"),T=this.commonService.myTranslateInstant("lang_testbank_wrong_answer_to_offline_exam");return M.map(x=>b.includes(x)?R:T).join("")}ngOnChanges(){this.isExported=!1,this.maxQuestionIndex=this.calculateMaxQuestion(),this.totalExamCode=this.obj.offlineMixQuestionObjs?.length??0}ngAfterViewChecked(){0==this.isExported&&(this.isExported=!0,setTimeout(()=>{this.exportDataDone.emit(this.exportExcelService.exportHtmlTableToExcelBlob(this.table,!0))},0))}ngOnInit(){super.ngOnInit(),this.processData()}constructor(C){super(),this.exportExcelService=C,this.startQuestionIndex=1,this.exportDataDone=new e.vpe,this.maxQuestionIndex=0,this.totalExamCode=0,this.isExported=!1,this.offlineAnswerType=l.X,this.answerChoiceMap=["A","B","C","D"]}}return w.\u0275fac=function(C){return new(C||w)(e.Y36(L.L))},w.\u0275cmp=e.Xpm({type:w,selectors:[["azt-export-excel-for-answersheet"]],viewQuery:function(C,b){if(1&C&&e.Gf(m,5),2&C){let M;e.iGM(M=e.CRH())&&(b.table=M.first)}},inputs:{obj:"obj",startQuestionIndex:"startQuestionIndex"},outputs:{exportDataDone:"exportDataDone"},features:[e.qOj,e.TTD],decls:14,vars:16,consts:[[1,"table","table-bordered",2,"display","none"],["table",""],["rowspan","2","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["class","text-center azt-excel-cell","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',1,"text-center","azt-excel-cell"],[4,"ngIf"]],template:function(C,b){if(1&C&&(e.TgZ(0,"table",0,1)(2,"tbody")(3,"tr")(4,"td",2),e._uU(5),e.ALo(6,"mytranslate"),e.qZA(),e.TgZ(7,"td",3),e._uU(8),e.ALo(9,"mytranslate"),e.qZA()(),e.TgZ(10,"tr"),e.YNc(11,g,3,5,"td",4),e.qZA(),e.YNc(12,J,4,5,"tr",5),e.ALo(13,"createEmptyArray"),e.qZA()()),2&C){let M;e.xp6(4),e.uIk("excelRow",0)("excelColumn",0),e.xp6(1),e.hij(" ",e.lcZ(6,9,"lang_testbank_answersheet_question_title")," "),e.xp6(2),e.uIk("colspan",b.totalExamCode)("excelRow",0)("excelColumn",1),e.xp6(1),e.hij(" ",e.lcZ(9,11,"lang_auto_ma_de_thi")," "),e.xp6(3),e.Q6J("ngForOf",null!==(M=null==b.obj?null:b.obj.offlineMixQuestionObjs)&&void 0!==M?M:e.DdM(15,n)),e.xp6(1),e.Q6J("ngForOf",e.lcZ(13,13,b.maxQuestionIndex))}},dependencies:[o.sg,o.O5,t.JV,t.Aw,t.ib],encapsulation:2}),w})()},73311:(Y,P,a)=>{a.d(P,{h:()=>at});var e=a(56223),l=a(19347),B=a(72164),L=a(76359),o=a(47180),t=a(65879),m=a(49870),g=a(90592),d=a(96814),E=a(70342),D=a(87466),y=a(95545),n=a(37722),J=a(67679),K=a(88674),w=a(47496),Z=a(2783),C=a(92596),b=a(36727);function M(r,S){if(1&r){const s=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4),t._uU(3),t.ALo(4,"mytranslate"),t.TgZ(5,"a",5),t.NdJ("click",function(){t.CHM(s);const f=t.oxw();return t.KtG(f.openDialogCreateClassroom())}),t._uU(6),t.ALo(7,"mytranslate"),t.qZA(),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()()()}2&r&&(t.xp6(3),t.hij(" ",t.lcZ(4,3,"lang_auto_thay_co_chua_tao_lop_vui_long_click")," "),t.xp6(3),t.hij(" ",t.lcZ(7,5,"lang_testbank_test_config_come_in")," "),t.xp6(2),t.hij(" ",t.lcZ(9,7,"lang_testbank_test_config_create_classroom"),". "))}function R(r,S){1&r&&(t.ynx(0),t.TgZ(1,"div",9)(2,"span",10),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.BQk()),2&r&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"lang_testbank_no_classes_are_selected")))}function T(r,S){if(1&r&&(t.TgZ(0,"span",21),t._uU(1),t.ALo(2,"slice"),t.qZA()),2&r){const s=t.oxw(3).index,i=t.oxw(3);t.s9C("matTooltip",i.objs[s].name),t.xp6(1),t.AsE("",t.Dn7(2,3,i.objs[s].name,0,25)+"..."," (",i.objs[s].countStudents,")")}}function W(r,S){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&r){const s=t.oxw(3).index,i=t.oxw(3);t.xp6(1),t.AsE("",i.objs[s].name," (",i.objs[s].countStudents,")")}}function x(r,S){1&r&&(t.TgZ(0,"span",22),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&r&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_share")," "))}function z(r,S){if(1&r){const s=t.EpF();t.TgZ(0,"div",16)(1,"input",17),t.NdJ("change",function(){t.CHM(s);const f=t.oxw(2).index,j=t.oxw(3);return t.KtG(j.changeCheckboxEventLocal(j.objs[f]))}),t.qZA(),t.TgZ(2,"label",18),t.YNc(3,T,3,7,"span",19),t.YNc(4,W,2,2,"span",1),t.YNc(5,x,3,3,"span",20),t.ALo(6,"fullPermission"),t.qZA()()}if(2&r){const s=t.oxw(2).index,i=t.oxw(3);let f,j;t.xp6(1),t.s9C("id","azt-checkbox-item-"+i.objs[s].id),t.s9C("value",i.objs[s].id),t.Q6J("formControlName",s),t.xp6(1),t.s9C("for","azt-checkbox-item-"+i.objs[s].id),t.xp6(1),t.Q6J("ngIf",(null!==(f=null==i.objs[s].name?null:i.objs[s].name.length)&&void 0!==f?f:0)>25),t.xp6(1),t.Q6J("ngIf",(null!==(j=null==i.objs[s].name?null:i.objs[s].name.length)&&void 0!==j?j:0)<=25),t.xp6(1),t.Q6J("ngIf",!t.xi3(6,7,i.objs[s],"classroom"))}}function c(r,S){if(1&r&&(t.TgZ(0,"span",21),t._uU(1),t.ALo(2,"slice"),t.qZA()),2&r){const s=t.oxw(3).index,i=t.oxw(3);t.s9C("matTooltip",i.objs[s].name),t.xp6(1),t.AsE("",t.Dn7(2,3,i.objs[s].name,0,25)+"..."," (",i.objs[s].countStudents,")")}}function O(r,S){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&r){const s=t.oxw(3).index,i=t.oxw(3);t.xp6(1),t.AsE("",i.objs[s].name," (",i.objs[s].countStudents,")")}}function u(r,S){1&r&&(t.TgZ(0,"span",22),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&r&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_share")," "))}function p(r,S){if(1&r){const s=t.EpF();t.TgZ(0,"div",16)(1,"input",23),t.NdJ("change",function(){t.CHM(s);const f=t.oxw(2).index,j=t.oxw(3);return t.KtG(j.changeCheckboxEventLocal(j.objs[f]))}),t.qZA(),t.TgZ(2,"label",24),t.YNc(3,c,3,7,"span",19),t.YNc(4,O,2,2,"span",1),t.YNc(5,u,3,3,"span",20),t.ALo(6,"fullPermission"),t.qZA()()}if(2&r){const s=t.oxw(2).index,i=t.oxw(3);let f,j;t.xp6(1),t.s9C("id","azt-checkbox-item-"+s),t.s9C("value",i.objs[s].id),t.Q6J("disabled",!0)("formControlName",s),t.xp6(1),t.s9C("for","azt-checkbox-item-"+s),t.xp6(1),t.Q6J("ngIf",(null!==(f=null==i.objs[s].name?null:i.objs[s].name.length)&&void 0!==f?f:0)>25),t.xp6(1),t.Q6J("ngIf",(null!==(j=null==i.objs[s].name?null:i.objs[s].name.length)&&void 0!==j?j:0)<=25),t.xp6(1),t.Q6J("ngIf",!t.xi3(6,8,i.objs[s],"classroom"))}}function F(r,S){if(1&r&&(t.TgZ(0,"div",14),t.YNc(1,z,7,10,"div",15),t.ALo(2,"createPermission"),t.YNc(3,p,7,11,"div",15),t.ALo(4,"createPermission"),t.qZA()),2&r){const s=t.oxw().index,i=t.oxw(3);t.xp6(1),t.Q6J("ngIf",null!=i.objs[s].permissionObj&&t.xi3(2,2,i.objs[s],i.listPermissionTypes[i.permissionName])),t.xp6(2),t.Q6J("ngIf",!(null!=i.objs[s].permissionObj&&t.xi3(4,5,i.objs[s],i.listPermissionTypes[i.permissionName])))}}function k(r,S){if(1&r&&(t.ynx(0),t.YNc(1,F,5,8,"div",13),t.BQk()),2&r){const s=S.$implicit,i=S.index,f=t.oxw(3);t.xp6(1),t.Q6J("ngIf",f.objs[i]&&(null==f.form.controls.isShowCheckClass||!f.form.controls.isShowCheckClass.value||f.form.controls.isShowCheckClass.value&&s.value))}}function G(r,S){if(1&r&&(t.TgZ(0,"div",11),t.YNc(1,k,2,1,"ng-container",12),t.qZA()),2&r){const s=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",s.formArray.controls)}}function v(r,S){if(1&r&&(t.TgZ(0,"div")(1,"form",6),t.YNc(2,R,5,3,"ng-container",7),t.YNc(3,G,2,1,"ng-template",null,8,t.W1O),t.qZA()()),2&r){const s=t.MAs(4),i=t.oxw();t.xp6(1),t.Q6J("formGroup",i.form),t.xp6(1),t.Q6J("ngIf",!i.hasSelectedClassroom&&i.form.controls.isShowCheckClass.value)("ngIfElse",s)}}let N=(()=>{class r extends w.Q{changeCheckboxEventLocal(s){this.changeCheckboxEvent.emit(s)}initClassroomCheckbox(){this.formArray.clear();var s=[];if(this.homeworkObj?.classroomId&&s.push(this.homeworkObj.classroomId),this.examClassroomObjs.length)for(var i=0;i<this.examClassroomObjs.length;i++){let j=this.examClassroomObjs[i].classroomId;j&&s.push(j)}for(null!=this.shareClassroomIds&&(s=this.shareClassroomIds),i=0;i<this.objs.length;i++){var f=!1;let tt=this.objs[i].id;null!=tt&&s.includes(tt)&&(f=!0),this.addNewCheckBox(this.formArray,f)}}addNewCheckBox(s,i){const f=new e.NI(i,{nonNullable:!0});s.push(f)}checkShowCreateClassroom(){var s=this.sAztClassroomCheckboxService.findClassroomWithNoFullPermission(this.objs,this.permissionName);this.showCreateNewClassroom=s.length===this.objs.length}changeClassroomObjs(s){this.objs.push(s),this.checkShowCreateClassroom(),this.initClassroomCheckbox(),this.objsChange.emit(this.objs)}openDialogCreateClassroom(){this.sAztDialogService.open(K.s,{data:{},width:"500px",restoreFocus:!1}).afterClosed().subscribe(i=>{i&&i.obj&&this.changeClassroomObjs(i.obj)})}fillClassroomIdConfig(){const s=this.getMyQueryParam("classroomId");if(s)for(let i=0;i<this.formArray.controls.length;i++)this.objs[i].id===Number(s)&&this.formArray.controls[i].setValue(!0)}ngOnInit(){super.ngOnInit(),this.objs.map(s=>s.name=this.commonService.myTranslateInstant(s.name)??""),this.checkShowCreateClassroom(),this.formArray=this.form.controls.classroomIds,this.initClassroomCheckbox(),this.form.controls.classroomIds.valueChanges.subscribe(s=>{this.hasSelectedClassroom=this.formArray.controls.filter(i=>i.value).length>0}),this.form.controls.isShowCheckClass.valueChanges.subscribe(s=>{this.hasSelectedClassroom=this.formArray.controls.filter(i=>i.value).length>0}),this.fillClassroomIdConfig()}constructor(s,i){super(),this.sAztDialogService=s,this.sAztClassroomCheckboxService=i,this.changeCheckboxEvent=new t.vpe,this.formArray=new e.Oe([]),this.objs=[],this.objsChange=new t.vpe,this.permissionName=L.y.homework,this.examClassroomObjs=[],this.shareClassroomIds=void 0,this.listPermissionTypes=L.y,this.showCreateNewClassroom=!1,this.hasSelectedClassroom=!1}}return r.\u0275fac=function(s){return new(s||r)(t.Y36(Z.C),t.Y36(g.f))},r.\u0275cmp=t.Xpm({type:r,selectors:[["azt-list-classroom-checkbox"]],inputs:{form:"form",objs:"objs",permissionName:"permissionName",homeworkObj:"homeworkObj",examClassroomObjs:"examClassroomObjs",shareClassroomIds:"shareClassroomIds"},outputs:{changeCheckboxEvent:"changeCheckboxEvent",objsChange:"objsChange"},features:[t.qOj],decls:2,vars:2,consts:[["class","mt-2",4,"ngIf"],[4,"ngIf"],[1,"mt-2"],[1,"p-3"],[1,"text-create"],["azt-track-service","azt-list-classroom-checkbox-6scHm7Ch1-",1,"btn-text-primary",3,"click"],[3,"formGroup"],[4,"ngIf","ngIfElse"],["checkedBox",""],[1,"flex","items-center",2,"height","220px"],[1,"mx-auto"],["formArrayName","classroomIds",1,"grid","grid-cols-12","gap-3","p-3"],[4,"ngFor","ngForOf"],["class","col-span-12 md:col-span-6 mt-2",4,"ngIf"],[1,"col-span-12","md:col-span-6","mt-2"],["class","azt-checkbox-item",4,"ngIf"],[1,"azt-checkbox-item"],["type","checkbox",1,"form-check-input",3,"id","formControlName","value","change"],[1,"form-check-label",2,"vertical-align","middle",3,"for"],[3,"matTooltip",4,"ngIf"],["class","ml-2 py-0.5 px-2 rounded-full text-xs bg-primary text-white cursor-pointer font-medium",4,"ngIf"],[3,"matTooltip"],[1,"ml-2","py-0.5","px-2","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium"],["type","checkbox",1,"form-check-input",3,"id","disabled","formControlName","value","change"],[1,"form-check-label",3,"for"]],template:function(s,i){1&s&&(t.YNc(0,M,10,9,"div",0),t.YNc(1,v,5,3,"div",1)),2&s&&(t.Q6J("ngIf",i.showCreateNewClassroom),t.xp6(1),t.Q6J("ngIf",i.form))},dependencies:[d.sg,d.O5,C.gM,e._Y,e.Wl,e.JJ,e.JL,e.sg,e.u,e.CE,J.M,d.OU,b.JV,b.NK,b.nq],encapsulation:2}),r})();function h(r,S){1&r&&(t.ynx(0),t._uU(1),t.ALo(2,"mytranslate"),t.BQk()),2&r&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_remove_all_classroom")," "))}function U(r,S){1&r&&(t._uU(0),t.ALo(1,"mytranslate")),2&r&&t.hij(" ",t.lcZ(1,1,"lang_select_all_classroom")," ")}let _=(()=>{class r extends w.Q{toggleAllCheckBox(s){let i=s.target.checked,f=this.sAztClassroomCheckboxService.findClassroomWithNoPermission(this.objs,this.permissionName);if(this.formArray)for(var j=0;j<this.formArray.controls.length;j++)this.objs[j]&&null!=this.objs[j].permissionObj&&!this.commonService.isExistInArray(f,this.objs[j].id)&&this.formArray.controls[j].setValue(i);this.calculateIsCheckAll(),this.changeCheckboxEvent.emit(void 0)}clearAllCheckBox(){var s=this.sAztClassroomCheckboxService.findClassroomWithNoPermission(this.objs,this.permissionName);if(this.formArray)for(var i=0;i<this.formArray.controls.length;i++)this.objs[i]&&null!=this.objs[i].permissionObj&&!this.commonService.isExistInArray(s,this.objs[i].id)&&this.formArray.controls[i].setValue(!1);this.calculateIsCheckAll(),this.changeCheckboxEvent.emit(void 0)}checkAllCheckBox(){var s=this.sAztClassroomCheckboxService.findClassroomWithNoPermission(this.objs,this.permissionName);if(this.formArray)for(var i=0;i<this.formArray.controls.length;i++)this.objs[i]&&null!=this.objs[i].permissionObj&&!this.commonService.isExistInArray(s,this.objs[i].id)&&this.formArray.controls[i].setValue(!0);this.calculateIsCheckAll(),this.changeCheckboxEvent.emit(void 0)}calculateIsCheckAll(){for(var s=!0,i=this.sAztClassroomCheckboxService.findClassroomWithNoPermission(this.objs,this.permissionName),f=0;f<this.formArray.controls.length;f++)this.objs[f]&&null!=this.objs[f].permissionObj&&!this.commonService.isExistInArray(i,this.objs[f].id)&&(this.formArray.controls[f].value||(s=!1));this.isCheckAll=s}ngOnInit(){super.ngOnInit(),this.calculateIsCheckAll(),this.formArray.valueChanges.subscribe(s=>{this.calculateIsCheckAll()})}constructor(s){super(),this.sAztClassroomCheckboxService=s,this.changeCheckboxEvent=new t.vpe,this.formArray=new e.Oe([]),this.objs=[],this.isCheckAll=!1}}return r.\u0275fac=function(s){return new(s||r)(t.Y36(g.f))},r.\u0275cmp=t.Xpm({type:r,selectors:[["azt-list-classroom-check-all"]],inputs:{formArray:"formArray",objs:"objs",permissionName:"permissionName"},outputs:{changeCheckboxEvent:"changeCheckboxEvent"},features:[t.qOj],decls:7,vars:4,consts:[[3,"hidden"],[1,"form-check"],["id","checkbox-all","type","checkbox",1,"form-check-input",3,"checked","change"],["for","checkbox-all",1,"form-check-label"],[4,"ngIf","ngIfElse"],["elseTemplate",""]],template:function(s,i){if(1&s&&(t.TgZ(0,"span",0)(1,"div",1)(2,"input",2),t.NdJ("change",function(j){return i.toggleAllCheckBox(j)}),t.qZA(),t.TgZ(3,"label",3),t.YNc(4,h,3,3,"ng-container",4),t.YNc(5,U,2,3,"ng-template",null,5,t.W1O),t.qZA()()()),2&s){const f=t.MAs(6);t.Q6J("hidden",i.objs.length<=0),t.xp6(2),t.Q6J("checked",i.isCheckAll),t.xp6(2),t.Q6J("ngIf",i.isCheckAll)("ngIfElse",f)}},dependencies:[d.O5,b.JV],encapsulation:2}),r})();var A=a(71646);function I(r,S){1&r&&(t.TgZ(0,"div",8)(1,"span",9),t._UZ(2,"azt-loading-ui"),t.qZA(),t.TgZ(3,"span",10),t._uU(4,"Loading..."),t.qZA()())}function Q(r,S){1&r&&(t.TgZ(0,"div",29)(1,"div",30),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&r&&(t.xp6(2),t.hij("*** ",t.lcZ(3,1,"lang_testbank_test_config_you_not_yet_class"),""))}function H(r,S){if(1&r){const s=t.EpF();t.TgZ(0,"div",31)(1,"span",32),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"button",33),t.NdJ("click",function(){t.CHM(s);const f=t.oxw(3);return t.KtG(f.showCopySuccess())}),t.TgZ(5,"div",34),t._UZ(6,"lucide-icon",35),t.qZA(),t._uU(7," Copy link "),t.qZA()()}if(2&r){const s=t.oxw(3);t.xp6(2),t.Oqu(t.lcZ(3,3,"lang_auto_copy_link_gui_cho_hoc_sinh")),t.xp6(2),t.Q6J("cdkCopyToClipboard",s.copyLinkToClipboard())("disabled",2==s.form.controls.chooseOption.value&&(null==s.form.controls.classroomIds.errors?null:s.form.controls.classroomIds.errors.classroomCheckBoxValidatorWithoutWhoAllow))}}function q(r,S){1&r&&(t.TgZ(0,"div",36)(1,"p",37),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&r&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"lang_auto_chua_duoc_cau_hinh_tra_de_thi")))}const V=function(r){return{"h-56-important":r}};function X(r,S){if(1&r){const s=t.EpF();t.ynx(0),t.TgZ(1,"div",15)(2,"mat-radio-group",16),t.NdJ("change",function(){t.CHM(s);const f=t.oxw(2);return t.KtG(f.changeStatusOfflineShare(void 0))}),t.TgZ(3,"mat-radio-button",17),t._uU(4),t.ALo(5,"mytranslate"),t.qZA(),t.TgZ(6,"mat-radio-button",18),t._uU(7),t.ALo(8,"mytranslate"),t.qZA(),t.TgZ(9,"mat-radio-button",18),t._uU(10),t.ALo(11,"mytranslate"),t.qZA()()(),t.TgZ(12,"div",19)(13,"div",20)(14,"azt-list-classroom-check-all",21),t.NdJ("changeCheckboxEvent",function(f){t.CHM(s);const j=t.oxw(2);return t.KtG(j.changeStatusOfflineShare(f))}),t.qZA()(),t.TgZ(15,"div",22)(16,"ng-scrollbar",23)(17,"azt-list-classroom-checkbox",24),t.NdJ("changeCheckboxEvent",function(f){t.CHM(s);const j=t.oxw(2);return t.KtG(j.changeStatusOfflineShare(f))}),t.qZA()()()(),t.YNc(18,Q,4,3,"div",25),t.TgZ(19,"div",26),t.YNc(20,H,8,5,"div",27),t.qZA(),t.YNc(21,q,4,3,"div",28),t.ALo(22,"fullPermission"),t.BQk()}if(2&r){const s=t.oxw(2);t.xp6(3),t.Q6J("checked",0==s.form.controls.chooseOption.value)("value",0),t.xp6(1),t.Oqu(t.lcZ(5,24,"lang_auto_khong")),t.xp6(2),t.Q6J("checked",1==s.form.controls.chooseOption.value)("value",1),t.xp6(1),t.Oqu(t.lcZ(8,26,"lang_auto_tat_ca_cac_lop")),t.xp6(2),t.Q6J("checked",2==s.form.controls.chooseOption.value)("value",2),t.xp6(1),t.Oqu(t.lcZ(11,28,"lang_auto_tuy_chon_theo_lop")),t.xp6(2),t.Q6J("hidden",2!=s.form.controls.chooseOption.value),t.xp6(2),t.Q6J("formArray",s.form.controls.classroomIds)("objs",s.classroomObjs)("permissionName",s.permissionTypes.exam),t.xp6(2),t.Q6J("visibility","hover")("autoHeightDisabled",!1)("ngClass",t.VKq(33,V,s.isMobileWebView)),t.xp6(1),t.Q6J("form",s.form)("formArrayName","classroomIds")("objs",s.classroomObjs)("shareClassroomIds",s.shareClassroomIds)("permissionName",s.permissionTypes.exam),t.xp6(1),t.Q6J("ngIf",2==s.form.controls.chooseOption.value&&s.form.controls.classroomIds.errors),t.xp6(2),t.Q6J("ngIf",0!=s.form.controls.chooseOption.value),t.xp6(1),t.Q6J("ngIf",!t.xi3(22,30,s.examWithPermissionObj,"exam"))}}function $(r,S){1&r&&(t.TgZ(0,"div",39)(1,"p",37),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&r&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"lang_auto_chua_duoc_cau_hinh_tra_de_thi")))}function ot(r,S){if(1&r&&(t.YNc(0,$,4,3,"div",38),t.ALo(1,"fullPermission")),2&r){const s=t.oxw(2);t.Q6J("ngIf",!t.xi3(1,1,s.examWithPermissionObj,"exam"))}}function nt(r,S){if(1&r&&(t.TgZ(0,"form",11)(1,"div",12),t.YNc(2,X,23,35,"ng-container",13),t.ALo(3,"fullPermission"),t.YNc(4,ot,2,4,"ng-template",null,14,t.W1O),t.qZA()()),2&r){const s=t.MAs(5),i=t.oxw();t.Q6J("formGroup",i.form),t.xp6(2),t.Q6J("ngIf",t.xi3(3,3,i.examWithPermissionObj,"exam"))("ngIfElse",s)}}function st(r,S){if(1&r){const s=t.EpF();t.TgZ(0,"div",40)(1,"button",41),t.NdJ("click",function(){t.CHM(s);const f=t.oxw();return t.KtG(f.btnCloseDialog(!1))}),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()}2&r&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_auto_dong")," "))}let at=(()=>{class r extends B.e{btnCloseDialog(s){this.dialogRef.close(s)}copyLinkToClipboard(){let s=this.commonService.getCurrentDomain();return this.linkCopy=`${s}/de-thi/${this.examWithPermissionObj?.hashId}?offline=${this.offlineCode}`,this.linkCopy}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong")}getCodeOfflineShare(){this.initStatusObj(),this.waitDestroy(this.offlineShareService.apiOfflineShareGetObjGet(this.examHashId).subscribe(s=>{1==s.success?(this.offlineCode=s.data?.shareHashId??"",this.classroomObjs=s.data?.classroomObjs??[],this.shareClassroomIds=s.data?.shareClassroomIds??[],this.examWithPermissionObj=s.data?.examObj,this.form.controls.chooseOption.setValue(s.data?.showOfflineResult??0),this.successStatusObj()):this.errorStatusObj(s.message??"",!0)}))}changeStatusOfflineShare(s){if(2==this.form.getRawValue().chooseOption&&this.form.controls.classroomIds.errors?.classroomCheckBoxValidatorWithoutWhoAllow)return;let i=this.form.getRawValue().chooseOption;var f=this.sAztClassroomCheckboxService.findClassroomWithNoPermission(this.classroomObjs,L.y.homework);f.push(0);const j=2!=i?[]:this.sAztClassroomCheckboxService.getClassroomIdsChecked(this.classroomObjs,f,this.form.getRawValue().classroomIds);this.waitDestroy(this.offlineShareService.apiOfflineShareChangeStatusPost({examHashId:this.examWithPermissionObj?.hashId??"",status:i,classroomIds:j}).subscribe(et=>{1==et.success?this.offlineCode=et.data?.shareHashId??"":this.errorStatusObj(et.message??"",!0)}))}ngOnInit(){super.ngOnInit(),this.getCodeOfflineShare()}constructor(s,i,f,j){super(f,i),this.offlineShareService=s,this.dialogRef=i,this.sAztClassroomCheckboxService=j,this.examHashId="",this.useDialog=!1,this.permissionTypes=L.y,this.offlineCode="",this.linkCopy="",this.examWithPermissionObj=void 0,this.classroomObjs=[],this.shareClassroomIds=[],this.examHashId=f.examHashId?f.examHashId:this.examHashId,this.useDialog=f?f.useDialog:this.useDialog,this.form=new e.cw({chooseOption:new e.NI(0,{nonNullable:!0}),whoAllow:new e.NI(0,{nonNullable:!0}),classroomIds:new e.Oe([]),classroomFormArray:new e.Oe([]),isShowCheckClass:new e.NI(!1,{nonNullable:!0})},{validators:[o.h.classroomCheckBoxValidatorWithoutWhoAllow]})}}return r.\u0275fac=function(s){return new(s||r)(t.Y36(m.kN),t.Y36(l.so,8),t.Y36(l.WI,8),t.Y36(g.f))},r.\u0275cmp=t.Xpm({type:r,selectors:[["azt-offline-share"]],inputs:{examHashId:"examHashId",useDialog:"useDialog"},features:[t.qOj],decls:12,vars:6,consts:[[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],[1,"intro-y"],[1,"text-base","font-medium","mr-auto"],["class","d-flex justify-content-center align-items-center",4,"ngIf","ngIfElse"],["doneLoading",""],["class","text-right mt-3",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center"],[1,"w-4","h-4","inline-block"],[1,"sr-only","ml-2"],[3,"formGroup"],[1,"block-body"],[4,"ngIf","ngIfElse"],["noFullPermission",""],[1,"input-toggle"],["color","primary","formControlName","chooseOption",2,"flex-direction","column",3,"change"],[3,"checked","value"],[1,"mt-1",3,"checked","value"],[1,"block-main-classroom",3,"hidden"],[1,"classroom_check_all"],[3,"formArray","objs","permissionName","changeCheckboxEvent"],[1,"classroom_list"],["pointerEventsMethod","scrollbar",1,"w-full",3,"visibility","autoHeightDisabled","ngClass"],[3,"form","formArrayName","objs","shareClassroomIds","permissionName","changeCheckboxEvent"],["class","col-span-12 pl-0 pt-3",4,"ngIf"],[1,"block-main","mt-2"],["class","block-copy",4,"ngIf"],["class","block-else",4,"ngIf"],[1,"col-span-12","pl-0","pt-3"],[1,"text-left","text-danger"],[1,"block-copy"],[1,"title-copy","mr-2"],["azt-track-service","azt-offline-share-6FNwLsA2D",1,"btn","btn-primary",3,"cdkCopyToClipboard","disabled","click"],[1,"w-4","h-4","mr-2"],["name","copy"],[1,"block-else"],[1,"note"],["class","block-else text-center",4,"ngIf"],[1,"block-else","text-center"],[1,"text-right","mt-3"],["azt-track-service","azt-offline-share-hrBGx7oL2r",1,"btn","w-24","btn-secondary",3,"click"]],template:function(s,i){if(1&s&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t.TgZ(7,"div",3),t.YNc(8,I,5,0,"div",5),t.YNc(9,nt,6,6,"ng-template",null,6,t.W1O),t.qZA(),t.YNc(11,st,4,3,"div",7),t.qZA()()()),2&s){const f=t.MAs(10);t.xp6(5),t.Oqu(t.lcZ(6,4,"lang_auto_tra_ket_qua_thi_offline")),t.xp6(3),t.Q6J("ngIf",i.statusObj.loading)("ngIfElse",f),t.xp6(3),t.Q6J("ngIf",i.useDialog)}},dependencies:[d.mk,d.O5,E.i3,D.VQ,D.U0,e._Y,e.JJ,e.JL,e.sg,e.u,e.CE,y.KC,n.Nh5,J.M,N,_,A.n,b.JV,b.NK],styles:[".school-info_bg[_ngcontent-%COMP%]{z-index:1000;width:100%;display:flex;left:0;top:0;position:fixed;height:100%;min-height:100vh;background-color:#3c3c3c80}.block-note[_ngcontent-%COMP%]{padding:5px}.note[_ngcontent-%COMP%]{color:#acacac}.school-info[_ngcontent-%COMP%]{z-index:1001;top:50%;left:50%;transform:translate(-50%,-50%);position:fixed;width:500px;min-height:180px;background:#fff;margin-left:auto;margin-right:auto;box-shadow:0 0 13px 3px #00000094}.btn-close[_ngcontent-%COMP%]{transition:all .5s}.btn-close[_ngcontent-%COMP%]:hover{background:#dfe6e9}mat-radio-group[_ngcontent-%COMP%]{margin:10px 5px;width:90%;display:flex;justify-content:space-between}.block-title[_ngcontent-%COMP%]{text-align:center;font-size:18px;font-weight:500}.block-main-classroom[_ngcontent-%COMP%]{padding:10px;border:1px solid #908e8e;border-radius:5px;height:200px;overflow:hidden}.classroom-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:15px}.btn-copy[_ngcontent-%COMP%]{border-radius:5px;transition:all .5s;text-transform:inherit}.btn-copy[_ngcontent-%COMP%]:hover:not([disabled]){background:rgba(211,211,211,.58)}@media only screen and (max-width: 1024px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:800px}}@media only screen and (max-width: 768px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:700px}}@media only screen and (max-width: 576px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:400px}.classroom-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}@media only screen and (max-width: 380px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:300px}}@media only screen and (max-width: 290px){.school-info[_ngcontent-%COMP%]{width:95%;max-width:250px}}"]}),r})()},62836:(Y,P,a)=>{a.d(P,{H:()=>N});var e=a(65879),l=a(19347),B=a(72164),L=a(89745),o=a(89156),t=a(10504),m=a(97151),g=a(92296),d=a(94690),E=a(56260),D=a(3849),y=a(49870),n=a(17997),J=a(96814),K=a(70342),w=a(77988),Z=a(92596),C=a(37722),b=a(80034),M=a(34340),R=a(78497),T=a(52467),W=a(71646),x=a(36727);function z(h,U){if(1&h&&(e.TgZ(0,"a",31),e.ALo(1,"mytranslate"),e.TgZ(2,"span",21),e._UZ(3,"lucide-icon",32),e.qZA()()),2&h){e.oxw(2);const _=e.MAs(3);e.s9C("matTooltip",e.lcZ(1,2,"lang_auto_tai_ve")),e.Q6J("matMenuTriggerFor",_)}}function c(h,U){if(1&h){const _=e.EpF();e.TgZ(0,"a",33),e.NdJ("click",function(){e.CHM(_);const I=e.oxw(2);return e.KtG(I.showCopySuccess())}),e.ALo(1,"mytranslate"),e.TgZ(2,"span",5),e._UZ(3,"lucide-icon",34),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"mytranslate"),e.qZA()()}if(2&h){const _=e.oxw(2);e.s9C("matTooltip",e.lcZ(1,3,"lang_auto_copy_link_de_thi")),e.Q6J("cdkCopyToClipboard",_.copyLinkExam()),e.xp6(5),e.Oqu(e.lcZ(6,5,"lang_auto_copy_link"))}}function O(h,U){1&h&&(e.TgZ(0,"div",35)(1,"span",36),e._UZ(2,"azt-loading-ui"),e.qZA(),e.TgZ(3,"span",37),e._uU(4),e.ALo(5,"mytranslate"),e.qZA()()),2&h&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"lang_auto_dang_chuan_bi_tai_lieu_doing")))}function u(h,U){if(1&h&&(e.TgZ(0,"div",38),e._UZ(1,"div",39),e.ALo(2,"safeAdminHtmlContent"),e.qZA()),2&h){const _=e.oxw(2);e.xp6(1),e.Q6J("innerHtml",e.lcZ(2,1,_.data.headerContent),e.oJD)}}function p(h,U){if(1&h&&e._UZ(0,"azt-loaded-img",40),2&h){const _=e.oxw(2);e.Q6J("imgSrc",_.data.obj.examHeader)}}function F(h,U){if(1&h&&e._UZ(0,"azt-question-standalone-for-preview",42),2&h){const _=e.oxw(),A=_.$implicit,I=_.index,Q=e.oxw(2);e.Q6J("examObj",Q.examObj)("questionObj",A)("follower",Q.followerRenderQuest)("curQuestionIndex",I)("isShowExplain",Q.showExplanation)}}function k(h,U){if(1&h&&(e.ynx(0),e.YNc(1,F,1,5,"azt-question-standalone-for-preview",41),e.BQk()),2&h){const _=e.oxw(2);e.xp6(1),e.Q6J("ngIf",_.examObj)}}function G(h,U){if(1&h){const _=e.EpF();e.ynx(0),e.TgZ(1,"div",11)(2,"div",12)(3,"div",13)(4,"div",14)(5,"div",15),e.YNc(6,z,4,4,"a",16),e.YNc(7,c,7,7,"a",17),e.TgZ(8,"button",18),e.NdJ("click",function(){e.CHM(_);const I=e.oxw();return e.KtG(I.showAllExplanation())}),e._uU(9),e.ALo(10,"mytranslate"),e.ALo(11,"mytranslate"),e.qZA()()(),e.TgZ(12,"div",19)(13,"a",20)(14,"span",21),e._UZ(15,"lucide-icon",22),e.qZA()()()(),e.TgZ(16,"azt-mat-dialog-content",23),e.YNc(17,O,6,3,"div",24),e.TgZ(18,"div",25),e._UZ(19,"div",26),e.YNc(20,u,3,3,"div",27),e.YNc(21,p,1,1,"azt-loaded-img",28),e.YNc(22,k,2,1,"ng-container",29),e._UZ(23,"div",30),e.qZA()()()(),e.BQk()}if(2&h){const _=e.oxw();e.xp6(6),e.Q6J("ngIf",!(null!=_.data&&_.data.globalLadingPage||_.data.allowHeader)),e.xp6(1),e.Q6J("ngIf",0==(null==_.data?null:_.data.isOnLib)&&!(null!=_.data&&_.data.globalLadingPage)),e.xp6(2),e.Oqu(_.showExplanation?e.lcZ(10,8,"lang_auto_an_giai_thich"):e.lcZ(11,10,"lang_auto_xem_giai_thich")),e.xp6(7),e.Q6J("defaultHeight",70),e.xp6(1),e.Q6J("ngIf",_.statusObj.loading),e.xp6(3),e.Q6J("ngIf",_.data.allowHeader&&!_.statusObj.loading),e.xp6(1),e.Q6J("ngIf",null==_.data||null==_.data.obj?null:_.data.obj.examHeader),e.xp6(1),e.Q6J("ngForOf",_.questionList)}}function v(h,U){if(1&h){const _=e.EpF();e.TgZ(0,"azt-export-excel-for-answersheet",43),e.NdJ("exportDataDone",function(I){e.CHM(_);const Q=e.oxw();return e.KtG(Q.exportDataDone(I))}),e.qZA()}if(2&h){const _=e.oxw();let A;e.Q6J("startQuestionIndex",null!==(A=null==_.examObj?null:_.examObj.startQuestionIndex)&&void 0!==A?A:1)("obj",_.exportExcelData)}}let N=(()=>{class h extends B.e{btnCloseDialog(){this.closeDialog.emit()}copyLinkExam(){return`${this.commonService.getCurrentDomain()}/de-thi/${this.data?.obj?.hashId}`}showCopySuccess(){this.commonService.snackSuccess("lang_auto_sao_chep_thanh_cong")}downloadExam(_){let A=this.commonService.myTranslateInstant("lang_auto_dang_khoi_tao_du_lieu")??"";o.G.openLoadingEffect(`${A}...`);let I={nameSchool:this.printAddInfo.nameSchool??"",nameSubject:this.printAddInfo.nameSubject??""},Q=this.printAddInfo.templateType??0;this.data.obj&&(this.data.obj.hideGroupQuestion=0,this.exportSAztDocxService.downloadExam(_,{...this.data.obj,editable:!1,allowStudentView:!0},void 0,void 0,this.cloneQuestionList,I,Q,void 0,void 0,void 0,!0).catch(H=>{this.showErrorSnack(H.message)}))}getData(_){this.initStatusObj(),this.data?.globalLadingPage?this.examService.apiExamGetGlobalQuestionsIdGet(_?.id??0).subscribe(A=>{const I=this.commonService.castJsonToClassObjs(L.v,JSON.stringify(A.data?.questionObjs||[]))??[];this.followerRenderQuest.setNumQuest(I.length),this.addRoleQuestion(I),this.cloneQuestionList=this.commonService.myClone(I),this.questionList=I,this.examObj=A.data?.examObj,this.successStatusObj()}):this.permissionService.hasViewPermission("exam",_)?this.examService.apiExamGetQuestionsIdGet(_?.id??0).subscribe(A=>{const I=this.commonService.castJsonToClassObjs(L.v,JSON.stringify(A.data?.questionObjs||[]))??[];this.followerRenderQuest.setNumQuest(I.length),this.addRoleQuestion(I),this.cloneQuestionList=this.commonService.myClone(I),this.questionList=I,this.examObj=A.data?.examObj,this.successStatusObj()}):this.showErrorSnack("lang_auto_ban_khong_co_quyen_thuc_thi_chuc_nang_nay")}addRoleQuestion(_){for(let A=0;A<_.length;A++)_[A].isRoleTeacher=!0}downloadExamAnswer(){this.waitDestroy(this.offlineExamExportService.apiOfflineExamExportExportResultOfRawExamGet(this.examObj?.hashId??"").subscribe(_=>{if(_.success){let A=_.data?.obj;A?.offlineMixQuestionObjs&&A.offlineMixQuestionObjs.length>0&&(this.exportExcelData=this.commonService.myClone(A))}else this.errorStatusObj(_.message??"")}))}exportDataDone(_){let A=this.createNameExam("answerexcel",!1);this.shareFileFlutterService.shareFileWithBlob(_,A)}createNameExam(_,A){let I="";I="answersheet"==_?this.printAnswersheetService.exportFileNameOfAnswerSheet(0,this.examObj?.name??"",""):"answerexcel"==_?this.printAnswersheetService.exportFileNameOfAnswerExcelOffline(0,this.examObj?.name??"",""):this.printAnswersheetService.exportFileNameOfExamOffline(0,this.examObj?.name??"","",void 0),A&&(I=this.commonService.replaceAll(I,"_","-")??"");let Q=".docx";return Q="answersheet"==_?".pdf":Q,Q="answerexcel"==_?".xlsx":Q,I+Q}showAllExplanation(){this.showExplanation=!this.showExplanation}ngOnChanges(){this.data?.obj&&this.getData(this.data.obj)}ngOnInit(){this.data?.obj&&this.getData(this.data.obj),super.ngOnInit()}constructor(_,A,I,Q,H,q,V,X,$){super($,X),this.shareFileFlutterService=_,this.baseApiService=A,this.permissionService=I,this.exportSAztDocxService=Q,this.examService=H,this.offlineExamExportService=q,this.printAnswersheetService=V,this.dialogRef=X,this.data=$,this.closeDialog=new e.vpe,this.questionList=[],this.cloneQuestionList=[],this.followerRenderQuest=new t.p,this.printAddInfo={},this.showExplanation=!1}}return h.\u0275fac=function(_){return new(_||h)(e.Y36(m.g),e.Y36(g.V),e.Y36(d.j),e.Y36(E.F),e.Y36(D.O),e.Y36(y.qr),e.Y36(n.H),e.Y36(l.so,8),e.Y36(l.WI,8))},h.\u0275cmp=e.Xpm({type:h,selectors:[["azt-preview-exam"]],outputs:{closeDialog:"closeDialog"},features:[e.qOj,e.TTD],decls:25,vars:14,consts:[[4,"ngIf"],["menuDownload","matMenu"],[1,"dropdown-menu","show","relative","w-72"],[1,"dropdown-content"],["azt-track-service","azt-preview-exam-4UtiW7OU6PC",1,"dropdown-item",3,"click"],[1,"w-4","h-4","mr-2","flex-none"],["name","file-check"],["azt-track-service","azt-preview-exam--mJB2JKFgNu",1,"dropdown-item",3,"click"],["name","file-spreadsheet"],["name","file-text"],[3,"startQuestionIndex","obj","exportDataDone",4,"ngIf"],[1,"az-dialog-info"],[1,"box",2,"overflow-x","hidden"],[1,"flex","items-center","p-2","bg-slate-100","dark:bg-darkmode-400"],[1,"mr-auto"],[1,"flex","items-center","mr-2"],["class","btn btn-sm btn-outline-secondary btn-transparent mr-2",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["azt-track-service","azt-preview-exam-dgdyLZO48Hq","class","btn btn-sm btn-outline-secondary btn-transparent mr-2",3,"matTooltip","cdkCopyToClipboard","click",4,"ngIf"],[1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"click"],[1,"ml-auto"],["azt-track-service","azt-preview-exam-y2xqBN7DlGX",1,"btn","btn-transparent","btn-outline-danger","btn-sm",3,"mat-dialog-close"],[1,"w-4","h-4","flex-none"],["name","x"],[1,"mt-3",3,"defaultHeight"],["class","flex justify-center items-center h-40",4,"ngIf"],["id","boxContentQuestion",1,"p-2"],[1,"pt-3"],["class","box p-3 mb-3",4,"ngIf"],["style","display: block","class","mt-5",3,"imgSrc",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"py-5"],[1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"matTooltip","matMenuTriggerFor"],["name","download"],["azt-track-service","azt-preview-exam-dgdyLZO48Hq",1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"matTooltip","cdkCopyToClipboard","click"],["name","copy"],[1,"flex","justify-center","items-center","h-40"],[1,"w-4","h-4","inline-block"],[1,"sr-only","ml-2"],[1,"box","p-3","mb-3"],[2,"line-height","1.5",3,"innerHtml"],[1,"mt-5",2,"display","block",3,"imgSrc"],[3,"examObj","questionObj","follower","curQuestionIndex","isShowExplain",4,"ngIf"],[3,"examObj","questionObj","follower","curQuestionIndex","isShowExplain"],[3,"startQuestionIndex","obj","exportDataDone"]],template:function(_,A){1&_&&(e.YNc(0,G,24,12,"ng-container",0),e.ALo(1,"viewPermission"),e.TgZ(2,"mat-menu",null,1)(4,"div",2)(5,"ul",3)(6,"li")(7,"a",4),e.NdJ("click",function(){return A.downloadExam(!1)}),e.TgZ(8,"span",5),e._UZ(9,"lucide-icon",6),e.qZA(),e._uU(10),e.ALo(11,"mytranslate"),e.qZA()(),e.TgZ(12,"li")(13,"a",7),e.NdJ("click",function(){return A.downloadExamAnswer()}),e.TgZ(14,"span",5),e._UZ(15,"lucide-icon",8),e.qZA(),e._uU(16),e.ALo(17,"mytranslate"),e.qZA()(),e.TgZ(18,"li")(19,"a",7),e.NdJ("click",function(){return A.downloadExam(!0)}),e.TgZ(20,"span",5),e._UZ(21,"lucide-icon",9),e.qZA(),e._uU(22),e.ALo(23,"mytranslate"),e.qZA()()()()(),e.YNc(24,v,1,2,"azt-export-excel-for-answersheet",10)),2&_&&(e.Q6J("ngIf",e.xi3(1,5,null==A.data?null:A.data.obj,"exam")||(null==A.data?null:A.data.globalLadingPage)),e.xp6(10),e.hij(" ",e.lcZ(11,8,"lang_auto_tai_xuong_de_thi")," "),e.xp6(6),e.hij(" ",e.lcZ(17,10,"lang_auto_tai_xuong_dap_an_de_thi")," "),e.xp6(6),e.hij(" ",e.lcZ(23,12,"lang_azt_download_exam_paper_with_detailed_answers")," "),e.xp6(2),e.Q6J("ngIf",null!=A.exportExcelData))},dependencies:[J.sg,J.O5,K.i3,l.ZT,w.VK,w.p6,Z.gM,C.Nh5,b.y,M.A,R.R,T.S,W.n,x.JV,x.Tm,x.J7],encapsulation:2}),h})()}}]);