"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[733],{33733:(E,D,c)=>{c.r(D),c.d(D,{HomeworkModule:()=>Ie});var b=c(96814),n=c(56223),x=c(19347),y=c(21266),r=c(42753),d=c(37722),f=c(21494),k=c(95545),O=c(23348),z=c(84155),H=c(78217),w=c(35529),T=c(24406),v=c(82481),Z=c(71026),j=c(29023),I=c(69862),ut=c(73445),V=c(23680),K=c(52572),gt=c(44683),pt=c(13217),W=c(76359),$=c(84003),N=c(47496),_t=c(47180),ft=c(91765),R=c(61713),bt=c(15828),kt=c(20553),t=c(65879),P=c(2783),A=c(79995),B=c(82228),L=c(85929),vt=c(2816),X=c(88489),wt=c(90592),xt=c(71814),yt=c(71069),tt=c(32296),Ot=c(2032),q=c(64170),et=c(92596),Q=c(43389),Y=c(67679),St=c(68547),jt=c(76476),Ct=c(86717),Dt=c(7081),it=c(98129),C=c(40750);const At=["startTime"],Mt=["endTime"];function Tt(o,_){1&o&&t._UZ(0,"azt-loading-effect")}function Zt(o,_){1&o&&(t.TgZ(0,"div",102),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_auto_vui_long_nhap_ten_bai_tap")," "))}function It(o,_){1&o&&(t.TgZ(0,"div",103),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"lang_testbank_test_config_end_time_bigger_time_star"),". "))}function Nt(o,_){1&o&&(t.TgZ(0,"div",104),t.O4$(),t.TgZ(1,"svg",105)(2,"g",106)(3,"g",107),t._UZ(4,"circle",108),t.TgZ(5,"path",109),t._UZ(6,"animateTransform",110),t.qZA()()()()())}function Et(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"div",111)(1,"button",112),t.NdJ("click",function(){const s=t.CHM(e).index,m=t.oxw(2);return t.KtG(!!m.formHomework.files&&m.formHomework.files.splice(s,1))}),t.O4$(),t.TgZ(2,"svg",27),t._UZ(3,"line",113)(4,"line",114),t.qZA()(),t.kcU(),t.TgZ(5,"a",115),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.onShowFile(s,-1))}),t.TgZ(6,"span",116),t._uU(7),t.qZA()()()}if(2&o){const e=_.$implicit;t.xp6(6),t.Q6J("title",e.name),t.xp6(1),t.Oqu(e.name)}}function Pt(o,_){1&o&&(t.TgZ(0,"div",117)(1,"div",118),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_testbank_test_config_you_not_yet_class")," "))}const Lt=function(){return{standalone:!0}},Ut=function(o){return{"h-56-important":o}};function Jt(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"form",4)(2,"div",5)(3,"div",6)(4,"h3",7),t._uU(5),t.ALo(6,"mytranslate"),t.qZA(),t.TgZ(7,"div",8)(8,"div",9)(9,"div",10)(10,"label",11),t._uU(11),t.ALo(12,"mytranslate"),t.qZA()(),t.TgZ(13,"div",10)(14,"div",12),t._UZ(15,"input",13),t.ALo(16,"mytranslate"),t.qZA(),t.YNc(17,Zt,3,3,"div",14),t.qZA()(),t.TgZ(18,"div",15)(19,"div",16)(20,"label",17),t._uU(21),t.ALo(22,"mytranslate"),t.O4$(),t.TgZ(23,"svg",18),t.ALo(24,"mytranslate"),t._UZ(25,"circle",19)(26,"line",20)(27,"line",21),t.qZA()()(),t.kcU(),t.TgZ(28,"div",16)(29,"div",22)(30,"div",23)(31,"mat-form-field",24)(32,"input",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openDateTimePicker(1))}),t.ALo(33,"mytranslate"),t.qZA(),t.TgZ(34,"button",26),t.NdJ("click",function(i){return t.CHM(e),t.oxw().openDateTimePicker(1),t.KtG(i.stopPropagation())}),t.O4$(),t.TgZ(35,"svg",27),t._UZ(36,"path",28)(37,"path",29)(38,"path",30)(39,"path",31)(40,"path",32)(41,"path",33),t.qZA()(),t.kcU(),t.TgZ(42,"ngx-mat-datetime-picker",34,35)(44,"ngx-mat-datepicker-actions")(45,"button",36),t._uU(46),t.ALo(47,"mytranslate"),t.qZA(),t.TgZ(48,"button",37),t._uU(49,"OK"),t.qZA()()()()(),t.TgZ(50,"div",23)(51,"mat-form-field",24)(52,"input",38),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openDateTimePicker(0))}),t.ALo(53,"mytranslate"),t.qZA(),t.TgZ(54,"button",39),t.NdJ("click",function(i){return t.CHM(e),t.oxw().openDateTimePicker(0),t.KtG(i.stopPropagation())}),t.O4$(),t.TgZ(55,"svg",27),t._UZ(56,"path",28)(57,"path",29)(58,"path",30)(59,"path",31)(60,"path",32)(61,"path",33),t.qZA()(),t.kcU(),t.TgZ(62,"ngx-mat-datetime-picker",34,40)(64,"ngx-mat-datepicker-actions")(65,"button",36),t._uU(66),t.ALo(67,"mytranslate"),t.qZA(),t.TgZ(68,"button",37),t._uU(69,"OK"),t.qZA()()()()(),t.TgZ(70,"div",41)(71,"button",42),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clearTime())}),t.O4$(),t.TgZ(72,"svg",43),t._UZ(73,"path",44)(74,"path",45)(75,"path",46)(76,"path",47),t.qZA(),t._uU(77),t.ALo(78,"mytranslate"),t.qZA()()(),t.kcU(),t.TgZ(79,"div",48)(80,"div",49),t._uU(81),t.ALo(82,"mytranslate"),t.qZA(),t.YNc(83,It,3,3,"div",50),t.qZA()()(),t.TgZ(84,"div",51)(85,"div",10)(86,"h3",52),t._uU(87),t.ALo(88,"mytranslate"),t.qZA()(),t.TgZ(89,"div",53)(90,"div",54)(91,"input",55,56),t.NdJ("change",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.onFileSelected(i))}),t.qZA(),t.TgZ(93,"a",57),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(92);return t.KtG(i.click())}),t.O4$(),t.TgZ(94,"svg",58),t._UZ(95,"line",59)(96,"line",60),t.qZA(),t.kcU(),t.TgZ(97,"span"),t._uU(98),t.ALo(99,"mytranslate"),t.qZA()(),t.YNc(100,Nt,7,0,"div",61),t.TgZ(101,"div",62),t._uU(102),t.ALo(103,"mytranslate"),t.qZA(),t.YNc(104,Et,8,2,"div",63),t.qZA(),t.TgZ(105,"editor",64),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.formHomework.content=i)}),t.qZA()()(),t.TgZ(106,"div",65)(107,"div",66)(108,"label",67),t._uU(109),t.ALo(110,"mytranslate"),t.qZA()(),t.TgZ(111,"div",68)(112,"div",69)(113,"div",70),t._UZ(114,"input",71),t.TgZ(115,"label",72),t._uU(116),t.ALo(117,"mytranslate"),t.qZA()(),t.TgZ(118,"div",73),t._UZ(119,"input",74),t.TgZ(120,"label",75),t._uU(121),t.ALo(122,"mytranslate"),t.qZA()()()()(),t.TgZ(123,"div",76)(124,"div",66)(125,"label",67),t._uU(126),t.ALo(127,"mytranslate"),t.qZA()(),t.TgZ(128,"div",68)(129,"div",69)(130,"div",70),t._UZ(131,"input",77),t.TgZ(132,"label",78),t._uU(133),t.ALo(134,"mytranslate"),t.qZA()(),t.TgZ(135,"div",73),t._UZ(136,"input",79),t.TgZ(137,"label",80),t._uU(138),t.ALo(139,"mytranslate"),t.qZA()()()()(),t.TgZ(140,"div",81)(141,"div",82)(142,"div",83),t._uU(143),t.ALo(144,"mytranslate"),t.qZA()(),t.TgZ(145,"div",84)(146,"div",85)(147,"div",86)(148,"h3",87),t._uU(149),t.ALo(150,"mytranslate"),t._UZ(151,"azt-list-classroom-count-checked",88),t.qZA(),t.TgZ(152,"div",89)(153,"div",90),t._UZ(154,"azt-list-classroom-check-all",91),t.qZA(),t.TgZ(155,"div",92),t._UZ(156,"azt-is-show-check-classroom",93),t.qZA()()(),t.TgZ(157,"div",94)(158,"ng-scrollbar",95),t._UZ(159,"azt-list-classroom-checkbox",96),t.qZA()()()(),t.YNc(160,Pt,4,3,"div",97),t.qZA()(),t.TgZ(161,"div",98)(162,"div",99)(163,"button",100),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.saveHomework(0))}),t._uU(164),t.ALo(165,"mytranslate"),t.qZA(),t.TgZ(166,"button",101),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.saveHomework(1))}),t._uU(167),t.ALo(168,"mytranslate"),t.qZA()()()()()()()}if(2&o){const e=t.MAs(43),a=t.MAs(63),i=t.oxw();t.xp6(1),t.Q6J("formGroup",i.form),t.xp6(4),t.hij(" ",t.lcZ(6,54,"lang_auto_tao_bai_tap_moi")," "),t.xp6(6),t.hij(" ",t.lcZ(12,56,"lang_auto_ten")," "),t.xp6(4),t.s9C("placeholder",t.lcZ(16,58,"lang_auto_nhap_ten")+" ..."),t.xp6(2),t.Q6J("ngIf",i.form.controls.homeworkName.errors),t.xp6(4),t.hij(" ",t.lcZ(22,60,"lang_testbank_test_config_time_assigne_homework")," "),t.xp6(2),t.s9C("matTooltip",t.lcZ(24,62,"lang_homework_add_home_work_startDate_introduce")),t.xp6(9),t.s9C("placeholder",t.lcZ(33,64,"lang_auto_tu")),t.Q6J("max",i.maxDate)("ngxMatDatetimePicker",e),t.xp6(10),t.Q6J("touchUi",!0),t.xp6(4),t.Oqu(t.lcZ(47,66,"lang_auto_dong")),t.xp6(6),t.s9C("placeholder",t.lcZ(53,68,"lang_auto_den")),t.Q6J("max",i.maxDate)("ngxMatDatetimePicker",a),t.xp6(10),t.Q6J("touchUi",!0),t.xp6(4),t.Oqu(t.lcZ(67,70,"lang_auto_dong")),t.xp6(11),t.hij(" ",t.lcZ(78,72,"lang_auto_dat_lai")," "),t.xp6(4),t.hij(" ",t.lcZ(82,74,"lang_auto_bo_trong_neu_khong_muon_gioi_han_thoi_gian"),". "),t.xp6(2),t.Q6J("ngIf",i.calculatorTimeValidate(i.form.controls.homeworkDeadline.value,i.form.controls.homeworkStartDate.value)<=0),t.xp6(4),t.hij(" ",t.lcZ(88,76,"lang_auto_noi_dung")," "),t.xp6(11),t.Oqu(t.lcZ(99,78,"lang_homework_add_home_work_add_file_homework")),t.xp6(2),t.Q6J("ngIf",i.loadingUpload),t.xp6(2),t.Oqu(t.lcZ(103,80,"lang_cms_add_homework_input_file")),t.xp6(2),t.Q6J("ngForOf",i.formHomework.files),t.xp6(1),t.Q6J("ngModel",i.formHomework.content)("ngModelOptions",t.DdM(102,Lt))("init",i.initDataEditor),t.xp6(4),t.hij(" ",t.lcZ(110,82,"lang_auto_cho_xem_ket_qua")," "),t.xp6(7),t.hij(" ",t.lcZ(117,84,"lang_auto_khong")," "),t.xp6(5),t.hij(" ",t.lcZ(122,86,"lang_auto_co")," "),t.xp6(5),t.hij(" ",t.lcZ(127,88,"lang_auto_dang_nhap_de_nop_bai")," "),t.xp6(7),t.hij(" ",t.lcZ(134,90,"lang_auto_khong")," "),t.xp6(5),t.hij(" ",t.lcZ(139,92,"lang_auto_co")," "),t.xp6(5),t.hij(" ",t.lcZ(144,94,"lang_auto_giao_cho_lop")," "),t.xp6(6),t.hij(" ",t.lcZ(150,96,"lang_auto_danh_sach_cac_lop"),"\xa0 "),t.xp6(2),t.Q6J("formArray",i.form.controls.classroomIds),t.xp6(3),t.Q6J("formArray",i.form.controls.classroomIds)("objs",i.classroomObjs)("permissionName",i.permissionTypes.exam),t.xp6(2),t.Q6J("form",i.form),t.xp6(2),t.Q6J("visibility","hover")("autoHeightDisabled",!1)("ngClass",t.VKq(103,Ut,i.isMobileWebView)),t.xp6(1),t.Q6J("form",i.form)("formArrayName","classroomIds")("objs",i.classroomObjs)("homeworkObj",void 0)("permissionName",i.permissionTypes.homework),t.xp6(1),t.Q6J("ngIf",null==i.form.controls.classroomIds.errors?null:i.form.controls.classroomIds.errors.classroomCheckBoxValidatorWithoutWhoAllow),t.xp6(3),t.Q6J("disabled",i.form.invalid||i.checkDeadLineValid(i.form.controls.homeworkStartDate.value,i.form.controls.homeworkDeadline.value)<=0),t.xp6(1),t.hij(" ",t.lcZ(165,98,"lang_auto_luu_nhap")," "),t.xp6(2),t.Q6J("disabled",i.form.invalid||i.checkDeadLineValid(i.form.controls.homeworkStartDate.value,i.form.controls.homeworkDeadline.value)<=0),t.xp6(1),t.hij(" ",t.lcZ(168,100,"lang_auto_xuat_ban")," ")}}let zt=(()=>{class o extends N.Q{clearTime(){this.form.controls.homeworkDeadline.setValue(""),this.form.controls.homeworkStartDate.setValue("")}checkDeadLineValid(e,a){return""!=e&&""!=a?this.timeService.getDiffFromTwoDateWithZeroSecond(a,e):1}onFileSelected(e){let i=e.target,s=i.files,m=!!s&&s[0];0!=m&&((0,R.C0)(m.type)?(0,R.ml)(m.type)?this.showErrorSnack("lang_auto_file_gap_loi: "+m.name+"lang_auto__kieu: "+m.type+"lang_auto__chua_ho_tro_dinh_dang_video_wmv_vui_long_thu_lai"):(this.loadingUpload=!0,this.uploadProgress=0,(0,R.hv)(m).then(h=>{this.apiUploadService.uploadToCdnForHomework(h).subscribe(u=>{u.type!=I.dt.UploadProgress&&(1==u.success?(this.formHomework.files&&!Array.isArray(this.formHomework.files)&&(this.formHomework.files=[]),this.formHomework.files?.push({...u.data}),this.loadingUpload=!1,this.uploadProgress=-1):(this.loadingUpload=!1,this.showErrorSnack(this.commonService.translateToKeyParam("lang_auto_khong_upload_duoc_anh_vui_long_thu_lai_sau_loi",u.message??"none"))))})})):this.showErrorSnack("lang_cms_add_homework_not_support_file_upload")),i.files=null}onShowFile(e,a){let i={...e,index:a};this.sAztDialogService.open(bt.q,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{fileOption:i},restoreFocus:!1})}openDateTimePicker(e){1==e?this.startTime&&this.startTime.open():this.endTime&&this.endTime.open()}saveHomework(e){this.initStatusObj(),this.homeWorkContent=this.formHomework.content??"",this.uploadImageOfHomeworkService.replaceImageInContent(this.homeWorkContent).subscribe(a=>{null==a.errorMessage?(this.homeWorkContent=this.sAztReplaceContentHomeworkService.replaceLinkContent(a.content),this.callApiToSaveHomework(e)):(this.showErrorSnack(a.errorMessage),this.stopStatusObj())})}callApiToSaveHomework(e){let a=this.form.getRawValue(),i=a.homeworkStartDate?this.timeService.formatDateTimeToPostToServer(a.homeworkStartDate):void 0,s=a.homeworkDeadline?this.timeService.formatDateTimeToPostToServer(a.homeworkDeadline):void 0,m="1"!=a.mustVerified?0:1,h="1"!=a.whenShowAnswer?0:1;this.homeWorkContent=this.zipDataService.convertContentGzip(this.homeWorkContent);let u=this.userService.getUserObj(),l=JSON.stringify({type:"homework",id:0,user:u.id}),g=this.sAztClassroomCheckboxService.findClassroomWithNoPermission(this.classroomObjs,W.y.homework);const p=this.sAztClassroomCheckboxService.getClassroomIdsChecked(this.classroomObjs,g,a.classroomIds);let S={name:a.homeworkName,content:this.homeWorkContent,startDate:i,deadline:s,files:JSON.stringify(this.formHomework.files),mustVerified:m,whenShowAnswer:h,isPublished:e,categoryId:this.cateId?Number(this.cateId):void 0,classroomIds:p};this.subscriptions.add(this.homeworkService.apiHomeworkSaveObjPost(l,S).subscribe(M=>{if(1==M.success){if(e){this.successStatusObj("lang_auto_xuat_ban_thanh_cong",!0);let dt=[];if(M.data?.objs)for(let G=0;G<M.data.objs.length;G++)dt.push(M.data?.objs[G].hashId);this.listIds=JSON.stringify(dt),this.commonService.myNavigationWithQueryString("/admin/testbank/publish-document/1/"+(this.cateId??0)+"/"+this.listIds,"?backto="+encodeURIComponent(`/admin/homework/add-new-homework/${this.cateId??0}?backto=`+this.backToLink))}else this.commonService.myNavigation(this.backToLink?this.backToLink:"/admin/testbank/document-management/1/0/1"),this.successStatusObj("lang_auto_luu_thanh_cong_chua_xuat_ban",!0);this.successStatusObj()}else this.errorStatusObj(M.message??"",!0)}))}getHomework(){this.subscriptions.add(this.homeworkService.apiHomeworkGetObjGet("add_new").subscribe(e=>{1==e.success?(this.classroomObjs=e?.data?.classroomObjs??new Array,this.successStatusObj()):this.errorStatusObj(e.message??"",!0)}))}checkModeUiEditor(e){this.initDataEditor="dark"==e?{height:250,menubar:!1,plugins:[],skin:"oxide-dark",content_css:"dark",toolbar:"bold italic backcolor | alignleft aligncenter alignright alignjustify"}:{height:250,menubar:!1,plugins:[],toolbar:"bold italic backcolor | alignleft aligncenter alignright alignjustify"}}calculatorTimeValidate(e,a){return""!=e&&""!=a?this.timeService.calculationHomeworkTimeWithZeroSecond(e,a):1}ngOnChanges(){let e=""==this.browserStorageService.getStorage("mode_ui")?"light":this.browserStorageService.getStorage("mode_ui")??"light";this.checkModeUiEditor(e)}ngOnInit(){this.initStatusObj();let e=""==this.browserStorageService.getStorage("mode_ui")?"light":this.browserStorageService.getStorage("mode_ui")??"light";this.checkModeUiEditor(e),this.waitDestroy((0,K.a)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([])=>{this.backToLink=this.commonService.getMyQueryParam("backto")??"",this.cateId=this.commonService.getMyParam(this.activeRoute,"cat_id")??"",this.getHomework()})),this.form.valueChanges.subscribe(a=>{let i=JSON.stringify(a);i!=this.prevData&&(this.prevData=i,this.form.patchValue(a))}),this.commonService.translateMetaData({title:"lang_cms_homework_add_exercise_title",description:"lang_cms_homework_add_exercise_description",image:"lang_cms_test_image"})}constructor(e,a,i,s,m,h,u,l,g,p,S,M){super(),this.sAztDialogService=e,this.activeRoute=a,this.homeworkService=i,this.classroomService=s,this.apiUploadService=m,this.zipDataService=h,this.timeService=u,this.userService=l,this.browserStorageService=g,this.sAztClassroomCheckboxService=p,this.sAztReplaceContentHomeworkService=S,this.uploadImageOfHomeworkService=M,this.permissionTypes=W.y,this.formHomework={files:[],content:""},this.classroomObjs=[],this.prevData="",this.cateId="",this.listIds="",this.backToLink="",this.uploadProgress=-1,this.loadingUpload=!1,this.homeWorkContent="",this.initDataEditor={},this.maxDate=kt.N.maxDateTimePicker,this.form=new n.cw({homeworkName:new n.NI("",{nonNullable:!0,validators:[n.kI.required,n.kI.maxLength(180),ft._.noWhiteSpace]}),homeworkStartDate:new n.NI("",{nonNullable:!0}),homeworkDeadline:new n.NI("",{nonNullable:!0}),mustVerified:new n.NI("0",{nonNullable:!0}),whenShowAnswer:new n.NI("0",{nonNullable:!0}),classroomIds:new n.Oe([]),whoAllow:new n.NI(2,{nonNullable:!0}),isShowCheckClass:new n.NI(!1,{nonNullable:!0})},{validators:[_t.h.classroomCheckBoxValidatorWithoutWhoAllow]})}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(P.C),t.Y36(y.gz),t.Y36(A.Lk),t.Y36(A.um),t.Y36(B.W),t.Y36(L.a),t.Y36($.D),t.Y36(vt.U),t.Y36(X.n),t.Y36(wt.f),t.Y36(xt.c),t.Y36(yt.Z))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-add-home-work"]],viewQuery:function(a,i){if(1&a&&(t.Gf(At,5),t.Gf(Mt,5)),2&a){let s;t.iGM(s=t.CRH())&&(i.startTime=s.first),t.iGM(s=t.CRH())&&(i.endTime=s.first)}},features:[t._Bn([{provide:j.fM,useClass:gt.WG,deps:[V.Ad,ut.o8]},{provide:j.ab,useFactory:pt.hx,deps:[$.D]}]),t.qOj,t.TTD],decls:4,vars:3,consts:[[3,"headerBackToLink"],[4,"ngIf","ngIfElse"],["doneLoading",""],[1,"intro-y","mt-5"],[3,"formGroup"],[1,"azt-config-document","mx-auto",2,"max-width","1000px"],[1,"setting-basic"],[1,"text-md","uppercase","font-medium"],[1,"box","mt-2","p-5"],["id","azt-config-name",1,"grid","grid-cols-12"],[1,"col-span-12","lg:col-span-12"],["for","homework-name",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"setting-input"],["id","homework-name","formControlName","homeworkName","type","text",1,"form-control",3,"placeholder"],["class","text-xs text-danger mt-2",4,"ngIf"],["id","azt-config-time-assignment",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12"],["for","regular-form-1",1,"form-label","mb-0","font-medium","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","ml-2",3,"matTooltip"],["cx","12","cy","12","r","10"],["x1","12","y1","16","x2","12","y2","12"],["x1","12","y1","8","x2","12.01","y2","8"],[1,"grid","grid-cols-12","gap-3"],[1,"col-span-12","md:col-span-5"],["appearance","outline"],["azt-track-service","add-home-work-2lcHTxnwVmR","matInput","","formControlName","homeworkStartDate","readonly","",3,"placeholder","max","ngxMatDatetimePicker","click"],["azt-track-service","add-home-work-6MNUM1lV8t1","matSuffix","",2,"font-size","18px",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","lucide"],["d","M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5"],["d","M16 2v4"],["d","M8 2v4"],["d","M3 10h5"],["d","M17.5 17.5 16 16.25V14"],["d","M22 16a6 6 0 1 1-12 0 6 6 0 0 1 12 0Z"],[3,"touchUi"],["startTime",""],["mat-raised-button","","color","secondary","ngxMatDatepickerCancel",""],["mat-raised-button","","color","primary","ngxMatDatepickerApply",""],["azt-track-service","add-home-work-ShSJ8gIBpK8","matInput","","formControlName","homeworkDeadline","readonly","",3,"placeholder","max","ngxMatDatetimePicker","click"],["azt-track-service","add-home-work--BjU84v-g28","matSuffix","",2,"font-size","18px",3,"click"],["endTime",""],[1,"col-span-6","md:col-span-2"],["azt-track-service","add-home-work-NEdqGTKJIVb",1,"btn","btn-outline-secondary","w-full",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","w-4","h-4","mr-2"],["d","M10 2h4"],["d","M12 14v-4"],["d","M4 13a8 8 0 0 1 8-7 8 8 0 1 1-5.3 14L4 17.6"],["d","M9 17H4v5"],[1,"text-xs","mt-2"],[1,"text-slate-500","mt-1"],["class","text-danger mt-1",4,"ngIf"],[1,"grid","grid-cols-12","mt-4"],[1,"text-md","font-medium"],[1,"col-span-12","lg:col-span-12","mt-3"],[1,"col-md-12"],["type","file","name","fileHomework",2,"display","none",3,"change"],["formChoseFile",""],["azt-track-service","add-home-work-4ML9tUkucGY",1,"btn","btn-sm","btn-primary-soft",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2"],["x1","12","y1","5","x2","12","y2","19"],["x1","5","y1","12","x2","19","y2","12"],["class","flex justify-center my-2",4,"ngIf"],[1,"text-slate-600","text-xs","mt-2","mb-2"],["class","flex items-center mt-3 mb-3",4,"ngFor","ngForOf"],["apiKey","ldij13v1886vlrnk42g9bvngyqdc6gxpe8l0n9mo8gdjpg9d",3,"ngModel","ngModelOptions","init","ngModelChange"],["id","azt-config-when-result",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12","lg:col-span-5"],[1,"form-label","mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-7"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-8"],["id","whenShowAnswer-off","type","radio","formControlName","whenShowAnswer","value","1",1,"form-check-input"],["for","whenShowAnswer-off",1,"form-check-label"],[1,"form-check","mr-8","mt-2","sm:mt-0"],["id","whenShowAnswer-tested","type","radio","formControlName","whenShowAnswer","value","0",1,"form-check-input"],["for","whenShowAnswer-tested",1,"form-check-label","flex","items-center"],["id","azt-config-login-require",1,"grid","grid-cols-12","mt-4"],["id","mustVerified-off","type","radio","formControlName","mustVerified","value","0",1,"form-check-input"],["for","mustVerified-off",1,"form-check-label"],["id","mustVerified-tested","type","radio","formControlName","mustVerified","value","1",1,"form-check-input"],["for","mustVerified-tested",1,"form-check-label","flex","items-center"],["id","azt-config-who-allow",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12","lg:col-span-5","pr-5"],[1,"mb-0","font-medium","flex","items-center"],[1,"col-span-12","mt-4","intro-y"],[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","flex-col","sm:flex-row","sm:h-auto","sm:items-center"],[1,"mr-auto"],[3,"formArray"],[1,"flex","mt-2","sm:mt-0"],[1,"mr-3"],[3,"formArray","objs","permissionName"],[1,"mr-0"],[3,"form"],[1,"classroom_list"],["pointerEventsMethod","scrollbar",1,"w-full",3,"visibility","autoHeightDisabled","ngClass"],[3,"form","formArrayName","objs","homeworkObj","permissionName"],["class","col-span-12 mt-2 intro-y",4,"ngIf"],[1,"my-5"],[1,"text-right"],["azt-track-service","add-home-work-ZxDqD0KF4NR",1,"btn","btn-pending","w-24","mr-2",3,"disabled","click"],["azt-track-service","add-home-work-JgG_cpuccgD",1,"btn","w-24","btn-primary",3,"disabled","click"],[1,"text-xs","text-danger","mt-2"],[1,"text-danger","mt-1"],[1,"flex","justify-center","my-2"],["width","25","viewBox","-2 -2 42 42","xmlns","http://www.w3.org/2000/svg","stroke","rgb(30, 41, 59)",1,"w-6","h-6"],["fill","none","fill-rule","evenodd"],["transform","translate(1 1)","stroke-width","4"],["stroke-opacity",".5","cx","18","cy","18","r","18"],["d","M36 18c0-9.94-8.06-18-18-18"],["attributeName","transform","type","rotate","from","0 18 18","to","360 18 18","dur","1s","repeatCount","indefinite"],[1,"flex","items-center","mt-3","mb-3"],["azt-track-service","add-home-work-HeEXhrbob3P",1,"text-slate-600","mr-2",3,"click"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],["azt-track-service","add-home-work-QFtSJlUphLG",3,"click"],[1,"text-slate-600",3,"title"],[1,"col-span-12","mt-2","intro-y"],[1,"text-xs","text-danger"]],template:function(a,i){if(1&a&&(t.TgZ(0,"teacher-layout",0),t.YNc(1,Tt,1,0,"azt-loading-effect",1),t.YNc(2,Jt,169,105,"ng-template",null,2,t.W1O),t.qZA()),2&a){const s=t.MAs(3);t.Q6J("headerBackToLink","/admin/testbank/document-management/1/0/1"),t.xp6(1),t.Q6J("ngIf",1==i.statusObj.loading)("ngIfElse",s)}},dependencies:[k.KC,b.mk,b.sg,b.O5,tt.lW,Ot.Nt,q.KE,q.R9,et.gM,j.rZ,j.T$,j.c_,j.dW,j.cL,r.PG,n._Y,n.Fj,n._,n.JJ,n.JL,n.On,n.sg,n.u,n.CE,Q.l,Y.M,St.B,jt.V,Ct.f,Dt.M,it._,C.JV],encapsulation:2})}return o})();var U=c(47394),F=c(72164),at=c(59997),J=c(30617),Ht=c(98525),Rt=c(10505);function Bt(o,_){if(1&o&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&o){const e=_.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function qt(o,_){1&o&&t._UZ(0,"azt-loading-effect")}function Qt(o,_){1&o&&(t.TgZ(0,"div",18)(1,"span",19),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij("",t.lcZ(3,1,"lang_homework_content_store_not_found_search"),"!"))}function Yt(o,_){1&o&&(t.TgZ(0,"div",33),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_homework_content_store_free")))}function Ft(o,_){if(1&o&&(t.TgZ(0,"div",34),t._uU(1),t.ALo(2,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij("",t.lcZ(2,1,e.amount)," Azo")}}function Gt(o,_){1&o&&(t.TgZ(0,"div",35),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_homework_content_store_bought")))}function Vt(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"a",36),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw(3);return t.KtG(s.downloadFrontFileContent(i.id?i.id:0))}),t.TgZ(1,"mat-icon",37),t._uU(2,"save_alt"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()}2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_homework_content_store_download")," "))}function Kt(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"a",38),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw(3);return t.KtG(s.openBuyContentDialog(i,s.userObj&&s.userObj.amount?s.userObj.amount:0))}),t.TgZ(1,"mat-icon",37),t._uU(2,"shopping_cart"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()}2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_buttom_buy")," "))}function Wt(o,_){if(1&o&&(t.TgZ(0,"div",22)(1,"div",23),t._UZ(2,"img",24),t.ALo(3,"mycdn"),t.TgZ(4,"div",25)(5,"p",26),t._uU(6),t.qZA(),t.TgZ(7,"div",27),t.YNc(8,Yt,3,3,"div",28),t.YNc(9,Ft,3,3,"div",29),t.YNc(10,Gt,3,3,"div",30),t.YNc(11,Vt,5,3,"a",31),t.YNc(12,Kt,5,3,"a",32),t.qZA()()()()),2&o){const e=_.$implicit;t.xp6(2),t.s9C("src",t.lcZ(3,7,e.thumb),t.LSH),t.xp6(4),t.Oqu(e.name),t.xp6(2),t.Q6J("ngIf",0==e.amount),t.xp6(1),t.Q6J("ngIf",0!=e.amount&&-1!=e.amount),t.xp6(1),t.Q6J("ngIf",-1==e.amount),t.xp6(1),t.Q6J("ngIf",0==e.amount||-1==e.amount),t.xp6(1),t.Q6J("ngIf",(e&&e.amount?e.amount:0)>0)}}function $t(o,_){if(1&o&&(t.TgZ(0,"div",20),t.YNc(1,Wt,13,9,"div",21),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.objs)}}function Xt(o,_){if(1&o&&(t.YNc(0,Qt,4,3,"div",16),t.YNc(1,$t,2,1,"ng-template",null,17,t.W1O)),2&o){const e=t.MAs(2),a=t.oxw();t.Q6J("ngIf",a.isNullData)("ngIfElse",e)}}function te(o,_){if(1&o&&(t.TgZ(0,"div",14)(1,"p",15),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"p")(5,"span",6),t._uU(6),t.qZA()(),t.TgZ(7,"span",16),t._uU(8),t.ALo(9,"mytranslate"),t.TgZ(10,"span",17),t._uU(11),t.ALo(12,"number"),t.qZA(),t._uU(13),t.ALo(14,"mytranslate"),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,5,"lang_homework_content_store_definitely_want_to_buy")),t.xp6(4),t.hij(" ",null==e.content?null:e.content.name,""),t.xp6(2),t.hij(" ",t.lcZ(9,7,"lang_homework_content_store_with_price")," "),t.xp6(3),t.hij("",t.lcZ(12,9,null==e.content?null:e.content.amount)," Azo"),t.xp6(2),t.hij(" ",t.lcZ(14,11,"lang_homework_content_store_not"),"?")}}function ee(o,_){if(1&o&&(t.TgZ(0,"div",14)(1,"p",15),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"p")(5,"span",6),t._uU(6),t.qZA()(),t.TgZ(7,"span",16),t._uU(8),t.ALo(9,"mytranslate"),t.TgZ(10,"span",17),t._uU(11),t.ALo(12,"number"),t.qZA()()()),2&o){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"lang_homework_content_store_not_enough_azo")),t.xp6(4),t.hij(" ",null==e.content?null:e.content.name,""),t.xp6(2),t.hij(" ",t.lcZ(9,6,"lang_homework_content_store_with_price")," "),t.xp6(3),t.hij("",t.lcZ(12,8,null==e.content?null:e.content.amount)," Azo")}}function ie(o,_){1&o&&(t.TgZ(0,"div",5)(1,"span",18),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"lang_homework_content_store_please"),"!"))}function ae(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.buyContent())}),t.TgZ(1,"mat-icon",20),t._uU(2,"shopping_cart"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()}2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_buttom_buy")," "))}function oe(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.gotoPack())}),t.TgZ(1,"mat-icon",20),t._uU(2,"account_balance_wallet"),t.qZA(),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()}2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"lang_homework_content_store_recharge")," "))}let se=(()=>{class o extends N.Q{getData(){this.initStatusObj(),this.subscriptions.add(this.frontFileContentService.apiFrontFileContentGetObjsGet(0).subscribe(e=>{1==e.success?(this.objs=e.data?.objs??new Array,this.successStatusObj()):this.errorStatusObj(e.message??"")}))}getInfo(){this.initStatusObj(),this.subscriptions.add(this.userInfoService.apiUserInfoInfoGet().subscribe(e=>{1==e.success?(this.userObj=e.data,this.successStatusObj()):this.errorStatusObj(e.message??"")}))}getCategories(){this.initStatusObj(),this.subscriptions.add(this.frontFileContentService.apiFrontFileContentGetCategoriesObjsGet().subscribe(e=>{1==e.success?(this.categories=e.data?.objs??new Array,this.successStatusObj()):this.errorStatusObj(e.message??"")}))}openBuyContentDialog(e,a){this.openDialog(!(e.amount&&e.amount>a),e,a)}openDialog(e,a,i){this.sAztDialogService.open(ne,{width:"380px",panelClass:"buyContentDialogBox",data:{status:e,content:a,userAmount:i},restoreFocus:!1}).afterClosed().subscribe(m=>{})}selectValue(e){this.initStatusObj(),this.subscriptions.add(this.frontFileContentService.apiFrontFileContentGetObjsGet(e,void 0).subscribe(a=>{1==a.success?a.data?.objs&&a.data?.objs.length>0?(this.isNullData=!1,this.objs=a.data?.objs??new Array,this.successStatusObj()):(this.isNullData=!0,this.stopStatusObj()):this.errorStatusObj(a.message??"")}))}onSearch(){var e=this.getFormValue();this.initStatusObj(),""==e.searchContent?(this.isNullData=!1,this.subscriptions.add(this.frontFileContentService.apiFrontFileContentGetObjsGet(0).subscribe(a=>{1==a.success?(this.objs=a.data?.objs??new Array,this.successStatusObj()):this.errorStatusObj(a.message??"")}))):this.subscriptions.add(this.frontFileContentService.apiFrontFileContentGetObjsGet(0,e.searchContent).subscribe(a=>{1==a.success?(a.data?.objs&&0==a.data?.objs.length?this.isNullData=!0:this.objs=a.data?.objs??new Array,this.successStatusObj()):this.errorStatusObj(a.message??"")}))}downloadFrontFileContent(e){this.frontFileContentService.apiFrontFileContentGetFileLinkGet(e).subscribe(a=>{1==a.success&&a.data?.link?this.commonService.downloadFileByUrl(a.data.link):this.showErrorSnack("lang_cms_content_store_download_fail")})}getFormValue(){return this.form.getRawValue()}ngOnInit(){(0,K.a)([this.activeRoute.params,this.activeRoute.queryParams]).subscribe(([e,a])=>{this.getData(),this.getInfo(),this.getCategories()}),this.commonService.translateMetaData({title:"lang_cms_homework_content_store_title",description:"lang_cms_homework_content_store_description",image:"lang_cms_test_image"}),super.ngOnInit()}constructor(e,a,i,s){super(),this.activeRoute=e,this.userInfoService=a,this.frontFileContentService=i,this.sAztDialogService=s,this.isNullData=!1,this.subscriptions=new U.w0,this.objs=[],this.categories=[],this.form=new n.cw({searchContent:new n.NI("",{nonNullable:!0,validators:[n.kI.required]})})}ngOnDestroy(){this.subscriptions.unsubscribe(),super.ngOnDestroy()}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(y.gz),t.Y36(at.$C),t.Y36(at.cd),t.Y36(P.C))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-content-store"]],features:[t.qOj],decls:21,vars:14,consts:[[3,"headerTitle","headerBackToLink"],["id","content-store",1,"container-fluid","component-wrap","W1200","m-auto","mt-3","pb-mb-80","pb-4"],[3,"formGroup"],[1,"flex",2,"justify-content","space-between"],[2,"width","60%","margin-top","5px"],[1,"search-bar","form-group"],[1,"input-group-append"],["type","text","formControlName","searchContent",1,"form-control",3,"placeholder","keyup.enter"],["azt-track-service","content-store-Z-NOMKYiG5Z","id","basic-addon2",1,"btn","btn-primary","ml-2",3,"click"],[1,"content-store-select",2,"width","38%"],["appearance","outline"],["name","category",3,"placeholder","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["doneLoading",""],[3,"value"],["class","text-center mt-3 mb-3",4,"ngIf","ngIfElse"],["HasData",""],[1,"text-center","mt-3","mb-3"],[1,"h3"],[1,"grid","grid-cols-12","gap-5","mt-2"],["class","box col-span-12 md:col-span-4 sm:col-span-6 mb-2","style","margin: auto",4,"ngFor","ngForOf"],[1,"box","col-span-12","md:col-span-4","sm:col-span-6","mb-2",2,"margin","auto"],[1,"card"],["alt","thumbnail",1,"card-img-top",2,"width","80vw",3,"src"],[1,"card-body"],[1,"truncate","p-2","card-text"],[1,"actionZone","p-2"],["class","azo-price text-warning",4,"ngIf"],["class","azo-price text-danger",4,"ngIf"],["class","azo-price",4,"ngIf"],["azt-track-service","content-store-NDNy2GWJJPR","class","actionBtn clickable",3,"click",4,"ngIf"],["azt-track-service","content-store-7VbNrXJRnEV","class","actionBtn","style","cursor: pointer",3,"click",4,"ngIf"],[1,"azo-price","text-warning"],[1,"azo-price","text-danger"],[1,"azo-price"],["azt-track-service","content-store-NDNy2GWJJPR",1,"actionBtn","clickable",3,"click"],[2,"vertical-align","sub"],["azt-track-service","content-store-7VbNrXJRnEV",1,"actionBtn",2,"cursor","pointer",3,"click"]],template:function(a,i){if(1&a&&(t.TgZ(0,"teacher-layout",0),t.ALo(1,"mytranslate"),t.TgZ(2,"div",1)(3,"form",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"input",7),t.NdJ("keyup.enter",function(){return i.onSearch()}),t.ALo(9,"mytranslate"),t.qZA(),t.TgZ(10,"button",8),t.NdJ("click",function(){return i.onSearch()}),t.TgZ(11,"mat-icon"),t._uU(12,"search"),t.qZA()()()()(),t.TgZ(13,"div",9)(14,"mat-form-field",10)(15,"mat-select",11),t.NdJ("selectionChange",function(m){return i.selectValue(m.value)}),t.ALo(16,"mytranslate"),t.YNc(17,Bt,2,2,"mat-option",12),t.qZA()()()()(),t.YNc(18,qt,1,0,"azt-loading-effect",13),t.YNc(19,Xt,3,2,"ng-template",null,14,t.W1O),t.qZA()()),2&a){const s=t.MAs(20);t.Q6J("headerTitle",t.lcZ(1,8,"lang_homework_content_store_content_bank"))("headerBackToLink","/admin/dashboard"),t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(5),t.s9C("placeholder",t.lcZ(9,10,"lang_homework_content_store_search")),t.xp6(7),t.s9C("placeholder",t.lcZ(16,12,"lang_homework_content_store_all")),t.xp6(2),t.Q6J("ngForOf",i.categories),t.xp6(1),t.Q6J("ngIf",i.statusObj.loading)("ngIfElse",s)}},dependencies:[b.sg,b.O5,V.ey,J.Hw,q.KE,Ht.gD,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u,Q.l,Y.M,it._,b.JJ,C.JV,C.QN],styles:[".dashboard__header[_ngcontent-%COMP%]{background-color:#0089a7;border-radius:5px}.input-group-append[_ngcontent-%COMP%]{display:flex}.border-test[_ngcontent-%COMP%]{border:1px solid red;min-height:50px}.azo-price[_ngcontent-%COMP%]{padding-top:5px;font-weight:500;font-size:1.2rem}.content-store-select[_ngcontent-%COMP%]{margin-top:5px}.card-text[_ngcontent-%COMP%]{display:block!important;max-width:245px!important}.content-header[_ngcontent-%COMP%]{background:inherit;background-color:#0089a7;padding:20px 0}.user_amount[_ngcontent-%COMP%]{background:inherit;background-color:#009cbe;border:none;border-radius:5px;padding:10px;box-shadow:none}.user_amount[_ngcontent-%COMP%]:hover{text-decoration:none}.mat-card-avatar[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;flex-shrink:0;object-fit:cover}@media (max-width: 992px){.dashboard__header[_ngcontent-%COMP%]{background-color:#0089a7;margin-top:-15px;margin-left:-15px;margin-right:-15px;border-radius:0}}.actionZone[_ngcontent-%COMP%]{display:flex;justify-content:space-between}  .mat-form-field-underline{position:initial!important}@media (max-width: 768px){.card-text[_ngcontent-%COMP%]{display:block!important;max-width:120px}.header-col-center[_ngcontent-%COMP%]{text-align:center!important;display:block!important}.header-col-center[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]{margin-left:auto!important;margin-right:auto!important;margin-bottom:10px!important;text-align:center!important;display:inline-flex!important}.user_amount[_ngcontent-%COMP%]{margin-left:0!important;margin-bottom:10px!important}.content-header[_ngcontent-%COMP%]{padding:20px 0 0}}"]})}return o})(),ne=(()=>{class o extends F.e{getData(){this.initStatusObj(),this.data.content?(this.content=this.data.content,this.successStatusObj()):this.errorStatusObj("lang_auto_khong_tai_duoc_du_lieu")}buyContent(){this.initStatusObj(),this.subscriptions.add(this.paymentService.apiPaymentBuyFileContentByAzoPost(this.content?.id??0).subscribe(e=>{1==e.success?(this.successStatusObj(),this.showSuccessSnack("lang_auto_ban_da_mua_thanh_cong"),this.onNoClick(),setTimeout(()=>{document.location.reload()},3e3)):(this.errorStatusObj(e.message??"",!0),this.showErrorSnack("lang_auto_thanh_toan_khong_thanh_cong"),this.onNoClick(),setTimeout(()=>{document.location.reload()},3e3))}))}gotoPack(){this.onNoClick(),this.commonService.myNavigation("/payment/azo-pack")}onNoClick(){this.dialogRef.close(!1)}ngOnInit(){this.getData(),super.ngOnInit()}constructor(e,a,i){super(i,e),this.dialogRef=e,this.paymentService=a,this.data=i,this.subscriptions=new U.w0}ngOnDestroy(){this.subscriptions.unsubscribe(),super.ngOnDestroy()}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(x.so,8),t.Y36(Rt.te),t.Y36(x.WI,8))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["buy-content-dialog"]],features:[t.qOj],decls:22,vars:16,consts:[[1,"box","p-3"],[3,"hidden"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"sr-only"],[1,"text-center"],[1,"h5"],["class","text-left","style","border: 1px dashed red; padding: 10px 5px; border-radius: 5px;",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"flex","justify-end","mt-3"],[1,"azt-block-button"],["azt-track-service","content-store-wkv517MZvQQ","class","btn btn-primary",3,"click",4,"ngIf"],["azt-track-service","content-store-pGRw2qZB3VD","class","btn btn-primary",3,"click",4,"ngIf"],["azt-track-service","content-store-g17bdA2D8GW",1,"btn","btn-secondary",2,"margin-left","15px",3,"click"],[1,"text-left",2,"border","1px dashed red","padding","10px 5px","border-radius","5px"],[1,"h5","text-danger"],[1,"h5","mt-1"],[1,"text-danger"],[1,"h6","mt-2","mb-1"],["azt-track-service","content-store-wkv517MZvQQ",1,"btn","btn-primary",3,"click"],[2,"font-size","23px","vertical-align","sub"],["azt-track-service","content-store-pGRw2qZB3VD",1,"btn","btn-primary",3,"click"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),t._uU(5,"..."),t.qZA()()()(),t.TgZ(6,"div",1)(7,"div",5)(8,"p",6),t._uU(9),t.ALo(10,"mytranslate"),t.ALo(11,"number"),t.qZA()(),t.YNc(12,te,15,13,"div",7),t.YNc(13,ee,13,10,"div",7),t.YNc(14,ie,4,3,"div",8),t.qZA(),t.TgZ(15,"div",9)(16,"div",10),t.YNc(17,ae,5,3,"button",11),t.YNc(18,oe,5,3,"button",12),t.qZA(),t.TgZ(19,"button",13),t.NdJ("click",function(){return i.onNoClick()}),t._uU(20),t.ALo(21,"mytranslate"),t.qZA()()()),2&a&&(t.xp6(1),t.Q6J("hidden",!i.statusObj.loading),t.xp6(5),t.Q6J("hidden",i.statusObj.loading),t.xp6(3),t.AsE("",t.lcZ(10,10,"lang_homework_content_store_having")," ",t.lcZ(11,12,i.data.userAmount)," Azo"),t.xp6(3),t.Q6J("ngIf",i.data.status),t.xp6(1),t.Q6J("ngIf",!i.data.status),t.xp6(1),t.Q6J("ngIf",!i.data.status),t.xp6(3),t.Q6J("ngIf",i.data.status),t.xp6(1),t.Q6J("ngIf",!i.data.status),t.xp6(2),t.Oqu(t.lcZ(21,14,"lang_button_cancel")))},dependencies:[b.O5,J.Hw,b.JJ,C.JV],encapsulation:2})}return o})();var re=c(15861);let ot=(()=>{class o extends F.e{getData(){this.initStatusObj(),this.data.status?this.successStatusObj():this.stopStatusObj()}cleanResult(){var e=this.getFormValue(),a={homeworkHashId:this.data.itemHomework.hashId??"",id:this.data.ans_id,resendNote:e.reason};this.initStatusObj(),this.subscriptions.add(this.answerService.apiAnswerResendAnswerPost(a).subscribe(i=>{1==i.success?(this.showSuccessSnack("lang_cms_send_request_success"),this.result=!0,this.onSubmit({result:this.result,id:this.data.ans_id,itemHomework:this.data.itemHomework,isRedirect:this.data.redirect}),this.successStatusObj()):(this.showErrorSnack("lang_cms_send_request_error"),this.result=!1,this.onSubmit({result:this.result,id:this.data.ans_id,itemHomework:this.data.itemHomework,isRedirect:this.data.redirect}),this.errorStatusObj(i.message??""))}))}getFormValue(){return this.form.getRawValue()}ngOnInit(){this.homeworkHashId=this.commonService.getMyParam(this.activeRoute,"hash_id")??"",this.getData(),super.ngOnInit()}constructor(e,a,i,s){super(s,e),this.dialogRef=e,this.answerService=a,this.activeRoute=i,this.data=s,this.subscriptions=new U.w0,this.result=!1,this.homeworkHashId="",this.form=new n.cw({reason:new n.NI("",{nonNullable:!0,validators:[n.kI.required]})})}onNoClick(){this.dialogRef.close()}onSubmit(e){this.dialogRef.close(e)}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(x.so,8),t.Y36(A.P6),t.Y36(y.gz),t.Y36(x.WI,8))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["clean-result-dialog"]],features:[t.qOj],decls:43,vars:31,consts:[[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],[1,"intro"],[1,"text-base","font-medium","mr-auto","text-center"],[3,"hidden"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"sr-only"],[1,"intro",3,"hidden"],["enctype","multipart/form-data",1,"form-horizontal","text-center",3,"formGroup"],[1,"text-left",2,"border","1px dashed red","padding","10px 5px","border-radius","5px"],[1,"h5","text-danger","text-center"],[1,"h5","mb-1"],[1,"text-danger"],[1,"h5","text-danger","mt-1","mb-1"],["type","text","id","reason","formControlName","reason",1,"form-control","mt-2"],[1,"text-right","mt-3"],["azt-track-service","clean-result-dialog-_f7PVI4E-S_",1,"btn","w-24","btn-secondary","mr-3",3,"click"],["azt-track-service","clean-result-dialog-xDCHUvnl-fJ",1,"btn","w-24","btn-primary",3,"click"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),t._uU(5),t.ALo(6,"mytranslate"),t.qZA()(),t._UZ(7,"br"),t.TgZ(8,"div",5)(9,"div",6)(10,"div",7)(11,"span",8),t._uU(12,"..."),t.qZA()()()(),t.TgZ(13,"div",9)(14,"form",10)(15,"div",11)(16,"p",12),t._uU(17),t.ALo(18,"mytranslate"),t.qZA(),t.TgZ(19,"p",13),t._uU(20),t.ALo(21,"mytranslate"),t.TgZ(22,"span",14),t._uU(23),t.qZA(),t._uU(24),t.ALo(25,"mytranslate"),t.TgZ(26,"span",14),t._uU(27),t.ALo(28,"formatOnlyDateByUserUnitPipe"),t.qZA(),t._uU(29),t.ALo(30,"mytranslate"),t.qZA(),t._UZ(31,"hr"),t.TgZ(32,"p",15),t._uU(33),t.ALo(34,"mytranslate"),t.qZA(),t._UZ(35,"input",16),t.qZA()()(),t.TgZ(36,"div",17)(37,"button",18),t.NdJ("click",function(){return i.onNoClick()}),t._uU(38),t.ALo(39,"mytranslate"),t.qZA(),t.TgZ(40,"button",19),t.NdJ("click",function(){return i.cleanResult()}),t._uU(41),t.ALo(42,"mytranslate"),t.qZA()()()()()),2&a&&(t.xp6(5),t.Oqu(t.lcZ(6,13,"lang_homework_mark_exercise_utils_request_resubmit")),t.xp6(3),t.Q6J("hidden",!i.statusObj.loading),t.xp6(5),t.Q6J("hidden",i.statusObj.loading),t.xp6(1),t.Q6J("formGroup",i.form),t.xp6(3),t.hij("(*) ",t.lcZ(18,15,"lang_homework_mark_exercise_utils_note"),":"),t.xp6(3),t.hij(" ",t.lcZ(21,17,"lang_homework_mark_exercise_utils_request")," "),t.xp6(3),t.hij(" ",i.data.name," "),t.xp6(1),t.hij(" ",t.lcZ(25,19,"lang_homework_mark_exercise_utils_in_homework"),"\xa0"),t.xp6(3),t.Oqu(t.lcZ(28,21,i.data.deadline?i.data.deadline:i.data.itemHomework.createdAt)),t.xp6(2),t.hij("\xa0",t.lcZ(30,23,"lang_homework_mark_exercise_utils_will_be_deleted"),"! "),t.xp6(4),t.Oqu(t.lcZ(34,25,"lang_homework_mark_exercise_utils_coment_request_resubmit")),t.xp6(5),t.hij(" ",t.lcZ(39,27,"lang_button_cancel")," "),t.xp6(3),t.hij(" ",t.lcZ(42,29,"lang_button_confirm")," "))},dependencies:[n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u,Y.M,C.JV,C.YK],encapsulation:2})}return o})();var ce=c(91675);let st=(()=>{class o extends F.e{ngOnInit(){this.success=this.data.status}constructor(e,a,i){super(i,e),this.dialogRef=e,this.answerService=a,this.data=i,this.success=!1}checkNextAns(){this.dialogRef.close(),this.answerService.apiAnswerGetNextObjByHomeworkGet(this.data.homeworkHashId).subscribe(e=>{if(1==e.success)return this.commonService.myNavigationWithQueryString("/admin/homework/switch-mark-exercise/"+e.data?.obj?.id+"/"+this.data.homeworkHashId,"?backto="+encodeURIComponent(this.data.backToLink)),void(window.location.href=this.commonService.getLocalRouter("/admin/homework/switch-mark-exercise/"+e.data?.obj?.id+"/"+this.data.homeworkHashId+"?backto="+encodeURIComponent(this.data.backToLink)));window.location.href=this.commonService.getLocalRouter("/admin/testbank/homework-results-list/"+this.data.classID+"/"+this.data.homeWorkID+"/"+this.data.homeworkHashId)})}onNoClick(){this.dialogRef.close()}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(x.so,8),t.Y36(A.P6),t.Y36(x.WI,8))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["notice-dialog"]],features:[t.qOj],decls:22,vars:10,consts:[[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],[1,"intro"],[1,"text-base","font-medium","mr-auto"],[1,"mr-1",2,"color","green"],[2,"color","red","font-size","120%","font-weight","500"],[3,"mark"],[1,"text-right","mt-3"],["azt-track-service","notice-dialog-YnLBVlTjw",1,"btn","w-24","btn-secondary","mr-3",3,"click"],["azt-track-service","notice-dialog-D6RUmpOZKX",1,"btn","w-24","btn-primary",3,"click"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4)(5,"mat-icon",5),t._uU(6,"check_circle"),t.qZA(),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()(),t._UZ(9,"br"),t.TgZ(10,"div",3),t._uU(11),t.ALo(12,"mytranslate"),t.TgZ(13,"span",6),t._UZ(14,"azt-check-mark",7),t.qZA()(),t._UZ(15,"br"),t.TgZ(16,"div",8)(17,"button",9),t.NdJ("click",function(){return i.onNoClick()}),t._uU(18,"Ok"),t.qZA(),t.TgZ(19,"button",10),t.NdJ("click",function(){return i.checkNextAns()}),t._uU(20),t.ALo(21,"mytranslate"),t.qZA()()()()()),2&a&&(t.xp6(7),t.hij(" ",t.lcZ(8,4,"lang_homework_mark_exercise_utils_mark_success"),""),t.xp6(4),t.hij(" ",t.lcZ(12,6,"lang_homework_mark_exercise_utils_assignment_marking")," "),t.xp6(3),t.Q6J("mark",i.data.score),t.xp6(6),t.Oqu(t.lcZ(21,8,"lang_homework_mark_exercise_utils_mark_continue")))},dependencies:[J.Hw,ce.B,C.JV],styles:["#ok[_ngcontent-%COMP%]:hover{background-color:#e7e7e7}#next[_ngcontent-%COMP%]:hover{background-color:#1e579d!important}"]})}return o})();var nt=c(92296),rt=c(94690),ct=c(32965),lt=c(85904),le=c(76024),me=c(71646),he=c(62703);const de=["aztMarkNote"];function ue(o,_){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"azt-mark-note",37,38),t.NdJ("handleBackLink",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.goBack())})("doneLoadData",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.doneLoadData(i))})("markData",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.getMarkData(i))})("getIdHistory",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.getDataHistory(i))}),t.qZA(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("dataMarkNote",e.dataMarkNote)("showBackLink",!0)("markedByObj",e.markedByObj)("historyAnswerObjs",e.historyAnswerObjs)}}function ge(o,_){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.ALo(3,"mytranslate"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.HOy(" ",t.lcZ(2,4,"lang_testbank_tested_list_number_success")+" "," ",e.markData.totalRight+", "," ",t.lcZ(3,6,"lang_testbank_tested_list_error")+" "," ",e.markData.totalWrong," ")}}function pe(o,_){1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_core_chua_co_so_cau_dung_cau_sai")))}function _e(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"div",39)(1,"button",40),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.setPoint(s))}),t._uU(2),t.qZA()()}if(2&o){const e=_.$implicit;t.xp6(2),t.hij(" ",e.name," ")}}function fe(o,_){1&o&&(t.TgZ(0,"span",41),t._UZ(1,"azt-loading-ui",42),t.qZA()),2&o&&(t.xp6(1),t.Q6J("type","oval"))}const be=function(o){return{height:o}};let ke=(()=>{class o extends N.Q{onResize(e){this.changeSizeMarkGeneral()}doneLoadData(e){this.loadingDataCdn=!1}uploadDrawBase64ToCDN(e,a,i){let s=this.baseApiService.dataURItoBlob(e),m=Date.now();this.apiUploadService.commonUploadForMarkResult(s,`essay_note_${a}_${this.answerId}_${m}.png`,"image/png",1e4).subscribe(h=>{h.type!=I.dt.UploadProgress&&(1==h.success?(this.mnoteJsonData.pages?.[a]&&(this.mnoteJsonData.pages[a].draw=h.data?.url),this.pagesCount--,0==this.pagesCount&&this.remark(this.answerId,i,this.mnoteJsonData)):(this.showErrorSnack("lang_cms_cannot_save_data_marked"),this.stopStatusObj()))})}uploadAll(e,a){this.pagesCount=0;for(let i=0;i<e.length;i++)e[i].draw&&this.pagesCount++;if(0==this.pagesCount)this.remark(this.answerId,a,this.mnoteJsonData);else for(let i=0;i<e.length;i++)e[i].draw&&this.uploadDrawBase64ToCDN(e[i].draw,i,a)}sendDataToMarkNote(){let e=this.castObj(this.result.answerObj);if(e){let h=this.commonService.willDeleteParseJson(e.result??"");if(null!=h){let l=h.pages?.length??0;for(let g=0;g<l;g++)h?.pages?.[g].backgroundImage&&(h.pages[g].backgroundImage=this.cdnService.getMyCdn(h.pages[g].backgroundImage??"")),h.pages?.[g].draw&&(h.pages[g].draw=this.cdnService.getMyCdn(h.pages[g].draw));h=JSON.stringify(h),e.result=JSON.stringify(h)}let u=this.commonService.willDeleteParseJson(e.files??"");if(null!=u){for(let l=0;l<u.length;l++)u[l].url&&(u[l].url=this.cdnService.getMyCdn(u[l].url)),u[l].thumb&&(u[l].thumb=this.cdnService.getMyCdn(u[l].thumb));u=JSON.stringify(u),e.files=u}}let a=this.result.studentObj,i=this.result.classroomObj,s=this.result.homeworkObj,m=this.commonService.myParseJson(e?.result??"");if(this.jsonData&&this.jsonData.hasOwnProperty("pages"))for(let h=0;h<(this.jsonData.pages?.length??0);h++)this.jsonData.pages?.[h].hasOwnProperty("backgroundImage")&&(this.jsonData.pages[h].backgroundImage=this.cdnService.getMyCdn(this.jsonData.pages[h].backgroundImage??"")),this.jsonData.pages?.[h].hasOwnProperty("draw")&&(this.jsonData.pages[h].draw=this.cdnService.getMyCdn(this.jsonData.pages[h].draw??""));if(this.isMarked)this.jsonData.cmd="initMNote",this.jsonData.mode="edit",this.jsonData.answer_obj=e,this.jsonData.student_obj=a,this.jsonData.classroom_obj=i,this.jsonData.homework_obj=s,m&&m.hasOwnProperty("hideMark")&&(this.jsonData.hideMark=m.hideMark),this.dataMarkNote=this.jsonData;else{let h=[];this.files.forEach(l=>{h.push({backgroundImage:l.url})});let u={cmd:"initMNote",mode:"edit",pages:h,answer_obj:e,student_obj:a,classroom_obj:i,homework_obj:s};m&&m.hasOwnProperty("hideMark")&&(u.hideMark=m.hideMark),this.dataMarkNote=u}}getHistoryObjs(e){this.initStatusObj(),this.answerService.apiAnswerGetHistoryObjsGet(this.homeworkHashId,e).subscribe(a=>{1==a.success?this.historyAnswerObjs=a.data?.objs??new Array:this.errorMessage=a.message??"",this.stopStatusObj()})}getDataHistory(e){this.historyId=e,this.errorMessage="",this.countLoad=1,this.answerService.apiAnswerGetHistoryObjGet(this.homeworkHashId,this.answerId,parseInt(e,10)).subscribe(a=>{if(1==a.success){if(this.zipDataService.convertSubmittedAnswersObj(a.data?.answerObj),a.data){this.result=a.data,this.markedByObj=a.data.markedByObj,this.score=a.data?.answerObj?.point??0,this.pointExercise.value=a.data?.answerObj?.point??"",Number(this.pointExercise.value)<1e3?this.pointExercise.name=this.pointExercise.value.toString():this.listPointAzt.forEach(s=>{s.value==this.pointExercise.value&&(this.pointExercise=this.commonService.myClone(s))}),"0"==this.pointExercise.name&&(this.pointExercise.name="");let i=this.castJsonToObj(a.data.answerObj?.resultNote??"");if(this.commentExercise=i?.Note??"",this.showPoint=!i?.IsHideMark,this.files=this.commonService.myParseJson(a.data.answerObj?.files??"")??[],null!=this.files)for(let s=0;s<this.files.length;s++)this.files[s].url=this.cdnService.getMyCdn(this.files?.[s].url??""),this.files[s].thumb=this.cdnService.getMyCdn(this.files?.[s].thumb??"");this.handleJsonData(),this.hasLoadedData=!0,this.sendDataToMarkNote(),this.successStatusObj()}}else this.errorMessage=a.message??"",this.stopStatusObj()})}handleJsonData(){if(this.jsonData={},!this.result?.answerObj?.confirmedAt&&!this.result?.answerObj?.result&&(this.isMarked=!1),this.result.answerObj?.confirmedAt){this.isMarked=!0;var e=this.commonService.myParseJson(this.result.answerObj?.result??"");e&&(this.jsonData=e,null==this.jsonData&&(this.isMarked=!1))}}getData(e){this.initStatusObj(),this.errorMessage="",this.answerId=e,this.answerService.apiAnswerGetObjGet(this.homeworkHashId,e).subscribe(a=>{if(1==a.success)if(this.zipDataService.convertSubmittedAnswersObj(a.data?.answerObj),a.data?.hasOwnProperty("studentObj")&&null!=a.data?.studentObj){this.result=a.data,this.markedByObj=a.data.markedByObj,this.score=a.data?.answerObj?.point??0,this.pointExercise.value=a.data?.answerObj?.point??0,this.checkInputActive=!0,this.pointExercise.value<1e3?this.pointExercise.name=this.pointExercise.value.toString():this.listPointAzt.forEach(s=>{s.value==this.pointExercise.value&&(this.pointExercise=this.commonService.myClone(s))}),"0"==this.pointExercise.name&&(this.pointExercise.name="",this.checkInputActive=!1);let i=this.castJsonToObj(a.data.answerObj?.resultNote??"");if(this.commentExercise=i?.Note??"",this.showPoint=!i?.IsHideMark,this.homeworkID=a.data.homeworkObj?.id??0,this.classID=a.data.classroomObj?.id??0,this.files=this.commonService.myParseJson(a.data.answerObj?.files??"")??[],this.studentObj=a.data.studentObj,this.classroomObj=a.data.classroomObj??{},null!=this.files)for(let s=0;s<this.files.length;s++)this.files[s].url=this.cdnService.getMyCdn(this.files?.[s].url??""),this.files[s].thumb=this.cdnService.getMyCdn(this.files?.[s].thumb??"");this.homeworkObj=a.data.homeworkObj??{},this.studentName=a.data.studentObj.fullName??"",this.handleJsonData(),this.hasLoadedData=!0,0==this.hasSendDataToIframe&&(this.hasSendDataToIframe=!0,this.sendDataToMarkNote()),this.successStatusObj()}else this.errorMessage="lang_core_not_found_student",this.stopStatusObj();else this.errorMessage=a.message??"",this.stopStatusObj()})}openDialog(e,a){this.sAztDialogService.open(st,{width:"280px",autoFocus:!1,data:{score:a,status:e,homeWorkID:this.homeworkID,homeworkHashId:this.homeworkHashId,classID:this.classID,backToLink:this.backToLink},restoreFocus:!1}).afterClosed().subscribe(s=>{})}handleOpenReSubmit(){this.homeworkObj&&this.openDialogReSubmit(!0,this.homeworkObj.deadline??void 0,this.homeworkObj,this.answerId,this.studentName)}openDialogReSubmit(e,a,i,s,m){let h={status:e,deadline:a,itemHomework:i,ans_id:s,name:m,redirect:!0,classID:this.useNewDashboard?this.homeworkObj?.categoryId:this.classID};this.sAztDialogService.open(ot,{width:"380px",panelClass:"cleanResultDialogBox",data:h,restoreFocus:!1}).afterClosed().subscribe(l=>{if(l&&l.result&&l.isRedirect){let g="?backto="+encodeURIComponent("/admin/testbank/document-management/1/"+h.classID+"/1");this.commonService.myNavigationWithQueryString("/admin/testbank/homework-results-list/"+h.classID+"/"+h.itemHomework.id+"/"+this.homeworkHashId,g)}})}remark(e,a,i){let s=JSON.stringify({type:"homework",id:this.homeworkObj?.id,user:this.homeworkObj?.tenantId});if(""==this.historyId)if(1==this.permissionService.hasMarkPointPermission("homework",this.homeworkObj)){let m={id:e,comment:i.comment,hideMark:i.hideMark?1:0,point:a?parseFloat(a.replace(",",".")):0,result:this.zipDataService.convertContentGzip(JSON.stringify(i)),homeworkHashId:this.homeworkHashId};this.answerService.apiAnswerSaveResultPost(s,m).subscribe(h=>{1==h.success?(this.openDialog(!0,h.data?.obj?.point),this.successStatusObj()):(this.stopStatusObj(),this.showErrorSnack("lang_cms_mark_fail"))})}else this.showErrorSnack("lang_cms_no_permission_on_homework"),this.stopStatusObj();else this.stopStatusObj(),this.showErrorSnack("lang_cms_cannot_remark_student_history_result")}goBack(){this.backToLink?this.backToLink.includes("shareType")?this.commonService.myNavigationBySpecialQueryString(this.backToLink):this.commonService.myNavigation(this.backToLink):this.commonService.myNavigation(this.useNewDashboard?"/admin/testbank/homework-results-list/"+(this.homeworkObj?.categoryId??"0")+"/"+this.homeworkID+"/"+this.homeworkObj?.hashId:"/admin/testbank/homework-results-list/"+this.classID+"/"+this.homeworkID+"/"+this.homeworkObj?.hashId)}checkModeUiEditor(e){let i=(document.getElementById("mark-general-box")?.offsetHeight??0)-80-40-140-40-30;this.initDataEditor="dark"==e?{min_height:i,menubar:!1,resize:!1,skin:"oxide-dark",content_css:"dark",plugins:["advlist","anchor","autolink","charmap","code","fullscreen","lists","media","preview","textcolor","emoticons","fontselect","autoresize"],toolbar:"| fontfamily | fontsize |bold italic underline | forecolor backcolor | alignleft aligncenter alignright | emoticons",emoticons_database:"emojis",font_family_formats:"Arial=arial,helvetica,sans-serif; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Font ch\u1eef \u0111\u1eb9p=font_chu_dep",font_size_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 18pt 20pt 22pt 24pt 30pt 36pt 48pt 60pt 72pt 96pt",content_style:"@font-face { font-family: font_chu_dep; src: url('https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/fonts/HP0015HB.ttf');} body { font-family: font_chu_dep; color: red; font-size: 18pt; line-height: initial;};"}:{min_height:i,menubar:!1,resize:!1,plugins:["advlist","anchor","autolink","charmap","code","fullscreen","lists","media","preview","textcolor","emoticons","fontselect","autoresize"],toolbar:"| fontfamily | fontsize |bold italic underline | forecolor backcolor | alignleft aligncenter alignright | emoticons",emoticons_database:"emojis",font_family_formats:"Arial=arial,helvetica,sans-serif; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Font ch\u1eef \u0111\u1eb9p=font_chu_dep",font_size_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 18pt 20pt 22pt 24pt 30pt 36pt 48pt 60pt 72pt 96pt",content_style:"@font-face { font-family: font_chu_dep; src: url('https://cdn.jsdelivr.net/gh/azota889/storage_public/azota_assets/fonts/HP0015HB.ttf');} body { font-family: font_chu_dep; color: red; font-size: 18pt; line-height: initial;};"}}setPoint(e){this.pointExercise=this.commonService.myClone(e),this.checkInputActive=!0}setPointInput(e){if(e.target){this.checkInputActive=!0;let a=e.target.value;this.pointExercise.value=a,this.pointExercise.name=a}}getListPointDefault(){this.listPointAzt=[{value:1e3,name:"\u0110"},{value:1001,name:"C\u0110"},{value:2e3,name:"HT"},{value:2001,name:"CHT"},{value:3e3,name:"HTT"}]}getMarkData(e){e.checkChangeMark&&(this.markData=e,this.checkInputActive||(this.pointExercise.value=isNaN(this.markData.pointRaw??0)?"":this.markData.pointRaw,this.pointExercise.name=this.pointExercise.value?.toString()))}ngOnInit(){this.isMobileDevice||(document.body.style.overflowY="hidden"),this.getListPointDefault();const e=this.commonService.getMyParam(this.activeRoute,"id")?Number(this.commonService.getMyParam(this.activeRoute,"id")):0,a=this.commonService.getMyParam(this.activeRoute,"historyId")??"";this.homeworkHashId=this.commonService.getMyParam(this.activeRoute,"hash_id")??"";let i=this.commonService.getMyQueryParam("backto");this.backToLink=i?i.includes("shareType")?decodeURIComponent(i):i:"",this.getData(e),this.getHistoryObjs(e),a&&this.getDataHistory(a);let s=""==this.browserStorageService.getStorage("mode_ui")?"light":this.browserStorageService.getStorage("mode_ui")??"light";this.checkModeUiEditor(s),this.commonService.translateMetaData({title:"lang_cms_homework_mark_exercise_title",description:"lang_cms_homework_mark_exercise_description",image:"lang_cms_test_image"}),super.ngOnInit()}getSizeMarkEditor(e){this.sizeMarkEditor=e}changeSizeMarkGeneral(){let e=document.getElementById("mark-general"),a=document.getElementById("mark-general-box");a&&e&&(a.style.width=e.offsetWidth.toString()+"px")}uploadDrawBase64ToCdn(){return new Promise(e=>{let a=[];if(this.objectResult.pages){this.objectResult.pages.forEach(i=>{a.push(!1)});for(let i=0;i<this.objectResult.pages.length;i++)if(this.objectResult.pages[i]&&this.objectResult.pages[i].draws?.length)for(let s=0;s<(this.objectResult.pages[i].draws?.length??0);s++){let m=this.objectResult.pages[i].draws?.[s]??{};if(m.src&&m.src.includes("base64")){a[i]=!0;let h=this.baseApiService.dataURItoBlob(m.src);this.apiUploadService.commonUploadForMarkResult(h,`essay_note_${i}_${s}_${this.answerId}.png`,"image/png",1e4).subscribe(u=>{u.type!=I.dt.UploadProgress&&(m.src=u.data?.url,a[i]=!1),a.includes(!0)||e()})}}}})}saveDataMarkExercise(){var e=this;return(0,re.Z)(function*(){if(e.loadingSaveData=!0,""==e.historyId)if(1==e.permissionService.hasMarkPointPermission("homework",e.homeworkObj)){if(!e.MarkNote)return;e.objectResult=e.MarkNote?.exportDataMarkNote();let a=!1;if(e.objectResult.pages?.length===e.files.length){for(let u=0;u<e.objectResult.pages.length;u++)if(e.objectResult.pages[u]&&e.objectResult.pages[u].draws?.length)for(let l=0;l<(e.objectResult.pages[u].draws?.length??0);l++){let g=e.objectResult.pages[u].draws?.[l]??{};g.src&&g.src.includes("base64")&&(a=!0)}a&&(yield e.uploadDrawBase64ToCdn());const i=e.serializeJson(e.objectResult),s=e.zipDataService.convertContentGzip(i),m=new Blob([s],{type:"text/plain"}),h=new File([m],"txt",{type:"text/plain"});e.apiUploadService.uploadToCdnForHomework(h).subscribe(u=>{if(1==u.success){let l=u.data?.url??"",g={point:e.pointExercise.value?.toString(),urlDataMark:l,version:"0.1",comment:e.commentExercise,hideMark:!e.showPoint};e.remark(e.answerId,g.point??"0",g)}else e.showErrorSnack("lang_core_co_loi_trong_qua_trinh_luu_du_lieu_len_cdn_vui_long_thu_lai");e.loadingSaveData=!1})}else e.loadingSaveData=!1,e.showErrorSnack("lang_core_co_loi_trong_qua_trinh_luu_du_lieu_vui_long_thu_lai")}else e.showErrorSnack("lang_cms_no_permission_on_homework"),e.stopStatusObj();else e.stopStatusObj(),e.showErrorSnack("lang_cms_cannot_remark_student_history_result")})()}ngAfterViewInit(){this.changeSizeMarkGeneral()}constructor(e,a,i,s,m,h,u,l,g,p){super(),this.activeRoute=e,this.answerService=a,this.baseApiService=i,this.permissionService=s,this.sAztDialogService=m,this.cdnService=h,this.zipDataService=u,this.apiUploadService=l,this.browserStorageService=g,this.vcRef=p,this.answerId=0,this.homeworkID="",this.historyId="",this.isMarked=!1,this.jsonData={},this.errorMessage="",this.files=[],this.classID="",this.studentName="",this.score=0,this.mnoteJsonData={},this.pagesCount=0,this.backToLink="",this.hasSendDataToIframe=!1,this.hasLoadedData=!1,this.historyAnswerObjs=[],this.countLoad=1,this.homeworkHashId="",this.useNewDashboard=!1,this.initDataEditor={},this.color="#000",this.dataMarkNote={},this.loadingSaveData=!1,this.loadingDataCdn=!0,this.listPointAzt=[],this.pointExercise={value:0,name:""},this.markData={},this.commentExercise="",this.showPoint=!0,this.sizeMarkEditor={width:200,height:800},this.checkInputActive=!1,this.objectResult={},this.handleIframe=S=>{"MNoteJson"==S.data.cmd&&(this.initStatusObj(),this.mnoteJsonData=S.data.data,this.uploadAll(this.mnoteJsonData.pages??[],S.data.data.point)),"MNoteReSubmit"==S.data.cmd&&(console.log("Listen res submit"),this.handleOpenReSubmit()),"MNoteLoadComplete"==S.data&&(this.hasLoadedData?(this.hasSendDataToIframe=!0,""==this.historyId&&this.sendDataToMarkNote()):this.hasSendDataToIframe=!1)}}ngOnDestroy(){document.body.style.overflowY="auto",window.removeEventListener("message",this.handleIframe),super.ngOnDestroy()}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(y.gz),t.Y36(A.P6),t.Y36(nt.V),t.Y36(rt.j),t.Y36(P.C),t.Y36(ct.E),t.Y36(L.a),t.Y36(B.W),t.Y36(X.n),t.Y36(t.s_b))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-mark-exercise-new"]],viewQuery:function(a,i){if(1&a&&t.Gf(de,5),2&a){let s;t.iGM(s=t.CRH())&&(i.MarkNote=s.first)}},hostBindings:function(a,i){1&a&&t.NdJ("resize",function(m){return i.onResize(m)},!1,t.Jf7)},features:[t.qOj],decls:52,vars:39,consts:[[1,"content",2,"padding","0 12px"],[1,"grid","grid-cols-12","gap-3","mt-3"],[1,"col-span-12","md:col-span-8","mark-editor",3,"ngStyle"],[4,"ngIf"],["id","mark-general",1,"col-span-12","md:col-span-4","mark-general"],["id","mark-general-box",1,"box"],[1,"p-2"],[1,"box-head"],[1,"font-medium"],[1,"flex","items-center","mt-2"],[1,"info-student","flex","items-center"],[3,"nameCreateAvatar","size"],[1,"info","ml-2"],[1,"text-md"],[1,"text-xs"],[1,"score","ml-auto","flex","items-center"],["appOnlyNumber","","type","text","id","azt-score",1,"form-control","text-danger","font-medium",3,"decimal","max","value","placeholder","input"],[1,"bg-slate-200","dark:bg-darkmode-400","p-2","text-center","rounded","mt-3"],[4,"ngIf","ngIfElse"],["notMark",""],[1,"choose-score","mt-3"],[1,"score-list-one","grid","grid-cols-10","gap-3"],["class","score-item col-span-2",4,"ngFor","ngForOf"],[1,"comment","mt-3"],[1,"font-medium","text-md"],[1,"comment-editor","mt-2"],["apiKey","ldij13v1886vlrnk42g9bvngyqdc6gxpe8l0n9mo8gdjpg9d",3,"ngModel","init","ngModelChange"],[1,"flex","items-center","mt-3"],[1,"form-check","form-switch"],["id","show-score","type","checkbox",1,"form-check-input","mr-2",3,"ngModel","ngModelChange"],["for","show-score",1,"form-check-label","ml-0"],[1,"ml-auto"],["azt-track-service","mark-exercise-new-yWLPF_cK9E",1,"btn","btn-pending",3,"disabled","click"],[1,"grid","grid-cols-2","gap-3","mt-3"],["azt-track-service","mark-exercise-new-xgpK5bMM5y",1,"btn","btn-secondary",3,"click"],["azt-track-service","mark-exercise-new-lNij5J4UCD",1,"btn","btn-primary",3,"disabled","click"],["class","w-4 h-4 inline-block mr-2",4,"ngIf"],[3,"dataMarkNote","showBackLink","markedByObj","historyAnswerObjs","handleBackLink","doneLoadData","markData","getIdHistory"],["aztMarkNote",""],[1,"score-item","col-span-2"],["azt-track-service","mark-exercise-new-YBVZ7xc_A",1,"border","border-slate-200","dark:border-darkmode-400","btn-score","btn",3,"click"],[1,"w-4","h-4","inline-block","mr-2"],[3,"type"]],template:function(a,i){if(1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,ue,3,4,"ng-container",3),t.qZA(),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h3",8),t._uU(9),t.qZA(),t.TgZ(10,"div",9)(11,"div",10),t._UZ(12,"azt-create-avatar",11),t.TgZ(13,"div",12)(14,"p",13),t._uU(15),t.qZA(),t.TgZ(16,"p",14),t._uU(17),t.qZA()()(),t.TgZ(18,"div",15)(19,"input",16),t.NdJ("input",function(m){return i.setPointInput(m)}),t.ALo(20,"mytranslate"),t.qZA()()()(),t.TgZ(21,"div",17),t.YNc(22,ge,4,8,"span",18),t.YNc(23,pe,3,3,"ng-template",null,19,t.W1O),t.qZA(),t.TgZ(25,"div",20)(26,"div",21),t.YNc(27,_e,3,1,"div",22),t.qZA()(),t.TgZ(28,"div",23)(29,"p",24),t._uU(30),t.ALo(31,"mytranslate"),t.qZA(),t.TgZ(32,"div",25)(33,"editor",26),t.NdJ("ngModelChange",function(m){return i.commentExercise=m}),t.qZA()()(),t.TgZ(34,"div",27)(35,"div",28)(36,"input",29),t.NdJ("ngModelChange",function(m){return i.showPoint=m}),t.qZA(),t.TgZ(37,"label",30),t._uU(38),t.ALo(39,"mytranslate"),t.qZA()(),t.TgZ(40,"div",31)(41,"button",32),t.NdJ("click",function(){return i.handleOpenReSubmit()}),t._uU(42),t.ALo(43,"mytranslate"),t.qZA()()(),t.TgZ(44,"div",33)(45,"button",34),t.NdJ("click",function(){return i.goBack()}),t._uU(46),t.ALo(47,"mytranslate"),t.qZA(),t.TgZ(48,"button",35),t.NdJ("click",function(){return i.saveDataMarkExercise()}),t.YNc(49,fe,2,1,"span",36),t._uU(50),t.ALo(51,"mytranslate"),t.qZA()()()()()()()),2&a){const s=t.MAs(24);t.xp6(2),t.Q6J("ngStyle",t.VKq(37,be,i.sizeMarkEditor.height+"px")),t.xp6(1),t.Q6J("ngIf",i.dataMarkNote.answer_obj),t.xp6(6),t.hij(" ",null==i.homeworkObj?null:i.homeworkObj.name," "),t.xp6(3),t.Q6J("nameCreateAvatar",null==i.studentObj?null:i.studentObj.fullName)("size",35),t.xp6(3),t.hij(" ",null==i.studentObj?null:i.studentObj.fullName," "),t.xp6(2),t.hij(" ",null==i.classroomObj?null:i.classroomObj.name," "),t.xp6(2),t.s9C("placeholder",t.lcZ(20,25,"lang_auto_nhap_diem")),t.Q6J("decimal",!0)("max",999)("value",i.pointExercise.name),t.xp6(3),t.Q6J("ngIf",i.markData.totalRight||i.markData.totalWrong)("ngIfElse",s),t.xp6(5),t.Q6J("ngForOf",i.listPointAzt),t.xp6(3),t.hij(" ",t.lcZ(31,27,"lang_auto_nhan_xet")," "),t.xp6(3),t.Q6J("ngModel",i.commentExercise)("init",i.initDataEditor),t.xp6(3),t.Q6J("ngModel",i.showPoint),t.xp6(2),t.hij(" ",t.lcZ(39,29,"lang_auto_hien_thi_diem")," "),t.xp6(3),t.Q6J("disabled",""!==i.historyId),t.xp6(1),t.hij(" ",t.lcZ(43,31,"lang_auto_yeu_cau_nop_lai")," "),t.xp6(4),t.hij(" ",t.lcZ(47,33,"lang_auto_quay_lai")," "),t.xp6(2),t.Q6J("disabled",i.loadingSaveData||""!==i.historyId||""==i.pointExercise.name||i.loadingDataCdn),t.xp6(1),t.Q6J("ngIf",i.loadingSaveData),t.xp6(1),t.hij(" ",t.lcZ(51,35,"lang_auto_luu_du_lieu")," ")}},dependencies:[b.sg,b.O5,b.PC,r.PG,n.Wl,n.JJ,n.On,lt.g,le.Y,me.n,he.H,C.JV],styles:[".btn-score[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center}.btn-score[_ngcontent-%COMP%]:hover{background:rgb(var(--color-slate-200)/var(--tw-bg-opacity))}.choose-score[_ngcontent-%COMP%]{max-width:80%;margin-left:auto;margin-right:auto}.toolbar-list[_ngcontent-%COMP%]{width:100%;padding:5px;position:absolute;top:0;left:0;display:flex;align-items:center;border-bottom-left-radius:0;border-bottom-right-radius:0}.btn-icon[_ngcontent-%COMP%]{padding:10px;min-width:auto;line-height:initial}.toolbar-item[_ngcontent-%COMP%]{margin:0 3px}.toolbar-item[_ngcontent-%COMP%]:first-child{margin-left:0}.btn-icon-child[_ngcontent-%COMP%]{padding:5px}.azt-toolbar-active[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(var(--color-slate-200)/var(--tw-bg-opacity))}  .dark .azt-toolbar-active{--tw-bg-opacity: 1;background-color:rgb(var(--color-darkmode-200)/var(--tw-bg-opacity))}.mark-general[_ngcontent-%COMP%]{order:2}.mark-editor[_ngcontent-%COMP%]{order:1}@media screen and (max-width: 768px){.choose-score[_ngcontent-%COMP%]{max-width:80%}.mark-general[_ngcontent-%COMP%]{order:2}.mark-editor[_ngcontent-%COMP%]{order:1}.content[_ngcontent-%COMP%]{margin-bottom:100px}}#mark-general-box[_ngcontent-%COMP%]{height:calc(100vh - 24px);overflow:auto}@media screen and (max-width: 768px){#mark-general-box[_ngcontent-%COMP%]{position:relative;min-height:100vh;height:auto;overflow:hidden}}"]})}return o})();var mt=c(75270),ht=c(77988);function ve(o,_){if(1&o&&(t.TgZ(0,"button",15),t.ALo(1,"mytranslate"),t.TgZ(2,"mat-icon"),t._uU(3,"history"),t.qZA()()),2&o){t.oxw();const e=t.MAs(8);t.s9C("matTooltip",t.lcZ(1,2,"lang_homework_mark_exercise_history_submit")),t.Q6J("matMenuTriggerFor",e)}}function we(o,_){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"button",16),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.getDataHistory(s.id?s.id.toString():""))}),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"mytranslate"),t.ALo(5,"formatFullDateTimeWithoutSecondByUserUnitPipe"),t.qZA()()()}if(2&o){const e=_.$implicit,a=_.index;t.xp6(3),t.lnq("",t.lcZ(4,3,"lang_homework_mark_exercise_times")," ",a+1," - ",t.lcZ(5,5,e.createdAt),"")}}function xe(o,_){if(1&o&&(t.TgZ(0,"span"),t._UZ(1,"azt-create-avatar",18),t.ALo(2,"mytranslate"),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hYB("matTooltip","",t.lcZ(2,5,"lang_homework_mark_exercise_teacher_mark")," ",": "+(null==e.markedByObj?null:e.markedByObj.fullName),""),t.Q6J("nameCreateAvatar",null==e.markedByObj?null:e.markedByObj.fullName)("size",25)("linkAvatar",null==e.markedByObj?null:e.markedByObj.avatar)}}function ye(o,_){if(1&o&&(t.TgZ(0,"h4",17),t.YNc(1,xe,3,7,"span",13),t._uU(2),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.isMarked),t.xp6(1),t.AsE(" ",null==e.studentObj?null:e.studentObj.fullName,", ",e.classroomObj.name," ")}}function Oe(o,_){1&o&&(t._UZ(0,"azt-loading-effect",19),t.ALo(1,"mytranslate")),2&o&&t.Q6J("customText",t.lcZ(1,1,"lang_homework_mark_exercise_loading_data_mark"))}function Se(o,_){if(1&o&&(t.TgZ(0,"div")(1,"div",20)(2,"div",21)(3,"div",22),t._uU(4),t.ALo(5,"mytranslate"),t.qZA()()()()),2&o){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,1,e.errorMessage))}}function je(o,_){if(1&o&&(t.TgZ(0,"div",23),t._UZ(1,"iframe",24),t.ALo(2,"safe"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("src",t.lcZ(2,1,e.whiteListMNoteIframeSrc),t.uOi)}}let Ce=(()=>{class o extends N.Q{onPopState(e){this.goBack()}uploadDrawBase64ToCDN(e,a,i){let s=this.baseApiService.dataURItoBlob(e);this.apiUploadService.commonUploadForMarkResult(s,`essay_note_${a}_${this.answerId}.png`,"image/png",1e4).subscribe(m=>{m.type!=I.dt.UploadProgress&&(1==m.success?(this.mnoteJsonData.pages?.[a]&&(this.mnoteJsonData.pages[a].draw=m.data?.url),this.pagesCount--,0==this.pagesCount&&this.remark(this.answerId,i,this.mnoteJsonData)):(this.showErrorSnack("lang_cms_cannot_save_data_marked"),this.stopStatusObj()))})}uploadAll(e,a){this.pagesCount=0;for(let i=0;i<e.length;i++)e[i].draw&&this.pagesCount++;if(0==this.pagesCount)this.remark(this.answerId,a,this.mnoteJsonData);else for(let i=0;i<e.length;i++)e[i].draw&&this.uploadDrawBase64ToCDN(e[i].draw,i,a)}reloadPage(){location.reload()}sendDataToIframe(){const e=document.getElementById("mNote"),a=e?e.contentWindow:null;if(null!==a){let i=this.castObj(this.result.answerObj);if(null!=i){let l=this.commonService.willDeleteParseJson(i.result??"");if(null!=l){let p=l.pages?.length??0;for(let S=0;S<p;S++)l?.pages?.[S].backgroundImage&&(l.pages[S].backgroundImage=this.cdnService.getMyCdn(l.pages[S].backgroundImage??"")),l.pages?.[S].draw&&(l.pages[S].draw=this.cdnService.getMyCdn(l.pages[S].draw));l=JSON.stringify(l),i.result=l}let g=this.commonService.willDeleteParseJson(i.files??"");if(null!=g){for(let p=0;p<g.length;p++)g[p].url&&(g[p].url=this.cdnService.getMyCdn(g[p].url)),g[p].thumb&&(g[p].thumb=this.cdnService.getMyCdn(g[p].thumb));g=JSON.stringify(g),i.files=g}}let s=this.result.studentObj,m=this.result.classroomObj,h=this.result.homeworkObj,u=this.commonService.myParseJson(i?.result??"");if(this.jsonData&&this.jsonData.hasOwnProperty("pages"))for(let l=0;l<(this.jsonData.pages?.length??0);l++)this.jsonData.pages?.[l].hasOwnProperty("backgroundImage")&&(this.jsonData.pages[l].backgroundImage=this.cdnService.getMyCdn(this.jsonData.pages[l].backgroundImage??"")),this.jsonData.pages?.[l].hasOwnProperty("draw")&&(this.jsonData.pages[l].draw=this.cdnService.getMyCdn(this.jsonData.pages[l].draw??""));if(this.isMarked)this.jsonData.cmd="initMNote",this.jsonData.mode="edit",this.jsonData.answer_obj=i,this.jsonData.student_obj=s,this.jsonData.classroom_obj=m,this.jsonData.homework_obj=h,u&&u.hasOwnProperty("hideMark")&&(this.jsonData.hideMark=u.hideMark),a.postMessage(this.jsonData,"*");else{let l=[];this.files.forEach(p=>{l.push({backgroundImage:p.url})});let g={cmd:"initMNote",mode:"edit",pages:l,answer_obj:i,student_obj:s,classroom_obj:m,homework_obj:h};u&&u.hasOwnProperty("hideMark")&&(g.hideMark=u.hideMark),a.postMessage(g,"*")}}}sendDataToIframeHistory(){const e=document.getElementById("mNote");e&&1==this.countLoad&&(e.src+="");const a=e?e.contentWindow:null;if(null!==a){let i=this.castObj(this.result.answerObj);if(null!=i){let l=this.commonService.willDeleteParseJson(i?.result??"");if(null!=l){for(let p=0;p<l.pages.length;p++)l.pages[p].backgroundImage&&(l.pages[p].backgroundImage=this.cdnService.getMyCdn(l.pages[p].backgroundImage)),l.pages[p].draw&&(l.pages[p].draw=this.cdnService.getMyCdn(l.pages[p].draw));l=JSON.stringify(l),i.result=l}let g=this.commonService.willDeleteParseJson(i.files??"");if(null!=g){for(let p=0;p<g.length;p++)g[p].url&&(g[p].url=this.cdnService.getMyCdn(g[p].url)),g[p].thumb&&(g[p].thumb=this.cdnService.getMyCdn(g[p].thumb));g=JSON.stringify(g),i.files=g}}let s=this.studentObj,m=this.classroomObj,h=this.homeworkObj,u=this.commonService.willDeleteParseJson(i?.result??"");if(this.jsonData&&this.jsonData.hasOwnProperty("pages"))for(let l=0;l<(this.jsonData.pages?.length??0);l++)this.jsonData.pages?.[l].hasOwnProperty("backgroundImage")&&(this.jsonData.pages[l].backgroundImage=this.cdnService.getMyCdn(this.jsonData.pages[l].backgroundImage??"")),this.jsonData.pages?.[l].hasOwnProperty("draw")&&(this.jsonData.pages[l].draw=this.cdnService.getMyCdn(this.jsonData.pages[l].draw??""));if(this.isMarked)this.jsonData.cmd="initMNote",this.jsonData.mode="view",this.jsonData.answer_obj=i,this.jsonData.student_obj=s,this.jsonData.classroom_obj=m,this.jsonData.homework_obj=h,u&&u.hasOwnProperty("hideMark")&&(this.jsonData.hideMark=u.hideMark),a.postMessage(this.jsonData,"*");else{let l=[];this.files.forEach(p=>{l.push({backgroundImage:p.url})});let g={cmd:"initMNote",mode:"view",pages:l,answer_obj:i,student_obj:s,classroom_obj:m,homework_obj:h};u&&u.hasOwnProperty("hideMark")&&(g.hideMark=u.hideMark),a.postMessage(g,"*")}}}getHistoryObjs(e){this.initStatusObj(),this.answerService.apiAnswerGetHistoryObjsGet(this.homeworkHashId,e).subscribe(a=>{1==a.success?this.historyAnswerObjs=a.data?.objs??new Array:this.errorMessage=a.message??"",this.stopStatusObj()})}getDataHistory(e){this.historyId=e,this.errorMessage="",this.countLoad=1,this.answerService.apiAnswerGetHistoryObjGet(this.homeworkHashId,this.answerId,parseInt(e,10)).subscribe(a=>{if(1==a.success){if(a.data){if(this.zipDataService.convertSubmittedAnswersHistoryObj(a.data?.answerObj),this.result=a.data,this.markedByObj=a.data?.markedByObj,this.score=a.data?.answerObj?.point??0,this.files=this.commonService.myParseJson(a.data?.answerObj?.files??"")??[],null!=this.files)for(let i=0;i<this.files.length;i++)this.files[i].url=this.cdnService.getMyCdn(this.files?.[i].url??""),this.files[i].thumb=this.cdnService.getMyCdn(this.files?.[i].thumb??"");this.handleJsonData(),this.hasLoadedData=!0,1==this.countLoad&&(this.hasSendDataToIframe=!1),0==this.hasSendDataToIframe&&(this.hasSendDataToIframe=!0,this.sendDataToIframeHistory())}this.successStatusObj(),this.countLoad++}else this.errorMessage=a.message??"",this.stopStatusObj()})}handleJsonData(){if(this.jsonData={},!this.result?.answerObj?.confirmedAt&&!this.result?.answerObj?.result&&(this.isMarked=!1),this.result.answerObj?.confirmedAt){this.isMarked=!0;var e=this.commonService.myParseJson(this.result.answerObj?.result??"");e&&(this.jsonData=e,null==this.jsonData&&(this.isMarked=!1))}}getData(e){this.initStatusObj(),this.errorMessage="",this.answerId=e,this.answerService.apiAnswerGetObjGet(this.homeworkHashId,e).subscribe(a=>{if(1==a.success)if(this.zipDataService.convertSubmittedAnswersObj(a.data?.answerObj),a.data?.hasOwnProperty("studentObj")&&null!=a.data?.studentObj){if(this.result=a.data,this.markedByObj=a.data.markedByObj,this.score=a.data?.answerObj?.point??0,this.homeworkID=a.data.homeworkObj?.id??0,this.classID=a.data.classroomObj?.id??0,this.files=this.commonService.myParseJson(a.data.answerObj?.files??"")??[],this.studentObj=a.data.studentObj,this.classroomObj=a.data.classroomObj??{},null!=this.files)for(let i=0;i<this.files.length;i++)this.files[i].url=this.cdnService.getMyCdn(this.files?.[i].url??""),this.files[i].thumb=this.cdnService.getMyCdn(this.files?.[i].thumb??"");this.homeworkObj=a.data.homeworkObj??{},this.studentName=a.data.studentObj.fullName??"",this.handleJsonData(),this.hasLoadedData=!0,0==this.hasSendDataToIframe&&(this.hasSendDataToIframe=!0,this.sendDataToIframe()),this.successStatusObj()}else this.errorMessage="lang_core_not_found_student",this.stopStatusObj();else this.errorMessage=a.message??"",this.stopStatusObj()})}openDialog(e,a){this.sAztDialogService.open(st,{width:"280px",autoFocus:!1,data:{score:a,status:e,homeWorkID:this.homeworkID,homeworkHashId:this.homeworkHashId,classID:this.classID,backToLink:this.backToLink},restoreFocus:!1}).afterClosed().subscribe(s=>{})}handleOpenReSubmit(){null!=this.homeworkObj&&this.openDialogReSubmit(!0,this.homeworkObj.deadline,this.homeworkObj,this.answerId,this.studentName)}openDialogReSubmit(e,a,i,s,m){let h={status:e,deadline:a,itemHomework:i,ans_id:s,name:m,redirect:!0,classID:this.useNewDashboard?this.homeworkObj?.categoryId:this.classID};this.sAztDialogService.open(ot,{width:"380px",panelClass:"cleanResultDialogBox",data:h,restoreFocus:!1}).afterClosed().subscribe(l=>{if(l&&l.result&&l.isRedirect){let g="?backto="+encodeURIComponent("/admin/testbank/document-management/1/"+h.classID+"/1");this.commonService.myNavigationWithQueryString("/admin/testbank/homework-results-list/"+h.classID+"/"+h.itemHomework.id+"/"+this.homeworkHashId,g)}})}remark(e,a,i){let s=JSON.stringify({type:"homework",id:this.homeworkObj?.id,user:this.homeworkObj?.tenantId});if(""==this.historyId)if(1==this.permissionService.hasMarkPointPermission("homework",this.homeworkObj)){let m={id:e,comment:i.comment,hideMark:i.hideMark?1:0,point:a?parseFloat(a.replace(",",".")):0,result:this.zipDataService.convertContentGzip(JSON.stringify(i)),homeworkHashId:this.homeworkHashId};this.answerService.apiAnswerSaveResultPost(s,m).subscribe(h=>{1==h.success?(this.openDialog(!0,h.data?.obj?.point),this.successStatusObj()):(this.stopStatusObj(),this.showErrorSnack("lang_cms_mark_fail"))})}else this.showErrorSnack("lang_cms_no_permission_on_homework"),this.stopStatusObj();else this.stopStatusObj(),this.showErrorSnack("lang_cms_cannot_remark_student_history_result")}goBack(){this.backToLink?this.backToLink.includes("shareType")?this.commonService.myNavigationBySpecialQueryString(this.backToLink):this.commonService.myNavigation(this.backToLink):this.commonService.myNavigation(this.useNewDashboard?"/admin/testbank/homework-results-list/"+(this.homeworkObj?.categoryId??"0")+"/"+this.homeworkID+"/"+this.homeworkObj?.hashId:"/admin/testbank/homework-results-list/"+this.classID+"/"+this.homeworkID+"/"+this.homeworkObj?.hashId);let e=document.body,a=document.getElementById("azota-app-html");a?.classList.remove("overflow-hidden"),a?.classList.remove("height-100"),e.classList.remove("overflow-hidden"),e.classList.remove("height-100")}ngOnInit(){let e=document.body,a=document.getElementById("azota-app-html");a?.classList.add("overflow-hidden"),a?.classList.add("height-100"),e.classList.add("overflow-hidden"),e.classList.add("height-100"),this.whiteListMNoteIframeSrc=this.envService.getEnvValue("classliveUrl")??"";const i=this.commonService.getMyParam(this.activeRoute,"id")?Number(this.commonService.getMyParam(this.activeRoute,"id")):0,s=this.commonService.getMyParam(this.activeRoute,"historyId")??"";this.homeworkHashId=this.commonService.getMyParam(this.activeRoute,"hash_id")??"";let m=this.commonService.getMyQueryParam("backto");this.backToLink=m?m.includes("shareType")?decodeURIComponent(m):m:"",this.getData(i),this.getHistoryObjs(i),s&&this.getDataHistory(s),this.commonService.translateMetaData({title:"lang_cms_homework_mark_exercise_title",description:"lang_cms_homework_mark_exercise_description",image:"lang_cms_test_image"}),super.ngOnInit()}ngAfterViewInit(){window.addEventListener("message",this.handleIframe)}constructor(e,a,i,s,m,h,u,l,g){super(),this.activeRoute=e,this.answerService=a,this.baseApiService=i,this.permissionService=s,this.sAztDialogService=m,this.cdnService=h,this.zipDataService=u,this.envService=l,this.apiUploadService=g,this.subscriptions=new U.w0,this.answerId=0,this.homeworkID="",this.historyId="",this.whiteListMNoteIframeSrc="",this.isMarked=!1,this.jsonData={},this.errorMessage="",this.files=[],this.classID="",this.studentName="",this.score=0,this.mnoteJsonData={},this.pagesCount=0,this.backToLink="",this.hasSendDataToIframe=!1,this.hasLoadedData=!1,this.historyAnswerObjs=[],this.countLoad=1,this.homeworkHashId="",this.useNewDashboard=!1,this.handleIframe=p=>{"MNoteJson"==p.data.cmd&&(this.initStatusObj(),this.mnoteJsonData=p.data.data,this.uploadAll(this.mnoteJsonData.pages??[],p.data.data.point)),"MNoteReSubmit"==p.data.cmd&&(console.log("Listen res submit"),this.handleOpenReSubmit()),"MNoteLoadComplete"==p.data&&(this.hasLoadedData?(this.hasSendDataToIframe=!0,""==this.historyId?this.sendDataToIframe():this.sendDataToIframeHistory()):this.hasSendDataToIframe=!1)}}ngOnDestroy(){window.removeEventListener("message",this.handleIframe),super.ngOnDestroy()}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(y.gz),t.Y36(A.P6),t.Y36(nt.V),t.Y36(rt.j),t.Y36(P.C),t.Y36(ct.E),t.Y36(L.a),t.Y36(mt.h),t.Y36(B.W))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-mark-exericse"]],hostBindings:function(a,i){1&a&&t.NdJ("popstate",function(m){return i.onPopState(m)},!1,t.Jf7)},features:[t.qOj],decls:22,vars:13,consts:[["id","markContainer",1,"maxW1000"],["id","titleRow"],[1,"block-left"],["azt-track-service","mark-exercise-bqS4xx4zrp","mat-button","",3,"title","click"],["mat-icon-button","",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],[1,"dropdown-menu","w-56","show","relative"],[1,"dropdown-content"],["azt-track-service","mark-exercise-7krhNQm3da",1,"dropdown-item","w-full",3,"click"],[4,"ngFor","ngForOf"],["class","studentInfo","style","padding-right: 10px; color: #fff",4,"ngIf"],[3,"customText",4,"ngIf"],[3,"hidden"],[4,"ngIf"],["class","card-box listPhotos",4,"ngIf"],["mat-icon-button","",3,"matTooltip","matMenuTriggerFor"],["azt-track-service","mark-exercise-5mJpoIUV_A",1,"dropdown-item","w-full",3,"click"],[1,"studentInfo",2,"padding-right","10px","color","#fff"],[2,"cursor","pointer",3,"matTooltip","nameCreateAvatar","size","linkAvatar"],[3,"customText"],[1,"row","justify-content-center","py-5"],[1,"col-12","text-center"],[1,"alert","alert-danger"],[1,"card-box","listPhotos"],["id","mNote","frameborder","0",2,"width","100%","height","100%",3,"src"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),t.NdJ("click",function(){return i.goBack()}),t.ALo(4,"mytranslate"),t._uU(5,"keyboard_arrow_left"),t.qZA(),t.YNc(6,ve,4,4,"button",4),t.TgZ(7,"mat-menu",null,5)(9,"div",6)(10,"ul",7)(11,"li")(12,"button",8),t.NdJ("click",function(){return i.reloadPage()}),t.TgZ(13,"span"),t._uU(14),t.ALo(15,"mytranslate"),t.qZA()()(),t.YNc(16,we,6,7,"li",9),t.qZA()()()(),t.YNc(17,ye,3,3,"h4",10),t.qZA(),t.YNc(18,Oe,2,3,"azt-loading-effect",11),t.TgZ(19,"div",12),t.YNc(20,Se,6,3,"div",13),t.YNc(21,je,3,3,"div",14),t.qZA()()),2&a&&(t.xp6(3),t.s9C("title",t.lcZ(4,9,"lang_buttom_back")),t.xp6(3),t.Q6J("ngIf",null!=i.historyAnswerObjs&&i.historyAnswerObjs.length>0),t.xp6(8),t.Oqu(t.lcZ(15,11,"lang_homework_mark_exercise_last")),t.xp6(2),t.Q6J("ngForOf",i.historyAnswerObjs),t.xp6(1),t.Q6J("ngIf",i.classroomObj),t.xp6(1),t.Q6J("ngIf",i.statusObj.loading),t.xp6(1),t.Q6J("hidden",i.statusObj.loading),t.xp6(1),t.Q6J("ngIf",""!=i.errorMessage),t.xp6(1),t.Q6J("ngIf",""==i.errorMessage))},dependencies:[b.sg,b.O5,tt.RK,J.Hw,ht.VK,ht.p6,et.gM,Q.l,lt.g,C.JV,C.CR,C.$n],styles:["#markContainer[_ngcontent-%COMP%]{position:relative}  .studentInfo img{display:inline-flex!important}#titleRow[_ngcontent-%COMP%]{background-color:#00a7d0;height:40px;position:relative;align-items:center;display:flex;justify-content:space-between;color:#fff}#titleRow[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{cursor:pointer}#titleRow[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:0;font-weight:500;font-size:16px;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;display:-webkit-box}#titleRow[_ngcontent-%COMP%]   .score[_ngcontent-%COMP%]{margin-right:5px}.block-left[_ngcontent-%COMP%]{display:flex;align-items:center}button[_ngcontent-%COMP%]{border:none}.listPhotos[_ngcontent-%COMP%]{width:100%;position:fixed;top:40px;bottom:0}.file[_ngcontent-%COMP%]{border-width:0px;background:inherit;background-color:#f2f2f2;box-sizing:border-box;border-width:1px;border-style:solid;border-color:#e5e5e5;border-left:0px;border-right:0px;border-radius:0;box-shadow:none}.file[_ngcontent-%COMP%]:first-child{margin-top:52px}.file[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.back[_ngcontent-%COMP%]{padding:15px 10px}.back-to[_ngcontent-%COMP%]{color:#fff;display:flex}.back-to[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-bottom:10px}.block[_ngcontent-%COMP%]{padding-top:2px}.mat-expansion-indicator[_ngcontent-%COMP%]:after{color:#fff!important}.add-click[_ngcontent-%COMP%]{display:flex}.add-icon[_ngcontent-%COMP%]{margin-top:5px}.file-custom[_ngcontent-%COMP%]{margin-top:6px}.description__share[_ngcontent-%COMP%]{margin-top:10px}.description__share[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#fff;color:#666;margin-right:15px;padding:5px 10px 0}.row-check[_ngcontent-%COMP%]{border-bottom:1px solid #eee;padding:10px 0}.col-check[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:5px}.exercise[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:25px 0 15px;border-bottom:1px solid #eee}.btn-custom[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff;border-radius:5px;padding:10px 25px}.files-custom[_ngcontent-%COMP%]{margin:0}.btn-share[_ngcontent-%COMP%]{border:1px solid #eee}.score-exercise[_ngcontent-%COMP%]{background-color:#ea3d19;border-radius:50%;padding:3px 5px 3px 7px;color:#fff;font-weight:600;margin:0 10px}#listNumber[_ngcontent-%COMP%]{display:contents}#markNumber[_ngcontent-%COMP%]{position:absolute;top:40px;right:50%;z-index:9;margin-right:-60px;color:#fff;text-transform:uppercase;width:120px}@media (min-width: 1000px){.mark-edit[_ngcontent-%COMP%]{width:250px}.file[_ngcontent-%COMP%]:first-child{margin-top:0}.listPhotos[_ngcontent-%COMP%]{width:1000px}}"]})}return o})();var De=c(46558);const Te=[{path:"",component:(()=>{class o extends N.Q{ngOnInit(){super.ngOnInit()}constructor(e){super(),this.commonService=e}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(De.z))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["homework-master-page"]],features:[t.qOj],decls:2,vars:0,consts:[["id","homework-layout"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0),t._UZ(1,"router-outlet"),t.qZA())},dependencies:[y.lC],encapsulation:2})}return o})(),canActivate:[Z.v],children:[{path:"add-new-homework/:cat_id",component:zt},{path:"mark-exercise/:id/:hash_id",component:Ce},{path:"switch-mark-exercise/:id/:hash_id",component:(()=>{class o extends N.Q{getData(e){this.initStatusObj(),this.answerService.apiAnswerGetObjGet(this.homeworkHashId,e).subscribe(a=>{if(1==a.success)if(this.zipDataService.convertSubmittedAnswersObj(a.data?.answerObj),null!=a.data?.studentObj){const i=a.data,s=this.envService.getVersionMarkNote(this.classliveUrl),m=1e6;i.answerObj?.result?(i.answerObj?.result??"").includes("urlDataMark")?this.commonService.myNavigationWithQueryString(`/admin/homework/mark-exercise-new/${i.answerObj?.id}/${this.homeworkHashId}`,`?backto=${encodeURIComponent(this.backToLink)}`):this.commonService.myNavigationWithQueryString(`/admin/homework/mark-exercise/${i.answerObj?.id}/${this.homeworkHashId}`,`?backto=${encodeURIComponent(this.backToLink)}`):this.commonService.myNavigationWithQueryString(s>m?`/admin/homework/mark-exercise-new/${i.answerObj?.id}/${this.homeworkHashId}`:`/admin/homework/mark-exercise/${i.answerObj?.id}/${this.homeworkHashId}`,`?backto=${encodeURIComponent(this.backToLink)}`),this.successStatusObj()}else this.stopStatusObj();else this.stopStatusObj()})}ngOnInit(){this.classliveUrl=this.envService.getEnvValue("classliveUrl")??"",this.homeworkHashId=this.commonService.getMyParam(this.activeRoute,"hash_id")??"";const e=this.commonService.getMyParam(this.activeRoute,"id")?Number(this.commonService.getMyParam(this.activeRoute,"id")):0;let a=this.commonService.getMyQueryParam("backto");this.backToLink=a?a.includes("shareType")?decodeURIComponent(a):a:"",this.getData(e),super.ngOnInit()}constructor(e,a,i,s){super(),this.activeRoute=e,this.answerService=a,this.zipDataService=i,this.envService=s,this.homeworkHashId="",this.backToLink="",this.classliveUrl=""}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(y.gz),t.Y36(A.P6),t.Y36(L.a),t.Y36(mt.h))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-mark-exercise-new"]],features:[t.qOj],decls:0,vars:0,template:function(a,i){},encapsulation:2})}return o})()},{path:"mark-exercise-new/:id/:hash_id",component:ke},{path:"content-store",component:se}]}];let Ze=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({imports:[y.Bz.forChild(Te),y.Bz,v.fQ]})}return o})(),Ie=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({imports:[k.kb,y.Bz,b.ez,O.j,r.Z_,Ze,n.u5,n.UX,x.Is,z.Z,f.xC,T.W,H.d,w.k,d.qyJ.pick(d.ciZ)]})}return o})()},72164:(E,D,c)=>{c.d(D,{e:()=>y});var b=c(19347),n=c(47496),x=c(65879);let y=(()=>{class r extends n.Q{constructor(f,k){super(),this.data=f,this.dialogRef=k}static#t=this.\u0275fac=function(k){return new(k||r)(x.Y36(b.WI),x.Y36(b.so))};static#e=this.\u0275cmp=x.Xpm({type:r,selectors:[["ng-component"]],features:[x.qOj],decls:0,vars:0,template:function(k,O){},encapsulation:2})}return r})()},2783:(E,D,c)=>{c.d(D,{C:()=>x});var b=c(65879),n=c(19347);let x=(()=>{class y{constructor(d){this.dialog=d,this.open=(f,k)=>this.dialog.open(f,k)}static#t=this.\u0275fac=function(f){return new(f||y)(b.LFG(n.uw))};static#e=this.\u0275prov=b.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()},76024:(E,D,c)=>{c.d(D,{Y:()=>n});var b=c(65879);let n=(()=>{class x{constructor(r){this.el=r,this.hasDecimalPoint=!1,this.hasNegativeSign=!1,this.navigationKeys=["Backspace","Delete","Tab","Escape","Enter","Home","End","ArrowLeft","ArrowRight","Clear","Copy","Paste"],this.decimal=!1,this.decimalSeparator1=".",this.decimalSeparator2=",",this.allowNegatives=!1,this.allowPaste=!0,this.negativeSign="-",this.min=-1/0,this.max=1/0,this.regex=null,this.inputElement=r.nativeElement}ngOnChanges(r){if(r.pattern&&(this.regex=this.pattern?RegExp(this.pattern):null),r.min){const d=Number(this.min);this.min=isNaN(d)?-1/0:d}if(r.max){const d=Number(this.max);this.max=isNaN(d)?1/0:d}}onBeforeInput(r){if(isNaN(Number(r.data))){if(r.data===this.decimalSeparator1||r.data===this.decimalSeparator2||r.data===this.negativeSign&&this.allowNegatives)return;r.preventDefault(),r.stopPropagation()}}onKeyDown(r){if(this.navigationKeys.indexOf(r.key)>-1||("a"===r.key||"KeyA"===r.code)&&!0===r.ctrlKey||("c"===r.key||"KeyC"===r.code)&&!0===r.ctrlKey||("v"===r.key||"KeyV"===r.code)&&!0===r.ctrlKey||("x"===r.key||"KeyX"===r.code)&&!0===r.ctrlKey||("a"===r.key||"KeyA"===r.code)&&!0===r.metaKey||("c"===r.key||"KeyC"===r.code)&&!0===r.metaKey||("v"===r.key||"KeyV"===r.code)&&!0===r.metaKey||("x"===r.key||"KeyX"===r.code)&&!0===r.metaKey)return;let d="";var f=r.key;if(r.key===this.decimalSeparator2&&(f=this.decimalSeparator1),this.decimal&&f===this.decimalSeparator1)return d=this.forecastValue(f),d.split(this.decimalSeparator1).length>2||(this.hasDecimalPoint=d.indexOf(this.decimalSeparator1)>-1,this.setNewValue(f)),void r.preventDefault();if(f===this.negativeSign&&this.allowNegatives)return d=this.forecastValue(f),d.charAt(0)!==this.negativeSign||d.split(this.negativeSign).length>2?void r.preventDefault():void(this.hasNegativeSign=d.split(this.negativeSign).length>-1);if(" "===f||isNaN(Number(f)))return void r.preventDefault();if(d=d||this.forecastValue(f),this.regex&&!this.regex.test(d))return void r.preventDefault();const k=Number(d);(k>this.max||k<this.min)&&r.preventDefault()}onPaste(r){if(!0===this.allowPaste){let d="";window.clipboardData?d=window.clipboardData.getData("text"):r.clipboardData&&r.clipboardData.getData&&(d=r.clipboardData.getData("text/plain")),this.pasteData(d),r.preventDefault()}else r.preventDefault(),r.stopPropagation()}onDrop(r){const d=r.dataTransfer?.getData("text")??"";this.inputElement.focus(),this.pasteData(d),r.preventDefault()}pasteData(r){r=r.replace(",",".");const d=this.sanitizeInput(r);if(!d.includes(this.negativeSign)||!this.hasNegativeSign||this.getSelection().includes(this.negativeSign)){if(!document.execCommand("insertText",!1,d))if(this.inputElement.setRangeText){const{selectionStart:k,selectionEnd:O}=this.inputElement;this.inputElement.setRangeText(d,k??0,O??0,"end"),typeof window.InstallTrigger<"u"&&this.inputElement.dispatchEvent(new Event("input",{cancelable:!0}))}else this.insertAtCursor(this.inputElement,d);this.decimal&&(this.hasDecimalPoint=this.inputElement.value.indexOf(this.decimalSeparator1)>-1),this.hasNegativeSign=this.inputElement.value.indexOf(this.negativeSign)>-1}}setNewValue(r){r=r.replace(",","."),this.insertAtCursor(this.inputElement,r),this.decimal&&(this.hasDecimalPoint=this.inputElement.value.indexOf(this.decimalSeparator1)>-1),this.hasNegativeSign=this.inputElement.value.indexOf(this.negativeSign)>-1}insertAtCursor(r,d){const f=r.selectionStart??0,k=r.selectionEnd??0;r.value=r.value.substring(0,f)+d+r.value.substring(k,r.value.length);const O=f+d.length;r.focus(),r.setSelectionRange(O,O),this.triggerEvent(r,"input")}triggerEvent(r,d){if("createEvent"in document){const f=document.createEvent("HTMLEvents");f.initEvent(d,!1,!0),r.dispatchEvent(f)}}sanitizeInput(r){let f,d="";f=this.decimal&&this.isValidDecimal(r)?new RegExp(`${this.getNegativeSignRegExp()}[^0-9${this.decimalSeparator1}]`,"g"):new RegExp(`${this.getNegativeSignRegExp()}[^0-9]`,"g"),d=r.replace(f,"");const k=this.inputElement.maxLength;if(k>0){const O=k-this.inputElement.value.length+(d.includes(`${this.negativeSign}`)?1:0);d=O>0?d.substring(0,O):""}return d}getNegativeSignRegExp(){return!this.allowNegatives||this.hasNegativeSign&&!this.getSelection().includes(this.negativeSign)?"":`(?!^${this.negativeSign})`}isValidDecimal(r){if(this.hasDecimalPoint){const d=this.getSelection();return d&&d.indexOf(this.decimalSeparator1)>-1?r.split(this.decimalSeparator1).length<=2:r.indexOf(this.decimalSeparator1)<0}return r.split(this.decimalSeparator1).length<=2}getSelection(){return this.inputElement.value.substring(this.inputElement.selectionStart??0,this.inputElement.selectionEnd??0)}forecastValue(r){const f=this.inputElement.selectionEnd??0,k=this.inputElement.value;return k.substring(0,this.inputElement.selectionStart??0)+r+k.substring(f)}static#t=this.\u0275fac=function(d){return new(d||x)(b.Y36(b.SBq))};static#e=this.\u0275dir=b.lG2({type:x,selectors:[["","appOnlyNumber",""]],hostBindings:function(d,f){1&d&&b.NdJ("beforeinput",function(O){return f.onBeforeInput(O)})("keydown",function(O){return f.onKeyDown(O)})("paste",function(O){return f.onPaste(O)})("drop",function(O){return f.onDrop(O)})},inputs:{decimal:"decimal",decimalSeparator1:"decimalSeparator1",decimalSeparator2:"decimalSeparator2",allowNegatives:"allowNegatives",allowPaste:"allowPaste",negativeSign:"negativeSign",min:"min",max:"max",pattern:"pattern"},features:[b.TTD]})}return x})()},43389:(E,D,c)=>{c.d(D,{l:()=>H});var b=c(47496),n=c(65879),x=c(96814),y=c(16007),r=c(40750);function d(w,T){if(1&w&&(n.O4$(),n.kcU(),n._UZ(0,"mat-progress-bar",10)),2&w){const v=n.oxw();n.Q6J("value",v.progress_value)}}function f(w,T){if(1&w&&(n.O4$(),n.kcU(),n.TgZ(0,"div",11),n._uU(1),n.qZA()),2&w){const v=n.oxw();n.xp6(1),n.Oqu(v.getMsg())}}function k(w,T){if(1&w){const v=n.EpF();n.O4$(),n.kcU(),n.TgZ(0,"div",12),n._uU(1),n.ALo(2,"mytranslate"),n.TgZ(3,"a",13),n.NdJ("click",function(){n.CHM(v);const j=n.oxw();return n.KtG(j.isShowErrorsBox=!j.isShowErrorsBox)}),n._uU(4),n.ALo(5,"mytranslate"),n.ALo(6,"mytranslate"),n.qZA()()}if(2&w){const v=n.oxw();n.xp6(1),n.hij(" ",n.lcZ(2,2,"lang_auto_da_xay_ra_loi_trong_qua_trinh_trao_doi_du_lieu_")," "),n.xp6(3),n.hij(" ",v.isShowErrorsBox?n.lcZ(5,4,"lang_auto_an_chi_tiet"):n.lcZ(6,6,"lang_auto_xem_chi_tiet")," ")}}function O(w,T){if(1&w&&(n.O4$(),n.kcU(),n.TgZ(0,"div",12),n._uU(1),n.qZA()),2&w){const v=n.oxw();n.xp6(1),n.hij(" ",v.LogErrorsRequest," ")}}function z(w,T){if(1&w&&(n.O4$(),n.kcU(),n.TgZ(0,"div",14),n._uU(1),n.ALo(2,"mytranslate"),n.qZA()),2&w){const v=n.oxw();n.xp6(1),n.Oqu(v.customText?v.customText:n.lcZ(2,1,"lang_auto_dang_tai_du_lieu")+"...")}}let H=(()=>{class w extends b.Q{constructor(){super(...arguments),this.progress_value=-1,this.LogErrorsRequest=!1,this.customText="",this.isShowErrorsBox=!1}getMsg(){let v="";return 100==this.progress_value||0==this.progress_value?(v=this.commonService.myTranslateInstant("lang_auto_dang_xu_ly")??"",`${v} ...`):(v=this.commonService.myTranslateInstant("lang_auto_dang_tai_tep_tin_len_he_thong")??"",`${v}... ${this.progress_value} %`)}static#t=this.\u0275fac=function(){let v;return function(j){return(v||(v=n.n5z(w)))(j||w)}}();static#e=this.\u0275cmp=n.Xpm({type:w,selectors:[["azt-loading-effect"]],inputs:{progress_value:"progress_value",LogErrorsRequest:"LogErrorsRequest",customText:"customText"},features:[n.qOj],decls:12,vars:5,consts:[[1,"box-loading","h-full"],[1,"text-center","py-4"],["version","1.1","id","jobing-j-drawit","id","Layer_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","x","0px","y","0px","viewBox","0 0 109 92.9",0,"xml","space","preserve",1,"w-12","mx-auto",2,"enable-background","new 0 0 109 92.9"],["d","M90.8,52c3.5,6.2,7.1,11.7,9.8,17.7c4.4,9.7-2.9,20.7-13.8,20.9c-11.8,0.2-23.7,0.2-35.5,0 c-11-0.1-17.6-12.2-12-21.7c0.4-0.8,1.8-1.4,2.7-1.4c9.9-0.1,19.7-0.1,29.6-0.1c9.8,0,15.9-4.6,18.7-14C90.4,53.2,90.5,52.9,90.8,52 z",1,"azt-svg-loading","jobing-j"],["d","M39.6,90.3c-6.8,0-13.8,0.8-20.5-0.2c-9.7-1.4-15-12.8-10.3-21.3c5.9-10.9,12.1-21.6,18.5-32.2 c5.5-9,18.6-8.7,24.2,0.2c0.7,1.1,0.8,1.9,0.1,3.1C46.7,48.3,42,57,36.8,65.3c-5.3,8.4-3.8,18.8,2.5,24.6 C39.5,89.9,39.5,90.2,39.6,90.3z",1,"azt-svg-loading","jobing-j"],["d","M32.5,27.3c3.3-5.7,6.1-11,9.4-16c5.9-9.1,19.4-9.2,25.1,0c6.5,10.4,12.6,21,18.3,31.7 c4.8,9-1.5,19.9-11.5,20.7c-1.6,0.1-2.6-0.2-3.5-1.8c-4.8-8.6-9.8-17.1-14.7-25.6c-4.7-8.3-12.5-11.6-21.7-9.2 C33.6,27.1,33.3,27.1,32.5,27.3z",1,"azt-svg-loading","jobing-j"],["style","margin-bottom: 30px; border-radius: 5px","mode","buffer",3,"value",4,"ngIf"],["class","note text-center font-weight-bold",4,"ngIf","ngIfElse"],["class","alert alert-danger mt-3","role","alert",4,"ngIf"],["notLoading",""],["mode","buffer",2,"margin-bottom","30px","border-radius","5px",3,"value"],[1,"note","text-center","font-weight-bold"],["role","alert",1,"alert","alert-danger","mt-3"],["azt-track-service","loading-effect-5TYv52U-wgq","href","javscript:void(0)",3,"click"],[1,"note","text-center","font-medium"]],template:function(Z,j){if(1&Z&&(n.TgZ(0,"div",0)(1,"div",1),n.O4$(),n.TgZ(2,"svg",2),n._UZ(3,"path",3)(4,"path",4)(5,"path",5),n.qZA()(),n.YNc(6,d,1,1,"mat-progress-bar",6),n.YNc(7,f,2,1,"div",7),n.YNc(8,k,7,8,"div",8),n.YNc(9,O,2,1,"div",8),n.YNc(10,z,3,3,"ng-template",null,9,n.W1O),n.qZA()),2&Z){const I=n.MAs(11);n.xp6(6),n.Q6J("ngIf",-1!=j.progress_value),n.xp6(1),n.Q6J("ngIf",-1!=j.progress_value)("ngIfElse",I),n.xp6(1),n.Q6J("ngIf",!1!==j.LogErrorsRequest),n.xp6(1),n.Q6J("ngIf",j.isShowErrorsBox)}},dependencies:[x.O5,y.pW,r.JV],encapsulation:2})}return w})()}}]);