"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[4695],{57003:(H,F,n)=>{n.d(F,{Q:()=>Q});var t=n(81519),i=n(10936),U=n(34514),e=n(47426),y=n(89163),o=n(99503),N=n(79347),_=n(33887),C=n(38009),u=n(9691),E=n(80037),M=n(48485),a=n(48891),s=n(33634),f=n(51913),g=n(3780),k=n(54460),A=n(81587),p=n(27985),S=n(52811),V=n(9842),J=n(76975);function Z(b,z){1&b&&(a.j41(0,"div",5),a.nrm(1,"azt-loading-ui"),a.k0s())}function tt(b,z){if(1&b&&(a.j41(0,"div",27)(1,"div",28),a.nrm(2,"azt-list-classroom-checkbox",29),a.k0s()()),2&b){const v=a.XpG(2);a.R7$(2),a.Y8G("form",v.form)("classroomGroupData",v.classroomWithGroup)("examClassroomObjs",v.examClassroomObjs)("permissionName",v.permissionTypes.exam)}}function q(b,z){if(1&b&&(a.j41(0,"div",27)(1,"div",30)(2,"div",31)(3,"h3",32),a.EFF(4),a.nI1(5,"mytranslate"),a.k0s()(),a.nrm(6,"list-student-checkbox",33),a.k0s()()),2&b){const v=a.XpG(2);a.R7$(4),a.SpI(" ",a.bMT(5,5,"lang_test_config_student_list")," "),a.R7$(2),a.Y8G("form",v.form)("classroomGroupData",v.classroomWithGroup)("examStudentObjs",v.data.examStudents)("permissionName",v.permissionTypes.exam)}}function w(b,z){if(1&b){const v=a.RV6();a.j41(0,"div",6)(1,"form",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"div",11),a.EFF(6),a.nI1(7,"mytranslate"),a.k0s()(),a.j41(8,"div",12)(9,"div",13)(10,"div",14)(11,"input",15),a.bIt("change",function(){a.eBV(v);const R=a.XpG();return a.Njj(R.clearAllCheckBox(0))}),a.k0s(),a.j41(12,"label",16),a.EFF(13),a.nI1(14,"mytranslate"),a.k0s()(),a.j41(15,"div",17)(16,"input",18),a.bIt("change",function(){a.eBV(v);const R=a.XpG();return a.Njj(R.clearAllCheckBox(2))}),a.k0s(),a.j41(17,"label",19),a.EFF(18),a.nI1(19,"mytranslate"),a.k0s()(),a.j41(20,"div",20)(21,"input",21),a.bIt("change",function(){a.eBV(v);const R=a.XpG();return a.Njj(R.clearAllCheckBox(3))}),a.k0s(),a.j41(22,"label",22),a.EFF(23),a.nI1(24,"mytranslate"),a.k0s()()()(),a.DNE(25,tt,3,4,"div",23)(26,q,7,7,"div",23),a.k0s()()()(),a.j41(27,"div",24)(28,"button",25),a.bIt("click",function(){a.eBV(v);const R=a.XpG();return a.Njj(R.closeDialog())}),a.EFF(29),a.nI1(30,"mytranslate"),a.k0s(),a.j41(31,"button",26),a.bIt("click",function(){a.eBV(v);const R=a.XpG();return a.Njj(R.savePublishExam("save"))}),a.EFF(32),a.nI1(33,"mytranslate"),a.k0s()()}if(2&b){const v=a.XpG();a.R7$(),a.Y8G("formGroup",v.form),a.R7$(5),a.SpI(" ",a.bMT(7,13,"lang_testbank_test_config_who_tested")," "),a.R7$(5),a.Y8G("value",0),a.R7$(2),a.SpI(" ",a.bMT(14,15,"lang_testbank_test_config_all_people")," "),a.R7$(3),a.Y8G("value",2),a.R7$(2),a.SpI(" ",a.bMT(19,17,"lang_testbank_test_config_assigne_class")," "),a.R7$(3),a.Y8G("value",3),a.R7$(2),a.SpI(" ",a.bMT(24,19,"lang_testbank_test_config_assigne_student")," "),a.R7$(2),a.Y8G("ngIf",2===v.form.controls.whoAllow.value),a.R7$(),a.Y8G("ngIf",3===v.form.controls.whoAllow.value),a.R7$(3),a.SpI(" ",a.bMT(30,21,"lang_auto_huy")," "),a.R7$(2),a.Y8G("disabled",3===v.form.controls.whoAllow.value&&v.form.controls.studentIds.errors||2===v.form.controls.whoAllow.value&&v.form.controls.classroomFormArray.errors),a.R7$(),a.SpI(" ",a.bMT(33,23,"lang_auto_luu")," ")}}let Q=(()=>{var b;class z extends _._{clearAllCheckBox(B){1==B?this.isSelectClassroom=!1:2==B&&(this.isSelectClassroom=!0)}closeDialog(B){this.dialogRef.close(B)}savePublishExam(B){this.initStatusObj();let R="publish"===B?1:void 0;var m=this.form.getRawValue();const P=this.sAztClassroomCheckboxService.getClassroomIdsCheckedInGroup(this.form.controls.classroomFormArray);let O=[];if(3==m.whoAllow&&m.studentIds&&m.studentIds.length){let Y=this.commonService.arrayToDictionary(m.studentIds,x=>x.classroomId.toString());Object.entries(Y).forEach(([x,I],T)=>{let L=this.commonService.getFirstOfArray(I)?.classroomId;L&&O?.push({classroomId:L,assignStudentIds:I.map($=>$.studentId)})})}else O=void 0;let D={whoAllow:m.whoAllow,isPublished:R??void 0,classroomIds:P,assignStudents:O,isSaveConfig:0};var d=this.permissionService.hasEditPermission("exam",this.obj)?this.documentConfigService.apiDocumentConfigSaveExamConfigPost(this.hashId,D):this.documentConfigService.apiDocumentConfigSaveExamDataForConfigClassroomPost(this.hashId,D);this.waitDestroy(d.subscribe(Y=>{1==Y.success?(this.successStatusObj(),this.showSuccessSnack("lang_auto_luu_thanh_cong"),this.closeDialog(Y.data?.obj)):this.errorStatusObj(Y.message??"",!0)}))}getExamDataByHashId(B){this.initStatusObj(),this.waitDestroy(this.documentConfigService.apiDocumentConfigGetExamDataForConfigClassroomV2Get(B).subscribe(R=>{if(1==R.success){if(null!=R.data){var P,m=R.data?.examObj;if(!(P=this.castObj(m)))return;P.limitQuestionGroupsParse=this.commonService.myParseJson(m.limitQuestionGroups??""),this.obj=P,this.hashId=this.obj.hashId??"",this.classroomWithGroup=R.data.classroomGroupObjs??new Array,this.classroomObjs=this.commonService.concatMultipleArray(R.data.classroomGroupObjs.map(O=>O.classroomObjs)),this.examClassroomObjs=R.data.examClassroomObjs??[],this.form.patchValue({whoAllow:this.obj.whoAllow}),this.isSelectClassroom=2==this.obj.whoAllow,this.successStatusObj()}}else this.errorStatusObj(R.message??"",!0)}))}ngOnInit(){super.ngOnInit(),this.getExamDataByHashId(this.hashId)}constructor(B,R,m,P,O){super(P,m),this.documentConfigService=B,this.permissionService=R,this.dialogRef=m,this.data=P,this.sAztClassroomCheckboxService=O,this.permissionTypes=C.t,this.checkDialogFastContent=[],this.classroomObjs=[],this.examClassroomObjs=[],this.isSelectClassroom=!1,this.hashId="",this.classroomWithGroup=[],this.hashId=P.hashId,this.form=new i.gE({whoAllow:new i.MJ(0,{nonNullable:!0}),classroomFormArray:new i.Yp([]),studentIds:new i.Yp([])},{validators:[E.j.classroomInGroupCheckBoxValidator,M.H.studentCheckBoxValidator]})}}return(b=z).\u0275fac=function(B){return new(B||b)(a.rXU(s.x),a.rXU(f.p),a.rXU(y.CP,8),a.rXU(y.Vh,8),a.rXU(g.Q))},b.\u0275cmp=a.VBU({type:b,selectors:[["config-online-exam-dialog"]],features:[a.Jv_([{provide:t.$O,useClass:o.fb,deps:[e.Ju,U.ij]},{provide:t.vq,useFactory:N.Yw,deps:[u.F]}]),a.Vt3],decls:6,vars:2,consts:[["doneLoading",""],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],["class","loading flex items-center justify-center",4,"ngIf","ngIfElse"],[1,"loading","flex","items-center","justify-center"],[1,"col-md-12","setting"],[3,"formGroup"],[1,"setting-base"],["id","azt-config-who-allow",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12","lg:col-span-3","pr-2"],[1,"mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-9"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-5"],["id","config-who-all","formControlName","whoAllow","type","radio",1,"form-check-input",3,"change","value"],["for","config-who-all",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0","mr-5"],["id","config-who-class","formControlName","whoAllow","type","radio",1,"form-check-input",3,"change","value"],["for","config-who-class",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0"],["id","config-who-student","formControlName","whoAllow","type","radio",1,"form-check-input",3,"change","value"],["for","config-who-student",1,"form-check-label"],["class","col-span-12 mt-4",4,"ngIf"],[1,"text-right","mt-4"],["azt-track-service","config-exam-classroom-6-a-m4KztM",1,"btn","w-24","btn-secondary","mr-3",3,"click"],["azt-track-service","config-exam-classroom-brv1ZZTsfLY",1,"btn","w-24","btn-primary",3,"click","disabled"],[1,"col-span-12","mt-4"],[1,"azt-list-classroom"],[3,"form","classroomGroupData","examClassroomObjs","permissionName"],[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","items-center"],[1,"mr-auto"],[3,"form","classroomGroupData","examStudentObjs","permissionName"]],template:function(B,R){if(1&B&&(a.j41(0,"div",1)(1,"div",2)(2,"div",3),a.DNE(3,Z,2,0,"div",4)(4,w,34,25,"ng-template",null,0,a.C5r),a.k0s()()()),2&B){const m=a.sdS(5);a.R7$(3),a.Y8G("ngIf",R.statusObj.loading)("ngIfElse",m)}},dependencies:[k.bT,i.qT,i.me,i.Fm,i.BC,i.cb,i.j4,i.JD,A.t,p.D,S.R,V.M,J.wp],encapsulation:2}),z})()},9842:(H,F,n)=>{n.d(F,{M:()=>lt});var t=n(10936),i=n(38009),U=n(59640),e=n(48891),y=n(54460),o=n(5502),N=n(74151),_=n(27208),C=n(89163),u=n(33887),E=n(35048);let M=(()=>{var l;class G extends u._{btnCloseDialog(c){if(!c)return this.dialogRef.close();this.dialogRef.close(c)}ngOnInit(){}constructor(c,r){super(r,c),this.dialogRef=c,this.data=r,this.selectAllFormControl=new t.MJ(!1,{nonNullable:!0}),this.showCheckedFormControl=new t.MJ(!1,{nonNullable:!0}),this.studentObjs=[],this.totalStudentsSelected=0,this.totalStudentsShow=0,this.searchContentObj=new _.Z}}return(l=G).\u0275fac=function(c){return new(c||l)(e.rXU(C.CP,8),e.rXU(C.Vh,8))},l.\u0275cmp=e.VBU({type:l,selectors:[["azt-assign-student-dialog"]],features:[e.Vt3],decls:1,vars:1,consts:[[3,"closeBox","data"]],template:function(c,r){1&c&&(e.j41(0,"azt-select-student",0),e.bIt("closeBox",function(W){return r.btnCloseDialog(W)}),e.k0s()),2&c&&e.Y8G("data",r.data)},dependencies:[E.w],encapsulation:2}),G})();var a=n(51913),s=n(3780),f=n(46899),g=n(17818),k=n(45785),A=n(47712),p=n(56551),S=n(15343),V=n(91032),J=n(32099),Z=n(95825),tt=n(76975);const q=(l,G)=>({"classroom-box-in-full-screen-in-mobile":l,"classroom-box-in-full-screen-in-desktop":G}),w=(l,G)=>({"w-85":l,"w-56":G}),Q=l=>({"ml-3":l}),b=(l,G)=>({"bg-primary text-white font-medium":l,"hover:bg-slate-100 dark:hover:bg-darkmode-400":G}),z=(l,G)=>({"bg-primary text-white font-medium":l," hover:bg-slate-100 dark:hover:bg-darkmode-400":G}),v=l=>({"grid-column":l}),B=l=>({"text-success font-medium":l});function R(l,G){if(1&l){const h=e.RV6();e.j41(0,"button",45),e.bIt("click",function(){e.eBV(h);const r=e.XpG();return e.Njj(r.selectByGroupId(void 0))}),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()}if(2&l){const h=e.XpG();e.Y8G("ngClass",e.l_i(5,b,0===h.mapClassroomGroupDataToForm.groupIdSelected,0!==h.mapClassroomGroupDataToForm.groupIdSelected)),e.R7$(),e.Lme(" ",e.bMT(2,3,"lang_auto_tat_ca")," (",h.mapClassroomGroupDataToForm.totalAllClassrooms,") ")}}function m(l,G){if(1&l){const h=e.RV6();e.j41(0,"button",48),e.bIt("click",function(){e.eBV(h);const r=e.XpG().$implicit,j=e.XpG(2);return e.Njj(j.selectByGroupId(r.groupObj))}),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()}if(2&l){const h=e.XpG().$implicit,c=e.XpG(2);e.Y8G("ngClass",e.l_i(4,z,c.mapClassroomGroupDataToForm.groupIdSelected===h.groupObj.id,c.mapClassroomGroupDataToForm.groupIdSelected!==h.groupObj.id)),e.R7$(),e.SpI(" ",e.bMT(2,2,h.groupObj.name)+" ("+h.groupObj.totalAllClassrooms+")"," ")}}function P(l,G){if(1&l&&(e.qex(0),e.DNE(1,m,3,7,"button",47),e.bVm()),2&l){const h=G.$implicit;e.R7$(),e.Y8G("ngIf",h.groupObj.isShowGroup)}}function O(l,G){if(1&l&&(e.qex(0),e.DNE(1,P,2,1,"ng-container",46),e.bVm()),2&l){const h=e.XpG();e.R7$(),e.Y8G("ngForOf",h.mapClassroomGroupDataToForm.groupObjs)}}function D(l,G){if(1&l){const h=e.RV6();e.j41(0,"button",49),e.nI1(1,"mytranslate"),e.bIt("click",function(){e.eBV(h);const r=e.XpG();return e.Njj(r.sAztMatDrawerService.openDrawer())}),e.nrm(2,"lucide-icon",50),e.k0s()}2&l&&e.FS9("matTooltip",e.bMT(1,1,"lang_auto_mo_menu"))}function d(l,G){if(1&l){const h=e.RV6();e.j41(0,"button",51),e.nI1(1,"mytranslate"),e.bIt("click",function(){e.eBV(h);const r=e.XpG();return e.Njj(r.sAztMatDrawerService.closeDrawer())}),e.nrm(2,"lucide-icon",52),e.k0s()}2&l&&e.FS9("matTooltip",e.bMT(1,1,"lang_auto_dong_menu"))}function Y(l,G){if(1&l&&(e.j41(0,"span",53),e.EFF(1),e.k0s()),2&l){const h=e.XpG();e.R7$(),e.SpI(" ",(h.filterObj.isShowChecked?1:0)+(h.filterObj.isShowNotChecked?1:0)," ")}}function x(l,G){if(1&l&&(e.qex(0),e.j41(1,"span",59),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s(),e.EFF(4),e.nI1(5,"mytranslate"),e.bVm()),2&l){const h=e.XpG().$implicit;e.R7$(2),e.JRh(e.bMT(3,2,h.groupObj.name)),e.R7$(2),e.SpI(" ","("+h.groupObj.totalAllClassrooms+" "+e.bMT(5,4,"lang_testbank_test_list_classes")+")"," ")}}function I(l,G){if(1&l&&(e.j41(0,"span",64),e.EFF(1),e.nI1(2,"slice"),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&l){const h=e.XpG(2).$implicit;e.FS9("matTooltip",h.classroomObj.name),e.R7$(),e.SpI(" ",e.brH(2,4,h.classroomObj.name,0,25)+"..."," "),e.R7$(3),e.Lme("(",h.classroomObj.studentIdsSelected.length,"/",h.classroomObj.countStudents,")")}}function T(l,G){if(1&l&&(e.j41(0,"span"),e.EFF(1),e.j41(2,"span"),e.EFF(3),e.k0s()()),2&l){const h=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",h.classroomObj.name," "),e.R7$(2),e.Lme("(",h.classroomObj.studentIdsSelected.length,"/",h.classroomObj.countStudents,")")}}function L(l,G){1&l&&(e.j41(0,"span",65),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&l&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"lang_testbank_test_config_share")," "))}function $(l,G){if(1&l){const h=e.RV6();e.qex(0),e.j41(1,"div",60),e.bIt("click",function(){e.eBV(h);const r=e.XpG().$implicit,j=e.XpG(2);return e.Njj(j.selectClassroomEvent(r.groupObj,r.classroomObj))}),e.j41(2,"span",22),e.nrm(3,"lucide-icon",61),e.k0s(),e.DNE(4,I,5,8,"span",62)(5,T,4,3,"span",15)(6,L,3,3,"span",63),e.nI1(7,"fullPermission"),e.k0s(),e.bVm()}if(2&l){let h,c;const r=e.XpG().$implicit;e.R7$(),e.Y8G("ngClass",e.eq3(7,B,r.classroomObj.studentIdsSelected.length>0)),e.R7$(3),e.Y8G("ngIf",(null!==(h=null==r.classroomObj.name?null:r.classroomObj.name.length)&&void 0!==h?h:0)>25),e.R7$(),e.Y8G("ngIf",(null!==(c=null==r.classroomObj.name?null:r.classroomObj.name.length)&&void 0!==c?c:0)<=25),e.R7$(),e.Y8G("ngIf",!e.i5U(7,4,r.classroomObj,"classroom"))}}function X(l,G){if(1&l&&(e.j41(0,"div",58),e.DNE(1,x,6,6,"ng-container",15)(2,$,8,9,"ng-container",15),e.k0s()),2&l){const h=G.$implicit;e.Y8G("ngStyle",e.eq3(3,v,"group"==h.type?"span 12 / span 12":"")),e.R7$(),e.Y8G("ngIf","group"==h.type),e.R7$(),e.Y8G("ngIf","classroom"==h.type&&h.classroomObj)}}function et(l,G){if(1&l&&(e.qex(0),e.j41(1,"ng-scrollbar",54)(2,"cdk-virtual-scroll-viewport",55)(3,"div",56),e.DNE(4,X,3,5,"div",57),e.k0s()()(),e.bVm()),2&l){const h=e.XpG();e.R7$(),e.Y8G("visibility","hover"),e.R7$(3),e.Y8G("cdkVirtualForOf",h.mapClassroomGroupDataToVirtualScroll)}}function st(l,G){1&l&&(e.j41(0,"div",66),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&l&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"lang_student_classroom_list_class_null")," "))}let ot=(()=>{var l;class G extends U.H{searchByClassroomName(c){this.searchByClassroomContentObj=c,this.checkIsFilter(),this.calculateClassroomInfo()}searchByGroupName(c){this.searchByGroupContentObj=c,this.checkIsFilter(),this.calculateClassroomInfo()}changeFilter(){this.checkIsFilter(),this.calculateClassroomInfo()}clearFilter(){this.filterObj={isShowChecked:!1,isShowNotChecked:!1},this.checkIsFilter(),this.calculateClassroomInfo()}checkIsFilter(){return 0!=this.mapClassroomGroupDataToForm.groupIdSelected||this.filterObj.isShowChecked||this.filterObj.isShowNotChecked||""!=this.searchByClassroomContentObj.searchContent.trim()}selectByGroupId(c){this.mapClassroomGroupDataToForm.groupIdSelected=c?.id??0,this.calculateClassroomInfo(),this.scrollable?.scrollTo({top:0,duration:0}),this.isMobileDevice&&this.sAztMatDrawerService.closeDrawer()}selectClassroomEvent(c,r){this.sAztDialogService.open(M,{data:{classroomId:r.id,classroomName:r.name,studentIdsSelected:this.studentsSelected.find(W=>W.classroomId==r.id)?.studentIdsSelected??[]},width:"1000px",autoFocus:!1}).afterClosed().subscribe(W=>{W&&this.chooseStudentsEvent.emit(W)})}calculateClassroomInfo(){this.doFilterData(),this.countFilterData(),this.calculateVirtualScrollData()}doFilterData(){const c=this.searchByClassroomContentObj.searchContent?this.commonService.convertVietnameseToEnglish(this.searchByClassroomContentObj.searchContent).toLowerCase().trim():"",r=this.searchByGroupContentObj.searchContent?this.commonService.convertVietnameseToEnglish(this.searchByGroupContentObj.searchContent).toLowerCase().trim():"";this.mapClassroomGroupDataToForm.groupObjs.forEach(j=>{const W=this.commonService.convertVietnameseToEnglish(j.groupObj.name??"");j.groupObj.isShowGroup=""==r||W.toLowerCase().trim().includes(r),j.classroomObjs.forEach(K=>{if(K.isShowClassroom=!0,!this.checkIsFilter())return;const at=this.commonService.convertVietnameseToEnglish(K.name);let it=0==this.mapClassroomGroupDataToForm.groupIdSelected||j.groupObj.id==this.mapClassroomGroupDataToForm.groupIdSelected,ct=""==c||at.toLowerCase().trim().includes(c);K.isShowClassroom=it&&ct&&(this.filterObj.isShowChecked&&K.studentIdsSelected.length>0||this.filterObj.isShowNotChecked&&K.studentIdsSelected.length<=0||!this.filterObj.isShowChecked&&!this.filterObj.isShowNotChecked)})})}countFilterData(){this.mapClassroomGroupDataToForm.groupObjs.forEach(c=>{c.groupObj.totalAllClassrooms=c.classroomObjs.length,c.groupObj.totalViewClassrooms=c.classroomObjs.filter(r=>r.isShowClassroom).length}),this.mapClassroomGroupDataToForm.totalAllClassrooms=this.mapClassroomGroupDataToForm.groupObjs.reduce((c,r)=>c+r.groupObj.totalAllClassrooms,0),this.mapClassroomGroupDataToForm.totalViewClassrooms=this.mapClassroomGroupDataToForm.groupObjs.reduce((c,r)=>c+r.groupObj.totalViewClassrooms,0)}calculateVirtualScrollData(){var c=[];this.mapClassroomGroupDataToForm.groupObjs.filter(r=>r.groupObj.totalViewClassrooms>0).forEach(r=>{c.push({type:"group",groupObj:r.groupObj,classroomObj:void 0}),r.classroomObjs.filter(j=>j.isShowClassroom).forEach(j=>{c.push({type:"classroom",groupObj:r.groupObj,classroomObj:j})})}),this.mapClassroomGroupDataToVirtualScroll=c}initClassroomData(){this.classroomGroupData=this.classroomGroupData.map(c=>({groupObj:c.groupObj,isOwned:c.isOwned,classroomObjs:c.classroomObjs.filter(r=>null!=r.permissionObj&&this.permissionService.hasCreatePermission(this.listPermissionTypes[this.permissionName],r))})),this.mapClassroomGroupDataToForm.groupObjs=this.classroomGroupData.map(c=>({groupObj:{...c.groupObj,isShowGroup:!0,totalAllClassrooms:0,totalViewClassrooms:0},isOwned:c.isOwned,classroomObjs:c.classroomObjs.map(r=>{let j=this.studentsSelected.find(W=>W.classroomId==r.id)?.studentIdsSelected??[];return{...r,studentIdsSelected:j,isShowClassroom:!0}})})),this.calculateClassroomInfo()}ngOnChanges(){this.initClassroomData()}ngOnInit(){super.ngOnInit(),this.classroomGroupData.forEach(c=>c.classroomObjs.map(r=>r.name=this.commonService.myTranslateInstant(r.name)??"")),this.initClassroomData()}constructor(c,r,j,W){super(),this.sAztMatDrawerService=c,this.permissionService=r,this.sAztClassroomCheckboxService=j,this.sAztDialogService=W,this.permissionName=i.t.exam,this.defaultCssClass="classroom-box-in-single-page",this.chooseStudentsEvent=new e.bkB,this.studentsSelected=[],this.mapClassroomGroupDataToForm={groupObjs:[],groupIdSelected:0,totalAllClassrooms:0,totalViewClassrooms:0},this.mapClassroomGroupDataToVirtualScroll=[],this.listPermissionTypes=i.t,this.searchByClassroomContentObj=new _.Z,this.searchByGroupContentObj=new _.Z,this.filterObj={isShowChecked:!1,isShowNotChecked:!1}}}return(l=G).\u0275fac=function(c){return new(c||l)(e.rXU(N.n),e.rXU(a.p),e.rXU(s.Q),e.rXU(f.i))},l.\u0275cmp=e.VBU({type:l,selectors:[["azt-list-classroom-view-tree"]],viewQuery:function(c,r){if(1&c&&e.GBs(o.Yh,7),2&c){let j;e.mGM(j=e.lsd())&&(r.scrollable=j.first)}},inputs:{classroomGroupData:"classroomGroupData",permissionName:"permissionName",defaultCssClass:"defaultCssClass",studentsSelected:"studentsSelected"},outputs:{chooseStudentsEvent:"chooseStudentsEvent"},features:[e.Jv_([N.n]),e.Vt3,e.OA$],decls:66,vars:55,consts:[["maximize","maximize"],["drawer",""],["menuFilter","matMenu"],["emptyClassroom",""],["maximize","",1,"azt-list-classroom-by-group"],[1,"azt-drawer-container",3,"ngClass","hasBackdrop"],[3,"openedChange","ngClass","mode","opened"],[1,"box","h-full","border","border-slate-200/60","dark:border-darkmode-400"],[1,"flex","rounded-md","border-b","border-slate-200","dark:border-darkmode-400","p-2","text-slate-500",2,"border-bottom-right-radius","0","border-bottom-left-radius","0"],[1,"search-box"],[3,"onSearch","isServerSearch","placeholder","searchContentObj","styleInput"],[2,"height","calc(100% - 50px)"],["track","vertical","pointerEventsMethod","scrollbar",1,"w-full",3,"visibility"],[1,"p-2"],["azt-track-service","azt-list-classroom-checkbox-TUrZzBy9T","class","flex items-center px-3 py-2 rounded-md w-full",3,"ngClass","click",4,"ngIf"],[4,"ngIf"],[1,"azt-drawer-content","h-full",3,"ngClass"],[1,"box","border","border-slate-200","dark:border-darkmode-400","h-full"],[1,"flex","items-center","rounded-md","border-b","border-slate-200","dark:border-darkmode-400","p-2","text-slate-500",2,"border-bottom-right-radius","0","border-bottom-left-radius","0"],["azt-track-service","azt-list-classroom-checkbox-WB1u8XZHUS","class","btn btn-sm mr-2",3,"matTooltip","click",4,"ngIf"],["azt-track-service","azt-list-classroom-checkbox-q2BPTM5lPo","class","btn btn-sm mr-2",3,"matTooltip","click",4,"ngIf"],[1,"flex","ml-auto"],[1,"mr-2"],[1,"filter","mr-2"],[1,"btn","btn-sm",3,"matMenuTriggerFor"],[1,"w-4","h-4","inline-block"],["name","filter","size","18"],[1,"azt-hidden","md:block","ml-2"],["class","p-1 ml-1 items-center justify-center rounded-full text-xs bg-primary text-white cursor-pointer font-medium","style","display: inline-flex; width: 15px; height: 15px; font-size: 10px",4,"ngIf"],[1,"flex","items-center"],[3,"maximize"],[1,"dropdown-menu","show","relative","w-56"],[1,"dropdown-content"],["azt-track-service","azt-list-classroom-checkbox-mJWF3uWTQJ","for","isShowChecked",1,"dropdown-item","cursor-pointer",3,"click"],[1,"form-check","form-switch","ml-auto"],["id","isShowChecked","type","checkbox",1,"show-code","form-check-input","ml-2",3,"change","checked"],["azt-track-service","azt-list-classroom-checkbox-pFWk_nWN9o","for","isShowNotChecked",1,"dropdown-item","cursor-pointer",3,"click"],["id","isShowNotChecked","type","checkbox",1,"show-code","form-check-input","ml-2",3,"change","checked"],[1,"dropdown-divider"],[1,"flex","p-1"],[1,"btn","btn-secondary","py-1","px-2","ml-auto","mr-2"],["azt-track-service","azt-list-classroom-checkbox-3OFGLRY5fa",3,"click"],["azt-track-service","azt-list-classroom-checkbox-iJlkvwO36n",1,"btn","btn-danger","py-1","px-2",3,"click"],[1,"w-full",2,"height","calc(100% - 50px)"],[4,"ngIf","ngIfElse"],["azt-track-service","azt-list-classroom-checkbox-TUrZzBy9T",1,"flex","items-center","px-3","py-2","rounded-md","w-full",3,"click","ngClass"],[4,"ngFor","ngForOf"],["azt-track-service","azt-list-classroom-checkbox-hUXQqnl7px","class","flex items-center px-3 py-2 rounded-md w-full text-left",3,"ngClass","click",4,"ngIf"],["azt-track-service","azt-list-classroom-checkbox-hUXQqnl7px",1,"flex","items-center","px-3","py-2","rounded-md","w-full","text-left",3,"click","ngClass"],["azt-track-service","azt-list-classroom-checkbox-WB1u8XZHUS",1,"btn","btn-sm","mr-2",3,"click","matTooltip"],["name","panel-left-open","size","16"],["azt-track-service","azt-list-classroom-checkbox-q2BPTM5lPo",1,"btn","btn-sm","mr-2",3,"click","matTooltip"],["name","panel-left-close","size","16"],[1,"p-1","ml-1","items-center","justify-center","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium",2,"display","inline-flex","width","15px","height","15px","font-size","10px"],["track","vertical",1,"h-full",3,"visibility"],["scrollViewport","","itemSize","10"],[1,"grid","grid-cols-12","gap-3","p-3","pt-2"],["class","col-span-12 md:col-span-6",3,"ngStyle",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"col-span-12","md:col-span-6",3,"ngStyle"],[1,"font-bold"],["azt-track-service","azt-list-classroom-view-tree-o6QRGuakJ",1,"flex","items-center","clickable","hover:text-primary",3,"click","ngClass"],["name","align-justify","size","16"],[3,"matTooltip",4,"ngIf"],["class","ml-2 py-0.5 px-2 rounded-full text-xs bg-primary text-white cursor-pointer font-medium",4,"ngIf"],[3,"matTooltip"],[1,"ml-2","py-0.5","px-2","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium"],[1,"flex","items-center","justify-center",2,"height","200px"]],template:function(c,r){if(1&c){const j=e.RV6();e.j41(0,"div",4,0)(2,"mat-drawer-container",5)(3,"mat-drawer",6,1),e.bIt("openedChange",function(K){return e.eBV(j),e.Njj(r.sAztMatDrawerService.openedChange(K))}),e.j41(5,"div",7)(6,"div",8)(7,"div",9)(8,"azt-search-box",10),e.nI1(9,"mytranslate"),e.bIt("onSearch",function(K){return e.eBV(j),e.Njj(r.searchByGroupName(K.searchObj))}),e.k0s()()(),e.j41(10,"div",11)(11,"ng-scrollbar",12)(12,"div",13),e.DNE(13,R,3,8,"button",14)(14,O,2,1,"ng-container",15),e.k0s()()()()(),e.j41(15,"mat-drawer-content")(16,"div",16)(17,"div",17)(18,"div",18),e.DNE(19,D,3,3,"button",19)(20,d,3,3,"button",20),e.j41(21,"div",21)(22,"div",22)(23,"azt-search-box",10),e.nI1(24,"mytranslate"),e.bIt("onSearch",function(K){return e.eBV(j),e.Njj(r.searchByClassroomName(K.searchObj))}),e.k0s()(),e.j41(25,"div",23)(26,"button",24)(27,"span",25),e.nrm(28,"lucide-icon",26),e.k0s(),e.j41(29,"span",27),e.EFF(30),e.nI1(31,"mytranslate"),e.DNE(32,Y,2,1,"span",28),e.k0s()()(),e.j41(33,"div",29),e.nrm(34,"azt-maximize-box",30),e.k0s(),e.j41(35,"mat-menu",null,2)(37,"div",31)(38,"ul",32)(39,"li")(40,"label",33),e.bIt("click",function(K){return e.eBV(j),e.Njj(K.stopPropagation())}),e.EFF(41),e.nI1(42,"mytranslate"),e.j41(43,"div",34)(44,"input",35),e.bIt("change",function(){return e.eBV(j),r.filterObj.isShowChecked=!r.filterObj.isShowChecked,e.Njj(r.changeFilter())}),e.k0s()()()(),e.j41(45,"li")(46,"label",36),e.bIt("click",function(K){return e.eBV(j),e.Njj(K.stopPropagation())}),e.EFF(47),e.nI1(48,"mytranslate"),e.j41(49,"div",34)(50,"input",37),e.bIt("change",function(){return e.eBV(j),r.filterObj.isShowNotChecked=!r.filterObj.isShowNotChecked,e.Njj(r.changeFilter())}),e.k0s()()()(),e.j41(51,"li"),e.nrm(52,"hr",38),e.k0s(),e.j41(53,"li")(54,"div",39)(55,"button",40),e.EFF(56),e.nI1(57,"mytranslate"),e.k0s(),e.j41(58,"div",41),e.bIt("click",function(K){return e.eBV(j),e.Njj(K.stopPropagation())}),e.j41(59,"button",42),e.bIt("click",function(){return e.eBV(j),e.Njj(r.clearFilter())}),e.EFF(60),e.nI1(61,"mytranslate"),e.k0s()()()()()()()()(),e.j41(62,"div",43),e.DNE(63,et,5,2,"ng-container",44)(64,st,3,3,"ng-template",null,3,e.C5r),e.k0s()()()()()()}if(2&c){const j=e.sdS(1),W=e.sdS(36),K=e.sdS(65);e.R7$(2),e.HbH(r.defaultCssClass),e.Y8G("ngClass",e.l_i(47,q,r.isMobileDevice,!r.isMobileDevice))("hasBackdrop",r.sAztMatDrawerService.hasBackdrop),e.R7$(),e.FS9("opened",r.sAztMatDrawerService.isOpenSideNav?"true":"false"),e.Y8G("ngClass",e.l_i(50,w,r.isMobileDevice,!r.isMobileDevice))("mode",r.sAztMatDrawerService.mode),e.R7$(5),e.Y8G("isServerSearch",!1)("placeholder",e.bMT(9,33,"lang_azt_search_class_group"))("searchContentObj",r.searchByGroupContentObj)("styleInput","pr-10 py-1"),e.R7$(3),e.Y8G("visibility","hover"),e.R7$(2),e.Y8G("ngIf",!r.searchByGroupContentObj.searchContent),e.R7$(),e.Y8G("ngIf",r.mapClassroomGroupDataToForm.groupObjs.length>1),e.R7$(2),e.Y8G("ngClass",e.eq3(53,Q,!r.isMobileDevice&&r.sAztMatDrawerService.isOpenSideNav)),e.R7$(3),e.Y8G("ngIf",!r.sAztMatDrawerService.isOpenSideNav||r.isMobileDevice),e.R7$(),e.Y8G("ngIf",r.sAztMatDrawerService.isOpenSideNav&&!r.isMobileDevice),e.R7$(3),e.Y8G("isServerSearch",!1)("placeholder",e.bMT(24,35,"lang_azt_search_class"))("searchContentObj",r.searchByClassroomContentObj)("styleInput","py-1"),e.R7$(3),e.Y8G("matMenuTriggerFor",W),e.R7$(4),e.SpI(" ",e.bMT(31,37,"lang_testbank_tested_list_sort")," "),e.R7$(2),e.Y8G("ngIf",r.filterObj.isShowChecked||r.filterObj.isShowNotChecked),e.R7$(2),e.Y8G("maximize",j),e.R7$(7),e.SpI(" ",e.bMT(42,39,"lang_azt_selected_classes")," "),e.R7$(3),e.Y8G("checked",r.filterObj.isShowChecked),e.R7$(3),e.SpI(" ",e.bMT(48,41,"lang_azt_unselected_classes")," "),e.R7$(3),e.Y8G("checked",r.filterObj.isShowNotChecked),e.R7$(6),e.JRh(e.bMT(57,43,"lang_button_close")),e.R7$(4),e.JRh(e.bMT(61,45,"lang_button_delete")),e.R7$(3),e.Y8G("ngIf",r.mapClassroomGroupDataToForm.totalViewClassrooms>0)("ngIfElse",K)}},dependencies:[y.YU,y.Sq,y.bT,y.B3,g.kk,g.Cp,k.qe,k.$C,k.$l,A.oV,p.yg,p.E$,p.d6,o.Yh,o.Gl,S.WGl,V.e,J.W,Z.g,y.P9,tt.wp,tt.gC],encapsulation:2}),G})();function nt(l,G){1&l&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&l&&(e.R7$(),e.JRh(e.bMT(2,1,"lang_testbank_test_config_you_not_yet_student")))}function rt(l,G){if(1&l){const h=e.RV6();e.j41(0,"div")(1,"azt-list-classroom-view-tree",1),e.bIt("chooseStudentsEvent",function(r){e.eBV(h);const j=e.XpG();return e.Njj(j.chooseStudentsEvent(r))}),e.k0s(),e.j41(2,"div",2)(3,"div",3),e.DNE(4,nt,3,3,"span",0),e.k0s()()()}if(2&l){const h=e.XpG();e.R7$(),e.Y8G("classroomGroupData",h.classroomGroupData)("studentsSelected",h.studentsSelected)("permissionName",h.permissionName),e.R7$(3),e.Y8G("ngIf",h.form.controls.studentIds.errors)}}let lt=(()=>{var l;class G extends U.H{chooseStudentsEvent(c){let r=this.form.controls.studentIds.controls.filter(j=>j.controls.classroomId.value!=c.classroomId);this.form.controls.studentIds.clear(),r.forEach(j=>{this.form.controls.studentIds.push(j)}),c.studentIdsSelected.forEach(j=>{this.form.controls.studentIds.push(new t.gE({classroomId:new t.MJ(c.classroomId,{nonNullable:!0}),studentId:new t.MJ(j,{nonNullable:!0})}))}),this.calculateStudentsSelected()}initStudentsControl(){this.form.controls.studentIds.clear(),this.examStudentObjs.forEach(c=>{this.form.controls.studentIds.push(new t.gE({classroomId:new t.MJ(c.classroomId,{nonNullable:!0}),studentId:new t.MJ(c.studentId,{nonNullable:!0})}))}),this.calculateStudentsSelected()}calculateStudentsSelected(){let c=[],r=this.commonService.arrayToDictionary(this.form.controls.studentIds.getRawValue(),j=>j.classroomId.toString());Object.entries(r).forEach(([j,W],K)=>{let at=this.commonService.getFirstOfArray(W)?.classroomId;at&&c.push({classroomId:at,classroomName:"",studentIdsSelected:W.map(it=>it.studentId)})}),this.studentsSelected=c}ngOnInit(){super.ngOnInit(),this.initStudentsControl()}constructor(){super(),this.examStudentObjs=[],this.permissionName=i.t.exam,this.studentsSelected=[]}}return(l=G).\u0275fac=function(c){return new(c||l)},l.\u0275cmp=e.VBU({type:l,selectors:[["list-student-checkbox"]],inputs:{form:"form",classroomGroupData:"classroomGroupData",examStudentObjs:"examStudentObjs",permissionName:"permissionName"},features:[e.Vt3],decls:1,vars:1,consts:[[4,"ngIf"],[3,"chooseStudentsEvent","classroomGroupData","studentsSelected","permissionName"],[1,"mt-2"],[1,"text-xs","font-medium","text-danger"]],template:function(c,r){1&c&&e.DNE(0,rt,5,4,"div",0),2&c&&e.Y8G("ngIf",r.form)},dependencies:[y.bT,ot,tt.wp],encapsulation:2}),G})()},92654:(H,F,n)=>{n.d(F,{x:()=>u});var t=n(51698),i=n(82716),U=n(94217),e=n(33860),y=n(57003),o=n(92274),N=n(48891),_=n(53793),C=n(46899);let u=(()=>{var E;class M{doExamAction(s,f){switch(f){case o.$.CONFIG_EXAM_CLASSROOM:return this.showConfigExamClassroomDialog(s);case o.$.SHOW_EXAM_DETAIL:this.openDialog(s);break;case o.$.SHARE_OFFLINE_RESULT:this.showOfflineShareDialog(s);break;case o.$.COPY_EXAM_LINK:this.copyExamLink()}return this.returnUndefinedOutput()}copyExamLink(){this.commonService.snackSuccess("lang_auto_sao_chep_thanh_cong")}showConfigExamClassroomDialog(s){return new t.c(f=>{this.sAztDialogService.open(y.Q,{width:"900px",data:{hashId:s.examObj.hashId,examStudents:s.examObj?.examStudents??[]},restoreFocus:!1}).afterClosed().subscribe(k=>{k?(f.next({reloadData:!0}),f.complete()):(f.next(void 0),f.complete())})})}openDialog(s){"CAPACITY"!==s.examObj?.objectType&&this.showExamDetailDialog(s),"CAPACITY"===s.examObj?.objectType&&this.openDialogCapacityExamDetail(s)}openDialogCapacityExamDetail(s){this.sAztDialogService.open(U.A,{width:"800px",maxWidth:"90vw",enterAnimationDuration:"0ms",exitAnimationDuration:"0ms",data:{id:s.examObj?.id??0},restoreFocus:!1}).afterClosed().subscribe(g=>{})}showExamDetailDialog(s){let f={obj:{...s.examObj,countQuestion:0,showFrontend:1,editable:!0,allowStudentView:!0},globalLadingPage:s.globalLadingPage,curCateId:s.categoryId,isOnLib:0,isShow:!0,showDelete:!0};this.sAztDialogService.open(e.c,{width:"800px",maxWidth:"90vw",enterAnimationDuration:"0ms",exitAnimationDuration:"0ms",data:f,restoreFocus:!1}).afterClosed().subscribe(k=>{})}showOfflineShareDialog(s){this.sAztDialogService.open(i.h,{width:"1000px",data:{examHashId:s.examObj.hashId,useDialog:!0},restoreFocus:!1})}returnUndefinedOutput(){return new t.c(s=>{s.next(void 0),s.complete()})}constructor(s,f){this.commonService=s,this.sAztDialogService=f}}return(E=M).\u0275fac=function(s){return new(s||E)(N.KVO(_.R),N.KVO(C.i))},E.\u0275prov=N.jDH({token:E,factory:E.\u0275fac,providedIn:"root"}),M})()},31291:(H,F,n)=>{n.d(F,{n:()=>e});var t=n(43362),i=n(48891),U=n(53793);let e=(()=>{var y;class o{sortExamByColumn(_,C,u){return C==t.N.BY_NAME?this.sortExamByName(_,u):C==t.N.BY_PUBLISH_STATUS?this.sortExamByPublishStatus(_,u):C==t.N.BY_UPDATED_DATE?this.sortExamByDateUpdated(_,u):C==t.N.BY_ATTENDED?this.sortExamByAttended(_,u):this.sortExamByName(_,u)}sortExamByName(_,C){var u=[..._.rootCategoryObjs??[]],E=[..._.rootDocumentObjs??[]];return 1==C?{categoryObjs:this._sortCateByName(u),documentObjs:this._sortDocumentByName(E)}:{categoryObjs:this._sortCateByName(u).reverse(),documentObjs:this._sortDocumentByName(E).reverse()}}sortExamByPublishStatus(_,C){var u=[..._.rootDocumentObjs??[]];return 1==C?{categoryObjs:_.currentCategoryObjs,documentObjs:this._sortDocumentByPublish(u,u?.length)}:{categoryObjs:_.currentCategoryObjs,documentObjs:this._sortDocumentByPublish(u,u?.length).reverse()}}sortExamByDateUpdated(_,C){var u=this.commonService.castObj(_.rootCategoryObjs),E=this.commonService.castObj(_.rootDocumentObjs);return 1==C?{categoryObjs:this._sortCateByDateUpdateExam(u??[]),documentObjs:this._sortDocumentByUpdateTime(E??[])}:{categoryObjs:this._sortCateByDateUpdateExam(u??[]).reverse(),documentObjs:this._sortDocumentByUpdateTime(E??[]).reverse()}}sortExamByAttended(_,C){var u=this.commonService.castObj(_.rootDocumentObjs);return 1==C?{categoryObjs:_.currentCategoryObjs,documentObjs:this._sortDocumentByAttended(u??[])}:{categoryObjs:_.currentCategoryObjs,documentObjs:this._sortDocumentByAttended(u??[]).reverse()}}_sortCateByName(_){return _?.sort((C,u)=>(C.name?.trim()??"").localeCompare(u.name?.trim()??""))??[]}_sortDocumentByName(_){return _?.sort((C,u)=>(C.name?.trim()??"").localeCompare(u.name?.trim()??""))??[]}_sortDocumentByPublish(_,C){let u=[],E=[];for(let M=0;M<(C??0);M++)null!=_?.[M]&&!_?.[M].isPublished&&u.push(_[M]),_?.[M].isPublished&&E.push(_[M]);return u.concat(E)}_sortCateByDateUpdateExam(_){return _.sort((C,u)=>Number(new Date(C.updatedAt??""))-Number(new Date(u.updatedAt??""))),_}_sortDocumentByUpdateTime(_){return _?.sort((C,u)=>Number(new Date(C.updatedAt??""))-Number(new Date(u.updatedAt??"")))}_sortDocumentByAttended(_){return _?.sort((C,u)=>Number(C.attended)-Number(u.attended))}constructor(_){this.commonService=_}}return(y=o).\u0275fac=function(_){return new(_||y)(i.KVO(U.R))},y.\u0275prov=i.jDH({token:y,factory:y.\u0275fac,providedIn:"root"}),o})()},92274:(H,F,n)=>{n.d(F,{$:()=>t});var t=function(i){return i[i.CONFIG_EXAM_CLASSROOM=0]="CONFIG_EXAM_CLASSROOM",i[i.SHOW_EXAM_DETAIL=1]="SHOW_EXAM_DETAIL",i[i.SHARE_OFFLINE_RESULT=2]="SHARE_OFFLINE_RESULT",i[i.COPY_EXAM_LINK=3]="COPY_EXAM_LINK",i}(t||{})},45306:(H,F,n)=>{n.d(F,{d:()=>t});var t=function(i){return i[i.OFFLINE_CONFIG=0]="OFFLINE_CONFIG",i[i.CONFIG_EXAM=1]="CONFIG_EXAM",i[i.EDIT_EXAM=2]="EDIT_EXAM",i[i.POWER_POINT=3]="POWER_POINT",i[i.STATISTIC=4]="STATISTIC",i[i.TESTED_LIST=5]="TESTED_LIST",i}(t||{})},43362:(H,F,n)=>{n.d(F,{N:()=>t});var t=function(i){return i[i.BY_NAME=0]="BY_NAME",i[i.BY_PUBLISH_STATUS=1]="BY_PUBLISH_STATUS",i[i.BY_UPDATED_DATE=2]="BY_UPDATED_DATE",i[i.BY_ATTENDED=3]="BY_ATTENDED",i}(t||{})},45168:(H,F,n)=>{n.d(F,{C:()=>t});var t=function(i){return i[i.multipleChoice=1]="multipleChoice",i[i.essay=3]="essay",i[i.trueFalse=5]="trueFalse",i[i.fill=4]="fill",i}(t||{})},99503:(H,F,n)=>{n.d(F,{fb:()=>u,ij:()=>N});var t=n(81519),i=n(48891),U=n(20381),e=n.n(U),y=n(53793);const o=e()||U,N=new i.nKC("MAT_MOMENT_DATE_ADAPTER_OPTIONS",{providedIn:"root",factory:function _(){return{useUtc:!1}}});function C(E,M){const a=Array(E);for(let s=0;s<E;s++)a[s]=M(s);return a}let u=(()=>{var E;class M extends t.$O{constructor(s){super(),this._options=s,this.commonService=(0,i.WQX)(y.R),this._localeData={firstDayOfWeek:0,longMonths:"",shortMonths:"",dates:"",longDaysOfWeek:"",shortDaysOfWeek:"",narrowDaysOfWeek:""},o.locale(),this.setLocale(this.commonService.getCurrentLang()||o.locale())}setLocale(s){super.setLocale(s);const f=o.localeData(s);this._localeData={firstDayOfWeek:f.firstDayOfWeek(),longMonths:f.months(),shortMonths:f.monthsShort(),dates:C(31,g=>this.createDate(2017,0,g+1).format("D")),longDaysOfWeek:f.weekdays(),shortDaysOfWeek:f.weekdaysShort(),narrowDaysOfWeek:f.weekdaysMin()}}getYear(s){return this.clone(s).year()}getMonth(s){return this.clone(s).month()}getDate(s){return this.clone(s).date()}getDayOfWeek(s){return this.clone(s).day()}getMonthNames(s){return"long"===s?this._localeData.longMonths:this._localeData.shortMonths}getDateNames(){return this._localeData.dates}getDayOfWeekNames(s){return"long"===s?this._localeData.longDaysOfWeek:"short"===s?this._localeData.shortDaysOfWeek:this._localeData.narrowDaysOfWeek}getYearName(s){return this.clone(s).format("YYYY")}getFirstDayOfWeek(){return this._localeData.firstDayOfWeek}getNumDaysInMonth(s){return this.clone(s).daysInMonth()}clone(s){return s.clone().locale(this.locale)}createDate(s,f,g){if(f<0||f>11)throw Error(`Invalid month index "${f}". Month index has to be between 0 and 11.`);if(g<1)throw Error(`Invalid date "${g}". Date has to be greater than 0.`);const k=this._createMoment({year:s,month:f,date:g}).locale(this.locale);if(!k.isValid())throw Error(`Invalid date "${g}" for month with index "${f}".`);return k}today(){return this._createMoment().locale(this.locale)}parse(s,f){return s&&"string"==typeof s?this._createMoment(s,f,this.locale):s?this._createMoment(s).locale(this.locale):null}format(s,f){if(s=this.clone(s),!this.isValid(s))throw Error("MomentDateAdapter: Cannot format invalid date.");return s.format(f)}addCalendarYears(s,f){return this.clone(s).add({years:f})}addCalendarMonths(s,f){return this.clone(s).add({months:f})}addCalendarDays(s,f){return this.clone(s).add({days:f})}toIso8601(s){return this.clone(s).format()}deserialize(s){let f;if(s instanceof Date)f=this._createMoment(s).locale(this.locale);else if(this.isDateInstance(s))return this.clone(s);if("string"==typeof s){if(!s)return null;f=this._createMoment(s,o.ISO_8601).locale(this.locale)}return f&&this.isValid(f)?this._createMoment(f).locale(this.locale):super.deserialize(s)}isDateInstance(s){return o.isMoment(s)}isValid(s){return this.clone(s).isValid()}invalid(){return o.invalid()}getHour(s){return s.hours()}getMinute(s){return s.minutes()}getSecond(s){return s.seconds()}setHour(s,f){s.hours(f)}setMinute(s,f){s.minutes(f)}setSecond(s,f){s.seconds(f)}_createMoment(s,f,g){const{strict:k,useUtc:A}=this._options||{};return A?o.utc(s,f,g,k):o(s,f,g,k)}}return(E=M).\u0275fac=function(s){return new(s||E)(i.KVO(N,8))},E.\u0275prov=i.jDH({token:E,factory:E.\u0275fac}),M})()},51221:(H,F,n)=>{n.d(F,{$:()=>t});var t=function(i){return i.COPY="copy",i.CUT="cut",i.DELETE="delete",i.SELECTED="selected",i}(t||{})},86925:(H,F,n)=>{n.d(F,{Y:()=>t});var t=function(i){return i[i.EXAM_CATEGORY=0]="EXAM_CATEGORY",i[i.EXAM=1]="EXAM",i}(t||{})},30977:(H,F,n)=>{n.d(F,{g:()=>e});var t=n(51221),i=n(86925),U=n(48891);let e=(()=>{var y;class o{constructor(){this.clipboardObjs=[]}setActionToClipboard(_,C,u,E){var M={id:_,name:E,type:C,action:u};this.clipboardObjs.filter(s=>s.id==M.id&&s.type==M.type).length>0?this.clipboardObjs.forEach(s=>{s.id==M.id&&s.type==M.type&&(s.action=M.action)}):this.clipboardObjs.push(M)}hasInClipboard(_,C){return this.clipboardObjs.filter(E=>E.id==_&&E.type==C).length>0}hasCopyFolderActionInClipboard(){var _=!1;return this.clipboardObjs.forEach(C=>{C.type==i.Y.EXAM_CATEGORY&&C.action==t.$.COPY&&(_=!0)}),_}getActionOfDocumentObj(_,C){var u=this.clipboardObjs.filter(E=>E.id==_&&E.type==C);if(u&&u.length>0)return u[0].action}removeDocumentInClipboard(_,C){for(var u=0;u<this.clipboardObjs.length;u++)this.clipboardObjs[u].id==_&&this.clipboardObjs[u].type==C&&this.clipboardObjs.splice(u,1)}isPasteToSelfFolder(_){var C=!1;return this.clipboardObjs.forEach(u=>{u.id==_&&u.type==i.Y.EXAM_CATEGORY&&u.action==t.$.COPY&&(C=!0)}),C}getCurrentClipBoard(){return this.clipboardObjs}resetClipBoardAfterPasteOrCancelAllActions(){this.clipboardObjs=[]}}return(y=o).\u0275fac=function(_){return new(_||y)},y.\u0275prov=U.jDH({token:y,factory:y.\u0275fac,providedIn:"root"}),o})()},48485:(H,F,n)=>{n.d(F,{H:()=>t});class t{static studentCheckBoxValidator(U){const y=U.controls.whoAllow,o=U.controls.studentIds;return y&&o?3!=y.value||t.countCheckBox(o)>=1?(o.setErrors(null),null):(o.setErrors({studentCheckBoxValidator:!0}),{identityRevealed:!0}):null}static countCheckBox(U){return U.getRawValue().length}}},62538:(H,F,n)=>{n.d(F,{O:()=>f});var t=n(48891),i=n(45168),U=n(59640),e=n(67638),y=n(54460),o=n(76975);const N=["table"],_=()=>[];function C(g,k){if(1&g&&(t.j41(0,"td",6),t.EFF(1),t.nI1(2,"formatOfflineExamHashIdToNumber"),t.k0s()),2&g){const A=k.$implicit,p=k.index;t.BMQ("excelRow",1)("excelColumn",p+1),t.R7$(),t.SpI(" ",t.bMT(2,3,null==A?null:A.offlineMixQuestionHashId)," ")}}function u(g,k){if(1&g&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&g){const A=t.XpG(2).$implicit,p=t.XpG().$implicit;t.R7$(),t.SpI(" ",t.bMT(2,1,A.offlineQuestionObjs[p].answer)," ")}}function E(g,k){1&g&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&g&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"lang_core_essay_question")," "))}function M(g,k){if(1&g&&(t.j41(0,"span"),t.DNE(1,u,3,3,"span",7)(2,E,3,3,"span",7),t.k0s()),2&g){const A=t.XpG().$implicit,p=t.XpG().$implicit;t.R7$(),t.Y8G("ngIf",!(null!=A.offlineQuestionObjs&&null!=A.offlineQuestionObjs[p]&&A.offlineQuestionObjs[p].isEssay)),t.R7$(),t.Y8G("ngIf",null==A.offlineQuestionObjs||null==A.offlineQuestionObjs[p]?null:A.offlineQuestionObjs[p].isEssay)}}function a(g,k){if(1&g&&(t.j41(0,"td",6),t.DNE(1,M,3,2,"span",7),t.k0s()),2&g){let A;const p=k.$implicit,S=k.index,V=t.XpG().$implicit;t.BMQ("excelRow",V+2)("excelColumn",S+1),t.R7$(),t.Y8G("ngIf",(null!==(A=null==p.offlineQuestionObjs?null:p.offlineQuestionObjs.length)&&void 0!==A?A:0)>V)}}function s(g,k){if(1&g&&(t.j41(0,"tr")(1,"td",3),t.EFF(2),t.k0s(),t.DNE(3,a,2,3,"td",4),t.k0s()),2&g){let A;const p=k.$implicit,S=t.XpG();t.R7$(),t.BMQ("excelRow",p+2)("excelColumn",0),t.R7$(),t.SpI(" ",p+S.startQuestionIndex," "),t.R7$(),t.Y8G("ngForOf",null!==(A=null==S.obj?null:S.obj.offlineMixQuestionObjs)&&void 0!==A?A:t.lJ4(4,_))}}let f=(()=>{var g;class k extends U.H{calculateMaxQuestion(){let p=0;return this.obj.offlineMixQuestionObjs&&this.obj.offlineMixQuestionObjs.forEach(S=>{p<(S.offlineQuestionObjs?.length??0)&&(p=S.offlineQuestionObjs?.length??0)}),p}processData(){for(let p=0;p<this.obj.offlineMixQuestionObjs.length;p++)for(let S=0;S<this.obj.offlineMixQuestionObjs[p].offlineQuestionObjs.length;S++)this.obj.offlineMixQuestionObjs[p].offlineQuestionObjs[S].answerType===this.offlineAnswerType.trueFalse&&(this.obj.offlineMixQuestionObjs[p].offlineQuestionObjs[S].answer=this.convertAnswerTrueFalse(this.obj.offlineMixQuestionObjs[p].offlineQuestionObjs[S].answer))}convertAnswerTrueFalse(p){const S=p.split(","),V=this.commonService.myClone(this.answerChoiceMap),J=this.commonService.myTranslateInstant("lang_testbank_correct_answer_to_offline_exam"),Z=this.commonService.myTranslateInstant("lang_testbank_wrong_answer_to_offline_exam");return V.map(q=>S.includes(q)?J:Z).join("")}ngOnChanges(){this.processData(),this.isExported=!1,this.maxQuestionIndex=this.calculateMaxQuestion(),this.totalExamCode=this.obj.offlineMixQuestionObjs?.length??0}ngAfterViewChecked(){0==this.isExported&&(this.isExported=!0,setTimeout(()=>{this.exportDataDone.emit(this.exportExcelService.exportHtmlTableToExcelBlob(this.table,!0))},0))}constructor(p){super(),this.exportExcelService=p,this.startQuestionIndex=1,this.exportDataDone=new t.bkB,this.maxQuestionIndex=0,this.totalExamCode=0,this.isExported=!1,this.offlineAnswerType=i.C,this.answerChoiceMap=["A","B","C","D"]}}return(g=k).\u0275fac=function(p){return new(p||g)(t.rXU(e.x))},g.\u0275cmp=t.VBU({type:g,selectors:[["azt-export-excel-for-answersheet"]],viewQuery:function(p,S){if(1&p&&t.GBs(N,5),2&p){let V;t.mGM(V=t.lsd())&&(S.table=V.first)}},inputs:{obj:"obj",startQuestionIndex:"startQuestionIndex"},outputs:{exportDataDone:"exportDataDone"},features:[t.Vt3,t.OA$],decls:14,vars:16,consts:[["table",""],[1,"table","table-bordered",2,"display","none"],["rowspan","2","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["class","text-center azt-excel-cell","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',1,"text-center","azt-excel-cell"],[4,"ngIf"]],template:function(p,S){if(1&p&&(t.j41(0,"table",1,0)(2,"tbody")(3,"tr")(4,"td",2),t.EFF(5),t.nI1(6,"mytranslate"),t.k0s(),t.j41(7,"td",3),t.EFF(8),t.nI1(9,"mytranslate"),t.k0s()(),t.j41(10,"tr"),t.DNE(11,C,3,5,"td",4),t.k0s(),t.DNE(12,s,4,5,"tr",5),t.nI1(13,"createEmptyArray"),t.k0s()()),2&p){let V;t.R7$(4),t.BMQ("excelRow",0)("excelColumn",0),t.R7$(),t.SpI(" ",t.bMT(6,9,"lang_testbank_answersheet_question_title")," "),t.R7$(2),t.BMQ("colspan",S.totalExamCode)("excelRow",0)("excelColumn",1),t.R7$(),t.SpI(" ",t.bMT(9,11,"lang_auto_ma_de_thi")," "),t.R7$(3),t.Y8G("ngForOf",null!==(V=null==S.obj?null:S.obj.offlineMixQuestionObjs)&&void 0!==V?V:t.lJ4(15,_)),t.R7$(),t.Y8G("ngForOf",t.bMT(13,13,S.maxQuestionIndex))}},dependencies:[y.Sq,y.bT,o.wp,o.IX,o.c],encapsulation:2}),k})()},82716:(H,F,n)=>{n.d(F,{h:()=>q});var t=n(10936),i=n(89163),U=n(33887),e=n(38009),y=n(80037),o=n(48891),N=n(97885),_=n(3780),C=n(54460),u=n(64160),E=n(15343),M=n(81587),a=n(27985),s=n(52811),f=n(76975);function g(w,Q){1&w&&(o.j41(0,"div",9)(1,"span",10),o.nrm(2,"azt-loading-ui"),o.k0s(),o.j41(3,"span",11),o.EFF(4,"Loading..."),o.k0s()())}function k(w,Q){if(1&w){const b=o.RV6();o.j41(0,"div",26)(1,"azt-list-classroom-checkbox",27),o.bIt("changeCheckboxEvent",function(v){o.eBV(b);const B=o.XpG(3);return o.Njj(B.changeStatusOfflineShare(v))}),o.k0s()()}if(2&w){const b=o.XpG(3);o.R7$(),o.Y8G("form",b.form)("classroomGroupData",b.classroomWithGroup)("shareClassroomIds",b.shareClassroomIds)("permissionName",b.permissionTypes.exam)("defaultCssClass","classroom-box-in-dialog")}}function A(w,Q){if(1&w){const b=o.RV6();o.j41(0,"div",28),o.nrm(1,"input",29),o.j41(2,"button",30),o.bIt("click",function(){o.eBV(b);const v=o.XpG(3);return o.Njj(v.showCopySuccess())}),o.j41(3,"span",31),o.nrm(4,"lucide-icon",32),o.k0s(),o.EFF(5),o.nI1(6,"mytranslate"),o.k0s()()}if(2&w){const b=o.XpG(3);o.R7$(),o.Y8G("value",b.linkCopy),o.R7$(),o.Y8G("cdkCopyToClipboard",b.copyLinkToClipboard()),o.R7$(3),o.SpI(" ",o.bMT(6,3,"lang_auto_sao_chep")," ")}}function p(w,Q){1&w&&(o.j41(0,"div",33)(1,"p",34),o.EFF(2),o.nI1(3,"mytranslate"),o.k0s()()),2&w&&(o.R7$(2),o.JRh(o.bMT(3,1,"lang_auto_chua_duoc_cau_hinh_tra_de_thi")))}function S(w,Q){if(1&w){const b=o.RV6();o.qex(0),o.j41(1,"div",14)(2,"div",15)(3,"input",16),o.bIt("change",function(){o.eBV(b);const v=o.XpG(2);return o.Njj(v.changeStatusOfflineShare(void 0))}),o.k0s(),o.j41(4,"label",17),o.EFF(5),o.nI1(6,"mytranslate"),o.k0s()(),o.j41(7,"div",18)(8,"input",19),o.bIt("change",function(){o.eBV(b);const v=o.XpG(2);return o.Njj(v.changeStatusOfflineShare(void 0))}),o.k0s(),o.j41(9,"label",20),o.EFF(10),o.nI1(11,"mytranslate"),o.k0s()(),o.j41(12,"div",18)(13,"input",21),o.bIt("change",function(){o.eBV(b);const v=o.XpG(2);return o.Njj(v.changeStatusOfflineShare(void 0))}),o.k0s(),o.j41(14,"label",22),o.EFF(15),o.nI1(16,"mytranslate"),o.k0s()()(),o.DNE(17,k,2,5,"div",23)(18,A,7,5,"div",24)(19,p,4,3,"div",25),o.nI1(20,"fullPermission"),o.bVm()}if(2&w){const b=o.XpG(2);o.R7$(3),o.Y8G("value",0),o.R7$(2),o.JRh(o.bMT(6,9,"lang_auto_khong")),o.R7$(3),o.Y8G("value",1),o.R7$(2),o.JRh(o.bMT(11,11,"lang_auto_tat_ca_cac_lop")),o.R7$(3),o.Y8G("value",2),o.R7$(2),o.JRh(o.bMT(16,13,"lang_auto_tuy_chon_theo_lop")),o.R7$(2),o.Y8G("ngIf",2===b.form.controls.chooseOption.value),o.R7$(),o.Y8G("ngIf",1===b.form.controls.chooseOption.value||2===b.form.controls.chooseOption.value&&!b.form.controls.classroomFormArray.errors),o.R7$(),o.Y8G("ngIf",!o.i5U(20,15,b.examWithPermissionObj,"exam"))}}function V(w,Q){1&w&&(o.j41(0,"div",36)(1,"p",34),o.EFF(2),o.nI1(3,"mytranslate"),o.k0s()()),2&w&&(o.R7$(2),o.JRh(o.bMT(3,1,"lang_auto_chua_duoc_cau_hinh_tra_de_thi")))}function J(w,Q){if(1&w&&(o.DNE(0,V,4,3,"div",35),o.nI1(1,"fullPermission")),2&w){const b=o.XpG(2);o.Y8G("ngIf",!o.i5U(1,1,b.examWithPermissionObj,"exam"))}}function Z(w,Q){if(1&w&&(o.j41(0,"form",12),o.DNE(1,S,21,18,"ng-container",13),o.nI1(2,"fullPermission"),o.DNE(3,J,2,4,"ng-template",null,1,o.C5r),o.k0s()),2&w){const b=o.sdS(4),z=o.XpG();o.Y8G("formGroup",z.form),o.R7$(),o.Y8G("ngIf",o.i5U(2,3,z.examWithPermissionObj,"exam"))("ngIfElse",b)}}function tt(w,Q){if(1&w){const b=o.RV6();o.j41(0,"div",37)(1,"button",38),o.bIt("click",function(){o.eBV(b);const v=o.XpG();return o.Njj(v.btnCloseDialog(!1))}),o.EFF(2),o.nI1(3,"mytranslate"),o.k0s()()}2&w&&(o.R7$(2),o.SpI(" ",o.bMT(3,1,"lang_auto_dong")," "))}let q=(()=>{var w;class Q extends U._{btnCloseDialog(z){this.dialogRef.close(z)}copyLinkToClipboard(){let z=this.commonService.getCurrentDomain();return this.linkCopy=`${z}/de-thi/${this.examWithPermissionObj?.hashId}?offline=${this.offlineCode}`,this.linkCopy}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong")}getCodeOfflineShare(){this.initStatusObj(),this.waitDestroy(this.offlineShareService.apiOfflineShareGetObjGet(this.examHashId).subscribe(z=>{1==z.success?(this.offlineCode=z.data?.shareHashId??"",this.shareClassroomIds=z.data?.shareClassroomIds??[],this.examWithPermissionObj=z.data?.examObj,this.classroomWithGroup=[{groupObj:{id:-1,name:this.commonService.myTranslateInstant("lang_testbank_share_offline_default_group")},isOwned:!0,classroomObjs:z.data?.classroomObjs??[]}],this.form.controls.chooseOption.setValue(z.data?.showOfflineResult??0),this.successStatusObj()):this.errorStatusObj(z.message??"",!0)}))}changeStatusOfflineShare(z){if(2==this.form.getRawValue().chooseOption&&this.form.controls.classroomFormArray.errors?.classroomCheckBoxValidatorWithoutWhoAllow)return;let v=this.form.getRawValue().chooseOption;const B=2!=v?[]:this.sAztClassroomCheckboxService.getClassroomIdsCheckedInGroup(this.form.controls.classroomFormArray);this.waitDestroy(this.offlineShareService.apiOfflineShareChangeStatusPost({examHashId:this.examWithPermissionObj?.hashId??"",status:v,classroomIds:B}).subscribe(m=>{1==m.success?this.offlineCode=m.data?.shareHashId??"":this.errorStatusObj(m.message??"",!0)}))}ngAfterContentChecked(){this.changeDetector.detectChanges()}ngOnInit(){super.ngOnInit(),this.getCodeOfflineShare()}constructor(z,v,B,R,m){super(R,B),this.changeDetector=z,this.offlineShareService=v,this.dialogRef=B,this.sAztClassroomCheckboxService=m,this.examHashId="",this.useDialog=!1,this.permissionTypes=e.t,this.offlineCode="",this.linkCopy="",this.examWithPermissionObj=void 0,this.classroomWithGroup=[],this.shareClassroomIds=[],this.examHashId=R.examHashId?R.examHashId:this.examHashId,this.useDialog=R?R.useDialog:this.useDialog,this.form=new t.gE({chooseOption:new t.MJ(0,{nonNullable:!0}),whoAllow:new t.MJ(0,{nonNullable:!0}),classroomFormArray:new t.Yp([])},{validators:[y.j.classroomInGroupCheckBoxValidatorWithoutWhoAllow]})}}return(w=Q).\u0275fac=function(z){return new(z||w)(o.rXU(o.gRc),o.rXU(N.i$),o.rXU(i.CP,8),o.rXU(i.Vh,8),o.rXU(_.Q))},w.\u0275cmp=o.VBU({type:w,selectors:[["azt-offline-share"]],inputs:{examHashId:"examHashId",useDialog:"useDialog"},features:[o.Vt3],decls:11,vars:6,consts:[["doneLoading",""],["noFullPermission",""],[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-3"],[1,"text-base","font-medium"],[1,"p-3","pt-0"],["class","flex justify-center items-center",4,"ngIf","ngIfElse"],["class","text-right mt-3",4,"ngIf"],[1,"flex","justify-center","items-center"],[1,"w-4","h-4","inline-block"],[1,"sr-only","ml-2"],[3,"formGroup"],[4,"ngIf","ngIfElse"],[1,"flex","flex-col","sm:flex-row","mb-3"],[1,"form-check","mr-8"],["formControlName","chooseOption","id","notAllow","type","radio",1,"form-check-input",3,"change","value"],["for","notAllow",1,"form-check-label"],[1,"form-check","mr-8","mt-2","sm:mt-0"],["formControlName","chooseOption","id","allAllow","type","radio",1,"form-check-input",3,"change","value"],["for","allAllow",1,"form-check-label"],["formControlName","chooseOption","id","customAllow","type","radio",1,"form-check-input",3,"change","value"],["for","customAllow",1,"form-check-label"],["class","azt-list-classroom",4,"ngIf"],["class","azt-copy relative",4,"ngIf"],["class","mt-0",4,"ngIf"],[1,"azt-list-classroom"],[3,"changeCheckboxEvent","form","classroomGroupData","shareClassroomIds","permissionName","defaultCssClass"],[1,"azt-copy","relative"],["type","text","readonly","",1,"form-control","py-3","px-4","border-transparent","bg-slate-100","pr-10","text-primary",2,"padding-right","120px","cursor","pointer",3,"value"],["azt-track-service","practice-detail-isTsISlyAY",1,"btn","btn-outline-primary","absolute","my-auto","inset-y-0","right-0",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"click","cdkCopyToClipboard"],[1,"w-4","h-4","inline-block","mr-2"],["name","copy","size","20"],[1,"mt-0"],[1,"note"],["class","text-center",4,"ngIf"],[1,"text-center"],[1,"text-right","mt-3"],["azt-track-service","azt-offline-share-hrBGx7oL2r",1,"btn","w-24","btn-secondary",3,"click"]],template:function(z,v){if(1&z&&(o.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"h3",5),o.EFF(4),o.nI1(5,"mytranslate"),o.k0s()(),o.j41(6,"div",6),o.DNE(7,g,5,0,"div",7)(8,Z,5,6,"ng-template",null,0,o.C5r)(10,tt,4,3,"div",8),o.k0s()()()),2&z){const B=o.sdS(9);o.R7$(4),o.JRh(o.bMT(5,4,"lang_auto_tra_ket_qua_thi_offline")),o.R7$(3),o.Y8G("ngIf",v.statusObj.loading)("ngIfElse",B),o.R7$(3),o.Y8G("ngIf",v.useDialog)}},dependencies:[C.bT,u.dF,t.qT,t.me,t.Fm,t.BC,t.cb,t.j4,t.JD,E.WGl,M.t,a.D,s.R,f.wp,f.gC],encapsulation:2}),Q})()},94217:(H,F,n)=>{n.d(F,{A:()=>f});var t=n(89163),i=n(33887),U=n(33860),e=n(48891),y=n(9280),o=n(46899),N=n(24506),_=n(54460),C=n(2915),u=n(52811),E=n(8022),M=n(76975);function a(g,k){1&g&&(e.j41(0,"div",6),e.nrm(1,"azt-loading-ui"),e.k0s())}function s(g,k){if(1&g){const A=e.RV6();e.j41(0,"azt-mat-dialog-content",7)(1,"app-capacity-exam-tree-in-view-mode-component",8),e.bIt("getExamData",function(S){e.eBV(A);const V=e.XpG();return e.Njj(V.getExamData(S))}),e.k0s()()}if(2&g){const A=e.XpG();e.Y8G("defaultHeight",70),e.R7$(),e.Y8G("rawNodes",A.examComponents)}}let f=(()=>{var g;class k extends i._{getExamData(p){this.documentConfigService.apiDocumentConfigGetExamConfigDataV2Get(p.hashId??"").subscribe(S=>{if(!S.success||!S.data?.examObj)return this.errorStatusObj(S.message??"");this.showExamDetailDialog(S.data?.examObj)})}showExamDetailDialog(p){let S={obj:{...p},curCateId:p.categoryId??0,isOnLib:0,isShow:!0};this.sAztDialogService.open(U.c,{width:"800px",maxWidth:"90vw",enterAnimationDuration:"0ms",exitAnimationDuration:"0ms",data:S,restoreFocus:!1}).afterClosed().subscribe(J=>{})}getData(){this.initStatusObj(),this.waitDestroy(this.examService.apiExamListExamComponentsIdGet(this.data.id).subscribe(p=>{if(!p.success)return this.errorStatusObj(p.message??"");this.examComponents=p.data?.objs??[],this.stopStatusObj()}))}ngOnInit(){super.ngOnInit(),this.getData()}constructor(p,S,V,J,Z){super(Z,J),this.documentConfigService=p,this.sAztDialogService=S,this.examService=V,this.dialogRef=J,this.data=Z,this.examComponents=[]}}return(g=k).\u0275fac=function(p){return new(p||g)(e.rXU(y.x_),e.rXU(o.i),e.rXU(N.R),e.rXU(t.CP,8),e.rXU(t.Vh,8))},g.\u0275cmp=e.VBU({type:g,selectors:[["azt-preview-capacity-exam"]],features:[e.Vt3],decls:8,vars:5,consts:[[1,"az-dialog-info"],[1,"box","p-3",2,"overflow-x","hidden"],["class","flex justify-between items-center p-5",4,"ngIf"],["class","mt-3",3,"defaultHeight",4,"ngIf"],[1,"text-right","pt-3"],[1,"btn","w-24","btn-outline-secondary",3,"click"],[1,"flex","justify-between","items-center","p-5"],[1,"mt-3",3,"defaultHeight"],[3,"getExamData","rawNodes"]],template:function(p,S){1&p&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,a,2,0,"div",2)(3,s,2,2,"azt-mat-dialog-content",3),e.j41(4,"div",4)(5,"button",5),e.bIt("click",function(){return S.dialogRef.close()}),e.EFF(6),e.nI1(7,"mytranslate"),e.k0s()()()()),2&p&&(e.R7$(2),e.Y8G("ngIf",S.statusObj.loading),e.R7$(),e.Y8G("ngIf",!S.statusObj.loading),e.R7$(3),e.SpI(" ",e.bMT(7,3,"lang_auto_dong")," "))},dependencies:[_.bT,C.U,u.R,E.n,M.wp],encapsulation:2}),k})()},33860:(H,F,n)=>{n.d(F,{c:()=>D});var t=n(48891),i=n(89163),U=n(33887),e=n(25539),y=n(18148),o=n(78111),N=n(9280),_=n(10296),C=n(51913),u=n(91513),E=n(24506),M=n(97885),a=n(42032),s=n(54460),f=n(64160),g=n(17818),k=n(47712),A=n(15343),p=n(63958),S=n(52654),V=n(2915),J=n(62538),Z=n(52811),tt=n(22783),q=n(76975);const w=()=>({"mr-1 flex-none":!0});function Q(d,Y){if(1&d&&(t.j41(0,"a",33),t.nI1(1,"mytranslate"),t.j41(2,"span",23),t.nrm(3,"lucide-icon",34),t.k0s()()),2&d){t.XpG(2);const x=t.sdS(3);t.FS9("matTooltip",t.bMT(1,2,"lang_auto_tai_ve")),t.Y8G("matMenuTriggerFor",x)}}function b(d,Y){if(1&d){const x=t.RV6();t.j41(0,"a",35),t.nI1(1,"mytranslate"),t.bIt("click",function(){t.eBV(x);const T=t.XpG(2);return t.Njj(T.showCopySuccess())}),t.j41(2,"span",36),t.nrm(3,"lucide-icon",37),t.k0s(),t.j41(4,"span"),t.EFF(5),t.nI1(6,"mytranslate"),t.k0s()()}if(2&d){const x=t.XpG(2);t.FS9("matTooltip",t.bMT(1,3,"lang_auto_copy_link_de_thi")),t.Y8G("cdkCopyToClipboard",x.copyLinkExam()),t.R7$(5),t.JRh(t.bMT(6,5,"lang_auto_copy_link"))}}function z(d,Y){1&d&&(t.j41(0,"div",38)(1,"span",39),t.nrm(2,"azt-loading-ui"),t.k0s(),t.j41(3,"span",40),t.EFF(4),t.nI1(5,"mytranslate"),t.k0s()()),2&d&&(t.R7$(4),t.JRh(t.bMT(5,1,"lang_auto_dang_chuan_bi_tai_lieu_doing")))}function v(d,Y){if(1&d&&(t.j41(0,"div",41),t.nrm(1,"div",42),t.nI1(2,"safeNormalHtmlContent"),t.k0s()),2&d){const x=t.XpG(2);t.R7$(),t.Y8G("innerHtml",t.bMT(2,1,x.data.headerContent),t.npT)}}function B(d,Y){if(1&d&&t.nrm(0,"azt-loaded-img",43),2&d){const x=t.XpG(2);t.Y8G("imgSrc",x.data.obj.examHeader)}}function R(d,Y){if(1&d&&t.nrm(0,"azt-question-standalone-for-preview",45),2&d){const x=t.XpG(),I=x.$implicit,T=x.index,L=t.XpG(2);t.Y8G("examObj",L.examObj)("questionObj",I)("follower",L.followerRenderQuest)("curQuestionIndex",T)("isShowExplain",L.showExplanation)}}function m(d,Y){if(1&d&&(t.qex(0),t.DNE(1,R,1,5,"azt-question-standalone-for-preview",44),t.bVm()),2&d){const x=t.XpG(2);t.R7$(),t.Y8G("ngIf",x.examObj)}}function P(d,Y){if(1&d){const x=t.RV6();t.qex(0),t.j41(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17),t.DNE(6,Q,4,4,"a",18),t.nI1(7,"editPermission"),t.DNE(8,b,7,7,"a",19),t.j41(9,"button",20),t.bIt("click",function(){t.eBV(x);const T=t.XpG();return t.Njj(T.showAllExplanation())}),t.EFF(10),t.nI1(11,"mytranslate"),t.nI1(12,"mytranslate"),t.k0s()()(),t.j41(13,"div",21)(14,"a",22)(15,"span",23),t.nrm(16,"lucide-icon",24),t.k0s()()()(),t.j41(17,"azt-mat-dialog-content",25),t.DNE(18,z,6,3,"div",26),t.j41(19,"div",27),t.nrm(20,"div",28),t.DNE(21,v,3,3,"div",29)(22,B,1,1,"azt-loaded-img",30)(23,m,2,1,"ng-container",31),t.nrm(24,"div",32),t.k0s()()()(),t.bVm()}if(2&d){const x=t.XpG();t.R7$(6),t.Y8G("ngIf",!(null!=x.data&&x.data.globalLadingPage)&&!x.data.allowHeader&&t.i5U(7,8,null==x.data?null:x.data.obj,"exam")),t.R7$(2),t.Y8G("ngIf",0==(null==x.data?null:x.data.isOnLib)&&!(null!=x.data&&x.data.globalLadingPage)),t.R7$(2),t.SpI(" ",x.showExplanation?t.bMT(11,11,"lang_auto_an_giai_thich"):t.bMT(12,13,"lang_auto_xem_giai_thich")," "),t.R7$(7),t.Y8G("defaultHeight",70),t.R7$(),t.Y8G("ngIf",x.statusObj.loading),t.R7$(3),t.Y8G("ngIf",x.data.allowHeader&&!x.statusObj.loading),t.R7$(),t.Y8G("ngIf",null==x.data||null==x.data.obj?null:x.data.obj.examHeader),t.R7$(),t.Y8G("ngForOf",x.questionList)}}function O(d,Y){if(1&d){const x=t.RV6();t.j41(0,"azt-export-excel-for-answersheet",46),t.bIt("exportDataDone",function(T){t.eBV(x);const L=t.XpG();return t.Njj(L.exportDataDone(T))}),t.k0s()}if(2&d){let x;const I=t.XpG();t.Y8G("startQuestionIndex",null!==(x=null==I.examObj?null:I.examObj.startQuestionIndex)&&void 0!==x?x:1)("obj",I.exportExcelData)}}let D=(()=>{var d;class Y extends U._{handlerCloseDialog(I){I&&this.dialogRef.close()}copyLinkExam(){return`${this.commonService.getCurrentDomain()}/de-thi/${this.data?.obj?.hashId}`}showCopySuccess(){this.commonService.snackSuccess("lang_auto_sao_chep_thanh_cong")}showAllExplanation(){this.showExplanation=!this.showExplanation}downloadExam(I,T){if(!I||!this.data.obj)return;const L=this.commonService.myTranslateInstant("lang_auto_dang_khoi_tao_du_lieu")??"",$=this.printAddInfo.templateType??0,X={nameSchool:this.printAddInfo.nameSchool??"",nameSubject:this.printAddInfo.nameSubject??""};y.L.openLoadingEffect(`${L}...`),this.data.obj.hideGroupQuestion=0,this.exportSAztDocxService.downloadExam(T,{...this.data.obj,editable:!1,allowStudentView:!0},void 0,void 0,this.cloneQuestionList,X,$,void 0,void 0,void 0,!0).then(()=>{}).catch(et=>{this.showErrorSnack(et.message)})}downloadExamAnswer(){this.waitDestroy(this.offlineExamExportService.apiOfflineExamExportExportResultOfRawExamGet(this.examObj?.hashId??"").subscribe(I=>{if(!I.success)return this.errorStatusObj(I.message??"");let T=I.data?.obj;T?.offlineMixQuestionObjs&&T.offlineMixQuestionObjs.length>0&&(this.exportExcelData=this.commonService.myClone(T))}))}exportDataDone(I){const T=this.createNameExam("answerexcel",!1);this.shareFileFlutterService.shareFileWithBlob(I,T)}redirectToDownloadExamPdf(I){window.open(this.commonService.getLocalRouter(`/admin/testbank/export-exam-to-pdf/${this.examObj?.id}?isShowExplain=${I}`),"_blank")}getConfigExam(){const I=this.data?.globalLadingPage?this.documentConfigService.apiDocumentConfigGetGlobalExamConfigDataGet(this.examObj?.hashId??""):this.documentConfigService.apiDocumentConfigGetExamConfigDataV2Get(this.examObj?.hashId??"");this.waitDestroy(I.subscribe(T=>{if(!T.success)return this.errorStatusObj(T.message,!1);let L=0,$=0;this.questionList.forEach((X,et)=>{X.labelIndex=et,T.data?.resetQuestionIndex&&X.groupInfo&&X.groupInfo.groupId&&(L!=X.groupInfo.groupId&&(L=X.groupInfo.groupId,$=0),X.labelIndex=$,$++)}),this.successStatusObj()}))}getData(I){this.initStatusObj();const T=this.data?.globalLadingPage?this.examService.apiExamGetGlobalQuestionsIdGet(I?.id??0):this.permissionService.hasViewPermission("exam",I)?this.examService.apiExamGetQuestionsIdGet(I?.id??0):void 0;if(!T)return this.showErrorSnack("lang_auto_ban_khong_co_quyen_thuc_thi_chuc_nang_nay");T.subscribe(L=>{const $=this.commonService.castJsonToClassObjs(e.I,JSON.stringify(L.data?.questionObjs||[]))??[];this.followerRenderQuest.setNumQuest($.length),$.forEach(X=>{X.isRoleTeacher=!0}),this.cloneQuestionList=this.commonService.myClone($),this.questionList=$,this.examObj=L.data?.examObj,this.getConfigExam()})}createNameExam(I,T){const L=this.examObj?.name??"";let $;switch(I){case"answersheet":$=this.printAnswersheetService.exportFileNameOfAnswerSheet(0,L,"");break;case"answerexcel":$=this.printAnswersheetService.exportFileNameOfAnswerExcelOffline(0,L,"");break;default:$=this.printAnswersheetService.exportFileNameOfExamOffline(0,L,"",void 0)}return T&&($=this.commonService.replaceAll($,"_","-")??""),$+("answersheet"===I?".pdf":"answerexcel"===I?".xlsx":".docx")}ngOnChanges(){this.data?.obj&&this.getData(this.data.obj)}ngOnInit(){super.ngOnInit(),this.data?.obj&&this.getData(this.data.obj)}constructor(I,T,L,$,X,et,st,ot,nt){super(nt,ot),this.documentConfigService=I,this.shareFileFlutterService=T,this.permissionService=L,this.exportSAztDocxService=$,this.examService=X,this.offlineExamExportService=et,this.printAnswersheetService=st,this.dialogRef=ot,this.data=nt,this.closeDialog=new t.bkB,this.questionList=[],this.cloneQuestionList=[],this.followerRenderQuest=new o.e,this.printAddInfo={},this.showExplanation=!1}}return(d=Y).\u0275fac=function(I){return new(I||d)(t.rXU(N.x_),t.rXU(_.R),t.rXU(C.p),t.rXU(u.c),t.rXU(E.R),t.rXU(M.qG),t.rXU(a.Q),t.rXU(i.CP,8),t.rXU(i.Vh,8))},d.\u0275cmp=t.VBU({type:d,selectors:[["azt-preview-exam"]],outputs:{closeDialog:"closeDialog"},features:[t.Vt3,t.OA$],decls:29,vars:35,consts:[["menuDownload","matMenu"],[4,"ngIf"],[1,"dropdown-menu","show","relative","w-72"],[1,"dropdown-content"],[3,"checkAction","closeDialog","vipPackageType","classCSSCustom","isShowBadgeVip","isAction","trackingKey"],["name","file-check","size","16",3,"ngClass"],[1,"mr-3"],["name","file-text","size","16",3,"ngClass"],["azt-track-service","azt-preview-exam-ef7yEq6a3",1,"dropdown-item",3,"click"],["name","file-down","size","16",3,"ngClass"],["azt-track-service","azt-preview-exam--mJB2JKFgNu",1,"dropdown-item",3,"click"],["name","file-spreadsheet","size","16",3,"ngClass"],[3,"startQuestionIndex","obj","exportDataDone",4,"ngIf"],[1,"az-dialog-info"],[1,"box",2,"overflow-x","hidden"],[1,"flex","items-center","p-2","bg-slate-100","dark:bg-darkmode-400"],[1,"mr-auto"],[1,"flex","items-center","mr-2"],["class","btn btn-sm btn-outline-secondary btn-transparent mr-2",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["azt-track-service","azt-preview-exam-dgdyLZO48Hq","class","btn btn-sm btn-outline-secondary btn-transparent mr-2",3,"matTooltip","cdkCopyToClipboard","click",4,"ngIf"],["azt-track-service","azt-preview-exam-WEwBr57UW",1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"click"],[1,"ml-auto"],["azt-track-service","azt-preview-exam-y2xqBN7DlGX",1,"btn","btn-transparent","btn-outline-danger","btn-sm",3,"mat-dialog-close"],[1,"w-4","h-4","flex-none"],["name","x","size","18"],[1,"mt-3",3,"defaultHeight"],["class","flex justify-center items-center h-40",4,"ngIf"],["id","boxContentQuestion",1,"p-2"],[1,"pt-3"],["class","box p-3 mb-3",4,"ngIf"],["style","display: block","class","mt-5",3,"imgSrc",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"py-5"],[1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"matTooltip","matMenuTriggerFor"],["name","download","size","18"],["azt-track-service","azt-preview-exam-dgdyLZO48Hq",1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"click","matTooltip","cdkCopyToClipboard"],[1,"w-4","h-4","mr-2","flex-none"],["name","copy","size","18"],[1,"flex","justify-center","items-center","h-40"],[1,"w-4","h-4","inline-block"],[1,"sr-only","ml-2"],[1,"box","p-3","mb-3"],[2,"line-height","1.5",3,"innerHtml"],[1,"mt-5",2,"display","block",3,"imgSrc"],[3,"examObj","questionObj","follower","curQuestionIndex","isShowExplain",4,"ngIf"],[3,"examObj","questionObj","follower","curQuestionIndex","isShowExplain"],[3,"exportDataDone","startQuestionIndex","obj"]],template:function(I,T){if(1&I){const L=t.RV6();t.DNE(0,P,25,15,"ng-container",1),t.nI1(1,"viewPermission"),t.j41(2,"mat-menu",null,0)(4,"div",2)(5,"ul",3)(6,"li")(7,"azt-check-vip-account",4),t.bIt("checkAction",function(X){return t.eBV(L),t.Njj(T.downloadExam(X,!1))})("closeDialog",function(X){return t.eBV(L),t.Njj(T.handlerCloseDialog(X))}),t.nrm(8,"lucide-icon",5),t.j41(9,"span",6),t.EFF(10),t.nI1(11,"mytranslate"),t.k0s()()(),t.j41(12,"li")(13,"azt-check-vip-account",4),t.bIt("checkAction",function(X){return t.eBV(L),t.Njj(T.downloadExam(X,!0))})("closeDialog",function(X){return t.eBV(L),t.Njj(T.handlerCloseDialog(X))}),t.nrm(14,"lucide-icon",7),t.j41(15,"span",6),t.EFF(16),t.nI1(17,"mytranslate"),t.k0s()()(),t.j41(18,"li")(19,"a",8),t.bIt("click",function(){return t.eBV(L),t.Njj(T.redirectToDownloadExamPdf(0))}),t.nrm(20,"lucide-icon",9),t.EFF(21),t.nI1(22,"mytranslate"),t.k0s()(),t.j41(23,"li")(24,"a",10),t.bIt("click",function(){return t.eBV(L),t.Njj(T.downloadExamAnswer())}),t.nrm(25,"lucide-icon",11),t.EFF(26),t.nI1(27,"mytranslate"),t.k0s()()()()(),t.DNE(28,O,1,2,"azt-export-excel-for-answersheet",12)}2&I&&(t.Y8G("ngIf",t.i5U(1,20,null==T.data?null:T.data.obj,"exam")||(null==T.data?null:T.data.globalLadingPage)),t.R7$(7),t.Y8G("vipPackageType","VIP_FOR_TEACHER")("classCSSCustom","dropdown-item cursor-pointer")("isShowBadgeVip",!T.isBusinessDomain)("isAction",!0)("trackingKey","DOWNLOAD_EXAM_DOCX_NO_ANSWER"),t.R7$(),t.Y8G("ngClass",t.lJ4(31,w)),t.R7$(2),t.SpI(" ",t.bMT(11,23,"lang_testbank_download_exam_in_docx")," "),t.R7$(3),t.Y8G("vipPackageType","VIP_FOR_TEACHER")("classCSSCustom","dropdown-item cursor-pointer")("isShowBadgeVip",!T.isBusinessDomain)("isAction",!0)("trackingKey","DOWNLOAD_EXAM_DOCX_WITH_ANSWER"),t.R7$(),t.Y8G("ngClass",t.lJ4(32,w)),t.R7$(2),t.SpI(" ",t.bMT(17,25,"lang_azt_download_exam_paper_with_detailed_answers_in_docx")," "),t.R7$(4),t.Y8G("ngClass",t.lJ4(33,w)),t.R7$(),t.SpI(" ",t.bMT(22,27,"lang_auto_tai_xuong_de_thi")+" PDF"," "),t.R7$(4),t.Y8G("ngClass",t.lJ4(34,w)),t.R7$(),t.SpI(" ",t.bMT(27,29,"lang_testbank_download_exam_answer_in_excel")," "),t.R7$(2),t.Y8G("ngIf",null!=T.exportExcelData))},dependencies:[s.YU,s.Sq,s.bT,f.dF,i.tx,g.kk,g.Cp,k.oV,A.WGl,p.H,S.a,V.U,J.O,Z.R,tt.F,q.wp,q._y,q.FV,q.eL],encapsulation:2}),Y})()},35048:(H,F,n)=>{n.d(F,{w:()=>R});var t=n(48891),i=n(10936),U=n(59640),e=n(27208),y=n(68774),o=n(31216),N=n(54460),_=n(47712),C=n(18718),u=n(2915),E=n(69135),M=n(32099),a=n(76975);const s=(m,P)=>({"dark:bg-darkmode-400 bg-slate-100":m,"border-b border-slate-200/60 dark:border-darkmode-400":P});function f(m,P){if(1&m&&t.nrm(0,"azt-loading-effect",10),2&m){const O=t.XpG();t.Y8G("currentStatusObj",O.statusObj)}}function g(m,P){if(1&m&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&m){const O=t.XpG(3);t.R7$(),t.JRh(t.bMT(2,1,"lang_auto_da_chon")+": "+O.totalStudentsSelected)}}function k(m,P){if(1&m&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&m){const O=t.XpG(3);t.R7$(),t.JRh(O.data.classroomName+(O.totalStudentsSelected?" ("+t.bMT(2,1,"lang_auto_da_chon")+": "+O.totalStudentsSelected+")":""))}}function A(m,P){}function p(m,P){if(1&m&&(t.j41(0,"div")(1,"azt-mat-dialog-content",24),t.DNE(2,A,0,0,"ng-template",25),t.k0s()()),2&m){t.XpG(3);const O=t.sdS(8);t.R7$(),t.Y8G("defaultHeight",40),t.R7$(),t.Y8G("ngTemplateOutlet",O)}}function S(m,P){}function V(m,P){if(1&m&&(t.j41(0,"div"),t.DNE(1,S,0,0,"ng-template",25),t.k0s()),2&m){t.XpG(3);const O=t.sdS(8);t.R7$(),t.Y8G("ngTemplateOutlet",O)}}function J(m,P){if(1&m){const O=t.RV6();t.qex(0),t.j41(1,"div",12)(2,"div",13),t.DNE(3,g,3,3,"span",14)(4,k,3,3,"span",14),t.j41(5,"div",15)(6,"azt-search-box",16),t.nI1(7,"mytranslate"),t.bIt("onSearch",function(d){t.eBV(O);const Y=t.XpG(2);return t.Njj(Y.onSearchBox(d.searchObj))}),t.k0s()()(),t.j41(8,"div",17)(9,"div",18)(10,"input",19),t.bIt("change",function(){t.eBV(O);const d=t.XpG(2);return t.Njj(d.selectAllStudentOfClass())}),t.k0s(),t.j41(11,"label",20),t.EFF(12),t.nI1(13,"mytranslate"),t.k0s()(),t.j41(14,"div",21)(15,"input",22),t.bIt("change",function(){t.eBV(O);const d=t.XpG(2);return t.Njj(d.calculateFormData())}),t.k0s(),t.j41(16,"label",23),t.EFF(17),t.nI1(18,"mytranslate"),t.k0s()()()(),t.DNE(19,p,3,2,"div",14)(20,V,2,1,"div",14),t.bVm()}if(2&m){const O=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.l_i(18,s,O.isDialog,!O.isDialog)),t.R7$(2),t.Y8G("ngIf",!O.isDialog),t.R7$(),t.Y8G("ngIf",O.isDialog),t.R7$(2),t.Y8G("isServerSearch",!1)("styleInput","form-control-sm ")("placeholder",t.bMT(7,12,"lang_student_classroom_list_detail_search_name_student")),t.R7$(4),t.Y8G("formControl",O.selectAllFormControl),t.R7$(2),t.SpI(" ",t.bMT(13,14,O.selectAllFormControl.value?"lang_remove_all":"lang_select_all")," "),t.R7$(3),t.Y8G("formControl",O.showCheckedFormControl),t.R7$(2),t.SpI(" ",t.bMT(18,16,"lang_testbank_selected_students")," "),t.R7$(2),t.Y8G("ngIf",O.isDialog),t.R7$(),t.Y8G("ngIf",!O.isDialog)}}function Z(m,P){1&m&&(t.j41(0,"div",26)(1,"span"),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s()()),2&m&&(t.R7$(2),t.JRh(t.bMT(3,1,"lang_core_class_has_no_student")))}function tt(m,P){if(1&m&&t.DNE(0,J,21,21,"ng-container",11)(1,Z,4,3,"ng-template",null,2,t.C5r),2&m){const O=t.sdS(2),D=t.XpG();t.Y8G("ngIf",D.studentObjs.length>0)("ngIfElse",O)}}function q(m,P){if(1&m){const O=t.RV6();t.j41(0,"div",27)(1,"button",28),t.bIt("click",function(){t.eBV(O);const d=t.XpG();return t.Njj(d.btnCloseDialog())}),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s()()}2&m&&(t.R7$(2),t.SpI(" ",t.bMT(3,1,"lang_cms_common_ok")," "))}function w(m,P){1&m&&(t.qex(0),t.j41(1,"div",26)(2,"span",29),t.EFF(3),t.nI1(4,"mytranslate"),t.k0s()(),t.bVm()),2&m&&(t.R7$(3),t.JRh(t.bMT(4,1,"lang_testbank_no_students_selected")))}function Q(m,P){if(1&m){const O=t.RV6();t.j41(0,"div",34)(1,"div",35)(2,"input",36),t.bIt("change",function(){t.eBV(O);const d=t.XpG(4);return t.Njj(d.calculateFormData())}),t.k0s(),t.j41(3,"label",37,4),t.nI1(5,"mytranslate"),t.EFF(6),t.nI1(7,"mytranslate"),t.k0s()()()}if(2&m){const O=t.sdS(4),D=t.XpG().$implicit;t.R7$(2),t.FS9("id","azt-checkbox-student-"+D.id),t.Y8G("formControl",D.isChecked),t.R7$(),t.FS9("for","azt-checkbox-student-"+D.id),t.Y8G("matTooltip",t.bMT(5,8,D.fullName))("isDisabledTooltip",!1)("matTooltipDisabled",O.isDisabled)("matTooltipShowDelay",500),t.R7$(3),t.SpI(" ",t.bMT(7,10,D.fullName)," ")}}function b(m,P){if(1&m&&(t.qex(0),t.DNE(1,Q,8,12,"div",33),t.bVm()),2&m){const O=P.$implicit;t.R7$(),t.Y8G("ngIf",O.isShowStudent)}}function z(m,P){1&m&&(t.j41(0,"div",26),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&m&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"lang_student_classroom_list_detail_not_student")," "))}function v(m,P){if(1&m&&(t.j41(0,"div",30),t.DNE(1,b,2,1,"ng-container",31),t.k0s(),t.DNE(2,z,3,3,"div",32)),2&m){const O=t.XpG(2);t.R7$(),t.Y8G("ngForOf",O.studentObjs),t.R7$(),t.Y8G("ngIf",0==O.totalStudentsShow)}}function B(m,P){if(1&m&&t.DNE(0,w,5,3,"ng-container",11)(1,v,3,2,"ng-template",null,3,t.C5r),2&m){const O=t.sdS(2),D=t.XpG();t.Y8G("ngIf",D.totalStudentsSelected<=0&&D.showCheckedFormControl.value)("ngIfElse",O)}}let R=(()=>{var m;class P extends U.H{resetAll(){this.selectAllFormControl.reset(),this.showCheckedFormControl.reset(),this.selectAllStudentOfClass()}btnCloseDialog(){if(this.studentObjs.length<=0)return this.closeBox.emit();let D={classroomId:this.data.classroomId,classroomName:this.data.classroomName,studentIdsSelected:this.studentObjs.filter(d=>d.isChecked.value).map(d=>d.id)};this.closeBox.emit(D)}onSearchBox(D){this.searchContentObj=D,this.calculateFormData()}selectAllStudentOfClass(){this.studentObjs.map(D=>D.isChecked.setValue(this.selectAllFormControl.value)),this.calculateFormData()}calculateFormData(){let D=this.commonService.convertVietnameseToEnglish(this.searchContentObj.searchContent).toLowerCase().trim();this.studentObjs.forEach(d=>{const Y=this.commonService.convertVietnameseToEnglish(d.fullName??"").toLowerCase().trim();let x=""==D||Y.includes(D);d.isShowStudent=(!this.showCheckedFormControl.value||d.isChecked.value)&&x}),this.totalStudentsSelected=this.studentObjs.filter(d=>d.isChecked.value).length,this.selectAllFormControl.setValue(this.totalStudentsSelected==this.studentObjs.length),this.totalStudentsShow=this.studentObjs.filter(d=>d.isShowStudent).length,this.isDialog||this.btnCloseDialog()}getData(){this.initStatusObj(),this.waitDestroy(this.studentProfileV2Service.apiStudentProfileV2GetObjsByClassroomIdGet(this.data.classroomId).subscribe(D=>{if(!D.success)return this.errorStatusObj(D.message,!0);let d=D.data?.studentObjs??[];d=0==D.data?.classroomObj.sortType?this.sortService.sortFirstNameStudents(this.commonService.myClone(d)??[]):this.sortService.sortArrayByMultipleObjectKeyAsc(this.commonService.myClone(d)??[],"pos","id"),this.initFormData(d),this.stopStatusObj()}))}initFormData(D){this.studentObjs=D.map(d=>({...d,isShowStudent:!0,isChecked:new i.MJ(this.data.studentIdsSelected.includes(d.id),{nonNullable:!0})})),this.calculateFormData()}ngOnInit(){this.getData()}constructor(D,d){super(),this.sortService=D,this.studentProfileV2Service=d,this.selectAllFormControl=new i.MJ(!1,{nonNullable:!0}),this.showCheckedFormControl=new i.MJ(!1,{nonNullable:!0}),this.studentObjs=[],this.totalStudentsSelected=0,this.totalStudentsShow=0,this.searchContentObj=new e.Z,this.isDialog=!0,this.closeBox=new t.bkB}}return(m=P).\u0275fac=function(D){return new(D||m)(t.rXU(y.g),t.rXU(o.m_))},m.\u0275cmp=t.VBU({type:m,selectors:[["azt-select-student"]],inputs:{isDialog:"isDialog",data:"data"},outputs:{closeBox:"closeBox"},features:[t.Vt3],decls:9,vars:3,consts:[["doneLoading",""],["templateSelectStudent",""],["emptyStudents",""],["checkedBox",""],["c","isDisabled"],["id","selectStudent",1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-0"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],["class","p-3 text-right",4,"ngIf"],[3,"currentStatusObj"],[4,"ngIf","ngIfElse"],[1,"p-3","flex","flex-col","sm:flex-row","sm:h-auto","sm:items-center",3,"ngClass"],[1,"font-medium","mr-auto"],[4,"ngIf"],[1,"w-full","relative","flex","items-center","mt-2"],[3,"onSearch","isServerSearch","styleInput","placeholder"],[1,"flex","items-center","mt-2","sm:mt-0"],[1,"form-check","mr-3"],["id","selected-all","type","checkbox",1,"form-check-input",3,"change","formControl"],["for","selected-all",1,"form-check-label"],[1,"form-check"],["id","show-student-checked","type","checkbox",1,"form-check-input",3,"change","formControl"],["for","show-student-checked",1,"form-check-label"],[3,"defaultHeight"],[3,"ngTemplateOutlet"],[1,"h-full","flex","items-center","justify-center","p-5"],[1,"p-3","text-right"],["azt-track-service","azt-dialog-warning-3FIn9IaXN",1,"btn","w-24","btn-primary",3,"click"],[1,"mx-auto"],[1,"p-3","grid","grid-cols-12","gap-3"],[4,"ngFor","ngForOf"],["class","h-full flex items-center justify-center p-5",4,"ngIf"],["class","col-span-12 md:col-span-4 mt-2",4,"ngIf"],[1,"col-span-12","md:col-span-4","mt-2"],[1,"azt-checkbox-item"],["type","checkbox",1,"form-check-input",3,"change","id","formControl"],[1,"form-check-label","truncate",2,"vertical-align","middle",3,"matTooltip","isDisabledTooltip","matTooltipDisabled","matTooltipShowDelay","for"]],template:function(D,d){if(1&D&&(t.j41(0,"div",5)(1,"div",6)(2,"div",7),t.DNE(3,f,1,1,"azt-loading-effect",8)(4,tt,3,2,"ng-template",null,0,t.C5r),t.k0s()(),t.DNE(6,q,4,3,"div",9),t.k0s(),t.DNE(7,B,3,2,"ng-template",null,1,t.C5r)),2&D){const Y=t.sdS(5);t.R7$(3),t.Y8G("ngIf",d.statusObj.loading)("ngIfElse",Y),t.R7$(3),t.Y8G("ngIf",d.isDialog)}},dependencies:[N.YU,N.Sq,N.bT,N.T3,_.oV,i.Zm,i.BC,i.l_,C.K,u.U,E.f,M.W,a.wp],encapsulation:2}),P})()}}]);