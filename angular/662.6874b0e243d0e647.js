"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[662],{7468:(p,l,i)=>{i.d(l,{$:()=>h});var g=i(60723),e=i(23353),o=i(70860),r=i(92381);class h extends r.N{constructor(s,n,_,a,d){super(),this.cdnService=s,this.commonService=n,this.configRenderService=_,this.callBack=a,this.callbackFall=d}render(s,n,_,a){if(s.indexOf("@[]")<0)return a&&a(),s;let u,d=/@\[\]\{[^@]+\}@\[\]/g,c=s,m=new Map;for(;null!==(u=d.exec(s));){let v=u[0],f=v.split("@[]")[1],E=this.commonService.willDeleteParseJson(f),C=E.link,I=g.G.generateIdRequired(10);c=c.replace(v,`<div id='${I}' class='img-docx skeleton-box-loading' style='width: ${E.data.width*this.ratioImage}px;height: ${E.data.height*this.ratioImage}px'></div>`),m.has(C)?m.get(C)?.push({id:I,data:E.data}):m.set(C,[{id:I,data:E.data}])}return this.startLoadImage(m).then(()=>{a&&a()}).catch(v=>{this.callbackFall&&this.callbackFall(v)}),c}startLoadImage(s){return new Promise((n,_)=>{var a=0;s.size>0?s.forEach((d,c)=>{this.loadImage(c,this.cdnService).then(m=>{if(this.processImageQuestion(m,d,_),this.loadingManager.delete(m.id),this.callBack)for(let u of d)this.callBack(u.id,u.renderStr);++a===s.size&&n()}).catch(()=>{const m=c.split("/");var u=this.commonService.myTranslateInstant("lang_testbank_render_cant_download_the_image")??"";_(new o.l("LOAD_IMAGE",[m[m.length-1]],u))})}):n()})}processImageQuestion(s,n,_){n.forEach(a=>{try{const d=document.createElement("canvas");a.data.width=-1===a.data.width?s.width:a.data.width,a.data.height=-1===a.data.height?s.height:a.data.height,d.width=a.data.width,d.height=a.data.height,d.getContext("2d")?.drawImage(s,a.data.x,a.data.y,a.data.width,a.data.height,0,0,d.width,d.height);let m=this.isCropImage?e.rj.cropCanvas(d):d;m=this.isCanvasEmpty(m)?d:m,a.renderStr=`<img id='${a.id}' class='img-docx' alt='error...' src='${m.toDataURL()}' style='width: ${m.width*this.ratioImage}px;height: auto'>`}catch{const c=s.src;return void _(new o.l("CROP_IMAGE",[c[c.length-1]],"Kh\xf4ng c\u1eaft \u0111\u01b0\u1ee3c n\u1ed9i dung trong h\xecnh \u1ea3nh"))}})}isCanvasEmpty(s){const n=document.createElement("canvas");return n.width=s.width,n.height=s.height,s.toDataURL()===n.toDataURL()}}},92381:(p,l,i)=>{i.d(l,{N:()=>r});var g=i(60723),e=i(23353),o=i(61713);class r{constructor(){this.isCropImage=!0,this.loadingManager=new Map,this.ratioImage=.65}setCallback(t){}setApiCache(t){}setLoadingManager(t){this.loadingManager=t}loadImage(t,s){return new Promise((n,_)=>{let a=g.G.generateIdRequired(10);this.loadingManager.set(a,t),(0,o.dr)(t,s).then(d=>{n(d),this.loadingManager.delete(a)}).catch(()=>{this.loadingManager.delete(a),_(new Error)})})}loadImageToBase64(t,s){return new Promise((n,_)=>{const a=new Image;a.crossOrigin="anonymous",a.setAttribute("count","1");let d=g.G.generateIdRequired(10);this.loadingManager.set(d,t),a.onload=()=>{const c=document.createElement("canvas");c.width=a.width,c.height=a.height,c.getContext("2d")?.drawImage(a,0,0,a.width,a.height,0,0,c.width,c.height);const u=this.isCropImage?e.rj.cropCanvas(c):c;let v=`<img id='${d}' class='img-docx' alt='error...' src='${u.toDataURL()}' style='width: ${u.width*this.ratioImage}px;height: auto'>`;n(v),this.loadingManager.delete(d)},a.onerror=()=>{this.loadingManager.delete(d);const c=a.getAttribute("count");c&&1==Number(c)?(a.src=s.getMyCdn(t),a.setAttribute("count","2")):c&&Number(c)<5?(a.setAttribute("count",c+1),a.src=s.getMyCdn(t)+"?t="+(new Date).getTime()):_(new Error)},a.src=s.getMyCdn(t)})}}},72164:(p,l,i)=>{i.d(l,{e:()=>r});var g=i(19347),e=i(47496),o=i(65879);let r=(()=>{class h extends e.Q{constructor(s,n){super(),this.data=s,this.dialogRef=n}static#e=this.\u0275fac=function(n){return new(n||h)(o.Y36(g.WI),o.Y36(g.so))};static#t=this.\u0275cmp=o.Xpm({type:h,selectors:[["ng-component"]],features:[o.qOj],decls:0,vars:0,template:function(n,_){},encapsulation:2})}return h})()},2783:(p,l,i)=>{i.d(l,{C:()=>o});var g=i(65879),e=i(19347);let o=(()=>{class r{constructor(t){this.dialog=t,this.open=(s,n)=>this.dialog.open(s,n)}static#e=this.\u0275fac=function(s){return new(s||r)(g.LFG(e.uw))};static#t=this.\u0275prov=g.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})()},22749:(p,l,i)=>{i.d(l,{O:()=>h});var g=i(47496),e=i(65879),o=i(96814),r=i(40750);let h=(()=>{class t extends g.Q{static#e=this.\u0275fac=function(){let n;return function(a){return(n||(n=e.n5z(t)))(a||t)}}();static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["azt-dynamic-hook"]],inputs:{content:"content"},features:[e.qOj],decls:5,vars:9,consts:[[3,"innerHTML"]],template:function(_,a){1&_&&(e._UZ(0,"span",0),e.ALo(1,"safeContentQuestion"),e.ALo(2,"async"),e.ALo(3,"mathJaxContent"),e.ALo(4,"replaceHookMedia")),2&_&&e.Q6J("innerHTML",e.lcZ(1,1,e.lcZ(2,3,e.lcZ(3,5,e.lcZ(4,7,a.content)))),e.oJD)},dependencies:[o.Ov,r.Pc,r.ES,r.EA],encapsulation:2})}return t})()},70860:(p,l,i)=>{i.d(l,{W:()=>o,l:()=>e});var g=i(7468);class e{constructor(h,t,s,n){this.type=h,this.data=t,this.message=s,this.questionNumber=n}}class o{initService(){const h=new g.$(this.cdnService,this.commonService,this.configRenderService,(t,s)=>{this.callbackPushImage&&this.caller&&this.callbackPushImage.call(this.caller,t,s)},t=>{this.callbackFall&&this.caller&&this.callbackFall.call(this.caller,t)});h.isCropImage=this.configRenderService.getIsCropImage(),this.services.push(h)}render(h,t){return this.services.forEach(s=>{h=s.render(h??"",[],void 0,t)}),h??""}constructor(h,t,s,n){this.cdnService=h,this.commonService=t,this.configRenderService=s,this.callbackFall=n,this.services=[],this.initService()}}},43389:(p,l,i)=>{i.d(l,{l:()=>d});var g=i(47496),e=i(65879),o=i(96814),r=i(16007),h=i(40750);function t(c,m){if(1&c&&(e.O4$(),e.kcU(),e._UZ(0,"mat-progress-bar",10)),2&c){const u=e.oxw();e.Q6J("value",u.progress_value)}}function s(c,m){if(1&c&&(e.O4$(),e.kcU(),e.TgZ(0,"div",11),e._uU(1),e.qZA()),2&c){const u=e.oxw();e.xp6(1),e.Oqu(u.getMsg())}}function n(c,m){if(1&c){const u=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"div",12),e._uU(1),e.ALo(2,"mytranslate"),e.TgZ(3,"a",13),e.NdJ("click",function(){e.CHM(u);const f=e.oxw();return e.KtG(f.isShowErrorsBox=!f.isShowErrorsBox)}),e._uU(4),e.ALo(5,"mytranslate"),e.ALo(6,"mytranslate"),e.qZA()()}if(2&c){const u=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,2,"lang_auto_da_xay_ra_loi_trong_qua_trinh_trao_doi_du_lieu_")," "),e.xp6(3),e.hij(" ",u.isShowErrorsBox?e.lcZ(5,4,"lang_auto_an_chi_tiet"):e.lcZ(6,6,"lang_auto_xem_chi_tiet")," ")}}function _(c,m){if(1&c&&(e.O4$(),e.kcU(),e.TgZ(0,"div",12),e._uU(1),e.qZA()),2&c){const u=e.oxw();e.xp6(1),e.hij(" ",u.LogErrorsRequest," ")}}function a(c,m){if(1&c&&(e.O4$(),e.kcU(),e.TgZ(0,"div",14),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&c){const u=e.oxw();e.xp6(1),e.Oqu(u.customText?u.customText:e.lcZ(2,1,"lang_auto_dang_tai_du_lieu")+"...")}}let d=(()=>{class c extends g.Q{constructor(){super(...arguments),this.progress_value=-1,this.LogErrorsRequest=!1,this.customText="",this.isShowErrorsBox=!1}getMsg(){let u="";return 100==this.progress_value||0==this.progress_value?(u=this.commonService.myTranslateInstant("lang_auto_dang_xu_ly")??"",`${u} ...`):(u=this.commonService.myTranslateInstant("lang_auto_dang_tai_tep_tin_len_he_thong")??"",`${u}... ${this.progress_value} %`)}static#e=this.\u0275fac=function(){let u;return function(f){return(u||(u=e.n5z(c)))(f||c)}}();static#t=this.\u0275cmp=e.Xpm({type:c,selectors:[["azt-loading-effect"]],inputs:{progress_value:"progress_value",LogErrorsRequest:"LogErrorsRequest",customText:"customText"},features:[e.qOj],decls:12,vars:5,consts:[[1,"box-loading","h-full"],[1,"text-center","py-4"],["version","1.1","id","jobing-j-drawit","id","Layer_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","x","0px","y","0px","viewBox","0 0 109 92.9",0,"xml","space","preserve",1,"w-12","mx-auto",2,"enable-background","new 0 0 109 92.9"],["d","M90.8,52c3.5,6.2,7.1,11.7,9.8,17.7c4.4,9.7-2.9,20.7-13.8,20.9c-11.8,0.2-23.7,0.2-35.5,0 c-11-0.1-17.6-12.2-12-21.7c0.4-0.8,1.8-1.4,2.7-1.4c9.9-0.1,19.7-0.1,29.6-0.1c9.8,0,15.9-4.6,18.7-14C90.4,53.2,90.5,52.9,90.8,52 z",1,"azt-svg-loading","jobing-j"],["d","M39.6,90.3c-6.8,0-13.8,0.8-20.5-0.2c-9.7-1.4-15-12.8-10.3-21.3c5.9-10.9,12.1-21.6,18.5-32.2 c5.5-9,18.6-8.7,24.2,0.2c0.7,1.1,0.8,1.9,0.1,3.1C46.7,48.3,42,57,36.8,65.3c-5.3,8.4-3.8,18.8,2.5,24.6 C39.5,89.9,39.5,90.2,39.6,90.3z",1,"azt-svg-loading","jobing-j"],["d","M32.5,27.3c3.3-5.7,6.1-11,9.4-16c5.9-9.1,19.4-9.2,25.1,0c6.5,10.4,12.6,21,18.3,31.7 c4.8,9-1.5,19.9-11.5,20.7c-1.6,0.1-2.6-0.2-3.5-1.8c-4.8-8.6-9.8-17.1-14.7-25.6c-4.7-8.3-12.5-11.6-21.7-9.2 C33.6,27.1,33.3,27.1,32.5,27.3z",1,"azt-svg-loading","jobing-j"],["style","margin-bottom: 30px; border-radius: 5px","mode","buffer",3,"value",4,"ngIf"],["class","note text-center font-weight-bold",4,"ngIf","ngIfElse"],["class","alert alert-danger mt-3","role","alert",4,"ngIf"],["notLoading",""],["mode","buffer",2,"margin-bottom","30px","border-radius","5px",3,"value"],[1,"note","text-center","font-weight-bold"],["role","alert",1,"alert","alert-danger","mt-3"],["azt-track-service","loading-effect-5TYv52U-wgq","href","javscript:void(0)",3,"click"],[1,"note","text-center","font-medium"]],template:function(v,f){if(1&v&&(e.TgZ(0,"div",0)(1,"div",1),e.O4$(),e.TgZ(2,"svg",2),e._UZ(3,"path",3)(4,"path",4)(5,"path",5),e.qZA()(),e.YNc(6,t,1,1,"mat-progress-bar",6),e.YNc(7,s,2,1,"div",7),e.YNc(8,n,7,8,"div",8),e.YNc(9,_,2,1,"div",8),e.YNc(10,a,3,3,"ng-template",null,9,e.W1O),e.qZA()),2&v){const E=e.MAs(11);e.xp6(6),e.Q6J("ngIf",-1!=f.progress_value),e.xp6(1),e.Q6J("ngIf",-1!=f.progress_value)("ngIfElse",E),e.xp6(1),e.Q6J("ngIf",!1!==f.LogErrorsRequest),e.xp6(1),e.Q6J("ngIf",f.isShowErrorsBox)}},dependencies:[o.O5,r.pW,h.JV],encapsulation:2})}return c})()},60723:(p,l)=>{l.G=void 0,l.G=class g{static generateIdRequired(o){let r="";for(let s=0;s<o;s++)r+="abcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(36*Math.random()));return Math.floor(Date.now()/1e3)+r}}},65097:(p,l,i)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PartsParser=void 0;const g=i(49288),e=i(90957),o=i(39963),r=i(15647),h=i(42292),t=i(58446);class s{constructor(_){this.__idCssElement="qv_style_element",this.baseConfigEventListener=[],this.imgMaps=[],this.services=new Array;const a=this.__pushServices([new e.FirstPartService(this.baseConfigEventListener),new g.ImagePartService(this.baseConfigEventListener),new h.DocxImagePartService(this.baseConfigEventListener),new r.LibrariesPartService(this.baseConfigEventListener,_),new o.FindAnsPartService(this.baseConfigEventListener),new t.LatexPartService(this.baseConfigEventListener)]);this.__pushCss(a)}__pushCss(_){if(!document.getElementById(this.__idCssElement)&&document.head){const d=document.createElement("style");d.id=this.__idCssElement,d.innerHTML=_.replace(/  /g," ").replace(/\n/g," ").replace(/\t/g," "),document.head.appendChild(d)}}__pushServices(_){let a="";return _.forEach(d=>{d.outCss().forEach(m=>{a+=`.${m.className} { ${m.content} } \n`}),this.services.push(d)}),a}start(_){const a=document.createElement("div");return _.forEach(d=>{const c=document.createElement("p");c.classList.add("qv_line"),this.services.forEach(m=>{m.pushImages(this.imgMaps),d=m.parse(d)}),c.innerHTML=d.text||"",a.appendChild(c)}),0===a.innerText.indexOf(s.IgnoreChar)?a.innerText.replace(s.IgnoreChar,""):a.outerHTML}register(_){this.imgMaps=_}configEventListener(_){_.forEach(a=>{-1===this.baseConfigEventListener.findIndex(d=>d.eventName===a.eventName)&&this.baseConfigEventListener.push(a)})}doneRenderQuestions(){this.services.forEach(_=>{_.onEndAll()})}}l.PartsParser=s,s.IgnoreChar="{!ignore}"},94235:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.BaseCaller=void 0,l.BaseCaller=class i{getQuestion(e,o,r,h,t,s){return new Promise(n=>{n([])})}}},20926:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.BeautyImageCrop=void 0;class i{static getRGB(e,o,r,h){return{red:h[4*(r.width*o+e)],green:h[4*(r.width*o+e)+1],blue:h[4*(r.width*o+e)+2],opacity:h[4*(r.width*o+e)+3]}}static isEmpty(e){return 255==e.red&&255==e.green&&255==e.blue||0===e.opacity}static scanX(e,o,r){for(var h=e?1:-1,t=e?0:o.width-1;e?t<o.width:t>-1;t+=h)for(var s=0;s<o.height;s++)if(!i.isEmpty(i.getRGB(t,s,o,r.data)))return t;return 0}static scanY(e,o,r){for(var h=e?1:-1,t=e?0:o.height-1;e?t<o.height:t>-1;t+=h)for(var s=0;s<o.width;s++)if(!i.isEmpty(i.getRGB(s,t,o,r.data)))return t;return 0}static cropImage(e,o,r){const t=e.canvas,s=document.createElement("canvas"),n=s.getContext("2d");var _=i.scanY(!0,t,o)-5,a=i.scanY(!1,t,o)+5,d=i.scanX(!0,t,o)-5,c=i.scanX(!1,t,o)+5;r&&(r.top||(a=0),r.bottom||(a=t.height),r.left||r.right?(r.left||(a=0),r.right||(a=t.width)):c=t.width+d);var m=c-d,u=a-_;return s.width=m,s.height=u,n?.drawImage(t,d,_,m,u,0,0,m,u),s}static removeBg(e){const o=document.createElement("canvas"),r=o.getContext("2d");if(r){o.width=e.width,o.height=e.height,r.drawImage(e,0,0);for(var h=r.getImageData(0,0,o.width,o.height),t=h.data,s=0;s<t.length;s+=4)t[s]>=185&&t[s+1]>=185&&t[s+2]>=185&&(t[s+3]=0);r.putImageData(h,0,0)}return o}static cropCanvas(e,o){const r=e.getContext("2d");if(r){var h=r.getImageData(0,0,e.width,e.height);return i.cropImage(r,h,o)}return e}}l.BeautyImageCrop=i},23353:(p,l,i)=>{l.rj=void 0;i(94235);const o=i(20926);Object.defineProperty(l,"rj",{enumerable:!0,get:function(){return o.BeautyImageCrop}});i(65097)},42292:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.DocxImagePartService=void 0;class i{constructor(e){this.pattern_check=/@\[\]{"link":"[^"]+","data":{[^}]+}}@\[\]/i,this.images=[],this.indexImageLink=[],this.style=document.createElement("style"),this.baseConfigEventListener=e,document.head.appendChild(this.style)}parse(e){let h,o=0,r=e.text||"";for(;null!==(h=this.pattern_check.exec(r));){try{var t=JSON.parse(h[0].split("@[]")[1]);t.data={x:Math.floor(t.data.x),y:Math.floor(t.data.y),width:Math.floor(t.data.width),height:Math.floor(t.data.height)},this.indexImageLink.push(t.link),r=r.replace(this.pattern_check,`<div class="background_question_${this.indexImageLink.length-1}"><img width="1024" height="1024" src="${t.link}"></div>`),this.style.textContent+=`.background_question_${this.indexImageLink.length-1} {margin: 0 3px; width: ${t.data.width}px; height: ${t.data.height}px; display: inline-block;vertical-align: middle; overflow: hidden;} .background_question_${this.indexImageLink.length-1} img { margin-top: -${t.data.y}px; margin-left: -${t.data.x}px;}`}catch{r=r.replace(this.pattern_check,"")}o++>1e4&&(r="")}return Object.assign(Object.assign({},e),{text:r})}outCss(){return[]}pushImages(e){this.images=e}onEndAll(){}}l.DocxImagePartService=i,i.NAME_SERVICE="image_part:"},39963:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.FindAnsPartService=void 0,l.FindAnsPartService=class i{constructor(e){this.pattern_check=/\[[ABCDEFGHI]:[^\]]+\]/i,this.images=[],this.baseConfigEventListener=e}parse(e){let h,o=0,r=e.text||"";for(;null!==(h=this.pattern_check.exec(r));){const t=h[0].replace("[","").replace("]",""),s=t.substring(0,1),n=document.createElement("span");n.classList.add("qv_string_eng_ans"),n.innerHTML=s;const _=t.substring(2),a=document.createElement("span");a.classList.add("qv_string_eng"),a.innerHTML=_,a.appendChild(n),r=r.replace(this.pattern_check,a.outerHTML),o++>1e4&&(r="")}return Object.assign(Object.assign({},e),{text:r})}outCss(){return[{className:"qv_string_eng",content:"\n                    cursor: pointer;\n                    padding: 0 5px;\n                    font-weight: bold;\n                    text-decoration: underline;\n                    position: relative;\n                    height: 40px;\n                    display: inline-block;\n                "},{className:"qv_string_eng_ans",content:"\n                    position: absolute;\n                    top: 20px;\n                    left: 45%;\n                "}]}pushImages(e){this.images=e}onEndAll(){}}},90957:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.FirstPartService=void 0,l.FirstPartService=class i{constructor(e){this.images=[],this.baseConfigEventListener=e}parse(e){return Object.assign({},e)}outCss(){return[{className:"qv_line",content:"\n                    margin: 0 !important;\n                "},{className:"qv_qts_image",content:"\n                    width: 100%;\n                "},{className:"qv_ats_image",content:"\n                    width: 60%;\n                "}]}pushImages(e){this.images=e}onEndAll(){}}},49288:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.ImagePartService=void 0;class i{constructor(e){this.pattern_check=/\[!img:[afhci]+[\dABCDEFGHI]+\]/i,this.images=[],this.baseConfigEventListener=e}parse(e){let h,o=0,r=e.text||"";for(;null!==(h=this.pattern_check.exec(r));){const t=h[0].replace("[!img:","").replace("]",""),s=this.images.find(n=>n.id===t);if(s){const n=document.createElement("img");n.crossOrigin="anonymous",n.classList.add(0===t.indexOf("af")?"qv_full_a_img":0===t.indexOf("f")?"qv_full_img":"qv_img"),n.src=s.link,r=r.replace(this.pattern_check,n.outerHTML)}else{const n=document.createElement("span");n.innerHTML="(Th\xeam h\xecnh \u1ea3nh)",n.classList.add("qv_none_image"),r=r.replace(this.pattern_check,n.outerHTML)}o++>1e4&&(r="")}return Object.assign(Object.assign({},e),{text:r})}outCss(){return[{className:"qv_full_a_img",content:"\n                    cursor: pointer;\n                    width: 60%\n                "},{className:"qv_full_img",content:"\n                    cursor: pointer;\n                    width: 100%\n                "},{className:"qv_img",content:"\n                    cursor: pointer;\n                    height: 25px;\n                "},{className:"qv_none_image",content:"\n                    display: inline-block;\n                    color: #2262ae;\n                    cursor: pointer;\n                "}]}pushImages(e){this.images=e}onEndAll(){}}l.ImagePartService=i,i.NAME_SERVICE="image_part:"},58446:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.LatexPartService=void 0;class i{constructor(e){this.images=[],this.baseConfigEventListener=e}parse(e){let o=e.text||"";return Object.assign(Object.assign({},e),{text:o})}outCss(){return[]}pushImages(e){this.images=e}onEndAll(){}}l.LatexPartService=i,i.NAME_SERVICE="latex:"},15647:(p,l,i)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.LibrariesHelper=l.LibrariesPartService=void 0;const g=i(65097);class e{constructor(t,s){this.pattern_check=/^(\[@[CTG]\d+:[^\]]+\]\.)+((\[@Q\d+:[^\]]+\])|(\[[^@:]+\]))$/i,this.pattern_content=/\[(.*?)\]/i,this.images=[],this.baseConfigEventListener=[],this.baseConfigEventListener=t,this.cacheProcess=new r(s,this.baseConfigEventListener)}parse(t){let s=0,n=t.text||"";if(this.pattern_check.test(n)){let _=[];for(;null!==this.pattern_content.exec(n);){const c=this.pattern_content.exec(n);if(!c)break;_.push(c[1]),n=n.substring(0,c.index)+n.substring(c.index+c[0].length)}const a=o.convertStringToTypeObject(_),d={numberQuestion:1,path:a[0],useCache:!0};"Random"===a[0].type?("G"===a[1].type?(d.groupId=a[1].id,d.examId=a[2].id):(d.catId="C"===a[1].type?a[1].id:void 0,d.examId="T"===a[1].type?a[1].id:void 0,d.questionId="Q"===a[1].type?a[1].id:void 0),d.numberQuestion=a[0].id):d.questionId=a[0].id,n=g.PartsParser.IgnoreChar+this.cacheProcess.pushCaller(d),s++>1e4&&(n="")}return Object.assign(Object.assign({},t),{text:n})}outCss(){return[]}pushImages(t){this.images=t}onEndAll(){this.cacheProcess.startCaller()}}l.LibrariesPartService=e,e.NAME_SERVICE="libraries_part:";class o{static convertStringToTypeObject(t){const s=[];return t.forEach(n=>{let _=n.substring(1,2),a=Number(o.pattern_number.exec(n)),d="";if(o.char_types.includes(_)){let c=n.indexOf(":");-1!==c&&(d=n.substring(c))}else _="Random";s.push({name:d,id:a,type:_,content:n})}),s.reverse()}}l.LibrariesHelper=o,o.pattern_number=/\d+/i,o.char_types="CTGQH";class r{constructor(t,s){this.eventDoneKey=e.NAME_SERVICE+"done",this.cacheObjs=[],this.baseCaller=t,this.baseConfigEventListener=s}pushEventValue(){const t=this.baseConfigEventListener.filter(n=>0===n.eventName.indexOf(this.eventDoneKey));let s=[];t.forEach(n=>{const _=this.cacheObjs.filter(d=>"done"===d.step);n.func.call(n.caller,_)&&s.push(n.eventName)}),s.forEach(n=>{const _=this.baseConfigEventListener.findIndex(a=>a.eventName===n);-1!==_&&this.baseConfigEventListener.splice(_,1)})}pushCaller(t){const s=t.catId+"_"+t.examId+"_"+t.groupId+"_"+t.questionId+"_"+t.numberQuestion;var n=this.cacheObjs.find(_=>_.key===s);return n||this.cacheObjs.push(n={key:s,value:[],step:"init",pars:t,count:0}),n.count++,s+"_"+n?.count}startCaller(){this.cacheObjs.forEach(t=>{t.count=0,"init"===t.step?(t.step="call",this.baseCaller.getQuestion(t.pars.numberQuestion,t.pars.useCache,t.pars.catId,t.pars.examId,t.pars.questionId,t.pars.groupId).then(s=>{t.step="done",t.value=s,this.pushEventValue()})):"done"===t.step&&this.pushEventValue()})}}}}]);