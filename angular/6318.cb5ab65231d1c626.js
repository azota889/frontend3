"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[6318],{2433:(A,C,s)=>{s.d(C,{h:()=>I});var b=s(48891),j=s(85710),e=s(51698),f=s(88249),w=s(39444),T=s(53793);let I=(()=>{var g;class h{constructor(){this.subscriptions=new j.yU,this.aiElearningService=(0,b.WQX)(w.T5),this.commonService=(0,b.WQX)(T.R),this.mapCacheSubscribers$=new Map}getKnowledgeByApi(a,l,r,d){let u=this.getCacheKey(a,l,r,d),O=this.mapCacheSubscribers$.get(u);return O||(O=new e.c(v=>{this.subscriptions.add(this.commonService.wrapApiResponse(this.aiElearningService.aiApiV1ElearningGetKnowledgeTreeGet(a,l,r,d||void 0)).subscribe(p=>{if(!p.success)return this.mapCacheSubscribers$.set(u,null),v.next({errorMessage:p.message,data:void 0}),void v.complete();v.next({errorMessage:void 0,data:{objs:p.data?.nodes??[]}}),v.complete()}))}).pipe((0,f.t)(1)),this.mapCacheSubscribers$.set(u,O),O)}getObjByObjectiveId(a,l){for(var r of a){if(r.objectiveId==l)return r;let d=this.getObjByObjectiveId(r.children,l);if(null!=d)return d}}getObjById(a,l){for(var r of a){if(r.id==l)return r;let d=this.getObjById(r.children,l);if(null!=d)return d}}getObjByKnowledgeIdOrObjectiveId(a,l,r){for(var d of a){if(d.knowledgeId==l||d.objectiveId==r)return d;let u=this.getObjByKnowledgeIdOrObjectiveId(d.children,l,r);if(null!=u)return u}}getAllObjectiveObjs(a,l){return a.forEach(r=>{r.objectiveId&&l.push({id:r.objectiveId,name:r.title,questionHistories:[]}),r.children.length&&(l=l.concat(this.getAllObjectiveObjs(r.children,[])))}),l}getCacheKey(a,l,r,d){return`${a}_${l}_${r?"true":"false"}_${d??0}`}ngOnDestroy(){this.subscriptions.unsubscribe()}}return(g=h).\u0275fac=function(a){return new(a||g)},g.\u0275prov=b.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),h})()},36318:(A,C,s)=>{s.d(C,{G:()=>k});var b=s(89163),j=s(33887),e=s(48891),f=s(2915),w=s(32099),T=s(50334),I=s(2433),g=s(54460),h=s(15343),K=s(18718),a=s(76975);const l=t=>({nodeObjs:t}),r=(t,c)=>({"text-pending":t," link-color-hover":c});function d(t,c){if(1&t&&e.nrm(0,"azt-loading-effect",3),2&t){const o=e.XpG();e.Y8G("currentStatusObj",o.statusObj)}}function u(t,c){1&t&&e.eu8(0)}function O(t,c){if(1&t&&(e.j41(0,"table")(1,"tbody"),e.DNE(2,u,1,0,"ng-container",4),e.k0s()()),2&t){const o=e.XpG(),n=e.sdS(4);e.R7$(2),e.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",e.eq3(2,l,o.nodeObjs))}}function v(t,c){1&t&&e.nrm(0,"lucide-icon",13)}function p(t,c){1&t&&e.nrm(0,"lucide-icon",14)}function E(t,c){if(1&t&&(e.j41(0,"i"),e.DNE(1,v,1,0,"lucide-icon",11)(2,p,1,0,"lucide-icon",12),e.k0s()),2&t){const o=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",o.isExpand),e.R7$(),e.Y8G("ngIf",!o.isExpand)}}function F(t,c){1&t&&(e.j41(0,"i"),e.nrm(1,"lucide-icon",15),e.k0s())}function x(t,c){1&t&&e.eu8(0)}function D(t,c){if(1&t&&(e.qex(0),e.DNE(1,x,1,0,"ng-container",4),e.bVm()),2&t){const o=e.XpG().$implicit;e.XpG(3);const n=e.sdS(4);e.R7$(),e.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",e.eq3(2,l,o.children))}}function y(t,c){if(1&t){const o=e.RV6();e.qex(0),e.j41(1,"tr",7)(2,"td")(3,"div",8),e.bIt("click",function(){const i=e.eBV(o).$implicit,_=e.XpG(3);return e.Njj(_.clickToNode(i))}),e.DNE(4,E,3,2,"i",5)(5,F,2,0,"i",5),e.j41(6,"label",9),e.nrm(7,"span",10),e.nI1(8,"mathJaxContent"),e.nI1(9,"async"),e.nI1(10,"safeContentQuestion"),e.k0s()()()(),e.DNE(11,D,2,4,"ng-container",5),e.bVm()}if(2&t){const o=c.$implicit;e.R7$(),e.Y8G("hidden",!o.isShow),e.R7$(),e.xc7("padding-left",14*(o.level+1),"px"),e.R7$(),e.Y8G("ngClass",e.l_i(14,r,o.isSelected,!o.isSelected)),e.R7$(),e.Y8G("ngIf",o.children.length),e.R7$(),e.Y8G("ngIf",!o.children.length),e.R7$(2),e.Y8G("innerHTML",e.bMT(10,12,e.bMT(9,10,e.bMT(8,8,"L"+(o.level+1)+". "+o.text))),e.npT),e.R7$(4),e.Y8G("ngIf",o.isExpand)}}function Q(t,c){if(1&t&&(e.qex(0),e.DNE(1,y,12,17,"ng-container",6),e.bVm()),2&t){const o=c.$implicit;e.R7$(),e.Y8G("ngForOf",o)}}function $(t,c){if(1&t&&e.DNE(0,Q,2,1,"ng-container",5),2&t){const o=c.nodeObjs,n=e.XpG();e.Y8G("ngIf",n.asTemplateDataObj(o))}}let G=(()=>{var t;class c extends T.C{constructor(){super(...arguments),this.allowSelectKnowledgeOrObjective="only_objective",this.selectKnowledgeOrObjectiveEvent=new e.bkB,this.nodeObjs=[],this.sAztKnowledgeObjectiveService=(0,e.WQX)(I.h)}clickToNode(n){return"only_objective"==this.allowSelectKnowledgeOrObjective&&n.data.objectiveId||"knowledge_or_objective"==this.allowSelectKnowledgeOrObjective&&(n.data.knowledgeId||n.data.objectiveId)?this.selectKnowledgeOrObjectiveEvent.emit(n.data):void(n.isExpand?this.collapse(n):this.expand(n))}asTemplateDataObj(n){return n}initData(n,i,_){this.initStatusObj(),this.sAztKnowledgeObjectiveService.getKnowledgeByApi(n,i,!1,_).subscribe(m=>{if(m.errorMessage||!m.data)return this.errorStatusObj(m.errorMessage??"",!0);this.nodeObjs=this.standardTreeNodes(m.data.objs,0),this.stopStatusObj()})}standardTreeNodes(n,i){let _=[];return n.forEach(m=>{let S=!1;this.selectedObj?.knowledgeId&&m.knowledgeId==this.selectedObj.knowledgeId&&(S=!0),this.selectedObj?.objectiveId&&m.objectiveId==this.selectedObj.objectiveId&&(S=!0);let z={level:i,typeNode:m.objectiveId?"objective":"knowledge",isExpand:!0,isShow:!0,isSelected:S,text:m.title,data:{...m,children:[]},children:[]};z.children=this.standardTreeNodes(m.children,i+1),_.push(z)}),_}ngOnChanges(n){n.searchContent&&this.searchByText(this.searchContent??"")}ngOnInit(){super.ngOnInit(),this.initData(this.levelId,this.subjectId,this.bookId)}}return(t=c).\u0275fac=(()=>{let o;return function(i){return(o||(o=e.xGo(t)))(i||t)}})(),t.\u0275cmp=e.VBU({type:t,selectors:[["coazt-knowledge-objective-tree-for-common-question"]],inputs:{levelId:"levelId",subjectId:"subjectId",bookId:"bookId",selectedObj:"selectedObj",searchContent:"searchContent",allowSelectKnowledgeOrObjective:"allowSelectKnowledgeOrObjective"},outputs:{selectKnowledgeOrObjectiveEvent:"selectKnowledgeOrObjectiveEvent"},features:[e.Vt3,e.OA$],decls:5,vars:2,consts:[["doneLoading",""],["recursiveListTmpl",""],[3,"currentStatusObj",4,"ngIf","ngIfElse"],[3,"currentStatusObj"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"hidden"],[1,"clickable",3,"click","ngClass"],[1,"form-check-label",2,"line-height","1.5"],[3,"innerHTML"],["name","chevron-down","size","14",4,"ngIf"],["name","chevron-right","size","14",4,"ngIf"],["name","chevron-down","size","14"],["name","chevron-right","size","14"],["name","dot","size","14"]],template:function(n,i){if(1&n&&e.DNE(0,d,1,1,"azt-loading-effect",2)(1,O,3,4,"ng-template",null,0,e.C5r)(3,$,1,1,"ng-template",null,1,e.C5r),2&n){const _=e.sdS(2);e.Y8G("ngIf",i.statusObj.loading)("ngIfElse",_)}},dependencies:[g.YU,g.Sq,g.bT,g.T3,h.WGl,K.K,g.Jj,a.km,a.ep],encapsulation:2}),c})(),k=(()=>{var t;class c extends j._{searchByText(n){this.searchContent=n}selectKnowledgeOrObjective(n){this.dialogRef.close(n)}btnCloseDialog(){this.dialogRef.close(void 0)}constructor(n,i){super(i,n),this.dialogRef=n,this.data=i}}return(t=c).\u0275fac=function(n){return new(n||t)(e.rXU(b.CP,8),e.rXU(b.Vh,8))},t.\u0275cmp=e.VBU({type:t,selectors:[["coazt-knowledge-objective-dialog-for-common-question"]],features:[e.Vt3],decls:12,vars:14,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"box","p-3"],[1,"pb-3"],[3,"onSearch","isServerSearch","placeholder"],[3,"minHeight"],[3,"selectKnowledgeOrObjectiveEvent","levelId","subjectId","bookId","selectedObj","searchContent","allowSelectKnowledgeOrObjective"],[1,"text-right","border-t","border-slate-200","dark:border-darkmode-400","p-3"],[1,"btn","btn-secondary","w-24",3,"click"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"azt-search-box",4),e.nI1(5,"mytranslate"),e.bIt("onSearch",function(m){return i.searchByText(m.searchObj)}),e.k0s()(),e.j41(6,"azt-mat-dialog-content",5)(7,"coazt-knowledge-objective-tree-for-common-question",6),e.bIt("selectKnowledgeOrObjectiveEvent",function(m){return i.selectKnowledgeOrObjective(m)}),e.k0s()()(),e.j41(8,"div",7)(9,"button",8),e.bIt("click",function(){return i.btnCloseDialog()}),e.EFF(10),e.nI1(11,"mytranslate"),e.k0s()()()()),2&n&&(e.R7$(4),e.Y8G("isServerSearch",!1)("placeholder",e.bMT(5,10,"lang_common_search_by_name")),e.R7$(2),e.Y8G("minHeight","calc(var(--vh, 1vh) * 100 - 300px)"),e.R7$(),e.Y8G("levelId",i.data.levelId)("subjectId",i.data.subjectId)("bookId",i.data.bookId)("selectedObj",i.data.selectedObj)("searchContent",null==i.searchContent?null:i.searchContent.searchContent)("allowSelectKnowledgeOrObjective",i.data.allowSelectKnowledgeOrObjective),e.R7$(3),e.SpI(" ",e.bMT(11,12,"lang_button_close")," "))},dependencies:[f.U,w.W,G,a.wp],encapsulation:2}),c})()}}]);