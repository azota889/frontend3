(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[8056],{54284:(we,it,C)=>{"use strict";C.d(it,{h:()=>ut});var R=C(37734),$=C(61713),st=C(65879);let ut=(()=>{class t extends R.Q{constructor(){super(...arguments),this.limitSize=200,this.selectFile=yt=>{const lt=yt.target,Ot=lt.files;if(Ot){if(this.limitSize=this.limitSize>200?200:this.limitSize,Array.from(Ot).find(at=>(0,$.EO)(at.size)>=this.limitSize))return this.showErrorSnack(this.commonService.translateToKeyParam("lang_auto_vui_long_chon_tep_co_kich_thuoc_nho_hon",this.limitSize.toString(),"MB"));const Nt=[];Array.from(Ot).forEach(at=>{Nt.push(at)}),this.emitUploadToEditorComplete(Nt)}lt.value=""}}}return t.\u0275fac=function(){let ct;return function(lt){return(ct||(ct=st.n5z(t)))(lt||t)}}(),t.\u0275cmp=st.Xpm({type:t,selectors:[["ng-component"]],inputs:{fileType:"fileType",limitSize:"limitSize"},features:[st.qOj],decls:0,vars:0,template:function(yt,lt){},encapsulation:2}),t})()},18056:(we,it,C)=>{"use strict";C.r(it),C.d(it,{AzotaDigitalizeModule:()=>Vt});var R=C(96814),$=C(56223),st=C(12044),ut=C(42753),t=C(65879),ct=C(63061);const yt=["image"];function lt(s,b){1&s&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.qZA())}function Ot(s,b){if(1&s&&(t.TgZ(0,"div",8),t._uU(1),t.qZA()),2&s){const o=t.oxw();t.xp6(1),t.Oqu(o.loadImageErrorText)}}let Nt=(()=>{class s{constructor(){this.cropperOptions={},this.export=new t.vpe,this.ready=new t.vpe,this.isLoading=!0}ngOnInit(){}ngOnDestroy(){this.cropper&&(this.cropper.destroy(),this.cropper=null)}imageLoaded(o){this.loadError=!1;const p=o.target;this.imageElement=p,this.cropperOptions.checkCrossOrigin&&(p.crossOrigin="anonymous"),p.addEventListener("ready",()=>{this.ready.emit(!0),this.isLoading=!1,this.cropbox&&this.cropper.setCropBoxData(this.cropbox)});let u=NaN;if(this.settings){const{width:v,height:w}=this.settings;u=v/w}this.cropperOptions={aspectRatio:u,checkCrossOrigin:!0,...this.cropperOptions},this.cropper&&(this.cropper.destroy(),this.cropper=void 0),this.cropper=new ct(p,this.cropperOptions)}imageLoadError(o){this.loadError=!0,this.isLoading=!1}exportCanvas(o){const p=this.cropper.getImageData(),u=this.cropper.getCropBoxData(),v=this.cropper.getCroppedCanvas(),w={imageData:p,cropData:u};new Promise(I=>{if(o)return I({dataUrl:v.toDataURL("image/png")});v.toBlob(J=>I({blob:J}))}).then(I=>{this.export.emit({...w,...I})})}}return s.\u0275fac=function(o){return new(o||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["angular-cropper"]],viewQuery:function(o,p){if(1&o&&t.Gf(yt,7),2&o){let u;t.iGM(u=t.CRH())&&(p.image=u.first)}},inputs:{imageUrl:"imageUrl",settings:"settings",cropbox:"cropbox",loadImageErrorText:"loadImageErrorText",cropperOptions:"cropperOptions"},outputs:{export:"export",ready:"ready"},decls:6,vars:3,consts:[[1,"cropper-wrapper"],["class","loading-block",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"cropper"],["alt","image",3,"src","load","error"],["image",""],[1,"loading-block"],[1,"spinner"],[1,"alert","alert-warning"]],template:function(o,p){1&o&&(t.TgZ(0,"div",0),t.YNc(1,lt,2,0,"div",1),t.YNc(2,Ot,2,1,"div",2),t.TgZ(3,"div",3)(4,"img",4,5),t.NdJ("load",function(v){return p.imageLoaded(v)})("error",function(v){return p.imageLoadError(v)}),t.qZA()()()),2&o&&(t.xp6(1),t.Q6J("ngIf",p.isLoading),t.xp6(1),t.Q6J("ngIf",p.loadError),t.xp6(2),t.Q6J("src",p.imageUrl,t.LSH))},dependencies:[R.O5],styles:[':host{display:block}.cropper img{max-width:100%;max-height:100%;height:auto}.cropper-wrapper{position:relative;min-height:80px}.cropper-wrapper .loading-block{position:absolute;top:0;left:0;width:100%;height:100%}.cropper-wrapper .loading-block .spinner{width:31px;height:31px;margin:0 auto;border:2px solid rgba(97,100,193,.98);border-radius:50%;border-left-color:transparent;border-right-color:transparent;-webkit-animation:cssload-spin 425ms infinite linear;position:absolute;top:calc(50% - 15px);left:calc(50% - 15px);animation:cssload-spin 425ms infinite linear}@keyframes cssload-spin{to{transform:rotate(360deg)}}/*!\n * Cropper.js v1.4.1\n * https://fengyuanchen.github.io/cropperjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2018-07-15T09:54:43.167Z\n */.cropper-container{direction:ltr;font-size:0;line-height:0;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.cropper-container img{display:block;height:100%;image-orientation:0deg;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;width:100%}.cropper-wrap-box,.cropper-canvas,.cropper-drag-box,.cropper-crop-box,.cropper-modal{inset:0;position:absolute}.cropper-wrap-box,.cropper-canvas{overflow:hidden}.cropper-drag-box{background-color:#fff;opacity:0}.cropper-modal{background-color:#000;opacity:.5}.cropper-view-box{display:block;height:100%;outline-color:#3399ffbf;outline:1px solid #39f;overflow:hidden;width:100%}.cropper-dashed{border:0 dashed #eee;display:block;opacity:.5;position:absolute}.cropper-dashed.dashed-h{border-bottom-width:1px;border-top-width:1px;height:calc(100% / 3);left:0;top:calc(100% / 3);width:100%}.cropper-dashed.dashed-v{border-left-width:1px;border-right-width:1px;height:100%;left:calc(100% / 3);top:0;width:calc(100% / 3)}.cropper-center{display:block;height:0;left:50%;opacity:.75;position:absolute;top:50%;width:0}.cropper-center:before,.cropper-center:after{background-color:#eee;content:" ";display:block;position:absolute}.cropper-center:before{height:1px;left:-3px;top:0;width:7px}.cropper-center:after{height:7px;left:0;top:-3px;width:1px}.cropper-face,.cropper-line,.cropper-point{display:block;height:100%;opacity:.1;position:absolute;width:100%}.cropper-face{background-color:#fff;left:0;top:0}.cropper-line{background-color:#39f}.cropper-line.line-e{cursor:ew-resize;right:-3px;top:0;width:5px}.cropper-line.line-n{cursor:ns-resize;height:5px;left:0;top:-3px}.cropper-line.line-w{cursor:ew-resize;left:-3px;top:0;width:5px}.cropper-line.line-s{bottom:-3px;cursor:ns-resize;height:5px;left:0}.cropper-point{background-color:#39f;height:5px;opacity:.75;width:5px}.cropper-point.point-e{cursor:ew-resize;margin-top:-3px;right:-3px;top:50%}.cropper-point.point-n{cursor:ns-resize;left:50%;margin-left:-3px;top:-3px}.cropper-point.point-w{cursor:ew-resize;left:-3px;margin-top:-3px;top:50%}.cropper-point.point-s{bottom:-3px;cursor:s-resize;left:50%;margin-left:-3px}.cropper-point.point-ne{cursor:nesw-resize;right:-3px;top:-3px}.cropper-point.point-nw{cursor:nwse-resize;left:-3px;top:-3px}.cropper-point.point-sw{bottom:-3px;cursor:nesw-resize;left:-3px}.cropper-point.point-se{bottom:-3px;cursor:nwse-resize;height:20px;opacity:1;right:-3px;width:20px}@media (min-width: 768px){.cropper-point.point-se{height:15px;width:15px}}@media (min-width: 992px){.cropper-point.point-se{height:10px;width:10px}}@media (min-width: 1200px){.cropper-point.point-se{height:5px;opacity:.75;width:5px}}.cropper-point.point-se:before{background-color:#39f;bottom:-50%;content:" ";display:block;height:200%;opacity:0;position:absolute;right:-50%;width:200%}.cropper-invisible{opacity:0}.cropper-bg{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC)}.cropper-hide{display:block;height:0;position:absolute;width:0}.cropper-hidden{display:none!important}.cropper-move{cursor:move}.cropper-crop{cursor:crosshair}.cropper-disabled .cropper-drag-box,.cropper-disabled .cropper-face,.cropper-disabled .cropper-line,.cropper-disabled .cropper-point{cursor:not-allowed}\n'],encapsulation:2}),s})(),at=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[R.ez]}),s})();var X=C(37722),jt=C(60381),At=C(95545),S=C(56731),Pt=C(84155),$t=C(78217),qt=C(24090),Lt=C(20553),pt=C(82481),W=C(37734),q=C(49671),ot=C(47394),L=C(36727),Dt=C(46558),zt=C(9e4);let mt=(()=>{class s{constructor(){this.subscriptions=new ot.w0,this.ocrService=(0,t.f3M)(zt.Kx),this.commonService=(0,t.f3M)(Dt.z)}digitalizeData(o,p,u,v){if(!o.image.url)return v(o);p("lang_digitalize_call_ocr_api"),this.subscriptions.add(this.ocrService.aiApiV1OcrImageToTextPost({imageUrl:o.image.url}).subscribe({next:w=>{p("lang_digitalize_load_detect_image_script"),this.loadScriptHandleImage(()=>{p("lang_digitalize_call_detect_image_function"),this.imageUtils.detectImage(o.image.fileBytes).then(D=>{o.image.base64Images=D.images.map(J=>({base64:this.uint8ArrayToBase64(new Uint8Array(J.content)),width:J.width,height:J.height,extension:J.extension}));let I=(new L.$e).transform((new L.h8).transform(w.data));I=this.commonService.convertLatexTagToDollarDollar(I),I=this.commonService.replaceAll(I,"<table>","<table class='table table-bordered'>")??I,o.htmlResult=I,v(o)}).catch(D=>u("lang_digitalize_error_when_call_detect_image"))})},error:w=>u(w.error.message)}))}uint8ArrayToBase64(o){let p="";const u=o.byteLength;for(let v=0;v<u;v++)p+=String.fromCharCode(o[v]);return btoa(p)}waitAnswerSheetInitDone(o){if(window.azotaScanAnswerSheet)return o();setTimeout(()=>{this.waitAnswerSheetInitDone(o)},100)}loadScriptHandleImage(o){var p=this;if(this.imageUtils)return o();this.commonService.loadAnswerSheetJs().then((0,q.Z)(function*(){p.waitAnswerSheetInitDone((0,q.Z)(function*(){p.imageUtils=yield window.azotaScanAnswerSheet.imageUtils(),o()}))})).catch(u=>{this.commonService.snackError("lang_auto_tai_thu_vien_that_bao_vui_long_load_lai_trang_de_thu_lai"),o()})}ngOnDestroy(){this.subscriptions.unsubscribe()}}return s.\u0275fac=function(o){return new(o||s)},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var F=function(s){return s[s.NONE=0]="NONE",s[s.PROCESSING=1]="PROCESSING",s[s.PROCESS_ERROR=2]="PROCESS_ERROR",s[s.PROCESSED=3]="PROCESSED",s}(F||{}),ft=function(s){return s[s.CHOOSE_IMAGES=0]="CHOOSE_IMAGES",s[s.PROCESS_IMAGES=1]="PROCESS_IMAGES",s}(ft||{}),U=C(43389),te=C(98129),Ce=C(61713),vt=C(63120),Zt=C(77757),Et=C(2459),kt=C(9769),Ut=C(26306),ee=C(22096),Ht=C(37398),Ft=C(69732),Bt=C(79360);const Jt=(s,b)=>(s.push(b),s);let ye=(()=>{class s{processObservables(o,p){return(0,Et.D)(p).pipe((0,kt.z)((u,v)=>u.pipe((0,Ut.K)(w=>(console.error("Error in observable:",w),(0,ee.of)(null))),(0,Ht.U)(w=>({result:w,index:v}))),o),function ie(){return(0,Bt.e)((s,b)=>{(function Yt(s,b){return(0,Bt.e)((0,Ft.U)(s,b,arguments.length>=2,!1,!0))})(Jt,[])(s).subscribe(b)})}(),(0,Ht.U)(u=>u.sort((v,w)=>v.index-w.index).map(v=>v.result)))}}return s.\u0275fac=function(o){return new(o||s)},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var Oe=C(84672),Ae=C(54284),ae=C(7827);const oe=["*"];let re=(()=>{class s extends Ae.h{constructor(){super(...arguments),this.emitFiles=new t.vpe}emitUploadToEditorComplete(o){o.length>0&&this.emitFiles.emit(o)}onDrop(o){try{this.emitFiles.emit(o)}catch(p){alert(p)}}}return s.\u0275fac=function(){let b;return function(p){return(b||(b=t.n5z(s)))(p||s)}}(),s.\u0275cmp=t.Xpm({type:s,selectors:[["azt-upload-multiple-document-to-editor"]],outputs:{emitFiles:"emitFiles"},features:[t.qOj],ngContentSelectors:oe,decls:5,vars:2,consts:[[1,"upload-document","h-full",3,"appDropZone","click"],[3,"hidden"],["type","file","multiple","",1,"form-control","file-input",3,"accept","change"],["fileSelect",""]],template:function(o,p){if(1&o){const u=t.EpF();t.F$t(),t.TgZ(0,"div",0),t.NdJ("appDropZone",function(w){return p.onDrop(w)})("click",function(){t.CHM(u);const w=t.MAs(3);return t.KtG(w.click())}),t.TgZ(1,"form",1)(2,"input",2,3),t.NdJ("change",function(w){return p.selectFile(w)}),t.qZA()(),t.Hsn(4),t.qZA()}2&o&&(t.xp6(1),t.Q6J("hidden",!0),t.xp6(1),t.s9C("accept",p.fileType))},dependencies:[$._Y,$.JL,$.F,ae.i],encapsulation:2}),s})();function ne(s,b){if(1&s&&t._UZ(0,"azt-loading-effect",2),2&s){const o=t.oxw();t.Q6J("currentStatusObj",o.statusObj)("customText",o.statusObj.errorMessage)}}const se=function(s,b){return[s,b]};function ce(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"azt-upload-multiple-document-to-editor",3),t.NdJ("emitFiles",function(u){t.CHM(o);const v=t.oxw();return t.KtG(v.handleUploadComplete(u))}),t.TgZ(1,"a",4),t.O4$(),t.TgZ(2,"svg",5),t._UZ(3,"line",6)(4,"line",7),t.qZA(),t.kcU(),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"mytranslate"),t.qZA()()()}if(2&s){const o=t.oxw();t.Q6J("fileType",t.WLB(4,se,o.allUploadFileTypes.PDF,o.allUploadFileTypes.IMAGE)),t.xp6(6),t.Oqu(t.lcZ(7,2,"lang_digitalize_book_upload_file"))}}let Qt=(()=>{class s extends W.Q{handleUploadComplete(o){this.initStatusObj("lang_digitalize_convert_pdf_to_images"),this.convertAllPdfToImages(o).then(p=>{let u=[];p.forEach(v=>{let w=this.apiUploadService.commonUploadFile(this.allUploadToCdnMenuTypes.ADMIN_DIGITALIZE,v,"");u.push(w)}),this.initStatusObj("lang_digitalize_upload_images_to_cdn"),this.sAztConcurrencyApiService.processObservables(this.uploadThread,u).subscribe(v=>{if(v.find(Y=>!Y?.success))return this.errorStatusObj("lang_digitalize_book_upload_file_error",!0);let D=[],I=v.map(Y=>Y?.data).filter(this.commonService.notEmpty),J=p.map(Y=>this.convertFileToUint8Array(Y));this.initStatusObj("lang_digitalize_convert_file_to_byte_array"),Promise.all(J).then(Y=>{I.forEach((_e,Kt)=>{let be=this.commonService.getItemAtIndexOfArray(Y,Kt);if(null==be)throw Error("lang_digitalize_missing_file_byte_array");D.push({..._e,fileBytes:be,base64Images:[]})}),this.stopStatusObj(),this.uploadData.emit(D)}).catch(Y=>console.error("lang_digitalize_convert_to_uint8_array_error: ",Y))})})}convertAllPdfToImages(o){var p=this;let u=[];return o.forEach(v=>{if((0,Ce.Or)(v.type))return void u.push(new Promise(function(){var D=(0,q.Z)(function*(I,J){I([v])});return function(I,J){return D.apply(this,arguments)}}()));let w=new Promise(function(){var D=(0,q.Z)(function*(I,J){let Y=[],Kt=yield p.withTimeout(p.myPdfService.getImageWithPdf(v),3e5);Y.push(...Kt),I(Y)});return function(I,J){return D.apply(this,arguments)}}());u.push(w)}),new Promise(function(){var v=(0,q.Z)(function*(w,D){Promise.all(u).then(I=>{w(p.commonService.concatMultipleArray(I))}).catch(I=>{p.showErrorSnack("lang_azt_pdf_invalid_format"),w([])})});return function(w,D){return v.apply(this,arguments)}}())}withTimeout(o,p){return new Promise((u,v)=>{const w=setTimeout(()=>{v(new Error("Operation timed out"))},p);o.then(D=>{clearTimeout(w),u(D)}).catch(D=>{clearTimeout(w),v(D)})})}convertFileToUint8Array(o){return new Promise((p,u)=>{const v=new FileReader;v.onload=()=>{if(v.result instanceof ArrayBuffer){const w=new Uint8Array(v.result);p(w)}else u(new Error("Error reading file as ArrayBuffer."))},v.onerror=()=>{u(new Error("Error reading file."))},v.readAsArrayBuffer(o)})}ngOnInit(){super.ngOnInit()}constructor(o,p,u){super(),this.myPdfService=o,this.sAztConcurrencyApiService=p,this.apiUploadService=u,this.uploadData=new t.vpe,this.allUploadToCdnMenuTypes=vt.j6,this.allUploadFileTypes=vt.AZ,this.uploadThread=10}}return s.\u0275fac=function(o){return new(o||s)(t.Y36(Zt.z),t.Y36(ye),t.Y36(Oe.W))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-digitalize-pdf-to-images"]],outputs:{uploadData:"uploadData"},features:[t.qOj],decls:3,vars:2,consts:[[3,"currentStatusObj","customText",4,"ngIf","ngIfElse"],["doneLoading",""],[3,"currentStatusObj","customText"],[3,"fileType","emitFiles"],[1,"btn","btn-primary-soft","w-full"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2"],["x1","12","y1","5","x2","12","y2","19"],["x1","5","y1","12","x2","19","y2","12"]],template:function(o,p){if(1&o&&(t.YNc(0,ne,1,2,"azt-loading-effect",0),t.YNc(1,ce,8,7,"ng-template",null,1,t.W1O)),2&o){const u=t.MAs(2);t.Q6J("ngIf",p.statusObj.loading)("ngIfElse",u)}},dependencies:[R.O5,U.l,re,L.JV],encapsulation:2}),s})();const le=function(s){return{"mb-2":s}},De=function(s){return{"border-pending":s}};function ze(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"div",4)(1,"span",5),t._uU(2),t.qZA(),t.TgZ(3,"img",6),t.NdJ("click",function(){const v=t.CHM(o).$implicit,w=t.oxw();return t.KtG(w.chooseImageEvent(v))}),t.qZA()()}if(2&s){const o=b.$implicit,p=b.last,u=t.oxw();t.Q6J("ngClass",t.VKq(4,le,!p)),t.xp6(2),t.Oqu(o.position),t.xp6(1),t.Q6J("src",o.image.url,t.LSH)("ngClass",t.VKq(6,De,u.listSelectedPositions.includes(o.position)))}}let Ee=(()=>{class s extends W.Q{chooseImageEvent(o){let p=this.objs.find(u=>u.position==o.position);p&&(p.isSelected=!p.isSelected,this.listSelectedPositions=this.objs.filter(u=>u.isSelected).map(u=>u.position),this.chooseImages.emit(this.objs.filter(u=>u.isSelected)))}ngOnInit(){super.ngOnInit(),this.listSelectedPositions=this.objs.filter(o=>o.isSelected).map(o=>o.position)}constructor(){super(),this.chooseImages=new t.vpe,this.listSelectedPositions=[]}}return s.\u0275fac=function(o){return new(o||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-digitalize-choose-images"]],inputs:{objs:"objs"},outputs:{chooseImages:"chooseImages"},features:[t.qOj],decls:6,vars:6,consts:[[2,"height","60vh","margin-bottom","30px"],[1,"pb-2"],["track","vertical","pointerEventsMethod","scrollbar",1,"w-full",3,"visibility"],["class","relative",3,"ngClass",4,"ngFor","ngForOf"],[1,"relative",3,"ngClass"],[1,"text-pending","font-medium","absolute","right-0","mr-2","pt-1"],[1,"w-full","clickable","mb-1","border-gray",3,"src","ngClass","click"]],template:function(o,p){1&o&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"ng-scrollbar",2),t.YNc(5,ze,4,8,"div",3),t.qZA()()),2&o&&(t.xp6(2),t.AsE("",t.lcZ(3,4,"lang_digitalize_book_total_page"),": ",p.objs.length,""),t.xp6(2),t.Q6J("visibility","hover"),t.xp6(1),t.Q6J("ngForOf",p.objs))},dependencies:[R.mk,R.sg,At.KC,L.JV],encapsulation:2}),s})();const Se=function(s){return{"mb-2":s}},pe=function(s){return{"border-pending":s}};function he(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"div",4)(1,"span",5),t._uU(2),t.qZA(),t.TgZ(3,"img",6),t.NdJ("click",function(){const v=t.CHM(o).$implicit,w=t.oxw();return t.KtG(w.processImage.emit(v))}),t.qZA()()}if(2&s){const o=b.$implicit,p=b.last,u=t.oxw();t.Q6J("ngClass",t.VKq(4,Se,!p)),t.xp6(2),t.Oqu(o.position),t.xp6(1),t.Q6J("src",o.image.url,t.LSH)("ngClass",t.VKq(6,pe,(null==u.currentObj?null:u.currentObj.position)==o.position))}}let de=(()=>{class s extends W.Q{ngOnInit(){super.ngOnInit(),this.viewObjs=this.objs.filter(o=>o.isSelected)}constructor(){super(),this.processImage=new t.vpe,this.viewObjs=[]}}return s.\u0275fac=function(o){return new(o||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-digitalize-process-images"]],inputs:{objs:"objs",currentObj:"currentObj"},outputs:{processImage:"processImage"},features:[t.qOj],decls:6,vars:6,consts:[[2,"height","60vh","margin-bottom","30px"],[1,"pb-2"],["track","vertical","pointerEventsMethod","scrollbar",1,"w-full",3,"visibility"],["class","relative",3,"ngClass",4,"ngFor","ngForOf"],[1,"relative",3,"ngClass"],[1,"text-pending","font-medium","absolute","right-0","mr-2","pt-1"],[1,"w-full","clickable","mb-1","border-gray",3,"src","ngClass","click"]],template:function(o,p){1&o&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.TgZ(4,"ng-scrollbar",2),t.YNc(5,he,4,8,"div",3),t.qZA()()),2&o&&(t.xp6(2),t.AsE("",t.lcZ(3,4,"lang_digitalize_book_total_page"),": ",p.viewObjs.length,""),t.xp6(2),t.Q6J("visibility","hover"),t.xp6(1),t.Q6J("ngForOf",p.viewObjs))},dependencies:[R.mk,R.sg,At.KC,L.JV],encapsulation:2}),s})();var Te=C(2783),Ie=C(28368),y=C(19347),ge=C(72164);const Xt=["angularCropper"];function ht(s,b){if(1&s){const o=t.EpF();t.ynx(0),t.TgZ(1,"img",9),t.NdJ("click",function(){const v=t.CHM(o).$implicit,w=t.oxw(2);return t.KtG(w.chooseImage(v))}),t.ALo(2,"addBase64Extension"),t.qZA(),t.BQk()}if(2&s){const o=b.$implicit;t.xp6(1),t.s9C("src",t.xi3(2,1,o.base64,"png"),t.LSH)}}function Me(s,b){if(1&s&&(t.TgZ(0,"div",7),t.YNc(1,ht,3,4,"ng-container",8),t.qZA()),2&s){const o=t.oxw();t.xp6(1),t.Q6J("ngForOf",o.base64Images)}}function _t(s,b){if(1&s&&(t._UZ(0,"angular-cropper",10,11),t.ALo(2,"addBase64Extension")),2&s){const o=t.oxw();t.Q6J("cropperOptions",o.cropperOptions)("imageUrl",t.xi3(2,2,o.currentBase64Image.base64,"png"))}}let H=(()=>{class s extends ge.e{chooseImage(o){this.currentBase64Image=o}cropImage(){this.angularCropper?.cropper.getCroppedCanvas().toBlob(o=>{o&&this.commonService.convertBlobToBase64(o,p=>{let u=this.angularCropper?.cropper.getCropBoxData(),v=u?.width,w=u?.height;!v||!w||this.base64Images.push({position:this.base64Images.length,base64:p,width:v,height:w,extension:"png"})})})}closeDialog(){this.dialogRef.close(this.base64Images)}constructor(o,p){super(p,o),this.dialogRef=o,this.data=p,this.base64Images=[],this.cropperOptions={movable:!0,scalable:!1,zoomable:!1,data:{width:240,height:90}},this.base64Images=p.base64Images,this.currentBase64Image=this.commonService.getFirstOfArray(this.base64Images)}}return s.\u0275fac=function(o){return new(o||s)(t.Y36(y.so,8),t.Y36(y.WI,8))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-coazt-image-editor"]],viewQuery:function(o,p){if(1&o&&t.Gf(Xt,5),2&o){let u;t.iGM(u=t.CRH())&&(p.angularCropper=u.first)}},features:[t.qOj],decls:11,vars:8,consts:[[1,"box","p-3"],["class","list-base640-images mb-3",4,"ngIf"],[1,"text-center","mb-3"],[1,"btn","btn-primary","mr-2","w-32",3,"click"],[1,"btn","btn-secondary","mr-2","w-32",3,"click"],[2,"height","calc(100vh - 120px)","overflow-x","hidden","overflow-y","scroll"],[3,"cropperOptions","imageUrl",4,"ngIf"],[1,"list-base640-images","mb-3"],[4,"ngFor","ngForOf"],[1,"box","mr-2","mb-2","clickable",3,"src","click"],[3,"cropperOptions","imageUrl"],["angularCropper",""]],template:function(o,p){1&o&&(t.TgZ(0,"div",0),t.YNc(1,Me,2,1,"div",1),t.TgZ(2,"div",2)(3,"span",3),t.NdJ("click",function(){return p.cropImage()}),t._uU(4),t.ALo(5,"mytranslate"),t.qZA(),t.TgZ(6,"span",4),t.NdJ("click",function(){return p.closeDialog()}),t._uU(7),t.ALo(8,"mytranslate"),t.qZA()(),t.TgZ(9,"div",5),t.YNc(10,_t,3,5,"angular-cropper",6),t.qZA()()),2&o&&(t.xp6(1),t.Q6J("ngIf",p.base64Images.length>0),t.xp6(3),t.Oqu(t.lcZ(5,4,"lang_button_crop")),t.xp6(3),t.Oqu(t.lcZ(8,6,"lang_button_close")),t.xp6(3),t.Q6J("ngIf",p.currentBase64Image))},dependencies:[R.sg,R.O5,Nt,L.JV,L.WF],styles:[".list-base640-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ccc;height:50px;width:50px}"]}),s})();function Ne(s,b){if(1&s){const o=t.EpF();t.ynx(0),t.TgZ(1,"img",11),t.NdJ("click",function(){const v=t.CHM(o).$implicit,w=t.oxw(2);return t.KtG(w.chooseImage(v))}),t.ALo(2,"addBase64Extension"),t.qZA(),t.BQk()}if(2&s){const o=b.$implicit;t.xp6(1),t.s9C("src",t.xi3(2,1,o.base64,o.extension),t.LSH)}}function ue(s,b){if(1&s&&(t.TgZ(0,"div",9),t.YNc(1,Ne,3,4,"ng-container",10),t.qZA()),2&s){const o=t.oxw();t.xp6(1),t.Q6J("ngForOf",o.obj.image.base64Images)}}let N=(()=>{class s extends W.Q{constructor(){super(...arguments),this.changeObj=new t.vpe,this.sAztDialogService=(0,t.f3M)(Te.C),this.tinyMceService=(0,t.f3M)(Ie.y),this.sAztDigitalizeService=(0,t.f3M)(mt),this.htmlFormControl=new $.NI("",{nonNullable:!0}),this.initDataEditor={},this.tinyEditorKey=Lt.N.tinyEditorKey,this.showTinyMceEditor=!1}chooseImage(o){this.obj.htmlResult=this.obj.htmlResult.replace("<img>",`<img src='${this.commonService.generateBase64Prefix(o.extension)+o.base64}'/>`),this.htmlFormControl.setValue(this.obj.htmlResult)}cropImageDialog(){let o=[{position:-1,base64:this.sAztDigitalizeService.uint8ArrayToBase64(new Uint8Array(this.obj.image.fileBytes)),width:100,height:100,extension:"png"}],p=this.obj.image.base64Images.map((v,w)=>({...v,position:w}));o=o.concat(p),this.sAztDialogService.open(H,{data:{base64Images:o},restoreFocus:!1,width:"100vw",maxWidth:"100vw",height:"100vh",backdropClass:"azt-backdrop-full-width-height",disableClose:!0}).afterClosed().subscribe(v=>{null!=v&&(this.obj.image.base64Images=v.slice(1),this.changeObj.emit(this.obj))})}ngOnChanges(){this.htmlFormControl.setValue(this.obj.htmlResult)}ngOnInit(){this.htmlFormControl.setValue(this.obj.htmlResult),this.htmlFormControl.valueChanges.subscribe(()=>{this.obj.htmlResult=this.htmlFormControl.getRawValue(),this.changeObj.emit(this.obj)}),this.initDataEditor=this.tinyMceService.initConfigForAdminForDigitalized(vt.j6.ADMIN)}}return s.\u0275fac=function(){let b;return function(p){return(b||(b=t.n5z(s)))(p||s)}}(),s.\u0275cmp=t.Xpm({type:s,selectors:[["app-digitalize-preview-result"]],inputs:{obj:"obj"},outputs:{changeObj:"changeObj"},features:[t.qOj,t.TTD],decls:14,vars:15,consts:[["class","box p-3 mb-3 list-base640-images",4,"ngIf"],[1,"mb-3"],[1,"btn","btn-primary","w-32",3,"click"],[1,"grid","grid-cols-12","gap-5"],[1,"col-span-12"],[1,"box","p-3"],[3,"formControl","apiKey","init"],[1,"mt-8","mb-8"],[3,"innerHTML"],[1,"box","p-3","mb-3","list-base640-images"],[4,"ngFor","ngForOf"],[1,"box","mr-2","mb-2","clickable",3,"src","click"]],template:function(o,p){1&o&&(t.YNc(0,ue,2,1,"div",0),t.TgZ(1,"div",1)(2,"span",2),t.NdJ("click",function(){return p.cropImageDialog()}),t._uU(3),t.ALo(4,"mytranslate"),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4)(7,"div",5),t._UZ(8,"editor",6)(9,"hr",7)(10,"div",8),t.ALo(11,"safeNormalHtmlContent"),t.ALo(12,"async"),t.ALo(13,"mathJaxContent"),t.qZA()()()),2&o&&(t.Q6J("ngIf",p.obj.image.base64Images.length>0),t.xp6(3),t.Oqu(t.lcZ(4,7,"lang_button_crop")),t.xp6(5),t.s9C("apiKey",p.tinyEditorKey),t.Q6J("formControl",p.htmlFormControl)("init",p.initDataEditor),t.uIk("style","width: 100%;min-height:500px;",t.Ckj),t.xp6(2),t.Q6J("innerHTML",t.lcZ(11,9,t.lcZ(12,11,t.lcZ(13,13,p.obj.htmlResult))),t.oJD))},dependencies:[R.sg,R.O5,$.JJ,ut.PG,$.oH,R.Ov,L.JV,L.Pc,L.fF,L.WF],styles:[".list-base640-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ccc;width:200px}"]}),s})();function T(s,b){if(1&s&&t._UZ(0,"azt-loading-effect",4),2&s){const o=t.oxw();t.Q6J("currentStatusObj",o.statusObj)}}function ke(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"app-digitalize-pdf-to-images",16),t.NdJ("uploadData",function(u){t.CHM(o);const v=t.oxw(2);return t.KtG(v.uploadData(u))}),t.qZA()}}function bt(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"div",17),t.NdJ("click",function(){t.CHM(o);const u=t.oxw(2);return t.KtG(u.showChooseLayout())}),t._uU(1),t.ALo(2,"mytranslate"),t.qZA()}2&s&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"lang_digitalize_book_go_back_choose_layout")))}function Be(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"app-digitalize-choose-images",21),t.NdJ("chooseImages",function(u){t.CHM(o);const v=t.oxw(3);return t.KtG(v.chooseImages(u))}),t.qZA()}if(2&s){const o=t.oxw(3);t.Q6J("objs",o.objs)}}function rt(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"app-digitalize-process-images",22),t.NdJ("processImage",function(u){t.CHM(o);const v=t.oxw(3);return t.KtG(v.processImage(u))}),t.qZA()}if(2&s){const o=t.oxw(3);t.Q6J("objs",o.objs)("currentObj",o.currentObj)}}function Re(s,b){if(1&s&&(t.TgZ(0,"div",18),t.YNc(1,Be,1,1,"app-digitalize-choose-images",19),t.YNc(2,rt,1,2,"app-digitalize-process-images",20),t.qZA()),2&s){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.currentLayout==o.allLayouts.CHOOSE_IMAGES),t.xp6(1),t.Q6J("ngIf",o.currentLayout==o.allLayouts.PROCESS_IMAGES)}}function k(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"div")(1,"div",12),t.NdJ("click",function(){t.CHM(o);const u=t.oxw(3);return t.KtG(u.startProcess())}),t._uU(2),t.ALo(3,"mytranslate"),t.ALo(4,"mytranslate"),t.qZA()()}if(2&s){const o=t.oxw(3);t.xp6(2),t.lnq("",t.lcZ(3,3,"lang_digitalize_book_start_call_orc_api")," (",o.totalSelected," ",t.lcZ(4,5,"lang_digitalize_book_total_images"),")")}}function tt(s,b){1&s&&(t._uU(0),t.ALo(1,"mytranslate")),2&s&&t.hij(" ",t.lcZ(1,1,"lang_digitalize_book_please_choose_image")," ")}function xt(s,b){if(1&s&&(t.ynx(0),t.TgZ(1,"div",18),t.YNc(2,k,5,7,"div",23),t.YNc(3,tt,2,3,"ng-template",null,24,t.W1O),t.qZA(),t.BQk()),2&s){const o=t.MAs(4),p=t.oxw(2);t.xp6(2),t.Q6J("ngIf",p.totalSelected>0)("ngIfElse",o)}}function je(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"div")(1,"span",25),t.NdJ("click",function(){t.CHM(o);const u=t.oxw(4);return t.KtG(u.processAgain())}),t._uU(2),t.ALo(3,"mytranslate"),t.qZA()()}2&s&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"lang_digitalize_book_call_ocr_again")))}function Wt(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"div")(1,"app-digitalize-preview-result",26),t.NdJ("changeObj",function(u){t.CHM(o);const v=t.oxw(4);return t.KtG(v.changeObj(u))}),t.qZA()()}if(2&s){const o=t.oxw(4);t.xp6(1),t.Q6J("obj",o.currentObj)}}function Gt(s,b){if(1&s&&t._UZ(0,"azt-loading-effect",28),2&s){const o=t.oxw(5);t.Q6J("currentStatusObj",o.processStatusObj)("customText",o.processStatusObj.errorMessage)}}function St(s,b){if(1&s&&(t.TgZ(0,"div"),t.YNc(1,Gt,1,2,"azt-loading-effect",27),t.qZA()),2&s){const o=t.oxw(4);t.xp6(1),t.Q6J("ngIf",o.processStatusObj.loading)}}function Pe(s,b){if(1&s&&(t.ynx(0),t.YNc(1,je,4,3,"div",15),t.YNc(2,Wt,2,1,"div",15),t.YNc(3,St,2,1,"div",15),t.BQk()),2&s){const o=t.oxw(3);t.xp6(1),t.Q6J("ngIf",o.currentObj.processStatus==o.allProcessStatuses.PROCESS_ERROR),t.xp6(1),t.Q6J("ngIf",o.currentObj.processStatus==o.allProcessStatuses.PROCESSED),t.xp6(1),t.Q6J("ngIf",o.currentObj.processStatus==o.allProcessStatuses.NONE||o.currentObj.processStatus==o.allProcessStatuses.PROCESSING)}}function me(s,b){1&s&&(t.ynx(0),t.TgZ(1,"div",18),t._uU(2),t.ALo(3,"mytranslate"),t.qZA(),t.BQk()),2&s&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"lang_digitalize_book_please_choose_image")))}function fe(s,b){if(1&s&&(t.ynx(0),t.YNc(1,Pe,4,3,"ng-container",15),t.YNc(2,me,4,3,"ng-container",15),t.BQk()),2&s){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.currentObj),t.xp6(1),t.Q6J("ngIf",!o.currentObj)}}function G(s,b){if(1&s){const o=t.EpF();t.TgZ(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8),t.YNc(4,ke,1,0,"app-digitalize-pdf-to-images",9),t.YNc(5,bt,3,3,"div",10),t.qZA(),t.TgZ(6,"div",11)(7,"div",12),t.NdJ("click",function(){t.CHM(o);const u=t.oxw();return t.KtG(u.downloadData("html"))}),t._uU(8),t.ALo(9,"mytranslate"),t.qZA()(),t.TgZ(10,"div",11)(11,"div",12),t.NdJ("click",function(){t.CHM(o);const u=t.oxw();return t.KtG(u.downloadData("docx"))}),t._uU(12),t.ALo(13,"mytranslate"),t.qZA()()(),t.YNc(14,Re,3,2,"div",13),t.qZA(),t.TgZ(15,"div",14),t.YNc(16,xt,5,2,"ng-container",15),t.YNc(17,fe,3,2,"ng-container",15),t.qZA()()}if(2&s){const o=t.oxw();t.xp6(4),t.Q6J("ngIf",o.currentLayout==o.allLayouts.CHOOSE_IMAGES),t.xp6(1),t.Q6J("ngIf",o.currentLayout==o.allLayouts.PROCESS_IMAGES),t.xp6(3),t.Oqu(t.lcZ(9,7,"lang_digitalize_book_download_result_html")),t.xp6(4),t.Oqu(t.lcZ(13,9,"lang_digitalize_book_download_result_docx")),t.xp6(2),t.Q6J("ngIf",o.objs.length>0),t.xp6(2),t.Q6J("ngIf",o.currentLayout==o.allLayouts.CHOOSE_IMAGES),t.xp6(1),t.Q6J("ngIf",o.currentLayout==o.allLayouts.PROCESS_IMAGES)}}const wt=[{path:"",children:[{path:"digitalize-book",component:(()=>{class s extends W.Q{startProcess(){this.currentLayout=ft.PROCESS_IMAGES;let o=this.objs.filter(p=>p.isSelected&&![F.PROCESSING,F.PROCESSED].includes(p.processStatus));this.currentObj=this.commonService.getFirstOfArray(o),this.callOrcApi(o,0)}processAgain(){let o=this.objs.filter(p=>p.isSelected&&![F.PROCESSING,F.PROCESSED].includes(p.processStatus));this.callOrcApi(o,0)}callOrcApi(o,p=0,u=1){if(p>=o.length)return void(this.processStatusObj.loading=!1);p<=0&&o.forEach(D=>D.processStatus=F.PROCESSING);let w=o.slice(p,p+u).map(D=>this.runDigitalizeOneImage(D));Promise.all(w).then(()=>{this.callOrcApi(o,p+u,u)})}runDigitalizeOneImage(o){return new Promise((p,u)=>{this.sAztDigitalizeService.digitalizeData(o,v=>{this.processStatusObj={loading:!0,errorMessage:v,mustShowErrorBox:!1}},v=>{o.processStatus=F.PROCESS_ERROR,this.replaceCurrentObj(o),p()},v=>{o={...v,processStatus:F.PROCESSED},this.replaceCurrentObj(o),p()})})}replaceCurrentObj(o){let p=this.objs.find(u=>u.position==o.position);null!=p&&(Object.assign(p,o),p.position==this.currentObj?.position&&Object.assign(this.currentObj,o))}chooseImages(o){let p=o.map(u=>u.position);this.objs.forEach(u=>u.isSelected=!!p.includes(u.position)||u.isSelected),this.totalSelected=this.objs.filter(u=>u.isSelected).length}processImage(o){let p=this.objs.find(u=>u.position==o.position);p&&(this.currentObj=p)}showChooseLayout(){this.currentLayout=ft.CHOOSE_IMAGES}changeObj(o){let p=this.objs.find(u=>u.position==o.position);p&&Object.assign(p,o)}uploadData(o){this.objs=o.map((p,u)=>({image:p,htmlResult:"",position:u+1,isSelected:!1,processStatus:F.NONE}))}downloadData(o){let p=new Date,u="";if(this.objs.forEach(v=>{u+=`<page [page]='${v.position}'/>`+(v.processStatus==F.PROCESSED?v.htmlResult:"")}),u=this.commonService.decodeHtmlEntities(u),"html"!=o)u=this.commonService.convertDollarDollarToLatexTag(u),this.commonService.loadAzotaDocxJs().then(()=>{azotaDocx.textToDocxBinary(u,null).then(v=>{let w=`azota-digitalize-book-${p.getDate()}${p.getMonth()+1}${p.getFullYear()}-${p.getTime()}.docx`;const D=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});D&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(D),w)}).catch(v=>{this.showErrorSnack(v)})}).catch(v=>{this.showErrorSnack(v)});else{let v=`azota-digitalize-book-${p.getDate()}${p.getMonth()+1}${p.getFullYear()}-${p.getTime()}.html`;const w=new Blob([u],{type:"text/plain"});w&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(w),v)}}ngOnInit(){super.ngOnInit(),this.commonService.translateMetaData({title:"lang_cms_admin_common_digitalize_book",description:"lang_cms_admin_common_digitalize_book",image:"lang_cms_test_image"}),this.headerBackTo=this.commonService.getMyQueryParam("backTo")??"/super-role/admin-tool"}constructor(){super(),this.sAztDigitalizeService=(0,t.f3M)(mt),this.processStatusObj={loading:!1,errorMessage:"",mustShowErrorBox:!1},this.headerBackTo="",this.objs=[],this.totalSelected=0,this.currentLayout=ft.CHOOSE_IMAGES,this.allLayouts=ft,this.allProcessStatuses=F}}return s.\u0275fac=function(o){return new(o||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-digitalize-book"]],features:[t.qOj],decls:5,vars:3,consts:[[3,"headerBackToLink"],[1,"container-fluid","component-wrap","centerBoth","hasBg","mt-3"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],["doneLoading",""],[3,"currentStatusObj"],[1,"grid","grid-cols-12","gap-5"],[1,"col-span-3"],[1,"box","p-3","mb-3","grid","grid-cols-12","gap-2"],[1,"col-span-12"],[3,"uploadData",4,"ngIf"],["class","btn btn-primary-soft w-full",3,"click",4,"ngIf"],[1,"col-span-6"],[1,"btn","btn-primary","w-full",3,"click"],["class","box p-3",4,"ngIf"],[1,"col-span-9"],[4,"ngIf"],[3,"uploadData"],[1,"btn","btn-primary-soft","w-full",3,"click"],[1,"box","p-3"],[3,"objs","chooseImages",4,"ngIf"],[3,"objs","currentObj","processImage",4,"ngIf"],[3,"objs","chooseImages"],[3,"objs","currentObj","processImage"],[4,"ngIf","ngIfElse"],["notSelectAnyObj",""],[1,"mb-3","btn","btn-pending",3,"click"],[3,"obj","changeObj"],[3,"currentStatusObj","customText",4,"ngIf"],[3,"currentStatusObj","customText"]],template:function(o,p){if(1&o&&(t.TgZ(0,"teacher-layout",0)(1,"div",1),t.YNc(2,T,1,1,"azt-loading-effect",2),t.YNc(3,G,18,11,"ng-template",null,3,t.W1O),t.qZA()()),2&o){const u=t.MAs(4);t.Q6J("headerBackToLink",p.headerBackTo),t.xp6(2),t.Q6J("ngIf",p.statusObj.loading)("ngIfElse",u)}},dependencies:[R.O5,U.l,te._,Qt,Ee,de,N,L.JV],encapsulation:2}),s})()}]}];let ve=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[st.Bz.forChild(wt),st.Bz,pt.fQ]}),s})(),Vt=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({providers:[{provide:ut.f8,useValue:Lt.N.azt_tiny_mce_script_src}],imports:[st.Bz,R.ez,$.u5,ut.Z_,S.j,$.UX,ve,qt.W,Pt.Z,At.kb,$t.d,X.qyJ.pick(X.ciZ),jt.l1,at]}),s})()},63061:function(we){we.exports=function(){"use strict";function it(r){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function R(r,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function st(r,e,a){return e in r?Object.defineProperty(r,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[e]=a,r}function ut(r,e){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(r,c).enumerable})),a.push.apply(a,i)}return a}function t(r){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(a),!0).forEach(function(i){st(r,i,a[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):ut(Object(a)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(a,i))})}return r}function ct(r){return function yt(r){if(Array.isArray(r))return Rt(r)}(r)||function lt(r){if(typeof Symbol<"u"&&Symbol.iterator in Object(r))return Array.from(r)}(r)||function Ot(r,e){if(r){if("string"==typeof r)return Rt(r,e);var a=Object.prototype.toString.call(r).slice(8,-1);if("Object"===a&&r.constructor&&(a=r.constructor.name),"Map"===a||"Set"===a)return Array.from(r);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Rt(r,e)}}(r)||function Nt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(r,e){(null==e||e>r.length)&&(e=r.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=r[a];return i}var at=typeof window<"u"&&typeof window.document<"u",X=at?window:{},jt=!(!at||!X.document.documentElement)&&"ontouchstart"in X.document.documentElement,At=!!at&&"PointerEvent"in X,S="cropper",W="w",q="s",ot="n",L="ne",Dt="nw",zt="se",mt="sw",F="".concat(S,"-crop"),ft="".concat(S,"-disabled"),U="".concat(S,"-hidden"),te="".concat(S,"-hide"),Ce="".concat(S,"-invisible"),vt="".concat(S,"-modal"),Zt="".concat(S,"-move"),Et="".concat(S,"Action"),kt="".concat(S,"Preview"),Ut="crop",Ft="crop",Bt="cropend",Yt="cropmove",Jt="cropstart",ie="dblclick",ae=At?"pointerdown":jt?"touchstart":"mousedown",oe=At?"pointermove":jt?"touchmove":"mousemove",re=At?"pointerup pointercancel":jt?"touchend touchcancel":"mouseup",Qt="zoom",le="image/jpeg",De=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,ze=/^data:/,Ee=/^data:image\/jpeg;base64,/,Se=/^img|canvas$/i,de={viewMode:0,dragMode:Ut,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Ie=Number.isNaN||X.isNaN;function y(r){return"number"==typeof r&&!Ie(r)}var ge=function(e){return e>0&&e<1/0};function Xt(r){return typeof r>"u"}function ht(r){return"object"===it(r)&&null!==r}var Me=Object.prototype.hasOwnProperty;function _t(r){if(!ht(r))return!1;try{var e=r.constructor,a=e.prototype;return e&&a&&Me.call(a,"isPrototypeOf")}catch{return!1}}function H(r){return"function"==typeof r}var Ne=Array.prototype.slice;function ue(r){return Array.from?Array.from(r):Ne.call(r)}function N(r,e){return r&&H(e)&&(Array.isArray(r)||y(r.length)?ue(r).forEach(function(a,i){e.call(r,a,i,r)}):ht(r)&&Object.keys(r).forEach(function(a){e.call(r,r[a],a,r)})),r}var T=Object.assign||function(e){for(var a=arguments.length,i=new Array(a>1?a-1:0),c=1;c<a;c++)i[c-1]=arguments[c];return ht(e)&&i.length>0&&i.forEach(function(n){ht(n)&&Object.keys(n).forEach(function(l){e[l]=n[l]})}),e},ke=/\.\d*(?:0|9){12}\d*$/;function bt(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return ke.test(r)?Math.round(r*e)/e:r}var Be=/^width|height|left|top|marginLeft|marginTop$/;function rt(r,e){var a=r.style;N(e,function(i,c){Be.test(c)&&y(i)&&(i="".concat(i,"px")),a[c]=i})}function k(r,e){if(e){if(y(r.length))return void N(r,function(i){k(i,e)});if(r.classList)return void r.classList.add(e);var a=r.className.trim();a?a.indexOf(e)<0&&(r.className="".concat(a," ").concat(e)):r.className=e}}function tt(r,e){if(e){if(y(r.length))return void N(r,function(a){tt(a,e)});if(r.classList)return void r.classList.remove(e);r.className.indexOf(e)>=0&&(r.className=r.className.replace(e,""))}}function xt(r,e,a){if(e){if(y(r.length))return void N(r,function(i){xt(i,e,a)});a?k(r,e):tt(r,e)}}var je=/([a-z\d])([A-Z])/g;function Wt(r){return r.replace(je,"$1-$2").toLowerCase()}function Gt(r,e){return ht(r[e])?r[e]:r.dataset?r.dataset[e]:r.getAttribute("data-".concat(Wt(e)))}function St(r,e,a){ht(a)?r[e]=a:r.dataset?r.dataset[e]=a:r.setAttribute("data-".concat(Wt(e)),a)}var me=/\s\s*/,fe=function(){var r=!1;if(at){var e=!1,a=function(){},i=Object.defineProperty({},"once",{get:function(){return r=!0,e},set:function(n){e=n}});X.addEventListener("test",a,i),X.removeEventListener("test",a,i)}return r}();function G(r,e,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=a;e.trim().split(me).forEach(function(n){if(!fe){var l=r.listeners;l&&l[n]&&l[n][a]&&(c=l[n][a],delete l[n][a],0===Object.keys(l[n]).length&&delete l[n],0===Object.keys(l).length&&delete r.listeners)}r.removeEventListener(n,c,i)})}function V(r,e,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=a;e.trim().split(me).forEach(function(n){if(i.once&&!fe){var l=r.listeners,h=void 0===l?{}:l;c=function(){delete h[n][a],r.removeEventListener(n,c,i);for(var m=arguments.length,g=new Array(m),d=0;d<m;d++)g[d]=arguments[d];a.apply(r,g)},h[n]||(h[n]={}),h[n][a]&&r.removeEventListener(n,h[n][a],i),h[n][a]=c,r.listeners=h}r.addEventListener(n,c,i)})}function wt(r,e,a){var i;return H(Event)&&H(CustomEvent)?i=new CustomEvent(e,{detail:a,bubbles:!0,cancelable:!0}):(i=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,a),r.dispatchEvent(i)}function ve(r){var e=r.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var Vt=X.location,s=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function b(r){var e=r.match(s);return null!==e&&(e[1]!==Vt.protocol||e[2]!==Vt.hostname||e[3]!==Vt.port)}function o(r){var e="timestamp=".concat((new Date).getTime());return r+(-1===r.indexOf("?")?"?":"&")+e}function p(r){var e=r.rotate,a=r.scaleX,i=r.scaleY,c=r.translateX,n=r.translateY,l=[];y(c)&&0!==c&&l.push("translateX(".concat(c,"px)")),y(n)&&0!==n&&l.push("translateY(".concat(n,"px)")),y(e)&&0!==e&&l.push("rotate(".concat(e,"deg)")),y(a)&&1!==a&&l.push("scaleX(".concat(a,")")),y(i)&&1!==i&&l.push("scaleY(".concat(i,")"));var h=l.length?l.join(" "):"none";return{WebkitTransform:h,msTransform:h,transform:h}}function v(r,e){var a=r.pageX,i=r.pageY,c={endX:a,endY:i};return e?c:t({startX:a,startY:i},c)}function D(r){var e=r.aspectRatio,a=r.height,i=r.width,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",n=ge(i),l=ge(a);if(n&&l){var h=a*e;"contain"===c&&h>i||"cover"===c&&h<i?a=i/e:i=a*e}else n?a=i/e:l&&(i=a*e);return{width:i,height:a}}var Y=String.fromCharCode;var Kt=/^data:.*,/;function Xe(r){var a,e=new DataView(r);try{var i,c,n;if(255===e.getUint8(0)&&216===e.getUint8(1))for(var l=e.byteLength,h=2;h+1<l;){if(255===e.getUint8(h)&&225===e.getUint8(h+1)){c=h;break}h+=1}if(c){var m=c+10;if("Exif"===function _e(r,e,a){var i="";a+=e;for(var c=e;c<a;c+=1)i+=Y(r.getUint8(c));return i}(e,c+4,4)){var g=e.getUint16(m);if(((i=18761===g)||19789===g)&&42===e.getUint16(m+2,i)){var d=e.getUint32(m+4,i);d>=8&&(n=m+d)}}}if(n){var A,O,f=e.getUint16(n,i);for(O=0;O<f;O+=1)if(274===e.getUint16(A=n+12*O+2,i)){a=e.getUint16(A+=8,i),e.setUint16(A,1,i);break}}}catch{a=1}return a}var Ge={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,a=this.options,i=this.container,c=this.cropper,n=Number(a.minContainerWidth),l=Number(a.minContainerHeight);k(c,U),tt(e,U);var h={width:Math.max(i.offsetWidth,n>=0?n:200),height:Math.max(i.offsetHeight,l>=0?l:100)};this.containerData=h,rt(c,{width:h.width,height:h.height}),k(e,U),tt(c,U)},initCanvas:function(){var e=this.containerData,a=this.imageData,i=this.options.viewMode,c=Math.abs(a.rotate)%180==90,n=c?a.naturalHeight:a.naturalWidth,l=c?a.naturalWidth:a.naturalHeight,h=n/l,_=e.width,m=e.height;e.height*h>e.width?3===i?_=e.height*h:m=e.width/h:3===i?m=e.width/h:_=e.height*h;var g={aspectRatio:h,naturalWidth:n,naturalHeight:l,width:_,height:m};this.canvasData=g,this.limited=1===i||2===i,this.limitCanvas(!0,!0),g.width=Math.min(Math.max(g.width,g.minWidth),g.maxWidth),g.height=Math.min(Math.max(g.height,g.minHeight),g.maxHeight),g.left=(e.width-g.width)/2,g.top=(e.height-g.height)/2,g.oldLeft=g.left,g.oldTop=g.top,this.initialCanvasData=T({},g)},limitCanvas:function(e,a){var i=this.options,c=this.containerData,n=this.canvasData,l=this.cropBoxData,h=i.viewMode,_=n.aspectRatio,m=this.cropped&&l;if(e){var g=Number(i.minCanvasWidth)||0,d=Number(i.minCanvasHeight)||0;h>1?(g=Math.max(g,c.width),d=Math.max(d,c.height),3===h&&(d*_>g?g=d*_:d=g/_)):h>0&&(g?g=Math.max(g,m?l.width:0):d?d=Math.max(d,m?l.height:0):m&&((d=l.height)*_>(g=l.width)?g=d*_:d=g/_));var f=D({aspectRatio:_,width:g,height:d});d=f.height,n.minWidth=g=f.width,n.minHeight=d,n.maxWidth=1/0,n.maxHeight=1/0}if(a)if(h>(m?0:1)){var A=c.width-n.width,O=c.height-n.height;n.minLeft=Math.min(0,A),n.minTop=Math.min(0,O),n.maxLeft=Math.max(0,A),n.maxTop=Math.max(0,O),m&&this.limited&&(n.minLeft=Math.min(l.left,l.left+(l.width-n.width)),n.minTop=Math.min(l.top,l.top+(l.height-n.height)),n.maxLeft=l.left,n.maxTop=l.top,2===h&&(n.width>=c.width&&(n.minLeft=Math.min(0,A),n.maxLeft=Math.max(0,A)),n.height>=c.height&&(n.minTop=Math.min(0,O),n.maxTop=Math.max(0,O))))}else n.minLeft=-n.width,n.minTop=-n.height,n.maxLeft=c.width,n.maxTop=c.height},renderCanvas:function(e,a){var i=this.canvasData,c=this.imageData;if(a){var n=function I(r){var e=r.width,a=r.height,i=r.degree;if(90==(i=Math.abs(i)%180))return{width:a,height:e};var c=i%90*Math.PI/180,n=Math.sin(c),l=Math.cos(c),h=e*l+a*n,_=e*n+a*l;return i>90?{width:_,height:h}:{width:h,height:_}}({width:c.naturalWidth*Math.abs(c.scaleX||1),height:c.naturalHeight*Math.abs(c.scaleY||1),degree:c.rotate||0}),l=n.width,h=n.height,_=i.width*(l/i.naturalWidth),m=i.height*(h/i.naturalHeight);i.left-=(_-i.width)/2,i.top-=(m-i.height)/2,i.width=_,i.height=m,i.aspectRatio=l/h,i.naturalWidth=l,i.naturalHeight=h,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,rt(this.canvas,T({width:i.width,height:i.height},p({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var a=this.canvasData,i=this.imageData,c=i.naturalWidth*(a.width/a.naturalWidth),n=i.naturalHeight*(a.height/a.naturalHeight);T(i,{width:c,height:n,left:(a.width-c)/2,top:(a.height-n)/2}),rt(this.image,T({width:i.width,height:i.height},p(T({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox:function(){var e=this.options,a=this.canvasData,i=e.aspectRatio||e.initialAspectRatio,c=Number(e.autoCropArea)||.8,n={width:a.width,height:a.height};i&&(a.height*i>a.width?n.height=n.width/i:n.width=n.height*i),this.cropBoxData=n,this.limitCropBox(!0,!0),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),n.width=Math.max(n.minWidth,n.width*c),n.height=Math.max(n.minHeight,n.height*c),n.left=a.left+(a.width-n.width)/2,n.top=a.top+(a.height-n.height)/2,n.oldLeft=n.left,n.oldTop=n.top,this.initialCropBoxData=T({},n)},limitCropBox:function(e,a){var i=this.options,c=this.containerData,n=this.canvasData,l=this.cropBoxData,h=this.limited,_=i.aspectRatio;if(e){var m=Number(i.minCropBoxWidth)||0,g=Number(i.minCropBoxHeight)||0,d=h?Math.min(c.width,n.width,n.width+n.left,c.width-n.left):c.width,f=h?Math.min(c.height,n.height,n.height+n.top,c.height-n.top):c.height;m=Math.min(m,c.width),g=Math.min(g,c.height),_&&(m&&g?g*_>m?g=m/_:m=g*_:m?g=m/_:g&&(m=g*_),f*_>d?f=d/_:d=f*_),l.minWidth=Math.min(m,d),l.minHeight=Math.min(g,f),l.maxWidth=d,l.maxHeight=f}a&&(h?(l.minLeft=Math.max(0,n.left),l.minTop=Math.max(0,n.top),l.maxLeft=Math.min(c.width,n.left+n.width)-l.width,l.maxTop=Math.min(c.height,n.top+n.height)-l.height):(l.minLeft=0,l.minTop=0,l.maxLeft=c.width-l.width,l.maxTop=c.height-l.height))},renderCropBox:function(){var e=this.options,a=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&St(this.face,Et,i.width>=a.width&&i.height>=a.height?"move":"all"),rt(this.cropBox,T({width:i.width,height:i.height},p({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),wt(this.element,Ft,this.getData())}},Ve={initPreview:function(){var e=this.element,a=this.crossOrigin,i=this.options.preview,c=a?this.crossOriginUrl:this.url,n=e.alt||"The image to preview",l=document.createElement("img");if(a&&(l.crossOrigin=a),l.src=c,l.alt=n,this.viewBox.appendChild(l),this.viewBoxImage=l,i){var h=i;"string"==typeof i?h=e.ownerDocument.querySelectorAll(i):i.querySelector&&(h=[i]),this.previews=h,N(h,function(_){var m=document.createElement("img");St(_,kt,{width:_.offsetWidth,height:_.offsetHeight,html:_.innerHTML}),a&&(m.crossOrigin=a),m.src=c,m.alt=n,m.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',_.innerHTML="",_.appendChild(m)})}},resetPreview:function(){N(this.previews,function(e){var a=Gt(e,kt);rt(e,{width:a.width,height:a.height}),e.innerHTML=a.html,function Pe(r,e){if(ht(r[e]))try{delete r[e]}catch{r[e]=void 0}else if(r.dataset)try{delete r.dataset[e]}catch{r.dataset[e]=void 0}else r.removeAttribute("data-".concat(Wt(e)))}(e,kt)})},preview:function(){var e=this.imageData,a=this.canvasData,i=this.cropBoxData,c=i.width,n=i.height,l=e.width,h=e.height,_=i.left-a.left-e.left,m=i.top-a.top-e.top;!this.cropped||this.disabled||(rt(this.viewBoxImage,T({width:l,height:h},p(T({translateX:-_,translateY:-m},e)))),N(this.previews,function(g){var d=Gt(g,kt),f=d.width,A=d.height,O=f,M=A,z=1;c&&(M=n*(z=f/c)),n&&M>A&&(O=c*(z=A/n),M=A),rt(g,{width:O,height:M}),rt(g.getElementsByTagName("img")[0],T({width:l*z,height:h*z},p(T({translateX:-_*z,translateY:-m*z},e))))}))}},Ke={bind:function(){var e=this.element,a=this.options,i=this.cropper;H(a.cropstart)&&V(e,Jt,a.cropstart),H(a.cropmove)&&V(e,Yt,a.cropmove),H(a.cropend)&&V(e,Bt,a.cropend),H(a.crop)&&V(e,Ft,a.crop),H(a.zoom)&&V(e,Qt,a.zoom),V(i,ae,this.onCropStart=this.cropStart.bind(this)),a.zoomable&&a.zoomOnWheel&&V(i,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&V(i,ie,this.onDblclick=this.dblclick.bind(this)),V(e.ownerDocument,oe,this.onCropMove=this.cropMove.bind(this)),V(e.ownerDocument,re,this.onCropEnd=this.cropEnd.bind(this)),a.responsive&&V(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,a=this.options,i=this.cropper;H(a.cropstart)&&G(e,Jt,a.cropstart),H(a.cropmove)&&G(e,Yt,a.cropmove),H(a.cropend)&&G(e,Bt,a.cropend),H(a.crop)&&G(e,Ft,a.crop),H(a.zoom)&&G(e,Qt,a.zoom),G(i,ae,this.onCropStart),a.zoomable&&a.zoomOnWheel&&G(i,"wheel",this.onWheel,{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&G(i,ie,this.onDblclick),G(e.ownerDocument,oe,this.onCropMove),G(e.ownerDocument,re,this.onCropEnd),a.responsive&&G(window,"resize",this.onResize)}},$e={resize:function(){if(!this.disabled){var n,l,e=this.options,a=this.container,i=this.containerData,c=a.offsetWidth/i.width;1===c&&a.offsetHeight===i.height||(e.restore&&(n=this.getCanvasData(),l=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(N(n,function(h,_){n[_]=h*c})),this.setCropBoxData(N(l,function(h,_){l[_]=h*c}))))}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(function Re(r,e){return r.classList?r.classList.contains(e):r.className.indexOf(e)>-1}(this.dragBox,F)?"move":Ut)},wheel:function(e){var a=this,i=Number(this.options.wheelZoomRatio)||.1,c=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){a.wheeling=!1},50),e.deltaY?c=e.deltaY>0?1:-1:e.wheelDelta?c=-e.wheelDelta/120:e.detail&&(c=e.detail>0?1:-1),this.zoom(-c*i,e)))},cropStart:function(e){var a=e.buttons,i=e.button;if(!(this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(y(a)&&1!==a||y(i)&&0!==i||e.ctrlKey))){var l,c=this.options,n=this.pointers;e.changedTouches?N(e.changedTouches,function(h){n[h.identifier]=v(h)}):n[e.pointerId||0]=v(e),l=Object.keys(n).length>1&&c.zoomable&&c.zoomOnTouch?"zoom":Gt(e.target,Et),De.test(l)&&!1!==wt(this.element,Jt,{originalEvent:e,action:l})&&(e.preventDefault(),this.action=l,this.cropping=!1,"crop"===l&&(this.cropping=!0,k(this.dragBox,vt)))}},cropMove:function(e){var a=this.action;if(!this.disabled&&a){var i=this.pointers;e.preventDefault(),!1!==wt(this.element,Yt,{originalEvent:e,action:a})&&(e.changedTouches?N(e.changedTouches,function(c){T(i[c.identifier]||{},v(c,!0))}):T(i[e.pointerId||0]||{},v(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var a=this.action,i=this.pointers;e.changedTouches?N(e.changedTouches,function(c){delete i[c.identifier]}):delete i[e.pointerId||0],a&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,xt(this.dragBox,vt,this.cropped&&this.options.modal)),wt(this.element,Bt,{originalEvent:e,action:a}))}}},qe={change:function(e){var dt,i=this.canvasData,c=this.containerData,n=this.cropBoxData,l=this.pointers,h=this.action,_=this.options.aspectRatio,m=n.left,g=n.top,d=n.width,f=n.height,A=m+d,O=g+f,M=0,z=0,j=c.width,Z=c.height,B=!0;!_&&e.shiftKey&&(_=d&&f?d/f:1),this.limited&&(z=n.minTop,j=(M=n.minLeft)+Math.min(c.width,i.width,i.left+i.width),Z=z+Math.min(c.height,i.height,i.top+i.height));var K=l[Object.keys(l)[0]],x={x:K.endX-K.startX,y:K.endY-K.startY},E=function(et){switch(et){case"e":A+x.x>j&&(x.x=j-A);break;case W:m+x.x<M&&(x.x=M-m);break;case ot:g+x.y<z&&(x.y=z-g);break;case q:O+x.y>Z&&(x.y=Z-O)}};switch(h){case"all":m+=x.x,g+=x.y;break;case"e":if(x.x>=0&&(A>=j||_&&(g<=z||O>=Z))){B=!1;break}E("e"),(d+=x.x)<0&&(h=W,m-=d=-d),_&&(g+=(n.height-(f=d/_))/2);break;case ot:if(x.y<=0&&(g<=z||_&&(m<=M||A>=j))){B=!1;break}E(ot),g+=x.y,(f-=x.y)<0&&(h=q,g-=f=-f),_&&(m+=(n.width-(d=f*_))/2);break;case W:if(x.x<=0&&(m<=M||_&&(g<=z||O>=Z))){B=!1;break}E(W),m+=x.x,(d-=x.x)<0&&(h="e",m-=d=-d),_&&(g+=(n.height-(f=d/_))/2);break;case q:if(x.y>=0&&(O>=Z||_&&(m<=M||A>=j))){B=!1;break}E(q),(f+=x.y)<0&&(h=ot,g-=f=-f),_&&(m+=(n.width-(d=f*_))/2);break;case L:if(_){if(x.y<=0&&(g<=z||A>=j)){B=!1;break}E(ot),g+=x.y,d=(f-=x.y)*_}else E(ot),E("e"),x.x>=0?A<j?d+=x.x:x.y<=0&&g<=z&&(B=!1):d+=x.x,x.y<=0?g>z&&(f-=x.y,g+=x.y):(f-=x.y,g+=x.y);d<0&&f<0?(h=mt,g-=f=-f,m-=d=-d):d<0?(h=Dt,m-=d=-d):f<0&&(h=zt,g-=f=-f);break;case Dt:if(_){if(x.y<=0&&(g<=z||m<=M)){B=!1;break}E(ot),g+=x.y,m+=n.width-(d=(f-=x.y)*_)}else E(ot),E(W),x.x<=0?m>M?(d-=x.x,m+=x.x):x.y<=0&&g<=z&&(B=!1):(d-=x.x,m+=x.x),x.y<=0?g>z&&(f-=x.y,g+=x.y):(f-=x.y,g+=x.y);d<0&&f<0?(h=zt,g-=f=-f,m-=d=-d):d<0?(h=L,m-=d=-d):f<0&&(h=mt,g-=f=-f);break;case mt:if(_){if(x.x<=0&&(m<=M||O>=Z)){B=!1;break}E(W),m+=x.x,f=(d-=x.x)/_}else E(q),E(W),x.x<=0?m>M?(d-=x.x,m+=x.x):x.y>=0&&O>=Z&&(B=!1):(d-=x.x,m+=x.x),x.y>=0?O<Z&&(f+=x.y):f+=x.y;d<0&&f<0?(h=L,g-=f=-f,m-=d=-d):d<0?(h=zt,m-=d=-d):f<0&&(h=Dt,g-=f=-f);break;case zt:if(_){if(x.x>=0&&(A>=j||O>=Z)){B=!1;break}E("e"),f=(d+=x.x)/_}else E(q),E("e"),x.x>=0?A<j?d+=x.x:x.y>=0&&O>=Z&&(B=!1):d+=x.x,x.y>=0?O<Z&&(f+=x.y):f+=x.y;d<0&&f<0?(h=Dt,g-=f=-f,m-=d=-d):d<0?(h=mt,m-=d=-d):f<0&&(h=L,g-=f=-f);break;case"move":this.move(x.x,x.y),B=!1;break;case"zoom":this.zoom(function u(r){var e=t({},r),a=0;return N(r,function(i,c){delete e[c],N(e,function(n){var l=Math.abs(i.startX-n.startX),h=Math.abs(i.startY-n.startY),_=Math.abs(i.endX-n.endX),m=Math.abs(i.endY-n.endY),g=Math.sqrt(l*l+h*h),f=(Math.sqrt(_*_+m*m)-g)/g;Math.abs(f)>Math.abs(a)&&(a=f)})}),a}(l),e),B=!1;break;case"crop":if(!x.x||!x.y){B=!1;break}dt=ve(this.cropper),m=K.startX-dt.left,g=K.startY-dt.top,d=n.minWidth,f=n.minHeight,x.x>0?h=x.y>0?zt:L:x.x<0&&(m-=d,h=x.y>0?mt:Dt),x.y<0&&(g-=f),this.cropped||(tt(this.cropBox,U),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}B&&(n.width=d,n.height=f,n.left=m,n.top=g,this.action=h,this.renderCropBox()),N(l,function(P){P.startX=P.endX,P.startY=P.endY})}},ti={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&k(this.dragBox,vt),tt(this.cropBox,U),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=T({},this.initialImageData),this.canvasData=T({},this.initialCanvasData),this.cropBoxData=T({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(T(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),tt(this.dragBox,vt),k(this.cropBox,U)),this},replace:function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&e&&(this.isImg&&(this.element.src=e),a?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,N(this.previews,function(i){i.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,tt(this.cropper,ft)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,k(this.cropper,ft)),this},destroy:function(){var e=this.element;return e[S]?(e[S]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,c=i.left,n=i.top;return this.moveTo(Xt(e)?e:c+Number(e),Xt(a)?a:n+Number(a))},moveTo:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,c=!1;return e=Number(e),a=Number(a),this.ready&&!this.disabled&&this.options.movable&&(y(e)&&(i.left=e,c=!0),y(a)&&(i.top=a,c=!0),c&&this.renderCanvas(!0)),this},zoom:function(e,a){var i=this.canvasData;return e=Number(e),this.zoomTo(i.width*(e=e<0?1/(1-e):1+e)/i.naturalWidth,null,a)},zoomTo:function(e,a,i){var c=this.options,n=this.canvasData,l=n.width,h=n.height,_=n.naturalWidth,m=n.naturalHeight;if((e=Number(e))>=0&&this.ready&&!this.disabled&&c.zoomable){var g=_*e,d=m*e;if(!1===wt(this.element,Qt,{ratio:e,oldRatio:l/_,originalEvent:i}))return this;if(i){var f=this.pointers,A=ve(this.cropper),O=f&&Object.keys(f).length?function w(r){var e=0,a=0,i=0;return N(r,function(c){e+=c.startX,a+=c.startY,i+=1}),{pageX:e/=i,pageY:a/=i}}(f):{pageX:i.pageX,pageY:i.pageY};n.left-=(O.pageX-A.left-n.left)/l*(g-l),n.top-=(O.pageY-A.top-n.top)/h*(d-h)}else _t(a)&&y(a.x)&&y(a.y)?(n.left-=(a.x-n.left)/l*(g-l),n.top-=(a.y-n.top)/h*(d-h)):(n.left-=(g-l)/2,n.top-=(d-h)/2);n.width=g,n.height=d,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return y(e=Number(e))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var a=this.imageData.scaleY;return this.scale(e,y(a)?a:1)},scaleY:function(e){var a=this.imageData.scaleX;return this.scale(y(a)?a:1,e)},scale:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.imageData,c=!1;return e=Number(e),a=Number(a),this.ready&&!this.disabled&&this.options.scalable&&(y(e)&&(i.scaleX=e,c=!0),y(a)&&(i.scaleY=a,c=!0),c&&this.renderCanvas(!0,!0)),this},getData:function(){var l,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.options,i=this.imageData,c=this.canvasData,n=this.cropBoxData;if(this.ready&&this.cropped){var h=i.width/i.naturalWidth;if(N(l={x:n.left-c.left,y:n.top-c.top,width:n.width,height:n.height},function(g,d){l[d]=g/h}),e){var _=Math.round(l.y+l.height),m=Math.round(l.x+l.width);l.x=Math.round(l.x),l.y=Math.round(l.y),l.width=m-l.x,l.height=_-l.y}}else l={x:0,y:0,width:0,height:0};return a.rotatable&&(l.rotate=i.rotate||0),a.scalable&&(l.scaleX=i.scaleX||1,l.scaleY=i.scaleY||1),l},setData:function(e){var a=this.options,i=this.imageData,c=this.canvasData,n={};if(this.ready&&!this.disabled&&_t(e)){var l=!1;a.rotatable&&y(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,l=!0),a.scalable&&(y(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,l=!0),y(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,l=!0)),l&&this.renderCanvas(!0,!0);var h=i.width/i.naturalWidth;y(e.x)&&(n.left=e.x*h+c.left),y(e.y)&&(n.top=e.y*h+c.top),y(e.width)&&(n.width=e.width*h),y(e.height)&&(n.height=e.height*h),this.setCropBoxData(n)}return this},getContainerData:function(){return this.ready?T({},this.containerData):{}},getImageData:function(){return this.sized?T({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,a={};return this.ready&&N(["left","top","width","height","naturalWidth","naturalHeight"],function(i){a[i]=e[i]}),a},setCanvasData:function(e){var a=this.canvasData,i=a.aspectRatio;return this.ready&&!this.disabled&&_t(e)&&(y(e.left)&&(a.left=e.left),y(e.top)&&(a.top=e.top),y(e.width)?(a.width=e.width,a.height=e.width/i):y(e.height)&&(a.height=e.height,a.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var a,e=this.cropBoxData;return this.ready&&this.cropped&&(a={left:e.left,top:e.top,width:e.width,height:e.height}),a||{}},setCropBoxData:function(e){var c,n,a=this.cropBoxData,i=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&_t(e)&&(y(e.left)&&(a.left=e.left),y(e.top)&&(a.top=e.top),y(e.width)&&e.width!==a.width&&(c=!0,a.width=e.width),y(e.height)&&e.height!==a.height&&(n=!0,a.height=e.height),i&&(c?a.height=a.width/i:n&&(a.width=a.height*i)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var a=this.canvasData,i=function J(r,e,a,i){var c=e.aspectRatio,n=e.naturalWidth,l=e.naturalHeight,h=e.rotate,_=void 0===h?0:h,m=e.scaleX,g=void 0===m?1:m,d=e.scaleY,f=void 0===d?1:d,A=a.aspectRatio,O=a.naturalWidth,M=a.naturalHeight,z=i.fillColor,j=void 0===z?"transparent":z,Z=i.imageSmoothingEnabled,B=void 0===Z||Z,dt=i.imageSmoothingQuality,K=void 0===dt?"low":dt,x=i.maxWidth,E=void 0===x?1/0:x,P=i.maxHeight,et=void 0===P?1/0:P,gt=i.minWidth,Tt=void 0===gt?0:gt,It=i.minHeight,Ct=void 0===It?0:It,nt=document.createElement("canvas"),Q=nt.getContext("2d"),Mt=D({aspectRatio:A,width:E,height:et}),xe=D({aspectRatio:A,width:Tt,height:Ct},"cover"),Le=Math.min(Mt.width,Math.max(xe.width,O)),Ze=Math.min(Mt.height,Math.max(xe.height,M)),He=D({aspectRatio:c,width:E,height:et}),Fe=D({aspectRatio:c,width:Tt,height:Ct},"cover"),Ye=Math.min(He.width,Math.max(Fe.width,n)),Je=Math.min(He.height,Math.max(Fe.height,l)),ii=[-Ye/2,-Je/2,Ye,Je];return nt.width=bt(Le),nt.height=bt(Ze),Q.fillStyle=j,Q.fillRect(0,0,Le,Ze),Q.save(),Q.translate(Le/2,Ze/2),Q.rotate(_*Math.PI/180),Q.scale(g,f),Q.imageSmoothingEnabled=B,Q.imageSmoothingQuality=K,Q.drawImage.apply(Q,[r].concat(ct(ii.map(function(ai){return Math.floor(bt(ai))})))),Q.restore(),nt}(this.image,this.imageData,a,e);if(!this.cropped)return i;var c=this.getData(),n=c.x,l=c.y,h=c.width,_=c.height,m=i.width/Math.floor(a.naturalWidth);1!==m&&(n*=m,l*=m,h*=m,_*=m);var g=h/_,d=D({aspectRatio:g,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),f=D({aspectRatio:g,width:e.minWidth||0,height:e.minHeight||0},"cover"),A=D({aspectRatio:g,width:e.width||(1!==m?i.width:h),height:e.height||(1!==m?i.height:_)}),O=A.width,M=A.height;O=Math.min(d.width,Math.max(f.width,O)),M=Math.min(d.height,Math.max(f.height,M));var z=document.createElement("canvas"),j=z.getContext("2d");z.width=bt(O),z.height=bt(M),j.fillStyle=e.fillColor||"transparent",j.fillRect(0,0,O,M);var Z=e.imageSmoothingEnabled,dt=e.imageSmoothingQuality;j.imageSmoothingEnabled=void 0===Z||Z,dt&&(j.imageSmoothingQuality=dt);var et,gt,Tt,It,Ct,nt,K=i.width,x=i.height,E=n,P=l;E<=-h||E>K?(E=0,et=0,Tt=0,Ct=0):E<=0?(Tt=-E,E=0,Ct=et=Math.min(K,h+E)):E<=K&&(Tt=0,Ct=et=Math.min(h,K-E)),et<=0||P<=-_||P>x?(P=0,gt=0,It=0,nt=0):P<=0?(It=-P,P=0,nt=gt=Math.min(x,_+P)):P<=x&&(It=0,nt=gt=Math.min(_,x-P));var Q=[E,P,et,gt];if(Ct>0&&nt>0){var Mt=O/h;Q.push(Tt*Mt,It*Mt,Ct*Mt,nt*Mt)}return j.drawImage.apply(j,[i].concat(ct(Q.map(function(xe){return Math.floor(bt(xe))})))),z},setAspectRatio:function(e){var a=this.options;return!this.disabled&&!Xt(e)&&(a.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var a=this.options,i=this.dragBox,c=this.face;if(this.ready&&!this.disabled){var n=e===Ut,l=a.movable&&"move"===e;a.dragMode=e=n||l?e:"none",St(i,Et,e),xt(i,F,n),xt(i,Zt,l),a.cropBoxMovable||(St(c,Et,e),xt(c,F,n),xt(c,Zt,l))}return this}},ei=X.Cropper,Ue=function(){function r(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function C(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),!e||!Se.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=T({},de,_t(a)&&a),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return function $(r,e,a){return e&&R(r.prototype,e),a&&R(r,a),r}(r,[{key:"init",value:function(){var c,a=this.element,i=a.tagName.toLowerCase();if(!a[S]){if(a[S]=this,"img"===i){if(this.isImg=!0,c=a.getAttribute("src")||"",this.originalUrl=c,!c)return;c=a.src}else"canvas"===i&&window.HTMLCanvasElement&&(c=a.toDataURL());this.load(c)}}},{key:"load",value:function(a){var i=this;if(a){this.url=a,this.imageData={};var c=this.element,n=this.options;if(!n.rotatable&&!n.scalable&&(n.checkOrientation=!1),!n.checkOrientation||!window.ArrayBuffer)return void this.clone();if(ze.test(a))return void(Ee.test(a)?this.read(function be(r){var e=r.replace(Kt,""),a=atob(e),i=new ArrayBuffer(a.length),c=new Uint8Array(i);return N(c,function(n,l){c[l]=a.charCodeAt(l)}),i}(a)):this.clone());var l=new XMLHttpRequest,h=this.clone.bind(this);this.reloading=!0,this.xhr=l,l.onabort=h,l.onerror=h,l.ontimeout=h,l.onprogress=function(){l.getResponseHeader("content-type")!==le&&l.abort()},l.onload=function(){i.read(l.response)},l.onloadend=function(){i.reloading=!1,i.xhr=null},n.checkCrossOrigin&&b(a)&&c.crossOrigin&&(a=o(a)),l.open("GET",a,!0),l.responseType="arraybuffer",l.withCredentials="use-credentials"===c.crossOrigin,l.send()}}},{key:"read",value:function(a){var i=this.options,c=this.imageData,n=Xe(a),l=0,h=1,_=1;if(n>1){this.url=function Qe(r,e){for(var a=[],c=new Uint8Array(r);c.length>0;)a.push(Y.apply(null,ue(c.subarray(0,8192)))),c=c.subarray(8192);return"data:".concat(e,";base64,").concat(btoa(a.join("")))}(a,le);var m=function We(r){var e=0,a=1,i=1;switch(r){case 2:a=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,a=-1;break;case 8:e=-90}return{rotate:e,scaleX:a,scaleY:i}}(n);l=m.rotate,h=m.scaleX,_=m.scaleY}i.rotatable&&(c.rotate=l),i.scalable&&(c.scaleX=h,c.scaleY=_),this.clone()}},{key:"clone",value:function(){var a=this.element,i=this.url,c=a.crossOrigin,n=i;this.options.checkCrossOrigin&&b(i)&&(c||(c="anonymous"),n=o(i)),this.crossOrigin=c,this.crossOriginUrl=n;var l=document.createElement("img");c&&(l.crossOrigin=c),l.src=n||i,l.alt=a.alt||"The image to crop",this.image=l,l.onload=this.start.bind(this),l.onerror=this.stop.bind(this),k(l,te),a.parentNode.insertBefore(l,a.nextSibling)}},{key:"start",value:function(){var a=this,i=this.image;i.onload=null,i.onerror=null,this.sizing=!0;var c=X.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(X.navigator.userAgent),n=function(m,g){T(a.imageData,{naturalWidth:m,naturalHeight:g,aspectRatio:m/g}),a.initialImageData=T({},a.imageData),a.sizing=!1,a.sized=!0,a.build()};if(!i.naturalWidth||c){var l=document.createElement("img"),h=document.body||document.documentElement;this.sizingImage=l,l.onload=function(){n(l.width,l.height),c||h.removeChild(l)},l.src=i.src,c||(l.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",h.appendChild(l))}else n(i.naturalWidth,i.naturalHeight)}},{key:"stop",value:function(){var a=this.image;a.onload=null,a.onerror=null,a.parentNode.removeChild(a),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var a=this.element,i=this.options,c=this.image,n=a.parentNode,l=document.createElement("div");l.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var h=l.querySelector(".".concat(S,"-container")),_=h.querySelector(".".concat(S,"-canvas")),m=h.querySelector(".".concat(S,"-drag-box")),g=h.querySelector(".".concat(S,"-crop-box")),d=g.querySelector(".".concat(S,"-face"));this.container=n,this.cropper=h,this.canvas=_,this.dragBox=m,this.cropBox=g,this.viewBox=h.querySelector(".".concat(S,"-view-box")),this.face=d,_.appendChild(c),k(a,U),n.insertBefore(h,a.nextSibling),this.isImg||tt(c,te),this.initPreview(),this.bind(),i.initialAspectRatio=Math.max(0,i.initialAspectRatio)||NaN,i.aspectRatio=Math.max(0,i.aspectRatio)||NaN,i.viewMode=Math.max(0,Math.min(3,Math.round(i.viewMode)))||0,k(g,U),i.guides||k(g.getElementsByClassName("".concat(S,"-dashed")),U),i.center||k(g.getElementsByClassName("".concat(S,"-center")),U),i.background&&k(h,"".concat(S,"-bg")),i.highlight||k(d,Ce),i.cropBoxMovable&&(k(d,Zt),St(d,Et,"all")),i.cropBoxResizable||(k(g.getElementsByClassName("".concat(S,"-line")),U),k(g.getElementsByClassName("".concat(S,"-point")),U)),this.render(),this.ready=!0,this.setDragMode(i.dragMode),i.autoCrop&&this.crop(),this.setData(i.data),H(i.ready)&&V(a,"ready",i.ready,{once:!0}),wt(a,"ready")}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),tt(this.element,U))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=ei,r}},{key:"setDefaults",value:function(a){T(de,_t(a)&&a)}}]),r}();return T(Ue.prototype,Ge,Ve,Ke,$e,qe,ti),Ue}()}}]);