(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[4324],{32586:(Ce,et,x)=>{"use strict";x.d(et,{Y:()=>ut});var M=x(59640),K=x(64198),st=x(26860);let ut=(()=>{class t extends M.H{constructor(){super(...arguments),this.limitSize=200,this.selectFile=ct=>{const mt=ct.target,it=mt.files;if(it){if(this.limitSize=this.limitSize>200?200:this.limitSize,Array.from(it).find(at=>(0,K.hD)(at.size)>=this.limitSize))return this.showErrorSnack(this.commonService.translateToKeyParam("lang_auto_vui_long_chon_tep_co_kich_thuoc_nho_hon",this.limitSize.toString(),"MB"));const Rt=[];Array.from(it).forEach(at=>{Rt.push(at)}),this.emitUploadToEditorComplete(Rt)}mt.value=""}}static#t=this.\u0275fac=function(){let ct;return function(it){return(ct||(ct=st.xGo(t)))(it||t)}}();static#e=this.\u0275cmp=st.VBU({type:t,selectors:[["ng-component"]],inputs:{fileType:"fileType",limitSize:"limitSize"},features:[st.Vt3],decls:0,vars:0,template:function(mt,it){},encapsulation:2})}return t})()},64324:(Ce,et,x)=>{"use strict";x.r(et),x.d(et,{AzotaDigitalizeModule:()=>be});var M=x(54460),K=x(10936),st=x(65162),ut=x(69223),t=x(26860),Kt=x(17715);const ct=["image"];function mt(s,w){1&s&&(t.j41(0,"div",6),t.nrm(1,"div",7),t.k0s())}function it(s,w){if(1&s&&(t.j41(0,"div",8),t.EFF(1),t.k0s()),2&s){const r=t.XpG();t.R7$(1),t.JRh(r.loadImageErrorText)}}let Rt=(()=>{class s{constructor(){this.cropperOptions={},this.export=new t.bkB,this.ready=new t.bkB,this.isLoading=!0}ngOnInit(){}ngOnDestroy(){this.cropper&&(this.cropper.destroy(),this.cropper=null)}imageLoaded(r){this.loadError=!1;const h=r.target;this.imageElement=h,this.cropperOptions.checkCrossOrigin&&(h.crossOrigin="anonymous"),h.addEventListener("ready",()=>{this.ready.emit(!0),this.isLoading=!1,this.cropbox&&this.cropper.setCropBoxData(this.cropbox)});let p=NaN;if(this.settings){const{width:m,height:y}=this.settings;p=m/y}this.cropperOptions={aspectRatio:p,checkCrossOrigin:!0,...this.cropperOptions},this.cropper&&(this.cropper.destroy(),this.cropper=void 0),this.cropper=new Kt(h,this.cropperOptions)}imageLoadError(r){this.loadError=!0,this.isLoading=!1}exportCanvas(r){const h=this.cropper.getImageData(),p=this.cropper.getCropBoxData(),m=this.cropper.getCroppedCanvas(),y={imageData:h,cropData:p};new Promise(F=>{if(r)return F({dataUrl:m.toDataURL("image/png")});m.toBlob(pt=>F({blob:pt}))}).then(F=>{this.export.emit({...y,...F})})}}return s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=t.VBU({type:s,selectors:[["angular-cropper"]],viewQuery:function(r,h){if(1&r&&t.GBs(ct,7),2&r){let p;t.mGM(p=t.lsd())&&(h.image=p.first)}},inputs:{imageUrl:"imageUrl",settings:"settings",cropbox:"cropbox",loadImageErrorText:"loadImageErrorText",cropperOptions:"cropperOptions"},outputs:{export:"export",ready:"ready"},decls:6,vars:3,consts:[[1,"cropper-wrapper"],["class","loading-block",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"cropper"],["alt","image",3,"src","load","error"],["image",""],[1,"loading-block"],[1,"spinner"],[1,"alert","alert-warning"]],template:function(r,h){1&r&&(t.j41(0,"div",0),t.DNE(1,mt,2,0,"div",1),t.DNE(2,it,2,1,"div",2),t.j41(3,"div",3)(4,"img",4,5),t.bIt("load",function(m){return h.imageLoaded(m)})("error",function(m){return h.imageLoadError(m)}),t.k0s()()()),2&r&&(t.R7$(1),t.Y8G("ngIf",h.isLoading),t.R7$(1),t.Y8G("ngIf",h.loadError),t.R7$(2),t.Y8G("src",h.imageUrl,t.B4B))},dependencies:[M.bT],styles:[':host{display:block}.cropper img{max-width:100%;max-height:100%;height:auto}.cropper-wrapper{position:relative;min-height:80px}.cropper-wrapper .loading-block{position:absolute;top:0;left:0;width:100%;height:100%}.cropper-wrapper .loading-block .spinner{width:31px;height:31px;margin:0 auto;border:2px solid rgba(97,100,193,.98);border-radius:50%;border-left-color:transparent;border-right-color:transparent;-webkit-animation:cssload-spin 425ms infinite linear;position:absolute;top:calc(50% - 15px);left:calc(50% - 15px);animation:cssload-spin 425ms infinite linear}@keyframes cssload-spin{to{transform:rotate(360deg)}}/*!\n * Cropper.js v1.4.1\n * https://fengyuanchen.github.io/cropperjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2018-07-15T09:54:43.167Z\n */.cropper-container{direction:ltr;font-size:0;line-height:0;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.cropper-container img{display:block;height:100%;image-orientation:0deg;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;width:100%}.cropper-wrap-box,.cropper-canvas,.cropper-drag-box,.cropper-crop-box,.cropper-modal{inset:0;position:absolute}.cropper-wrap-box,.cropper-canvas{overflow:hidden}.cropper-drag-box{background-color:#fff;opacity:0}.cropper-modal{background-color:#000;opacity:.5}.cropper-view-box{display:block;height:100%;outline-color:#3399ffbf;outline:1px solid #39f;overflow:hidden;width:100%}.cropper-dashed{border:0 dashed #eee;display:block;opacity:.5;position:absolute}.cropper-dashed.dashed-h{border-bottom-width:1px;border-top-width:1px;height:calc(100% / 3);left:0;top:calc(100% / 3);width:100%}.cropper-dashed.dashed-v{border-left-width:1px;border-right-width:1px;height:100%;left:calc(100% / 3);top:0;width:calc(100% / 3)}.cropper-center{display:block;height:0;left:50%;opacity:.75;position:absolute;top:50%;width:0}.cropper-center:before,.cropper-center:after{background-color:#eee;content:" ";display:block;position:absolute}.cropper-center:before{height:1px;left:-3px;top:0;width:7px}.cropper-center:after{height:7px;left:0;top:-3px;width:1px}.cropper-face,.cropper-line,.cropper-point{display:block;height:100%;opacity:.1;position:absolute;width:100%}.cropper-face{background-color:#fff;left:0;top:0}.cropper-line{background-color:#39f}.cropper-line.line-e{cursor:ew-resize;right:-3px;top:0;width:5px}.cropper-line.line-n{cursor:ns-resize;height:5px;left:0;top:-3px}.cropper-line.line-w{cursor:ew-resize;left:-3px;top:0;width:5px}.cropper-line.line-s{bottom:-3px;cursor:ns-resize;height:5px;left:0}.cropper-point{background-color:#39f;height:5px;opacity:.75;width:5px}.cropper-point.point-e{cursor:ew-resize;margin-top:-3px;right:-3px;top:50%}.cropper-point.point-n{cursor:ns-resize;left:50%;margin-left:-3px;top:-3px}.cropper-point.point-w{cursor:ew-resize;left:-3px;margin-top:-3px;top:50%}.cropper-point.point-s{bottom:-3px;cursor:s-resize;left:50%;margin-left:-3px}.cropper-point.point-ne{cursor:nesw-resize;right:-3px;top:-3px}.cropper-point.point-nw{cursor:nwse-resize;left:-3px;top:-3px}.cropper-point.point-sw{bottom:-3px;cursor:nesw-resize;left:-3px}.cropper-point.point-se{bottom:-3px;cursor:nwse-resize;height:20px;opacity:1;right:-3px;width:20px}@media (min-width: 768px){.cropper-point.point-se{height:15px;width:15px}}@media (min-width: 992px){.cropper-point.point-se{height:10px;width:10px}}@media (min-width: 1200px){.cropper-point.point-se{height:5px;opacity:.75;width:5px}}.cropper-point.point-se:before{background-color:#39f;bottom:-50%;content:" ";display:block;height:200%;opacity:0;position:absolute;right:-50%;width:200%}.cropper-invisible{opacity:0}.cropper-bg{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC)}.cropper-hide{display:block;height:0;position:absolute;width:0}.cropper-hidden{display:none!important}.cropper-move{cursor:move}.cropper-crop{cursor:crosshair}.cropper-disabled .cropper-drag-box,.cropper-disabled .cropper-face,.cropper-disabled .cropper-line,.cropper-disabled .cropper-point{cursor:not-allowed}\n'],encapsulation:2}),s})(),at=(()=>{class s{}return s.\u0275fac=function(r){return new(r||s)},s.\u0275mod=t.$C({type:s}),s.\u0275inj=t.G2t({imports:[M.MD]}),s})();var U=x(15343),Bt=x(10123),Ot=x(5502),I=x(46584),Nt=x(70050),Zt=x(7050),qt=x(91100),Pt=x(43234),lt=x(1133),W=x(59640),Z=x(73014),rt=x(85710),P=x(73437),Dt=x(25693),Et=x(5849);let ft=(()=>{class s{constructor(){this.subscriptions=new rt.yU,this.ocrService=(0,t.WQX)(Et.so),this.commonService=(0,t.WQX)(Dt.R)}digitalizeData(r,h,p,m){if(!r.image.url)return m(r);h("lang_digitalize_call_ocr_api"),this.subscriptions.add(this.ocrService.aiApiV1OcrImageToTextPost({imageUrl:r.image.url}).subscribe({next:y=>{h("lang_digitalize_load_detect_image_script"),this.loadScriptHandleImage(()=>{h("lang_digitalize_call_detect_image_function"),this.imageUtils.detectImage(r.image.fileBytes).then(O=>m(this.replaceOrcData(r,y,O.images))).catch(O=>m(this.replaceOrcData(r,y,[])))})},error:y=>p(y.error.message)}))}uint8ArrayToBase64(r){let h="";const p=r.byteLength;for(let m=0;m<p;m++)h+=String.fromCharCode(r[m]);return btoa(h)}replaceOrcData(r,h,p){r.image.base64Images=p.map(O=>({base64:this.uint8ArrayToBase64(new Uint8Array(O.content)),width:O.width,height:O.height,extension:O.extension}));let m=h.data,y={};return[m,y]=this.commonService.extractOriginDataOfLatex(m),m=(new P.bt).transform((new P.UN).transform(m)),m=this.commonService.replaceBackToOriginDataOfLatex(m,y),m=this.commonService.convertLatexTagToDollarDollar(m),m=this.commonService.replaceAll(m,"<table>","<table class='table table-bordered'>")??m,r.htmlResult=m,r}waitAnswerSheetInitDone(r){if(window.azotaScanAnswerSheet)return r();setTimeout(()=>{this.waitAnswerSheetInitDone(r)},100)}loadScriptHandleImage(r){var h=this;if(this.imageUtils)return r();this.commonService.loadAnswerSheetJs().then((0,Z.A)(function*(){h.waitAnswerSheetInitDone((0,Z.A)(function*(){h.imageUtils=yield window.azotaScanAnswerSheet.imageUtils(),r()}))})).catch(p=>{this.commonService.snackError("lang_auto_tai_thu_vien_that_bao_vui_long_load_lai_trang_de_thu_lai"),r()})}ngOnDestroy(){this.subscriptions.unsubscribe()}static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var Y=function(s){return s[s.NONE=0]="NONE",s[s.PROCESSING=1]="PROCESSING",s[s.PROCESS_ERROR=2]="PROCESS_ERROR",s[s.PROCESSED=3]="PROCESSED",s}(Y||{}),vt=function(s){return s[s.CHOOSE_IMAGES=0]="CHOOSE_IMAGES",s[s.PROCESS_IMAGES=1]="PROCESS_IMAGES",s}(vt||{}),L=x(18718),te=x(96451),Oe=x(64198),_t=x(39712),Gt=x(63709),St=x(14159),Mt=x(27035),Lt=x(17178),ee=x(63016),Ft=x(47947),Yt=x(20036),jt=x(15351);const Ut=(s,w)=>(s.push(w),s);let De=(()=>{class s{processObservables(r,h){return(0,St.H)(h).pipe((0,Mt.Z)((p,m)=>p.pipe((0,Lt.W)(y=>(console.error("Error in observable:",y),(0,ee.of)(null))),(0,Ft.T)(y=>({result:y,index:m}))),r),function ie(){return(0,jt.N)((s,w)=>{(function Xt(s,w){return(0,jt.N)((0,Yt.S)(s,w,arguments.length>=2,!1,!0))})(Ut,[])(s).subscribe(w)})}(),(0,Ft.T)(p=>p.sort((m,y)=>m.index-y.index).map(m=>m.result)))}static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var Ee=x(41426),Se=x(32586),ae=x(34068);const re=["*"];let oe=(()=>{class s extends Se.Y{constructor(){super(...arguments),this.emitFiles=new t.bkB}emitUploadToEditorComplete(r){r.length>0&&this.emitFiles.emit(r)}onDrop(r){try{this.emitFiles.emit(r)}catch(h){alert(h)}}static#t=this.\u0275fac=function(){let r;return function(p){return(r||(r=t.xGo(s)))(p||s)}}();static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["azt-upload-multiple-document-to-editor"]],outputs:{emitFiles:"emitFiles"},features:[t.Vt3],ngContentSelectors:re,decls:5,vars:2,consts:[[1,"upload-document","h-full",3,"appDropZone","click"],[3,"hidden"],["type","file","multiple","",1,"form-control","file-input",3,"accept","change"],["fileSelect",""]],template:function(h,p){if(1&h){const m=t.RV6();t.NAR(),t.j41(0,"div",0),t.bIt("appDropZone",function(O){return p.onDrop(O)})("click",function(){t.eBV(m);const O=t.sdS(3);return t.Njj(O.click())}),t.j41(1,"form",1)(2,"input",2,3),t.bIt("change",function(O){return p.selectFile(O)}),t.k0s()(),t.SdG(4),t.k0s()}2&h&&(t.R7$(1),t.Y8G("hidden",!0),t.R7$(1),t.FS9("accept",p.fileType))},dependencies:[K.qT,K.cb,K.cV,ae.F],encapsulation:2})}return s})();function ne(s,w){if(1&s&&t.nrm(0,"azt-loading-effect",2),2&s){const r=t.XpG();t.Y8G("currentStatusObj",r.statusObj)("customText",r.statusObj.errorMessage)}}const se=function(s,w){return[s,w]},ce=function(){return{"mr-2":!0}};function Vt(s,w){if(1&s){const r=t.RV6();t.j41(0,"azt-upload-multiple-document-to-editor",3),t.bIt("emitFiles",function(p){t.eBV(r);const m=t.XpG();return t.Njj(m.handleUploadComplete(p))}),t.j41(1,"a",4),t.nrm(2,"lucide-icon",5),t.j41(3,"span"),t.EFF(4),t.nI1(5,"mytranslate"),t.k0s()()()}if(2&s){const r=t.XpG();t.Y8G("fileType",t.l_i(5,se,r.allUploadFileTypes.PDF,r.allUploadFileTypes.IMAGE)),t.R7$(2),t.Y8G("ngClass",t.lJ4(8,ce)),t.R7$(2),t.JRh(t.bMT(5,3,"lang_digitalize_book_upload_file"))}}let le=(()=>{class s extends W.H{handleUploadComplete(r){this.initStatusObj("lang_digitalize_convert_pdf_to_images"),this.convertAllPdfToImages(r).then(h=>{let p=[];h.forEach(m=>{let y=this.apiUploadService.commonUploadFile(this.allUploadToCdnMenuTypes.ADMIN_DIGITALIZE,m,"");p.push(y)}),this.initStatusObj("lang_digitalize_upload_images_to_cdn"),this.sAztConcurrencyApiService.processObservables(this.uploadThread,p).subscribe(m=>{if(m.find($=>!$?.success))return this.errorStatusObj("lang_digitalize_book_upload_file_error",!0);let O=[],F=m.map($=>$?.data).filter(this.commonService.notEmpty),pt=h.map($=>this.convertFileToUint8Array($));this.initStatusObj("lang_digitalize_convert_file_to_byte_array"),Promise.all(pt).then($=>{F.forEach((ye,Jt)=>{let we=this.commonService.getItemAtIndexOfArray($,Jt);if(null==we)throw Error("lang_digitalize_missing_file_byte_array");O.push({...ye,fileBytes:we,base64Images:[]})}),this.stopStatusObj(),this.uploadData.emit(O)}).catch($=>console.error("lang_digitalize_convert_to_uint8_array_error: ",$))})})}convertAllPdfToImages(r){var h=this;let p=[];return r.forEach(m=>{if((0,Oe.wu)(m.type))return void p.push(new Promise(function(){var O=(0,Z.A)(function*(F,pt){F([m])});return function(F,pt){return O.apply(this,arguments)}}()));let y=new Promise(function(){var O=(0,Z.A)(function*(F,pt){let $=[],Jt=yield h.withTimeout(h.myPdfService.getImageWithPdf(m),3e5);$.push(...Jt),F($)});return function(F,pt){return O.apply(this,arguments)}}());p.push(y)}),new Promise(function(){var m=(0,Z.A)(function*(y,O){Promise.all(p).then(F=>{y(h.commonService.concatMultipleArray(F))}).catch(F=>{h.showErrorSnack("lang_azt_pdf_invalid_format"),y([])})});return function(y,O){return m.apply(this,arguments)}}())}withTimeout(r,h){return new Promise((p,m)=>{const y=setTimeout(()=>{m(new Error("Operation timed out"))},h);r.then(O=>{clearTimeout(y),p(O)}).catch(O=>{clearTimeout(y),m(O)})})}convertFileToUint8Array(r){return new Promise((h,p)=>{const m=new FileReader;m.onload=()=>{if(m.result instanceof ArrayBuffer){const y=new Uint8Array(m.result);h(y)}else p(new Error("Error reading file as ArrayBuffer."))},m.onerror=()=>{p(new Error("Error reading file."))},m.readAsArrayBuffer(r)})}ngOnInit(){super.ngOnInit()}constructor(r,h,p){super(),this.myPdfService=r,this.sAztConcurrencyApiService=h,this.apiUploadService=p,this.uploadData=new t.bkB,this.allUploadToCdnMenuTypes=_t.b8,this.allUploadFileTypes=_t.PO,this.uploadThread=10}static#t=this.\u0275fac=function(h){return new(h||s)(t.rXU(Gt.C),t.rXU(De),t.rXU(Ee.T))};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digitalize-pdf-to-images"]],outputs:{uploadData:"uploadData"},features:[t.Vt3],decls:3,vars:2,consts:[[3,"currentStatusObj","customText",4,"ngIf","ngIfElse"],["doneLoading",""],[3,"currentStatusObj","customText"],[3,"fileType","emitFiles"],[1,"btn","btn-primary-soft","w-full"],["name","plus","size","16",3,"ngClass"]],template:function(h,p){if(1&h&&(t.DNE(0,ne,1,2,"azt-loading-effect",0),t.DNE(1,Vt,6,9,"ng-template",null,1,t.C5r)),2&h){const m=t.sdS(2);t.Y8G("ngIf",p.statusObj.loading)("ngIfElse",m)}},dependencies:[M.YU,M.bT,L.K,oe,U.WGl,P.wp],encapsulation:2})}return s})();const Ae=function(s){return{"mb-2":s}},Ie=function(s){return{"border-pending":s}};function Te(s,w){if(1&s){const r=t.RV6();t.j41(0,"div",4)(1,"span",5),t.EFF(2),t.k0s(),t.j41(3,"img",6),t.bIt("click",function(){const m=t.eBV(r).$implicit,y=t.XpG();return t.Njj(y.chooseImageEvent(m))}),t.k0s()()}if(2&s){const r=w.$implicit,h=w.last,p=t.XpG();t.Y8G("ngClass",t.eq3(4,Ae,!h)),t.R7$(2),t.JRh(r.position),t.R7$(1),t.Y8G("src",r.image.url,t.B4B)("ngClass",t.eq3(6,Ie,p.listSelectedPositions.includes(r.position)))}}let ze=(()=>{class s extends W.H{chooseImageEvent(r){let h=this.objs.find(p=>p.position==r.position);h&&(h.isSelected=!h.isSelected,this.listSelectedPositions=this.objs.filter(p=>p.isSelected).map(p=>p.position),this.chooseImages.emit(this.objs.filter(p=>p.isSelected)))}ngOnInit(){super.ngOnInit(),this.listSelectedPositions=this.objs.filter(r=>r.isSelected).map(r=>r.position)}constructor(){super(),this.chooseImages=new t.bkB,this.listSelectedPositions=[]}static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digitalize-choose-images"]],inputs:{objs:"objs"},outputs:{chooseImages:"chooseImages"},features:[t.Vt3],decls:6,vars:6,consts:[[2,"height","60vh","margin-bottom","30px"],[1,"pb-2"],["track","vertical","pointerEventsMethod","scrollbar",1,"w-full",3,"visibility"],["class","relative",3,"ngClass",4,"ngFor","ngForOf"],[1,"relative",3,"ngClass"],[1,"text-pending","font-medium","absolute","right-0","mr-2","pt-1"],[1,"w-full","clickable","mb-1","border-gray",3,"src","ngClass","click"]],template:function(h,p){1&h&&(t.j41(0,"div",0)(1,"div",1),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s(),t.j41(4,"ng-scrollbar",2),t.DNE(5,Te,4,8,"div",3),t.k0s()()),2&h&&(t.R7$(2),t.Lme("",t.bMT(3,4,"lang_digitalize_book_total_page"),": ",p.objs.length,""),t.R7$(2),t.Y8G("visibility","hover"),t.R7$(1),t.Y8G("ngForOf",p.objs))},dependencies:[M.YU,M.Sq,Ot.Yh,P.wp],encapsulation:2})}return s})();const he=function(s){return{"mb-2":s}},pe=function(s){return{"border-pending":s}};function de(s,w){if(1&s){const r=t.RV6();t.j41(0,"div",4)(1,"span",5),t.EFF(2),t.k0s(),t.j41(3,"img",6),t.bIt("click",function(){const m=t.eBV(r).$implicit,y=t.XpG();return t.Njj(y.processImage.emit(m))}),t.k0s()()}if(2&s){const r=w.$implicit,h=w.last,p=t.XpG();t.Y8G("ngClass",t.eq3(4,he,!h)),t.R7$(2),t.JRh(r.position),t.R7$(1),t.Y8G("src",r.image.url,t.B4B)("ngClass",t.eq3(6,pe,(null==p.currentObj?null:p.currentObj.position)==r.position))}}let Re=(()=>{class s extends W.H{ngOnInit(){super.ngOnInit(),this.viewObjs=this.objs.filter(r=>r.isSelected)}constructor(){super(),this.processImage=new t.bkB,this.viewObjs=[]}static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digitalize-process-images"]],inputs:{objs:"objs",currentObj:"currentObj"},outputs:{processImage:"processImage"},features:[t.Vt3],decls:6,vars:6,consts:[[2,"height","60vh","margin-bottom","30px"],[1,"pb-2"],["track","vertical","pointerEventsMethod","scrollbar",1,"w-full",3,"visibility"],["class","relative",3,"ngClass",4,"ngFor","ngForOf"],[1,"relative",3,"ngClass"],[1,"text-pending","font-medium","absolute","right-0","mr-2","pt-1"],[1,"w-full","clickable","mb-1","border-gray",3,"src","ngClass","click"]],template:function(h,p){1&h&&(t.j41(0,"div",0)(1,"div",1),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s(),t.j41(4,"ng-scrollbar",2),t.DNE(5,de,4,8,"div",3),t.k0s()()),2&h&&(t.R7$(2),t.Lme("",t.bMT(3,4,"lang_digitalize_book_total_page"),": ",p.viewObjs.length,""),t.R7$(2),t.Y8G("visibility","hover"),t.R7$(1),t.Y8G("ngForOf",p.viewObjs))},dependencies:[M.YU,M.Sq,Ot.Yh,P.wp],encapsulation:2})}return s})();var Me=x(46899),C=x(70254),$t=x(89163),Ht=x(33887);const ht=["angularCropper"];function je(s,w){if(1&s){const r=t.RV6();t.qex(0),t.j41(1,"img",9),t.bIt("click",function(){const m=t.eBV(r).$implicit,y=t.XpG(2);return t.Njj(y.chooseImage(m))}),t.nI1(2,"addBase64Extension"),t.k0s(),t.bVm()}if(2&s){const r=w.$implicit;t.R7$(1),t.FS9("src",t.i5U(2,1,r.base64,"png"),t.B4B)}}function bt(s,w){if(1&s&&(t.j41(0,"div",7),t.DNE(1,je,3,4,"ng-container",8),t.k0s()),2&s){const r=t.XpG();t.R7$(1),t.Y8G("ngForOf",r.base64Images)}}function X(s,w){if(1&s&&(t.nrm(0,"angular-cropper",10,11),t.nI1(2,"addBase64Extension")),2&s){const r=t.XpG();t.Y8G("cropperOptions",r.cropperOptions)("imageUrl",t.i5U(2,2,r.currentBase64Image.base64,"png"))}}let ke=(()=>{class s extends Ht._{chooseImage(r){this.currentBase64Image=r}cropImage(){this.angularCropper?.cropper.getCroppedCanvas().toBlob(r=>{r&&this.commonService.convertBlobToBase64(r,h=>{let p=this.angularCropper?.cropper.getCropBoxData(),m=p?.width,y=p?.height;!m||!y||this.base64Images.push({position:this.base64Images.length,base64:h,width:m,height:y,extension:"png"})})})}closeDialog(){this.dialogRef.close(this.base64Images)}constructor(r,h){super(h,r),this.dialogRef=r,this.data=h,this.base64Images=[],this.cropperOptions={movable:!0,scalable:!1,zoomable:!1,data:{width:240,height:90}},this.base64Images=h.base64Images,this.currentBase64Image=this.commonService.getFirstOfArray(this.base64Images)}static#t=this.\u0275fac=function(h){return new(h||s)(t.rXU($t.CP,8),t.rXU($t.Vh,8))};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-coazt-image-editor"]],viewQuery:function(h,p){if(1&h&&t.GBs(ht,5),2&h){let m;t.mGM(m=t.lsd())&&(p.angularCropper=m.first)}},features:[t.Vt3],decls:11,vars:8,consts:[[1,"box","p-3"],["class","list-base640-images mb-3",4,"ngIf"],[1,"text-center","mb-3"],[1,"btn","btn-primary","mr-2","w-32",3,"click"],[1,"btn","btn-secondary","mr-2","w-32",3,"click"],[2,"height","calc(100vh - 120px)","overflow-x","hidden","overflow-y","scroll"],[3,"cropperOptions","imageUrl",4,"ngIf"],[1,"list-base640-images","mb-3"],[4,"ngFor","ngForOf"],[1,"box","mr-2","mb-2","clickable",3,"src","click"],[3,"cropperOptions","imageUrl"],["angularCropper",""]],template:function(h,p){1&h&&(t.j41(0,"div",0),t.DNE(1,bt,2,1,"div",1),t.j41(2,"div",2)(3,"span",3),t.bIt("click",function(){return p.cropImage()}),t.EFF(4),t.nI1(5,"mytranslate"),t.k0s(),t.j41(6,"span",4),t.bIt("click",function(){return p.closeDialog()}),t.EFF(7),t.nI1(8,"mytranslate"),t.k0s()(),t.j41(9,"div",5),t.DNE(10,X,3,5,"angular-cropper",6),t.k0s()()),2&h&&(t.R7$(1),t.Y8G("ngIf",p.base64Images.length>0),t.R7$(3),t.JRh(t.bMT(5,4,"lang_button_crop")),t.R7$(3),t.JRh(t.bMT(8,6,"lang_button_close")),t.R7$(3),t.Y8G("ngIf",p.currentBase64Image))},dependencies:[M.Sq,M.bT,Rt,P.wp,P.t4],styles:[".list-base640-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ccc;height:50px;width:50px}"]})}return s})();function ge(s,w){if(1&s){const r=t.RV6();t.qex(0),t.j41(1,"img",8),t.bIt("click",function(){const m=t.eBV(r).$implicit,y=t.XpG(2);return t.Njj(y.chooseImage(m))}),t.nI1(2,"addBase64Extension"),t.k0s(),t.bVm()}if(2&s){const r=w.$implicit;t.R7$(1),t.FS9("src",t.i5U(2,1,r.base64,r.extension),t.B4B)}}function R(s,w){if(1&s&&(t.j41(0,"div",6),t.DNE(1,ge,3,4,"ng-container",7),t.k0s()),2&s){const r=t.XpG();t.R7$(1),t.Y8G("ngForOf",r.obj.image.base64Images)}}function T(s,w){if(1&s&&(t.j41(0,"div",9),t.nrm(1,"editor",10)(2,"hr",11)(3,"div",12),t.nI1(4,"safeNormalHtmlContent"),t.nI1(5,"async"),t.nI1(6,"mathJaxContent"),t.k0s()),2&s){const r=t.XpG();t.R7$(1),t.FS9("apiKey",r.tinyEditorKey),t.Y8G("formControl",r.htmlFormControl)("init",r.initDataEditor),t.BMQ("style","width: 100%;min-height:500px;",t.$dS),t.R7$(2),t.Y8G("innerHTML",t.bMT(4,5,t.bMT(5,7,t.bMT(6,9,r.obj.htmlResult))),t.npT)}}let Be=(()=>{class s extends W.H{constructor(){super(...arguments),this.changeObj=new t.bkB,this.sAztDialogService=(0,t.WQX)(Me.i),this.tinyMceService=(0,t.WQX)(C.f),this.sAztDigitalizeService=(0,t.WQX)(ft),this.htmlFormControl=new K.MJ("",{nonNullable:!0}),this.initDataEditor={},this.tinyEditorKey=Pt.c.tinyEditorKey,this.showTinyMceEditor=!1,this.reRenderComponent=void 0}chooseImage(r){this.obj.htmlResult=this.obj.htmlResult.replace("<img>",`<img src='${this.commonService.generateBase64Prefix(r.extension)+r.base64}'/>`),this.htmlFormControl.setValue(this.obj.htmlResult)}cropImageDialog(){let r=[{position:-1,base64:this.sAztDigitalizeService.uint8ArrayToBase64(new Uint8Array(this.obj.image.fileBytes)),width:100,height:100,extension:"png"}],h=this.obj.image.base64Images.map((m,y)=>({...m,position:y}));r=r.concat(h),this.sAztDialogService.open(ke,{data:{base64Images:r},restoreFocus:!1,width:"100vw",maxWidth:"100vw",height:"100vh",backdropClass:"azt-backdrop-full-width-height",disableClose:!0}).afterClosed().subscribe(m=>{null!=m&&(this.obj.image.base64Images=m.slice(1),this.changeObj.emit(this.obj))})}ngOnChanges(){console.log("On change value"),this.reRenderComponent=void 0,this.htmlFormControl.setValue(this.obj.htmlResult),setTimeout(()=>this.reRenderComponent="OK",0)}ngOnInit(){this.htmlFormControl.valueChanges.subscribe(()=>{this.obj.htmlResult=this.htmlFormControl.getRawValue(),this.changeObj.emit(this.obj)}),this.initDataEditor=this.tinyMceService.initConfigForAdminForDigitalized(_t.b8.ADMIN)}static#t=this.\u0275fac=function(){let r;return function(p){return(r||(r=t.xGo(s)))(p||s)}}();static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digitalize-preview-result"]],inputs:{obj:"obj"},outputs:{changeObj:"changeObj"},features:[t.Vt3,t.OA$],decls:8,vars:5,consts:[["class","box p-3 mb-3 list-base640-images",4,"ngIf"],[1,"mb-3"],[1,"btn","btn-primary","w-32",3,"click"],[1,"grid","grid-cols-12","gap-5"],[1,"col-span-12"],["class","box p-3",4,"ngIf"],[1,"box","p-3","mb-3","list-base640-images"],[4,"ngFor","ngForOf"],[1,"box","mr-2","mb-2","clickable",3,"src","click"],[1,"box","p-3"],[3,"formControl","apiKey","init"],[1,"mt-8","mb-8"],[3,"innerHTML"]],template:function(h,p){1&h&&(t.DNE(0,R,2,1,"div",0),t.j41(1,"div",1)(2,"span",2),t.bIt("click",function(){return p.cropImageDialog()}),t.EFF(3),t.nI1(4,"mytranslate"),t.k0s()(),t.j41(5,"div",3)(6,"div",4),t.DNE(7,T,7,11,"div",5),t.k0s()()),2&h&&(t.Y8G("ngIf",p.obj.image.base64Images.length>0),t.R7$(3),t.JRh(t.bMT(4,3,"lang_button_crop")),t.R7$(4),t.Y8G("ngIf",p.reRenderComponent))},dependencies:[M.Sq,M.bT,K.BC,ut.xn,K.l_,M.Jj,P.wp,P.km,P._y,P.t4],styles:[".list-base640-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ccc;width:200px}"]})}return s})();function yt(s,w){if(1&s&&t.nrm(0,"azt-loading-effect",4),2&s){const r=t.XpG();t.Y8G("currentStatusObj",r.statusObj)}}function Ne(s,w){if(1&s){const r=t.RV6();t.j41(0,"app-digitalize-pdf-to-images",16),t.bIt("uploadData",function(p){t.eBV(r);const m=t.XpG(2);return t.Njj(m.uploadData(p))}),t.k0s()}}function ot(s,w){if(1&s){const r=t.RV6();t.j41(0,"div",17),t.bIt("click",function(){t.eBV(r);const p=t.XpG(2);return t.Njj(p.showChooseLayout())}),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()}2&s&&(t.R7$(1),t.JRh(t.bMT(2,1,"lang_digitalize_book_go_back_choose_layout")))}function Pe(s,w){if(1&s){const r=t.RV6();t.j41(0,"app-digitalize-choose-images",21),t.bIt("chooseImages",function(p){t.eBV(r);const m=t.XpG(3);return t.Njj(m.chooseImages(p))}),t.k0s()}if(2&s){const r=t.XpG(3);t.Y8G("objs",r.objs)}}function j(s,w){if(1&s){const r=t.RV6();t.j41(0,"app-digitalize-process-images",22),t.bIt("processImage",function(p){t.eBV(r);const m=t.XpG(3);return t.Njj(m.processImage(p))}),t.k0s()}if(2&s){const r=t.XpG(3);t.Y8G("objs",r.objs)("currentObj",r.currentObj)}}function q(s,w){if(1&s&&(t.j41(0,"div",18),t.DNE(1,Pe,1,1,"app-digitalize-choose-images",19),t.DNE(2,j,1,2,"app-digitalize-process-images",20),t.k0s()),2&s){const r=t.XpG(2);t.R7$(1),t.Y8G("ngIf",r.currentLayout==r.allLayouts.CHOOSE_IMAGES),t.R7$(1),t.Y8G("ngIf",r.currentLayout==r.allLayouts.PROCESS_IMAGES)}}function wt(s,w){if(1&s){const r=t.RV6();t.j41(0,"div")(1,"div",12),t.bIt("click",function(){t.eBV(r);const p=t.XpG(3);return t.Njj(p.startProcess())}),t.EFF(2),t.nI1(3,"mytranslate"),t.nI1(4,"mytranslate"),t.k0s()()}if(2&s){const r=t.XpG(3);t.R7$(2),t.E5c("",t.bMT(3,3,"lang_digitalize_book_start_call_orc_api")," (",r.totalSelected," ",t.bMT(4,5,"lang_digitalize_book_total_images"),")")}}function Ge(s,w){1&s&&(t.EFF(0),t.nI1(1,"mytranslate")),2&s&&t.SpI(" ",t.bMT(1,1,"lang_digitalize_book_please_choose_image")," ")}function Wt(s,w){if(1&s&&(t.qex(0),t.j41(1,"div",18),t.DNE(2,wt,5,7,"div",23),t.DNE(3,Ge,2,3,"ng-template",null,24,t.C5r),t.k0s(),t.bVm()),2&s){const r=t.sdS(4),h=t.XpG(2);t.R7$(2),t.Y8G("ngIf",h.totalSelected>0)("ngIfElse",r)}}function Qt(s,w){if(1&s){const r=t.RV6();t.j41(0,"div")(1,"span",25),t.bIt("click",function(){t.eBV(r);const p=t.XpG(4);return t.Njj(p.processAllAgain())}),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s()()}2&s&&(t.R7$(2),t.JRh(t.bMT(3,1,"lang_digitalize_book_call_ocr_all_again")))}function At(s,w){if(1&s){const r=t.RV6();t.j41(0,"div")(1,"span",26),t.bIt("click",function(){t.eBV(r);const p=t.XpG(4);return t.Njj(p.processCurrentPageAgain())}),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s()()}2&s&&(t.R7$(2),t.JRh(t.bMT(3,1,"lang_digitalize_book_call_ocr_current_page_again")))}function Le(s,w){if(1&s){const r=t.RV6();t.j41(0,"div")(1,"app-digitalize-preview-result",27),t.bIt("changeObj",function(p){t.eBV(r);const m=t.XpG(4);return t.Njj(m.changeObj(p))}),t.k0s()()}if(2&s){const r=t.XpG(4);t.R7$(1),t.Y8G("obj",r.currentObj)}}function ue(s,w){if(1&s&&t.nrm(0,"azt-loading-effect",29),2&s){const r=t.XpG(5);t.Y8G("currentStatusObj",r.processStatusObj)("customText",r.processStatusObj.errorMessage)}}function me(s,w){if(1&s&&(t.j41(0,"div"),t.DNE(1,ue,1,2,"azt-loading-effect",28),t.k0s()),2&s){const r=t.XpG(4);t.R7$(1),t.Y8G("ngIf",r.processStatusObj.loading)}}function Q(s,w){if(1&s&&(t.qex(0),t.DNE(1,Qt,4,3,"div",15),t.DNE(2,At,4,3,"div",15),t.DNE(3,Le,2,1,"div",15),t.DNE(4,me,2,1,"div",15),t.bVm()),2&s){const r=t.XpG(3);t.R7$(1),t.Y8G("ngIf",r.currentObj.processStatus==r.allProcessStatuses.PROCESS_ERROR),t.R7$(1),t.Y8G("ngIf",r.currentObj.processStatus==r.allProcessStatuses.PROCESSED),t.R7$(1),t.Y8G("ngIf",r.currentObj.processStatus==r.allProcessStatuses.PROCESSED),t.R7$(1),t.Y8G("ngIf",r.currentObj.processStatus==r.allProcessStatuses.NONE||r.currentObj.processStatus==r.allProcessStatuses.PROCESSING)}}function V(s,w){1&s&&(t.qex(0),t.j41(1,"div",18),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s(),t.bVm()),2&s&&(t.R7$(2),t.JRh(t.bMT(3,1,"lang_digitalize_book_please_choose_image")))}function xt(s,w){if(1&s&&(t.qex(0),t.DNE(1,Q,5,4,"ng-container",15),t.DNE(2,V,4,3,"ng-container",15),t.bVm()),2&s){const r=t.XpG(2);t.R7$(1),t.Y8G("ngIf",r.currentObj),t.R7$(1),t.Y8G("ngIf",!r.currentObj)}}function fe(s,w){if(1&s){const r=t.RV6();t.j41(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8),t.DNE(4,Ne,1,0,"app-digitalize-pdf-to-images",9),t.DNE(5,ot,3,3,"div",10),t.k0s(),t.j41(6,"div",11)(7,"div",12),t.bIt("click",function(){t.eBV(r);const p=t.XpG();return t.Njj(p.downloadData("html"))}),t.EFF(8),t.nI1(9,"mytranslate"),t.k0s()(),t.j41(10,"div",11)(11,"div",12),t.bIt("click",function(){t.eBV(r);const p=t.XpG();return t.Njj(p.downloadData("docx"))}),t.EFF(12),t.nI1(13,"mytranslate"),t.k0s()()(),t.DNE(14,q,3,2,"div",13),t.k0s(),t.j41(15,"div",14),t.DNE(16,Wt,5,2,"ng-container",15),t.DNE(17,xt,3,2,"ng-container",15),t.k0s()()}if(2&s){const r=t.XpG();t.R7$(4),t.Y8G("ngIf",r.currentLayout==r.allLayouts.CHOOSE_IMAGES),t.R7$(1),t.Y8G("ngIf",r.currentLayout==r.allLayouts.PROCESS_IMAGES),t.R7$(3),t.JRh(t.bMT(9,7,"lang_digitalize_book_download_result_html")),t.R7$(4),t.JRh(t.bMT(13,9,"lang_digitalize_book_download_result_docx")),t.R7$(2),t.Y8G("ngIf",r.objs.length>0),t.R7$(2),t.Y8G("ngIf",r.currentLayout==r.allLayouts.CHOOSE_IMAGES),t.R7$(1),t.Y8G("ngIf",r.currentLayout==r.allLayouts.PROCESS_IMAGES)}}const Fe=[{path:"",children:[{path:"digitalize-book",component:(()=>{class s extends W.H{startProcess(){this.currentLayout=vt.PROCESS_IMAGES;let r=this.objs.filter(p=>p.isSelected);this.processImage(this.commonService.getFirstOfArray(r));let h=r.filter(p=>![Y.PROCESSING,Y.PROCESSED].includes(p.processStatus));this.callOrcApi(h,0)}processCurrentPageAgain(){return this.currentObj?this.currentObj.processStatus==Y.PROCESSING?this.showErrorSnack("lang_digitalize_current_page_is_processing"):void this.callOrcApi([this.currentObj],0):this.showErrorSnack("lang_digitalize_not_select_any_current_page")}processAllAgain(){let r=this.objs.filter(h=>h.isSelected&&![Y.PROCESSING,Y.PROCESSED].includes(h.processStatus));if(r.length<=0)return this.showErrorSnack("lang_digitalize_not_found_any_error_record");this.callOrcApi(r,0)}callOrcApi(r,h=0,p=1){if(h>=r.length)return void(this.processStatusObj.loading=!1);h<=0&&r.forEach(O=>O.processStatus=Y.PROCESSING);let y=r.slice(h,h+p).map(O=>this.runDigitalizeOneImage(O));Promise.all(y).then(()=>{this.callOrcApi(r,h+p,p)})}runDigitalizeOneImage(r){return new Promise((h,p)=>{this.sAztDigitalizeService.digitalizeData(r,m=>{this.processStatusObj={loading:!0,errorMessage:m,mustShowErrorBox:!1}},m=>{r.processStatus=Y.PROCESS_ERROR,console.log("lang_digitalize_error_at_digitalized_function",m),this.replaceCurrentObj(r),h()},m=>{r={...m,processStatus:Y.PROCESSED},this.replaceCurrentObj(r),h()})})}replaceCurrentObj(r){let h=this.objs.find(p=>p.position==r.position);if(null==h)return this.showErrorSnack("lang_digitalize_not_found_position_in_replace_function");Object.assign(h,r),console.log("Orc done: ","cur position:"+this.currentObj?.position+", orc position: "+h?.position+", orc image url: "+h?.image.url),this.currentObj&&this.processImage(this.currentObj)}chooseImages(r){let h=r.map(p=>p.position);this.objs.forEach(p=>p.isSelected=!!h.includes(p.position)||p.isSelected),this.totalSelected=this.objs.filter(p=>p.isSelected).length}processImage(r){if(!r)return;let h=this.objs.find(p=>p.position==r.position);h&&(this.currentObj={...h}),console.log("View new image: status: "+h?.processStatus+", position: "+h?.position+", url: "+h?.image.url)}showChooseLayout(){this.currentLayout=vt.CHOOSE_IMAGES}changeObj(r){let h=this.objs.find(p=>p.position==r.position);h&&Object.assign(h,r)}uploadData(r){this.objs=r.map((h,p)=>({image:h,htmlResult:"",position:p+1,isSelected:!1,processStatus:Y.NONE}))}downloadData(r){let h=new Date,p="";if(this.objs.forEach(m=>{p+=`<page [page]='${m.position}'/>`+(m.processStatus==Y.PROCESSED?m.htmlResult:"")}),p=this.commonService.decodeHtmlEntities(p),"html"!=r)p=this.commonService.convertDollarDollarToLatexTag(p),this.commonService.loadAzotaDocxJs().then(()=>{azotaDocx.textToDocxBinary(p,null).then(m=>{let y=`azota-digitalize-book-${h.getDate()}${h.getMonth()+1}${h.getFullYear()}-${h.getTime()}.docx`;const O=new Blob([m],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});O&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(O),y)}).catch(m=>{this.showErrorSnack(m)})}).catch(m=>{this.showErrorSnack(m)});else{let m=`azota-digitalize-book-${h.getDate()}${h.getMonth()+1}${h.getFullYear()}-${h.getTime()}.html`;const y=new Blob([p],{type:"text/plain"});y&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(y),m)}}ngOnInit(){super.ngOnInit(),this.commonService.translateMetaData({title:"lang_cms_admin_common_digitalize_book",description:"lang_cms_admin_common_digitalize_book",image:"lang_cms_test_image"}),this.headerBackTo=this.commonService.getMyQueryParam("backTo")??"/super-role/admin-tool"}constructor(){super(),this.sAztDigitalizeService=(0,t.WQX)(ft),this.processStatusObj={loading:!1,errorMessage:"",mustShowErrorBox:!1},this.headerBackTo="",this.objs=[],this.totalSelected=0,this.currentLayout=vt.CHOOSE_IMAGES,this.allLayouts=vt,this.allProcessStatuses=Y}static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digitalize-book"]],features:[t.Vt3],decls:5,vars:3,consts:[[3,"headerBackToLink"],[1,"container-fluid","component-wrap","centerBoth","hasBg","mt-3"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],["doneLoading",""],[3,"currentStatusObj"],[1,"grid","grid-cols-12","gap-5"],[1,"col-span-3"],[1,"box","p-3","mb-3","grid","grid-cols-12","gap-2"],[1,"col-span-12"],[3,"uploadData",4,"ngIf"],["class","btn btn-primary-soft w-full",3,"click",4,"ngIf"],[1,"col-span-6"],[1,"btn","btn-primary","w-full",3,"click"],["class","box p-3",4,"ngIf"],[1,"col-span-9"],[4,"ngIf"],[3,"uploadData"],[1,"btn","btn-primary-soft","w-full",3,"click"],[1,"box","p-3"],[3,"objs","chooseImages",4,"ngIf"],[3,"objs","currentObj","processImage",4,"ngIf"],[3,"objs","chooseImages"],[3,"objs","currentObj","processImage"],[4,"ngIf","ngIfElse"],["notSelectAnyObj",""],[1,"mb-3","btn","btn-pending",3,"click"],[1,"mb-3","btn","btn-info",3,"click"],[3,"obj","changeObj"],[3,"currentStatusObj","customText",4,"ngIf"],[3,"currentStatusObj","customText"]],template:function(h,p){if(1&h&&(t.j41(0,"teacher-layout",0)(1,"div",1),t.DNE(2,yt,1,1,"azt-loading-effect",2),t.DNE(3,fe,18,11,"ng-template",null,3,t.C5r),t.k0s()()),2&h){const m=t.sdS(4);t.Y8G("headerBackToLink",p.headerBackTo),t.R7$(2),t.Y8G("ngIf",p.statusObj.loading)("ngIfElse",m)}},dependencies:[M.bT,L.K,te.Q,le,ze,Re,Be,P.wp],encapsulation:2})}return s})()}]}];let _e=(()=>{class s{static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275mod=t.$C({type:s});static#i=this.\u0275inj=t.G2t({imports:[st.iI.forChild(Fe),st.iI,lt.XE]})}return s})(),be=(()=>{class s{static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275mod=t.$C({type:s});static#i=this.\u0275inj=t.G2t({providers:[{provide:ut.vn,useValue:Pt.c.azt_tiny_mce_script_src}],imports:[st.iI,M.MD,K.YN,ut.sv,I.s,K.X1,_e,qt.Q,Nt.L,Ot.Id,Zt.b,U.flO.pick(U.Ptg),Bt.AC,at]})}return s})()},17715:function(Ce){Ce.exports=function(){"use strict";function et(o){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(o)}function M(o,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}function st(o,e,a){return e in o?Object.defineProperty(o,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[e]=a,o}function ut(o,e){var a=Object.keys(o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);e&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),a.push.apply(a,i)}return a}function t(o){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(a),!0).forEach(function(i){st(o,i,a[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(a)):ut(Object(a)).forEach(function(i){Object.defineProperty(o,i,Object.getOwnPropertyDescriptor(a,i))})}return o}function Kt(o){return function ct(o){if(Array.isArray(o))return kt(o)}(o)||function mt(o){if(typeof Symbol<"u"&&Symbol.iterator in Object(o))return Array.from(o)}(o)||function it(o,e){if(o){if("string"==typeof o)return kt(o,e);var a=Object.prototype.toString.call(o).slice(8,-1);if("Object"===a&&o.constructor&&(a=o.constructor.name),"Map"===a||"Set"===a)return Array.from(o);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return kt(o,e)}}(o)||function Rt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kt(o,e){(null==e||e>o.length)&&(e=o.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=o[a];return i}var at=typeof window<"u"&&typeof window.document<"u",U=at?window:{},Bt=!(!at||!U.document.documentElement)&&"ontouchstart"in U.document.documentElement,Ot=!!at&&"PointerEvent"in U,I="cropper",W="w",Z="s",rt="n",P="ne",Dt="nw",Et="se",ft="sw",Y="".concat(I,"-crop"),vt="".concat(I,"-disabled"),L="".concat(I,"-hidden"),te="".concat(I,"-hide"),Oe="".concat(I,"-invisible"),_t="".concat(I,"-modal"),Gt="".concat(I,"-move"),St="".concat(I,"Action"),Mt="".concat(I,"Preview"),Lt="crop",Yt="crop",jt="cropend",Xt="cropmove",Ut="cropstart",ie="dblclick",ae=Ot?"pointerdown":Bt?"touchstart":"mousedown",re=Ot?"pointermove":Bt?"touchmove":"mousemove",oe=Ot?"pointerup pointercancel":Bt?"touchend touchcancel":"mouseup",Vt="zoom",le="image/jpeg",Ae=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,Ie=/^data:/,Te=/^data:image\/jpeg;base64,/,ze=/^img|canvas$/i,de={viewMode:0,dragMode:Lt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Me=Number.isNaN||U.isNaN;function C(o){return"number"==typeof o&&!Me(o)}var $t=function(e){return e>0&&e<1/0};function Ht(o){return typeof o>"u"}function ht(o){return"object"===et(o)&&null!==o}var je=Object.prototype.hasOwnProperty;function bt(o){if(!ht(o))return!1;try{var e=o.constructor,a=e.prototype;return e&&a&&je.call(a,"isPrototypeOf")}catch{return!1}}function X(o){return"function"==typeof o}var ke=Array.prototype.slice;function ge(o){return Array.from?Array.from(o):ke.call(o)}function R(o,e){return o&&X(e)&&(Array.isArray(o)||C(o.length)?ge(o).forEach(function(a,i){e.call(o,a,i,o)}):ht(o)&&Object.keys(o).forEach(function(a){e.call(o,o[a],a,o)})),o}var T=Object.assign||function(e){for(var a=arguments.length,i=new Array(a>1?a-1:0),c=1;c<a;c++)i[c-1]=arguments[c];return ht(e)&&i.length>0&&i.forEach(function(n){ht(n)&&Object.keys(n).forEach(function(l){e[l]=n[l]})}),e},Be=/\.\d*(?:0|9){12}\d*$/;function yt(o){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return Be.test(o)?Math.round(o*e)/e:o}var Ne=/^width|height|left|top|marginLeft|marginTop$/;function ot(o,e){var a=o.style;R(e,function(i,c){Ne.test(c)&&C(i)&&(i="".concat(i,"px")),a[c]=i})}function j(o,e){if(e){if(C(o.length))return void R(o,function(i){j(i,e)});if(o.classList)return void o.classList.add(e);var a=o.className.trim();a?a.indexOf(e)<0&&(o.className="".concat(a," ").concat(e)):o.className=e}}function q(o,e){if(e){if(C(o.length))return void R(o,function(a){q(a,e)});if(o.classList)return void o.classList.remove(e);o.className.indexOf(e)>=0&&(o.className=o.className.replace(e,""))}}function wt(o,e,a){if(e){if(C(o.length))return void R(o,function(i){wt(i,e,a)});a?j(o,e):q(o,e)}}var Ge=/([a-z\d])([A-Z])/g;function Wt(o){return o.replace(Ge,"$1-$2").toLowerCase()}function Qt(o,e){return ht(o[e])?o[e]:o.dataset?o.dataset[e]:o.getAttribute("data-".concat(Wt(e)))}function At(o,e,a){ht(a)?o[e]=a:o.dataset?o.dataset[e]=a:o.setAttribute("data-".concat(Wt(e)),a)}var ue=/\s\s*/,me=function(){var o=!1;if(at){var e=!1,a=function(){},i=Object.defineProperty({},"once",{get:function(){return o=!0,e},set:function(n){e=n}});U.addEventListener("test",a,i),U.removeEventListener("test",a,i)}return o}();function Q(o,e,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=a;e.trim().split(ue).forEach(function(n){if(!me){var l=o.listeners;l&&l[n]&&l[n][a]&&(c=l[n][a],delete l[n][a],0===Object.keys(l[n]).length&&delete l[n],0===Object.keys(l).length&&delete o.listeners)}o.removeEventListener(n,c,i)})}function V(o,e,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=a;e.trim().split(ue).forEach(function(n){if(i.once&&!me){var l=o.listeners,d=void 0===l?{}:l;c=function(){delete d[n][a],o.removeEventListener(n,c,i);for(var f=arguments.length,u=new Array(f),g=0;g<f;g++)u[g]=arguments[g];a.apply(o,u)},d[n]||(d[n]={}),d[n][a]&&o.removeEventListener(n,d[n][a],i),d[n][a]=c,o.listeners=d}o.addEventListener(n,c,i)})}function xt(o,e,a){var i;return X(Event)&&X(CustomEvent)?i=new CustomEvent(e,{detail:a,bubbles:!0,cancelable:!0}):(i=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,a),o.dispatchEvent(i)}function fe(o){var e=o.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var ve=U.location,Fe=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function _e(o){var e=o.match(Fe);return null!==e&&(e[1]!==ve.protocol||e[2]!==ve.hostname||e[3]!==ve.port)}function be(o){var e="timestamp=".concat((new Date).getTime());return o+(-1===o.indexOf("?")?"?":"&")+e}function s(o){var e=o.rotate,a=o.scaleX,i=o.scaleY,c=o.translateX,n=o.translateY,l=[];C(c)&&0!==c&&l.push("translateX(".concat(c,"px)")),C(n)&&0!==n&&l.push("translateY(".concat(n,"px)")),C(e)&&0!==e&&l.push("rotate(".concat(e,"deg)")),C(a)&&1!==a&&l.push("scaleX(".concat(a,")")),C(i)&&1!==i&&l.push("scaleY(".concat(i,")"));var d=l.length?l.join(" "):"none";return{WebkitTransform:d,msTransform:d,transform:d}}function r(o,e){var a=o.pageX,i=o.pageY,c={endX:a,endY:i};return e?c:t({startX:a,startY:i},c)}function p(o){var e=o.aspectRatio,a=o.height,i=o.width,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",n=$t(i),l=$t(a);if(n&&l){var d=a*e;"contain"===c&&d>i||"cover"===c&&d<i?a=i/e:i=a*e}else n?a=i/e:l&&(i=a*e);return{width:i,height:a}}var O=String.fromCharCode;var pt=/^data:.*,/;function Jt(o){var a,e=new DataView(o);try{var i,c,n;if(255===e.getUint8(0)&&216===e.getUint8(1))for(var l=e.byteLength,d=2;d+1<l;){if(255===e.getUint8(d)&&225===e.getUint8(d+1)){c=d;break}d+=1}if(c){var f=c+10;if("Exif"===function F(o,e,a){var i="";a+=e;for(var c=e;c<a;c+=1)i+=O(o.getUint8(c));return i}(e,c+4,4)){var u=e.getUint16(f);if(((i=18761===u)||19789===u)&&42===e.getUint16(f+2,i)){var g=e.getUint32(f+4,i);g>=8&&(n=f+g)}}}if(n){var E,D,v=e.getUint16(n,i);for(D=0;D<v;D+=1)if(274===e.getUint16(E=n+12*D+2,i)){a=e.getUint16(E+=8,i),e.setUint16(E,1,i);break}}}catch{a=1}return a}var Qe={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,a=this.options,i=this.container,c=this.cropper,n=Number(a.minContainerWidth),l=Number(a.minContainerHeight);j(c,L),q(e,L);var d={width:Math.max(i.offsetWidth,n>=0?n:200),height:Math.max(i.offsetHeight,l>=0?l:100)};this.containerData=d,ot(c,{width:d.width,height:d.height}),j(e,L),q(c,L)},initCanvas:function(){var e=this.containerData,a=this.imageData,i=this.options.viewMode,c=Math.abs(a.rotate)%180==90,n=c?a.naturalHeight:a.naturalWidth,l=c?a.naturalWidth:a.naturalHeight,d=n/l,_=e.width,f=e.height;e.height*d>e.width?3===i?_=e.height*d:f=e.width/d:3===i?f=e.width/d:_=e.height*d;var u={aspectRatio:d,naturalWidth:n,naturalHeight:l,width:_,height:f};this.canvasData=u,this.limited=1===i||2===i,this.limitCanvas(!0,!0),u.width=Math.min(Math.max(u.width,u.minWidth),u.maxWidth),u.height=Math.min(Math.max(u.height,u.minHeight),u.maxHeight),u.left=(e.width-u.width)/2,u.top=(e.height-u.height)/2,u.oldLeft=u.left,u.oldTop=u.top,this.initialCanvasData=T({},u)},limitCanvas:function(e,a){var i=this.options,c=this.containerData,n=this.canvasData,l=this.cropBoxData,d=i.viewMode,_=n.aspectRatio,f=this.cropped&&l;if(e){var u=Number(i.minCanvasWidth)||0,g=Number(i.minCanvasHeight)||0;d>1?(u=Math.max(u,c.width),g=Math.max(g,c.height),3===d&&(g*_>u?u=g*_:g=u/_)):d>0&&(u?u=Math.max(u,f?l.width:0):g?g=Math.max(g,f?l.height:0):f&&((g=l.height)*_>(u=l.width)?u=g*_:g=u/_));var v=p({aspectRatio:_,width:u,height:g});g=v.height,n.minWidth=u=v.width,n.minHeight=g,n.maxWidth=1/0,n.maxHeight=1/0}if(a)if(d>(f?0:1)){var E=c.width-n.width,D=c.height-n.height;n.minLeft=Math.min(0,E),n.minTop=Math.min(0,D),n.maxLeft=Math.max(0,E),n.maxTop=Math.max(0,D),f&&this.limited&&(n.minLeft=Math.min(l.left,l.left+(l.width-n.width)),n.minTop=Math.min(l.top,l.top+(l.height-n.height)),n.maxLeft=l.left,n.maxTop=l.top,2===d&&(n.width>=c.width&&(n.minLeft=Math.min(0,E),n.maxLeft=Math.max(0,E)),n.height>=c.height&&(n.minTop=Math.min(0,D),n.maxTop=Math.max(0,D))))}else n.minLeft=-n.width,n.minTop=-n.height,n.maxLeft=c.width,n.maxTop=c.height},renderCanvas:function(e,a){var i=this.canvasData,c=this.imageData;if(a){var n=function m(o){var e=o.width,a=o.height,i=o.degree;if(90==(i=Math.abs(i)%180))return{width:a,height:e};var c=i%90*Math.PI/180,n=Math.sin(c),l=Math.cos(c),d=e*l+a*n,_=e*n+a*l;return i>90?{width:_,height:d}:{width:d,height:_}}({width:c.naturalWidth*Math.abs(c.scaleX||1),height:c.naturalHeight*Math.abs(c.scaleY||1),degree:c.rotate||0}),l=n.width,d=n.height,_=i.width*(l/i.naturalWidth),f=i.height*(d/i.naturalHeight);i.left-=(_-i.width)/2,i.top-=(f-i.height)/2,i.width=_,i.height=f,i.aspectRatio=l/d,i.naturalWidth=l,i.naturalHeight=d,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,ot(this.canvas,T({width:i.width,height:i.height},s({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var a=this.canvasData,i=this.imageData,c=i.naturalWidth*(a.width/a.naturalWidth),n=i.naturalHeight*(a.height/a.naturalHeight);T(i,{width:c,height:n,left:(a.width-c)/2,top:(a.height-n)/2}),ot(this.image,T({width:i.width,height:i.height},s(T({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox:function(){var e=this.options,a=this.canvasData,i=e.aspectRatio||e.initialAspectRatio,c=Number(e.autoCropArea)||.8,n={width:a.width,height:a.height};i&&(a.height*i>a.width?n.height=n.width/i:n.width=n.height*i),this.cropBoxData=n,this.limitCropBox(!0,!0),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),n.width=Math.max(n.minWidth,n.width*c),n.height=Math.max(n.minHeight,n.height*c),n.left=a.left+(a.width-n.width)/2,n.top=a.top+(a.height-n.height)/2,n.oldLeft=n.left,n.oldTop=n.top,this.initialCropBoxData=T({},n)},limitCropBox:function(e,a){var i=this.options,c=this.containerData,n=this.canvasData,l=this.cropBoxData,d=this.limited,_=i.aspectRatio;if(e){var f=Number(i.minCropBoxWidth)||0,u=Number(i.minCropBoxHeight)||0,g=d?Math.min(c.width,n.width,n.width+n.left,c.width-n.left):c.width,v=d?Math.min(c.height,n.height,n.height+n.top,c.height-n.top):c.height;f=Math.min(f,c.width),u=Math.min(u,c.height),_&&(f&&u?u*_>f?u=f/_:f=u*_:f?u=f/_:u&&(f=u*_),v*_>g?v=g/_:g=v*_),l.minWidth=Math.min(f,g),l.minHeight=Math.min(u,v),l.maxWidth=g,l.maxHeight=v}a&&(d?(l.minLeft=Math.max(0,n.left),l.minTop=Math.max(0,n.top),l.maxLeft=Math.min(c.width,n.left+n.width)-l.width,l.maxTop=Math.min(c.height,n.top+n.height)-l.height):(l.minLeft=0,l.minTop=0,l.maxLeft=c.width-l.width,l.maxTop=c.height-l.height))},renderCropBox:function(){var e=this.options,a=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&At(this.face,St,i.width>=a.width&&i.height>=a.height?"move":"all"),ot(this.cropBox,T({width:i.width,height:i.height},s({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),xt(this.element,Yt,this.getData())}},Je={initPreview:function(){var e=this.element,a=this.crossOrigin,i=this.options.preview,c=a?this.crossOriginUrl:this.url,n=e.alt||"The image to preview",l=document.createElement("img");if(a&&(l.crossOrigin=a),l.src=c,l.alt=n,this.viewBox.appendChild(l),this.viewBoxImage=l,i){var d=i;"string"==typeof i?d=e.ownerDocument.querySelectorAll(i):i.querySelector&&(d=[i]),this.previews=d,R(d,function(_){var f=document.createElement("img");At(_,Mt,{width:_.offsetWidth,height:_.offsetHeight,html:_.innerHTML}),a&&(f.crossOrigin=a),f.src=c,f.alt=n,f.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',_.innerHTML="",_.appendChild(f)})}},resetPreview:function(){R(this.previews,function(e){var a=Qt(e,Mt);ot(e,{width:a.width,height:a.height}),e.innerHTML=a.html,function Le(o,e){if(ht(o[e]))try{delete o[e]}catch{o[e]=void 0}else if(o.dataset)try{delete o.dataset[e]}catch{o.dataset[e]=void 0}else o.removeAttribute("data-".concat(Wt(e)))}(e,Mt)})},preview:function(){var e=this.imageData,a=this.canvasData,i=this.cropBoxData,c=i.width,n=i.height,l=e.width,d=e.height,_=i.left-a.left-e.left,f=i.top-a.top-e.top;!this.cropped||this.disabled||(ot(this.viewBoxImage,T({width:l,height:d},s(T({translateX:-_,translateY:-f},e)))),R(this.previews,function(u){var g=Qt(u,Mt),v=g.width,E=g.height,D=v,z=E,S=1;c&&(z=n*(S=v/c)),n&&z>E&&(D=c*(S=E/n),z=E),ot(u,{width:D,height:z}),ot(u.getElementsByTagName("img")[0],T({width:l*S,height:d*S},s(T({translateX:-_*S,translateY:-f*S},e))))}))}},Ke={bind:function(){var e=this.element,a=this.options,i=this.cropper;X(a.cropstart)&&V(e,Ut,a.cropstart),X(a.cropmove)&&V(e,Xt,a.cropmove),X(a.cropend)&&V(e,jt,a.cropend),X(a.crop)&&V(e,Yt,a.crop),X(a.zoom)&&V(e,Vt,a.zoom),V(i,ae,this.onCropStart=this.cropStart.bind(this)),a.zoomable&&a.zoomOnWheel&&V(i,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&V(i,ie,this.onDblclick=this.dblclick.bind(this)),V(e.ownerDocument,re,this.onCropMove=this.cropMove.bind(this)),V(e.ownerDocument,oe,this.onCropEnd=this.cropEnd.bind(this)),a.responsive&&V(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,a=this.options,i=this.cropper;X(a.cropstart)&&Q(e,Ut,a.cropstart),X(a.cropmove)&&Q(e,Xt,a.cropmove),X(a.cropend)&&Q(e,jt,a.cropend),X(a.crop)&&Q(e,Yt,a.crop),X(a.zoom)&&Q(e,Vt,a.zoom),Q(i,ae,this.onCropStart),a.zoomable&&a.zoomOnWheel&&Q(i,"wheel",this.onWheel,{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&Q(i,ie,this.onDblclick),Q(e.ownerDocument,re,this.onCropMove),Q(e.ownerDocument,oe,this.onCropEnd),a.responsive&&Q(window,"resize",this.onResize)}},Ze={resize:function(){if(!this.disabled){var n,l,e=this.options,a=this.container,i=this.containerData,c=a.offsetWidth/i.width;1===c&&a.offsetHeight===i.height||(e.restore&&(n=this.getCanvasData(),l=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(R(n,function(d,_){n[_]=d*c})),this.setCropBoxData(R(l,function(d,_){l[_]=d*c}))))}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(function Pe(o,e){return o.classList?o.classList.contains(e):o.className.indexOf(e)>-1}(this.dragBox,Y)?"move":Lt)},wheel:function(e){var a=this,i=Number(this.options.wheelZoomRatio)||.1,c=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){a.wheeling=!1},50),e.deltaY?c=e.deltaY>0?1:-1:e.wheelDelta?c=-e.wheelDelta/120:e.detail&&(c=e.detail>0?1:-1),this.zoom(-c*i,e)))},cropStart:function(e){var a=e.buttons,i=e.button;if(!(this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(C(a)&&1!==a||C(i)&&0!==i||e.ctrlKey))){var l,c=this.options,n=this.pointers;e.changedTouches?R(e.changedTouches,function(d){n[d.identifier]=r(d)}):n[e.pointerId||0]=r(e),l=Object.keys(n).length>1&&c.zoomable&&c.zoomOnTouch?"zoom":Qt(e.target,St),Ae.test(l)&&!1!==xt(this.element,Ut,{originalEvent:e,action:l})&&(e.preventDefault(),this.action=l,this.cropping=!1,"crop"===l&&(this.cropping=!0,j(this.dragBox,_t)))}},cropMove:function(e){var a=this.action;if(!this.disabled&&a){var i=this.pointers;e.preventDefault(),!1!==xt(this.element,Xt,{originalEvent:e,action:a})&&(e.changedTouches?R(e.changedTouches,function(c){T(i[c.identifier]||{},r(c,!0))}):T(i[e.pointerId||0]||{},r(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var a=this.action,i=this.pointers;e.changedTouches?R(e.changedTouches,function(c){delete i[c.identifier]}):delete i[e.pointerId||0],a&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,wt(this.dragBox,_t,this.cropped&&this.options.modal)),xt(this.element,jt,{originalEvent:e,action:a}))}}},qe={change:function(e){var dt,i=this.canvasData,c=this.containerData,n=this.cropBoxData,l=this.pointers,d=this.action,_=this.options.aspectRatio,f=n.left,u=n.top,g=n.width,v=n.height,E=f+g,D=u+v,z=0,S=0,B=c.width,G=c.height,k=!0;!_&&e.shiftKey&&(_=g&&v?g/v:1),this.limited&&(S=n.minTop,B=(z=n.minLeft)+Math.min(c.width,i.width,i.left+i.width),G=S+Math.min(c.height,i.height,i.top+i.height));var J=l[Object.keys(l)[0]],b={x:J.endX-J.startX,y:J.endY-J.startY},A=function(tt){switch(tt){case"e":E+b.x>B&&(b.x=B-E);break;case W:f+b.x<z&&(b.x=z-f);break;case rt:u+b.y<S&&(b.y=S-u);break;case Z:D+b.y>G&&(b.y=G-D)}};switch(d){case"all":f+=b.x,u+=b.y;break;case"e":if(b.x>=0&&(E>=B||_&&(u<=S||D>=G))){k=!1;break}A("e"),(g+=b.x)<0&&(d=W,f-=g=-g),_&&(u+=(n.height-(v=g/_))/2);break;case rt:if(b.y<=0&&(u<=S||_&&(f<=z||E>=B))){k=!1;break}A(rt),u+=b.y,(v-=b.y)<0&&(d=Z,u-=v=-v),_&&(f+=(n.width-(g=v*_))/2);break;case W:if(b.x<=0&&(f<=z||_&&(u<=S||D>=G))){k=!1;break}A(W),f+=b.x,(g-=b.x)<0&&(d="e",f-=g=-g),_&&(u+=(n.height-(v=g/_))/2);break;case Z:if(b.y>=0&&(D>=G||_&&(f<=z||E>=B))){k=!1;break}A(Z),(v+=b.y)<0&&(d=rt,u-=v=-v),_&&(f+=(n.width-(g=v*_))/2);break;case P:if(_){if(b.y<=0&&(u<=S||E>=B)){k=!1;break}A(rt),u+=b.y,g=(v-=b.y)*_}else A(rt),A("e"),b.x>=0?E<B?g+=b.x:b.y<=0&&u<=S&&(k=!1):g+=b.x,b.y<=0?u>S&&(v-=b.y,u+=b.y):(v-=b.y,u+=b.y);g<0&&v<0?(d=ft,u-=v=-v,f-=g=-g):g<0?(d=Dt,f-=g=-g):v<0&&(d=Et,u-=v=-v);break;case Dt:if(_){if(b.y<=0&&(u<=S||f<=z)){k=!1;break}A(rt),u+=b.y,f+=n.width-(g=(v-=b.y)*_)}else A(rt),A(W),b.x<=0?f>z?(g-=b.x,f+=b.x):b.y<=0&&u<=S&&(k=!1):(g-=b.x,f+=b.x),b.y<=0?u>S&&(v-=b.y,u+=b.y):(v-=b.y,u+=b.y);g<0&&v<0?(d=Et,u-=v=-v,f-=g=-g):g<0?(d=P,f-=g=-g):v<0&&(d=ft,u-=v=-v);break;case ft:if(_){if(b.x<=0&&(f<=z||D>=G)){k=!1;break}A(W),f+=b.x,v=(g-=b.x)/_}else A(Z),A(W),b.x<=0?f>z?(g-=b.x,f+=b.x):b.y>=0&&D>=G&&(k=!1):(g-=b.x,f+=b.x),b.y>=0?D<G&&(v+=b.y):v+=b.y;g<0&&v<0?(d=P,u-=v=-v,f-=g=-g):g<0?(d=Et,f-=g=-g):v<0&&(d=Dt,u-=v=-v);break;case Et:if(_){if(b.x>=0&&(E>=B||D>=G)){k=!1;break}A("e"),v=(g+=b.x)/_}else A(Z),A("e"),b.x>=0?E<B?g+=b.x:b.y>=0&&D>=G&&(k=!1):g+=b.x,b.y>=0?D<G&&(v+=b.y):v+=b.y;g<0&&v<0?(d=Dt,u-=v=-v,f-=g=-g):g<0?(d=ft,f-=g=-g):v<0&&(d=P,u-=v=-v);break;case"move":this.move(b.x,b.y),k=!1;break;case"zoom":this.zoom(function w(o){var e=t({},o),a=0;return R(o,function(i,c){delete e[c],R(e,function(n){var l=Math.abs(i.startX-n.startX),d=Math.abs(i.startY-n.startY),_=Math.abs(i.endX-n.endX),f=Math.abs(i.endY-n.endY),u=Math.sqrt(l*l+d*d),v=(Math.sqrt(_*_+f*f)-u)/u;Math.abs(v)>Math.abs(a)&&(a=v)})}),a}(l),e),k=!1;break;case"crop":if(!b.x||!b.y){k=!1;break}dt=fe(this.cropper),f=J.startX-dt.left,u=J.startY-dt.top,g=n.minWidth,v=n.minHeight,b.x>0?d=b.y>0?Et:P:b.x<0&&(f-=g,d=b.y>0?ft:Dt),b.y<0&&(u-=v),this.cropped||(q(this.cropBox,L),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}k&&(n.width=g,n.height=v,n.left=f,n.top=u,this.action=d,this.renderCropBox()),R(l,function(N){N.startX=N.endX,N.startY=N.endY})}},ti={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&j(this.dragBox,_t),q(this.cropBox,L),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=T({},this.initialImageData),this.canvasData=T({},this.initialCanvasData),this.cropBoxData=T({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(T(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),q(this.dragBox,_t),j(this.cropBox,L)),this},replace:function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&e&&(this.isImg&&(this.element.src=e),a?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,R(this.previews,function(i){i.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,q(this.cropper,vt)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,j(this.cropper,vt)),this},destroy:function(){var e=this.element;return e[I]?(e[I]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,c=i.left,n=i.top;return this.moveTo(Ht(e)?e:c+Number(e),Ht(a)?a:n+Number(a))},moveTo:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,c=!1;return e=Number(e),a=Number(a),this.ready&&!this.disabled&&this.options.movable&&(C(e)&&(i.left=e,c=!0),C(a)&&(i.top=a,c=!0),c&&this.renderCanvas(!0)),this},zoom:function(e,a){var i=this.canvasData;return e=Number(e),this.zoomTo(i.width*(e=e<0?1/(1-e):1+e)/i.naturalWidth,null,a)},zoomTo:function(e,a,i){var c=this.options,n=this.canvasData,l=n.width,d=n.height,_=n.naturalWidth,f=n.naturalHeight;if((e=Number(e))>=0&&this.ready&&!this.disabled&&c.zoomable){var u=_*e,g=f*e;if(!1===xt(this.element,Vt,{ratio:e,oldRatio:l/_,originalEvent:i}))return this;if(i){var v=this.pointers,E=fe(this.cropper),D=v&&Object.keys(v).length?function h(o){var e=0,a=0,i=0;return R(o,function(c){e+=c.startX,a+=c.startY,i+=1}),{pageX:e/=i,pageY:a/=i}}(v):{pageX:i.pageX,pageY:i.pageY};n.left-=(D.pageX-E.left-n.left)/l*(u-l),n.top-=(D.pageY-E.top-n.top)/d*(g-d)}else bt(a)&&C(a.x)&&C(a.y)?(n.left-=(a.x-n.left)/l*(u-l),n.top-=(a.y-n.top)/d*(g-d)):(n.left-=(u-l)/2,n.top-=(g-d)/2);n.width=u,n.height=g,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return C(e=Number(e))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var a=this.imageData.scaleY;return this.scale(e,C(a)?a:1)},scaleY:function(e){var a=this.imageData.scaleX;return this.scale(C(a)?a:1,e)},scale:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.imageData,c=!1;return e=Number(e),a=Number(a),this.ready&&!this.disabled&&this.options.scalable&&(C(e)&&(i.scaleX=e,c=!0),C(a)&&(i.scaleY=a,c=!0),c&&this.renderCanvas(!0,!0)),this},getData:function(){var l,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.options,i=this.imageData,c=this.canvasData,n=this.cropBoxData;if(this.ready&&this.cropped){var d=i.width/i.naturalWidth;if(R(l={x:n.left-c.left,y:n.top-c.top,width:n.width,height:n.height},function(u,g){l[g]=u/d}),e){var _=Math.round(l.y+l.height),f=Math.round(l.x+l.width);l.x=Math.round(l.x),l.y=Math.round(l.y),l.width=f-l.x,l.height=_-l.y}}else l={x:0,y:0,width:0,height:0};return a.rotatable&&(l.rotate=i.rotate||0),a.scalable&&(l.scaleX=i.scaleX||1,l.scaleY=i.scaleY||1),l},setData:function(e){var a=this.options,i=this.imageData,c=this.canvasData,n={};if(this.ready&&!this.disabled&&bt(e)){var l=!1;a.rotatable&&C(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,l=!0),a.scalable&&(C(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,l=!0),C(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,l=!0)),l&&this.renderCanvas(!0,!0);var d=i.width/i.naturalWidth;C(e.x)&&(n.left=e.x*d+c.left),C(e.y)&&(n.top=e.y*d+c.top),C(e.width)&&(n.width=e.width*d),C(e.height)&&(n.height=e.height*d),this.setCropBoxData(n)}return this},getContainerData:function(){return this.ready?T({},this.containerData):{}},getImageData:function(){return this.sized?T({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,a={};return this.ready&&R(["left","top","width","height","naturalWidth","naturalHeight"],function(i){a[i]=e[i]}),a},setCanvasData:function(e){var a=this.canvasData,i=a.aspectRatio;return this.ready&&!this.disabled&&bt(e)&&(C(e.left)&&(a.left=e.left),C(e.top)&&(a.top=e.top),C(e.width)?(a.width=e.width,a.height=e.width/i):C(e.height)&&(a.height=e.height,a.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var a,e=this.cropBoxData;return this.ready&&this.cropped&&(a={left:e.left,top:e.top,width:e.width,height:e.height}),a||{}},setCropBoxData:function(e){var c,n,a=this.cropBoxData,i=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&bt(e)&&(C(e.left)&&(a.left=e.left),C(e.top)&&(a.top=e.top),C(e.width)&&e.width!==a.width&&(c=!0,a.width=e.width),C(e.height)&&e.height!==a.height&&(n=!0,a.height=e.height),i&&(c?a.height=a.width/i:n&&(a.width=a.height*i)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var a=this.canvasData,i=function y(o,e,a,i){var c=e.aspectRatio,n=e.naturalWidth,l=e.naturalHeight,d=e.rotate,_=void 0===d?0:d,f=e.scaleX,u=void 0===f?1:f,g=e.scaleY,v=void 0===g?1:g,E=a.aspectRatio,D=a.naturalWidth,z=a.naturalHeight,S=i.fillColor,B=void 0===S?"transparent":S,G=i.imageSmoothingEnabled,k=void 0===G||G,dt=i.imageSmoothingQuality,J=void 0===dt?"low":dt,b=i.maxWidth,A=void 0===b?1/0:b,N=i.maxHeight,tt=void 0===N?1/0:N,gt=i.minWidth,It=void 0===gt?0:gt,Tt=i.minHeight,Ct=void 0===Tt?0:Tt,nt=document.createElement("canvas"),H=nt.getContext("2d"),zt=p({aspectRatio:E,width:A,height:tt}),xe=p({aspectRatio:E,width:It,height:Ct},"cover"),Ye=Math.min(zt.width,Math.max(xe.width,D)),Xe=Math.min(zt.height,Math.max(xe.height,z)),Ve=p({aspectRatio:c,width:A,height:tt}),$e=p({aspectRatio:c,width:It,height:Ct},"cover"),He=Math.min(Ve.width,Math.max($e.width,n)),We=Math.min(Ve.height,Math.max($e.height,l)),ii=[-He/2,-We/2,He,We];return nt.width=yt(Ye),nt.height=yt(Xe),H.fillStyle=B,H.fillRect(0,0,Ye,Xe),H.save(),H.translate(Ye/2,Xe/2),H.rotate(_*Math.PI/180),H.scale(u,v),H.imageSmoothingEnabled=k,H.imageSmoothingQuality=J,H.drawImage.apply(H,[o].concat(Kt(ii.map(function(ai){return Math.floor(yt(ai))})))),H.restore(),nt}(this.image,this.imageData,a,e);if(!this.cropped)return i;var c=this.getData(),n=c.x,l=c.y,d=c.width,_=c.height,f=i.width/Math.floor(a.naturalWidth);1!==f&&(n*=f,l*=f,d*=f,_*=f);var u=d/_,g=p({aspectRatio:u,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),v=p({aspectRatio:u,width:e.minWidth||0,height:e.minHeight||0},"cover"),E=p({aspectRatio:u,width:e.width||(1!==f?i.width:d),height:e.height||(1!==f?i.height:_)}),D=E.width,z=E.height;D=Math.min(g.width,Math.max(v.width,D)),z=Math.min(g.height,Math.max(v.height,z));var S=document.createElement("canvas"),B=S.getContext("2d");S.width=yt(D),S.height=yt(z),B.fillStyle=e.fillColor||"transparent",B.fillRect(0,0,D,z);var G=e.imageSmoothingEnabled,dt=e.imageSmoothingQuality;B.imageSmoothingEnabled=void 0===G||G,dt&&(B.imageSmoothingQuality=dt);var tt,gt,It,Tt,Ct,nt,J=i.width,b=i.height,A=n,N=l;A<=-d||A>J?(A=0,tt=0,It=0,Ct=0):A<=0?(It=-A,A=0,Ct=tt=Math.min(J,d+A)):A<=J&&(It=0,Ct=tt=Math.min(d,J-A)),tt<=0||N<=-_||N>b?(N=0,gt=0,Tt=0,nt=0):N<=0?(Tt=-N,N=0,nt=gt=Math.min(b,_+N)):N<=b&&(Tt=0,nt=gt=Math.min(_,b-N));var H=[A,N,tt,gt];if(Ct>0&&nt>0){var zt=D/d;H.push(It*zt,Tt*zt,Ct*zt,nt*zt)}return B.drawImage.apply(B,[i].concat(Kt(H.map(function(xe){return Math.floor(yt(xe))})))),S},setAspectRatio:function(e){var a=this.options;return!this.disabled&&!Ht(e)&&(a.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var a=this.options,i=this.dragBox,c=this.face;if(this.ready&&!this.disabled){var n=e===Lt,l=a.movable&&"move"===e;a.dragMode=e=n||l?e:"none",At(i,St,e),wt(i,Y,n),wt(i,Gt,l),a.cropBoxMovable||(At(c,St,e),wt(c,Y,n),wt(c,Gt,l))}return this}},ei=U.Cropper,Ue=function(){function o(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function x(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),!e||!ze.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=T({},de,bt(a)&&a),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return function K(o,e,a){return e&&M(o.prototype,e),a&&M(o,a),o}(o,[{key:"init",value:function(){var c,a=this.element,i=a.tagName.toLowerCase();if(!a[I]){if(a[I]=this,"img"===i){if(this.isImg=!0,c=a.getAttribute("src")||"",this.originalUrl=c,!c)return;c=a.src}else"canvas"===i&&window.HTMLCanvasElement&&(c=a.toDataURL());this.load(c)}}},{key:"load",value:function(a){var i=this;if(a){this.url=a,this.imageData={};var c=this.element,n=this.options;if(!n.rotatable&&!n.scalable&&(n.checkOrientation=!1),!n.checkOrientation||!window.ArrayBuffer)return void this.clone();if(Ie.test(a))return void(Te.test(a)?this.read(function $(o){var e=o.replace(pt,""),a=atob(e),i=new ArrayBuffer(a.length),c=new Uint8Array(i);return R(c,function(n,l){c[l]=a.charCodeAt(l)}),i}(a)):this.clone());var l=new XMLHttpRequest,d=this.clone.bind(this);this.reloading=!0,this.xhr=l,l.onabort=d,l.onerror=d,l.ontimeout=d,l.onprogress=function(){l.getResponseHeader("content-type")!==le&&l.abort()},l.onload=function(){i.read(l.response)},l.onloadend=function(){i.reloading=!1,i.xhr=null},n.checkCrossOrigin&&_e(a)&&c.crossOrigin&&(a=be(a)),l.open("GET",a,!0),l.responseType="arraybuffer",l.withCredentials="use-credentials"===c.crossOrigin,l.send()}}},{key:"read",value:function(a){var i=this.options,c=this.imageData,n=Jt(a),l=0,d=1,_=1;if(n>1){this.url=function ye(o,e){for(var a=[],c=new Uint8Array(o);c.length>0;)a.push(O.apply(null,ge(c.subarray(0,8192)))),c=c.subarray(8192);return"data:".concat(e,";base64,").concat(btoa(a.join("")))}(a,le);var f=function we(o){var e=0,a=1,i=1;switch(o){case 2:a=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,a=-1;break;case 8:e=-90}return{rotate:e,scaleX:a,scaleY:i}}(n);l=f.rotate,d=f.scaleX,_=f.scaleY}i.rotatable&&(c.rotate=l),i.scalable&&(c.scaleX=d,c.scaleY=_),this.clone()}},{key:"clone",value:function(){var a=this.element,i=this.url,c=a.crossOrigin,n=i;this.options.checkCrossOrigin&&_e(i)&&(c||(c="anonymous"),n=be(i)),this.crossOrigin=c,this.crossOriginUrl=n;var l=document.createElement("img");c&&(l.crossOrigin=c),l.src=n||i,l.alt=a.alt||"The image to crop",this.image=l,l.onload=this.start.bind(this),l.onerror=this.stop.bind(this),j(l,te),a.parentNode.insertBefore(l,a.nextSibling)}},{key:"start",value:function(){var a=this,i=this.image;i.onload=null,i.onerror=null,this.sizing=!0;var c=U.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(U.navigator.userAgent),n=function(f,u){T(a.imageData,{naturalWidth:f,naturalHeight:u,aspectRatio:f/u}),a.initialImageData=T({},a.imageData),a.sizing=!1,a.sized=!0,a.build()};if(!i.naturalWidth||c){var l=document.createElement("img"),d=document.body||document.documentElement;this.sizingImage=l,l.onload=function(){n(l.width,l.height),c||d.removeChild(l)},l.src=i.src,c||(l.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",d.appendChild(l))}else n(i.naturalWidth,i.naturalHeight)}},{key:"stop",value:function(){var a=this.image;a.onload=null,a.onerror=null,a.parentNode.removeChild(a),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var a=this.element,i=this.options,c=this.image,n=a.parentNode,l=document.createElement("div");l.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var d=l.querySelector(".".concat(I,"-container")),_=d.querySelector(".".concat(I,"-canvas")),f=d.querySelector(".".concat(I,"-drag-box")),u=d.querySelector(".".concat(I,"-crop-box")),g=u.querySelector(".".concat(I,"-face"));this.container=n,this.cropper=d,this.canvas=_,this.dragBox=f,this.cropBox=u,this.viewBox=d.querySelector(".".concat(I,"-view-box")),this.face=g,_.appendChild(c),j(a,L),n.insertBefore(d,a.nextSibling),this.isImg||q(c,te),this.initPreview(),this.bind(),i.initialAspectRatio=Math.max(0,i.initialAspectRatio)||NaN,i.aspectRatio=Math.max(0,i.aspectRatio)||NaN,i.viewMode=Math.max(0,Math.min(3,Math.round(i.viewMode)))||0,j(u,L),i.guides||j(u.getElementsByClassName("".concat(I,"-dashed")),L),i.center||j(u.getElementsByClassName("".concat(I,"-center")),L),i.background&&j(d,"".concat(I,"-bg")),i.highlight||j(g,Oe),i.cropBoxMovable&&(j(g,Gt),At(g,St,"all")),i.cropBoxResizable||(j(u.getElementsByClassName("".concat(I,"-line")),L),j(u.getElementsByClassName("".concat(I,"-point")),L)),this.render(),this.ready=!0,this.setDragMode(i.dragMode),i.autoCrop&&this.crop(),this.setData(i.data),X(i.ready)&&V(a,"ready",i.ready,{once:!0}),xt(a,"ready")}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),q(this.element,L))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=ei,o}},{key:"setDefaults",value:function(a){T(de,bt(a)&&a)}}]),o}();return T(Ue.prototype,Qe,Je,Ke,Ze,qe,ti),Ue}()}}]);