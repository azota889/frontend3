(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[6991],{75421:(ze,H,u)=>{"use strict";u.d(H,{u:()=>t});var x=u(89163),b=u(33887),_=u(26860),nt=u(76975);let t=(()=>{var W;class Ct extends b._{btnCloseDialog(){this.dialogRef.close(!1)}confirmDialog(){this.dialogRef.close(!0)}constructor(U,X){super(X,U),this.dialogRef=U,this.data=X}}return(W=Ct).\u0275fac=function(U){return new(U||W)(_.rXU(x.CP,8),_.rXU(x.Vh,8))},W.\u0275cmp=_.VBU({type:W,selectors:[["azt-dialog-danger"]],features:[_.Vt3],decls:12,vars:7,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-5"],[1,"text-md","flex"],[1,"text-md",3,"innerHtml"],[1,"p-3","text-right"],["azt-track-service","azt-dialog-danger-9EJYp6jGzr",1,"btn","w-24","btn-secondary","mr-2",3,"click"],["azt-track-service","azt-dialog-danger-ffMh3NrPRC",1,"btn","w-24","btn-danger",3,"click"]],template:function(U,X){1&U&&(_.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),_.nrm(4,"span",4),_.k0s()()(),_.j41(5,"div",5)(6,"button",6),_.bIt("click",function(){return X.btnCloseDialog()}),_.EFF(7),_.nI1(8,"mytranslate"),_.k0s(),_.j41(9,"button",7),_.bIt("click",function(){return X.confirmDialog()}),_.EFF(10),_.nI1(11,"mytranslate"),_.k0s()()()),2&U&&(_.R7$(4),_.Y8G("innerHtml",X.data.content,_.npT),_.R7$(3),_.SpI(" ",_.bMT(8,3,"lang_auto_huy")," "),_.R7$(3),_.SpI(" ",_.bMT(11,5,"lang_auto_xac_nhan")," "))},dependencies:[nt.wp],encapsulation:2}),Ct})()},66991:(ze,H,u)=>{"use strict";u.r(H),u.d(H,{AzotaDigitalizeModule:()=>ve});var x=u(54460),b=u(10936),_=u(65162),nt=u(69223),t=u(26860),W=u(17715);const Ct=["image"];function kt(o,i){1&o&&(t.j41(0,"div",6),t.nrm(1,"div",7),t.k0s())}function U(o,i){if(1&o&&(t.j41(0,"div",8),t.EFF(1),t.k0s()),2&o){const a=t.XpG();t.R7$(1),t.JRh(a.loadImageErrorText)}}let jt=(()=>{class o{constructor(){this.cropperOptions={},this.export=new t.bkB,this.ready=new t.bkB,this.isLoading=!0}ngOnInit(){}ngOnDestroy(){this.cropper&&(this.cropper.destroy(),this.cropper=null)}imageLoaded(a){this.loadError=!1;const e=a.target;this.imageElement=e,this.cropperOptions.checkCrossOrigin&&(e.crossOrigin="anonymous"),e.addEventListener("ready",()=>{this.ready.emit(!0),this.isLoading=!1,this.cropbox&&this.cropper.setCropBoxData(this.cropbox)});let n=NaN;if(this.settings){const{width:r,height:s}=this.settings;n=r/s}this.cropperOptions={aspectRatio:n,checkCrossOrigin:!0,...this.cropperOptions},this.cropper&&(this.cropper.destroy(),this.cropper=void 0),this.cropper=new W(e,this.cropperOptions)}imageLoadError(a){this.loadError=!0,this.isLoading=!1}exportCanvas(a){const e=this.cropper.getImageData(),n=this.cropper.getCropBoxData(),r=this.cropper.getCroppedCanvas(),s={imageData:e,cropData:n};new Promise(d=>{if(a)return d({dataUrl:r.toDataURL("image/png")});r.toBlob(g=>d({blob:g}))}).then(d=>{this.export.emit({...s,...d})})}}return o.\u0275fac=function(a){return new(a||o)},o.\u0275cmp=t.VBU({type:o,selectors:[["angular-cropper"]],viewQuery:function(a,e){if(1&a&&t.GBs(Ct,7),2&a){let n;t.mGM(n=t.lsd())&&(e.image=n.first)}},inputs:{imageUrl:"imageUrl",settings:"settings",cropbox:"cropbox",loadImageErrorText:"loadImageErrorText",cropperOptions:"cropperOptions"},outputs:{export:"export",ready:"ready"},decls:6,vars:3,consts:[[1,"cropper-wrapper"],["class","loading-block",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"cropper"],["alt","image",3,"src","load","error"],["image",""],[1,"loading-block"],[1,"spinner"],[1,"alert","alert-warning"]],template:function(a,e){1&a&&(t.j41(0,"div",0),t.DNE(1,kt,2,0,"div",1),t.DNE(2,U,2,1,"div",2),t.j41(3,"div",3)(4,"img",4,5),t.bIt("load",function(r){return e.imageLoaded(r)})("error",function(r){return e.imageLoadError(r)}),t.k0s()()()),2&a&&(t.R7$(1),t.Y8G("ngIf",e.isLoading),t.R7$(1),t.Y8G("ngIf",e.loadError),t.R7$(2),t.Y8G("src",e.imageUrl,t.B4B))},dependencies:[x.bT],styles:[':host{display:block}.cropper img{max-width:100%;max-height:100%;height:auto}.cropper-wrapper{position:relative;min-height:80px}.cropper-wrapper .loading-block{position:absolute;top:0;left:0;width:100%;height:100%}.cropper-wrapper .loading-block .spinner{width:31px;height:31px;margin:0 auto;border:2px solid rgba(97,100,193,.98);border-radius:50%;border-left-color:transparent;border-right-color:transparent;-webkit-animation:cssload-spin 425ms infinite linear;position:absolute;top:calc(50% - 15px);left:calc(50% - 15px);animation:cssload-spin 425ms infinite linear}@keyframes cssload-spin{to{transform:rotate(360deg)}}/*!\n * Cropper.js v1.4.1\n * https://fengyuanchen.github.io/cropperjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2018-07-15T09:54:43.167Z\n */.cropper-container{direction:ltr;font-size:0;line-height:0;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.cropper-container img{display:block;height:100%;image-orientation:0deg;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;width:100%}.cropper-wrap-box,.cropper-canvas,.cropper-drag-box,.cropper-crop-box,.cropper-modal{inset:0;position:absolute}.cropper-wrap-box,.cropper-canvas{overflow:hidden}.cropper-drag-box{background-color:#fff;opacity:0}.cropper-modal{background-color:#000;opacity:.5}.cropper-view-box{display:block;height:100%;outline-color:#3399ffbf;outline:1px solid #39f;overflow:hidden;width:100%}.cropper-dashed{border:0 dashed #eee;display:block;opacity:.5;position:absolute}.cropper-dashed.dashed-h{border-bottom-width:1px;border-top-width:1px;height:calc(100% / 3);left:0;top:calc(100% / 3);width:100%}.cropper-dashed.dashed-v{border-left-width:1px;border-right-width:1px;height:100%;left:calc(100% / 3);top:0;width:calc(100% / 3)}.cropper-center{display:block;height:0;left:50%;opacity:.75;position:absolute;top:50%;width:0}.cropper-center:before,.cropper-center:after{background-color:#eee;content:" ";display:block;position:absolute}.cropper-center:before{height:1px;left:-3px;top:0;width:7px}.cropper-center:after{height:7px;left:0;top:-3px;width:1px}.cropper-face,.cropper-line,.cropper-point{display:block;height:100%;opacity:.1;position:absolute;width:100%}.cropper-face{background-color:#fff;left:0;top:0}.cropper-line{background-color:#39f}.cropper-line.line-e{cursor:ew-resize;right:-3px;top:0;width:5px}.cropper-line.line-n{cursor:ns-resize;height:5px;left:0;top:-3px}.cropper-line.line-w{cursor:ew-resize;left:-3px;top:0;width:5px}.cropper-line.line-s{bottom:-3px;cursor:ns-resize;height:5px;left:0}.cropper-point{background-color:#39f;height:5px;opacity:.75;width:5px}.cropper-point.point-e{cursor:ew-resize;margin-top:-3px;right:-3px;top:50%}.cropper-point.point-n{cursor:ns-resize;left:50%;margin-left:-3px;top:-3px}.cropper-point.point-w{cursor:ew-resize;left:-3px;margin-top:-3px;top:50%}.cropper-point.point-s{bottom:-3px;cursor:s-resize;left:50%;margin-left:-3px}.cropper-point.point-ne{cursor:nesw-resize;right:-3px;top:-3px}.cropper-point.point-nw{cursor:nwse-resize;left:-3px;top:-3px}.cropper-point.point-sw{bottom:-3px;cursor:nesw-resize;left:-3px}.cropper-point.point-se{bottom:-3px;cursor:nwse-resize;height:20px;opacity:1;right:-3px;width:20px}@media (min-width: 768px){.cropper-point.point-se{height:15px;width:15px}}@media (min-width: 992px){.cropper-point.point-se{height:10px;width:10px}}@media (min-width: 1200px){.cropper-point.point-se{height:5px;opacity:.75;width:5px}}.cropper-point.point-se:before{background-color:#39f;bottom:-50%;content:" ";display:block;height:200%;opacity:0;position:absolute;right:-50%;width:200%}.cropper-invisible{opacity:0}.cropper-bg{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC)}.cropper-hide{display:block;height:0;position:absolute;width:0}.cropper-hidden{display:none!important}.cropper-move{cursor:move}.cropper-crop{cursor:crosshair}.cropper-disabled .cropper-drag-box,.cropper-disabled .cropper-face,.cropper-disabled .cropper-line,.cropper-disabled .cropper-point{cursor:not-allowed}\n'],encapsulation:2}),o})(),Dt=(()=>{class o{}return o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[x.MD]}),o})();var j=u(15343),St=u(10123),Mt=u(5502),w=u(46584),Rt=u(70050),Jt=u(7050),Qt=u(91100),Kt=u(43234),q=u(1133),tt=u(37714),R=u(59640),J=u(37497),Y=u(63028),dt=u(51113),V=u(73014),gt=u(85710),Pt=u(51698),Nt=u(79767),C=u(76975),ht=u(21973),Ce=u(2812),xt=u(52909),Ft=u(17776);let et=(()=>{var o;class i{constructor(){this.subscriptions=new gt.yU,this.sAztBase64Service=(0,t.WQX)(ht.D),this.ocrService=(0,t.WQX)(Ft.so),this.commonService=(0,t.WQX)(Ce.R),this.sAztUuidService=(0,t.WQX)(xt.D),this.digitalizedBookPageService=(0,t.WQX)(Y.gI)}callChangeBookPageDataApi(e,n,r,s){this.subscriptions.add(this.digitalizedBookPageService.apiDigitalizedBookPageUpdateOcrPost({bookId:e,bookPageId:n,ocrContent:r}).subscribe(d=>{if(!d.success)return s(!1,d.message);s(!0,"")}))}digitalizeOneImage(e,n,r,s){return new Pt.c(l=>{n("lang_digitalize_call_ocr_api"),this.subscriptions.add(this.ocrService.aiApiV1OcrImageToTextPost({imageUrl:e}).subscribe({next:d=>{s(this.replaceOrcData(d)),l.next(!0),l.complete()},error:d=>{r(d.error.message),l.next(!1),l.complete()}}))})}replaceOrcData(e){let n=e.data,r=this.sAztUuidService.getUuid();return n=this.commonService.convertLatexTagToAztMathTag(n,r),n=(new C.bt).transform((new C.UN).transform(n)),n=this.commonService.replaceAll(n,"<table>","<table class='table table-bordered'>")??n,n=n.replace(new RegExp(r,"g"),"\n"),{htmlResult:n}}extractImageByOrcUtil(e,n){this.sAztBase64Service.convertImageUrlToBase64(e,r=>{if(!r)return n(void 0,[],"Error to get base64 from url");this.sAztBase64Service.convertFileToUint8Array(this.sAztBase64Service.base64ToFile(r),s=>{if(!s)return n(void 0,[],"Error to get Uint8Array from base64");let l={base64:this.sAztBase64Service.removePrefixOfBase64(r),width:100,height:100,extension:"png"};this.loadScriptHandleImage(()=>{this.imageUtils.detectImage(s).then(d=>n(l,d.images.map(g=>({base64:this.sAztBase64Service.uint8ArrayToBase64(new Uint8Array(g.content)),width:g.width,height:g.height,extension:g.extension})),void 0)).catch(d=>n(l,[],"Error when call imageUtils.detectImage"))})})})}waitAnswerSheetInitDone(e){if(Nt.A.azotaScanAnswerSheet)return e();setTimeout(()=>{this.waitAnswerSheetInitDone(e)},100)}loadScriptHandleImage(e){var n=this;if(this.imageUtils)return e();this.commonService.loadAnswerSheetJs().then((0,V.A)(function*(){n.waitAnswerSheetInitDone((0,V.A)(function*(){n.imageUtils=yield Nt.A.azotaScanAnswerSheet.imageUtils(),e()}))})).catch(r=>{this.commonService.snackError("lang_auto_tai_thu_vien_that_bao_vui_long_load_lai_trang_de_thu_lai"),e()})}ngOnDestroy(){this.subscriptions.unsubscribe()}}return(o=i).\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),i})();var wt=u(14159),Gt=u(27035),Zt=u(17178),qt=u(63016),yt=u(47947),$t=u(20036),Ot=u(15351);const te=(o,i)=>(o.push(i),o);let De=(()=>{var o;class i{processObservables(e,n){return(0,wt.H)(n).pipe((0,Gt.Z)((r,s)=>r.pipe((0,Zt.W)(l=>(console.error("Error in observable:",l),(0,qt.of)(null))),(0,yt.T)(l=>({result:l,index:s}))),e),function ke(){return(0,Ot.N)((o,i)=>{(function Lt(o,i){return(0,Ot.N)((0,$t.S)(o,i,arguments.length>=2,!1,!0))})(te,[])(o).subscribe(i)})}(),(0,yt.T)(r=>r.sort((s,l)=>s.index-l.index).map(s=>s.result)))}}return(o=i).\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),i})();var At=u(18718),ee=u(22613),mt=u(96451),It=u(46899),ie=u(53043);const ae=["*"];let ut=(()=>{var o;class i extends R.H{constructor(){super(...arguments),this.imageUrl="",this.sAztDialogService=(0,t.WQX)(It.i)}previewImage(){this.sAztDialogService.open(ie.V,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{fileOption:{url:this.imageUrl,mimes:"image/jpeg"},viewFullImageWithScroll:!0},restoreFocus:!1})}}return(o=i).\u0275fac=function(){let a;return function(n){return(a||(a=t.xGo(o)))(n||o)}}(),o.\u0275cmp=t.VBU({type:o,selectors:[["azt-preview-image-tag"]],inputs:{imageUrl:"imageUrl"},features:[t.Vt3],ngContentSelectors:ae,decls:2,vars:0,consts:[[3,"click"]],template:function(e,n){1&e&&(t.NAR(),t.j41(0,"span",0),t.bIt("click",function(){return n.previewImage()}),t.SdG(1),t.k0s())},encapsulation:2}),i})();const Bt=function(){return{"flex-none":!0,"mr-1":!0}};function oe(o,i){if(1&o){const a=t.RV6();t.qex(0),t.j41(1,"span",10),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.editBookPage(n.obj))}),t.nrm(2,"lucide-icon",11),t.EFF(3),t.nI1(4,"mytranslate"),t.k0s(),t.EFF(5," | "),t.j41(6,"span",12),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.callAgainOcrBookPageEvent.emit(n.obj))}),t.nrm(7,"lucide-icon",13),t.EFF(8),t.nI1(9,"mytranslate"),t.k0s(),t.bVm()}2&o&&(t.R7$(2),t.Y8G("ngClass",t.lJ4(8,Bt)),t.R7$(1),t.SpI(" ",t.bMT(4,4,"lang_cms_admin_digitalized_edit_content")," "),t.R7$(4),t.Y8G("ngClass",t.lJ4(9,Bt)),t.R7$(1),t.SpI(" ",t.bMT(9,6,"lang_cms_admin_digitalized_re_digitalized_again")," "))}function xe(o,i){if(1&o&&(t.j41(0,"div",14),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&o){const a=t.XpG();t.R7$(1),t.JRh(t.bMT(2,1,a.obj.logMessage))}}function we(o,i){if(1&o&&(t.j41(0,"div"),t.nrm(1,"div",15),t.nI1(2,"safeNormalHtmlContent"),t.nI1(3,"async"),t.nI1(4,"mathJaxContent"),t.k0s()),2&o){const a=t.XpG();let e;t.R7$(1),t.Y8G("innerHTML",t.bMT(2,1,t.bMT(3,3,t.bMT(4,5,null!==(e=a.obj.ocrContent)&&void 0!==e?e:""))),t.npT)}}let ye=(()=>{var o;class i extends R.H{constructor(){super(...arguments),this.changeBookPageStatusEvent=new t.bkB,this.callAgainOcrBookPageEvent=new t.bkB}editBookPage(e){e.currentStatus="show_edit_form",this.changeBookPageStatusEvent.emit(e)}}return(o=i).\u0275fac=function(){let a;return function(n){return(a||(a=t.xGo(o)))(n||o)}}(),o.\u0275cmp=t.VBU({type:o,selectors:[["app-digitalized-view-book-page"]],inputs:{obj:"obj"},outputs:{changeBookPageStatusEvent:"changeBookPageStatusEvent",callAgainOcrBookPageEvent:"callAgainOcrBookPageEvent"},features:[t.Vt3],decls:13,vars:9,consts:[[1,"p-3","bg-slate-100","flex","items-center"],[1,"mr-3","w-full"],[1,"mr-2"],[1,"flex-none","items-center"],[4,"ngIf"],[1,"p-3"],[1,"clickable",3,"imageUrl"],["width","50px","height","50px",3,"src"],[1,"mb-3","mt-3"],["class","mb-3 text-pending",4,"ngIf"],[1,"text-primary","clickable","mr-2",3,"click"],["name","pencil","size","16",3,"ngClass"],[1,"text-primary","clickable","ml-2",3,"click"],["name","refresh-cw","size","16",3,"ngClass"],[1,"mb-3","text-pending"],[3,"innerHTML"]],template:function(e,n){1&e&&(t.j41(0,"div",0)(1,"span",1)(2,"b",2),t.EFF(3),t.nI1(4,"mytranslate"),t.k0s()(),t.j41(5,"div",3),t.DNE(6,oe,10,10,"ng-container",4),t.k0s()(),t.j41(7,"div",5)(8,"azt-preview-image-tag",6),t.nrm(9,"img",7),t.k0s(),t.nrm(10,"hr",8),t.DNE(11,xe,3,3,"div",9),t.DNE(12,we,5,7,"div",4),t.k0s()),2&e&&(t.R7$(3),t.Lme("",t.bMT(4,7,"lang_cms_admin_digitalized_page"),": ",n.obj.currentPage,""),t.R7$(3),t.Y8G("ngIf",n.obj.isOrc),t.R7$(2),t.Y8G("imageUrl",n.obj.imageLink),t.R7$(1),t.Y8G("src",n.obj.imageLink,t.B4B),t.R7$(2),t.Y8G("ngIf",n.obj.logMessage),t.R7$(1),t.Y8G("ngIf",n.obj.isOrc))},dependencies:[x.YU,x.bT,ut,j.WGl,x.Jj,C.wp,C.km,C._y],encapsulation:2}),i})();var Ut=u(52811);let ne=(()=>{var o;class i extends R.H{}return(o=i).\u0275fac=function(){let a;return function(n){return(a||(a=t.xGo(o)))(n||o)}}(),o.\u0275cmp=t.VBU({type:o,selectors:[["app-digitalized-processing-book-page"]],inputs:{obj:"obj"},features:[t.Vt3],decls:13,vars:9,consts:[[1,"p-3","bg-slate-100","flex","items-center"],[1,"mr-3","w-full"],[1,"mr-2"],[1,"p-3"],[1,"clickable",3,"imageUrl"],["width","50px","height","50px",3,"src"],[1,"mb-3","mt-3"],[1,"flex","items-center"],[1,"mr-1"]],template:function(e,n){if(1&e&&(t.j41(0,"div",0)(1,"span",1)(2,"b",2),t.EFF(3),t.nI1(4,"mytranslate"),t.k0s()()(),t.j41(5,"div",3)(6,"azt-preview-image-tag",4),t.nrm(7,"img",5),t.k0s(),t.nrm(8,"hr",6),t.j41(9,"div",7),t.nrm(10,"azt-loading-ui",8),t.EFF(11),t.nI1(12,"mytranslate"),t.k0s()()),2&e){let r;t.R7$(3),t.Lme("",t.bMT(4,5,"lang_cms_admin_digitalized_page"),": ",n.obj.currentPage,""),t.R7$(3),t.Y8G("imageUrl",n.obj.imageLink),t.R7$(1),t.Y8G("src",n.obj.imageLink,t.B4B),t.R7$(4),t.SpI(" ",t.bMT(12,7,null!==(r=n.obj.logMessage)&&void 0!==r?r:"lang_lang_cms_admin_digitalized_is_waiting_to_process")," ")}},dependencies:[Ut.R,ut,C.wp],encapsulation:2}),i})();var Xt=u(89163),re=u(33887);const Oe=["angularCropper"];function Ae(o,i){if(1&o){const a=t.RV6();t.qex(0),t.j41(1,"img",10),t.bIt("click",function(){const r=t.eBV(a).$implicit,s=t.XpG(2);return t.Njj(s.chooseImage(r))}),t.nI1(2,"addBase64Extension"),t.k0s(),t.bVm()}if(2&o){const a=i.$implicit;t.R7$(1),t.FS9("src",t.i5U(2,1,a.base64,"png"),t.B4B)}}function f(o,i){if(1&o&&(t.j41(0,"div",8),t.DNE(1,Ae,3,4,"ng-container",9),t.k0s()),2&o){const a=t.XpG();t.R7$(1),t.Y8G("ngForOf",a.base64Images)}}function se(o,i){if(1&o&&(t.nrm(0,"angular-cropper",11,12),t.nI1(2,"addBase64Extension")),2&o){const a=t.XpG();t.Y8G("cropperOptions",a.cropperOptions)("imageUrl",t.i5U(2,2,a.currentBase64Image.base64,"png"))}}let Yt=(()=>{var o;class i extends re._{chooseImage(e){this.currentBase64Image=e}cropImage(e){var n=this;return(0,V.A)(function*(){n.angularCropper?.cropper.getCroppedCanvas().toBlob(r=>{r&&n.sAztBase64Service.convertBlobToBase64(r,function(){var s=(0,V.A)(function*(l){let d=n.angularCropper?.cropper.getCropBoxData(),g=d?.width,p=d?.height;!g||!p||(n.base64Images.push({base64:l,width:g,height:p,extension:"png"}),yield n.sAztBase64Service.copyBase64ToClipBoard(l),n.showSuccessSnack("lang_cms_copy_success"),e&&n.dialogRef.close(n.base64Images))});return function(l){return s.apply(this,arguments)}}())})})()}closeDialog(){this.dialogRef.close(this.base64Images)}constructor(e,n){super(n,e),this.dialogRef=e,this.data=n,this.sAztBase64Service=(0,t.WQX)(ht.D),this.base64Images=[],this.cropperOptions={movable:!0,scalable:!1,zoomable:!1,data:{width:240,height:90}},this.base64Images=n.base64Images,this.currentBase64Image=this.commonService.getFirstOfArray(this.base64Images)}}return(o=i).\u0275fac=function(e){return new(e||o)(t.rXU(Xt.CP,8),t.rXU(Xt.Vh,8))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-coazt-image-editor"]],viewQuery:function(e,n){if(1&e&&t.GBs(Oe,5),2&e){let r;t.mGM(r=t.lsd())&&(n.angularCropper=r.first)}},features:[t.Vt3],decls:14,vars:11,consts:[[1,"box","p-3"],["class","list-base640-images mb-3",4,"ngIf"],[1,"text-center","mb-3"],[1,"btn","btn-primary","mr-2",3,"click"],[1,"btn","btn-info","mr-2",3,"click"],[1,"btn","btn-secondary","mr-2","w-32",3,"click"],[2,"height","calc(100vh - 120px)","overflow-x","hidden","overflow-y","scroll"],[3,"cropperOptions","imageUrl",4,"ngIf"],[1,"list-base640-images","mb-3"],[4,"ngFor","ngForOf"],[1,"box","mr-2","mb-2","clickable",3,"src","click"],[3,"cropperOptions","imageUrl"],["angularCropper",""]],template:function(e,n){1&e&&(t.j41(0,"div",0),t.DNE(1,f,2,1,"div",1),t.j41(2,"div",2)(3,"span",3),t.bIt("click",function(){return n.cropImage(!0)}),t.EFF(4),t.nI1(5,"mytranslate"),t.k0s(),t.j41(6,"span",4),t.bIt("click",function(){return n.cropImage(!1)}),t.EFF(7),t.nI1(8,"mytranslate"),t.k0s(),t.j41(9,"span",5),t.bIt("click",function(){return n.closeDialog()}),t.EFF(10),t.nI1(11,"mytranslate"),t.k0s()(),t.j41(12,"div",6),t.DNE(13,se,3,5,"angular-cropper",7),t.k0s()()),2&e&&(t.R7$(1),t.Y8G("ngIf",n.base64Images.length>0),t.R7$(3),t.JRh(t.bMT(5,5,"lang_button_crop_and_close")),t.R7$(3),t.JRh(t.bMT(8,7,"lang_button_crop")),t.R7$(3),t.JRh(t.bMT(11,9,"lang_button_close")),t.R7$(3),t.Y8G("ngIf",n.currentBase64Image))},dependencies:[x.Sq,x.bT,jt,C.wp,C.t4],styles:[".list-base640-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ccc;height:50px;width:50px}"]}),i})();function it(o,i){if(1&o){const a=t.RV6();t.qex(0),t.j41(1,"img",6),t.bIt("click",function(){const r=t.eBV(a).$implicit,s=t.XpG(2);return t.Njj(s.copyImage(r))}),t.nI1(2,"addBase64Extension"),t.k0s(),t.bVm()}if(2&o){const a=i.$implicit;t.R7$(1),t.FS9("src",t.i5U(2,1,a.base64,a.extension),t.B4B)}}function Ie(o,i){if(1&o&&(t.j41(0,"div",4),t.DNE(1,it,3,4,"ng-container",5),t.k0s()),2&o){const a=t.XpG();t.R7$(1),t.Y8G("ngForOf",a.base64Images)}}let rt=(()=>{var o;class i extends R.H{constructor(){super(...arguments),this.replaceImageEvent=new t.bkB,this.sAztDialogService=(0,t.WQX)(It.i),this.sAztDigitalizeService=(0,t.WQX)(et),this.sAztBase64Service=(0,t.WQX)(ht.D),this.base64Images=[]}copyImage(e){var n=this;return(0,V.A)(function*(){yield n.sAztBase64Service.copyBase64ToClipBoard(e.base64),n.showSuccessSnack("lang_cms_copy_and_replace_success"),n.replaceImageEvent.emit(e)})()}cropImageDialog(){this.sAztDialogService.open(Yt,{data:{base64Images:this.base64Images},restoreFocus:!1,width:"100vw",maxWidth:"100vw",height:"100vh",backdropClass:"azt-backdrop-full-width-height",disableClose:!0}).afterClosed().subscribe(n=>{null!=n&&(this.base64Images=n)})}ngOnChanges(){this.initStatusObj(),this.sAztDigitalizeService.extractImageByOrcUtil(this.imageUrl,(e,n,r)=>{if(r)return this.errorStatusObj(r,!0);let s=[];e&&s.push(e),n.forEach(l=>s.push(l)),this.base64Images=s,this.stopStatusObj()})}}return(o=i).\u0275fac=function(){let a;return function(n){return(a||(a=t.xGo(o)))(n||o)}}(),o.\u0275cmp=t.VBU({type:o,selectors:[["app-digitalized-list-digitalized-images"]],inputs:{imageUrl:"imageUrl"},outputs:{replaceImageEvent:"replaceImageEvent"},features:[t.Vt3,t.OA$],decls:6,vars:4,consts:[[2,"height","228px","overflow-x","scroll","overflow-y","hidden"],["class","list-base640-images",4,"ngIf"],[1,"mb-3","mt-3"],[1,"text-primary","clickable",3,"click"],[1,"list-base640-images"],[4,"ngFor","ngForOf"],[1,"box","mr-2","mb-2","clickable",3,"src","click"]],template:function(e,n){1&e&&(t.j41(0,"div",0),t.DNE(1,Ie,2,1,"div",1),t.k0s(),t.j41(2,"div",2)(3,"span",3),t.bIt("click",function(){return n.cropImageDialog()}),t.EFF(4),t.nI1(5,"mytranslate"),t.k0s()()),2&e&&(t.R7$(1),t.Y8G("ngIf",n.base64Images.length>0),t.R7$(3),t.JRh(t.bMT(5,2,"lang_button_crop")))},dependencies:[x.Sq,x.bT,C.wp,C.t4],styles:[".list-base640-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ccc;max-height:200px}"]}),i})();function M(o,i){1&o&&t.nrm(0,"azt-loading-ui",12)}const Be=function(){return{"flex-none":!0,"mr-1":!0}};let le=(()=>{var o;class i extends R.H{saveObj(){this.initStatusObj();let e=this.htmlFormControl.value;this.sAztDigitalizeService.callChangeBookPageDataApi(this.bookObj.id,this.obj.id,e,(n,r)=>{if(!n)return this.errorStatusObj(r,!0);this.obj.ocrContent=e,this.changeBookPageStatusEvent.emit(this.obj),this.successStatusObj("lang_cms_update_success",!0)})}cancelObj(){this.showSuccessSnack("lang_cms_cancel_success"),this.htmlFormControl.setValue(this.obj.ocrContent??"")}replaceImage(e){let n=this.htmlFormControl.value.replace("<img>",`<img src='${this.sAztBase64Service.generateBase64Prefix(e.extension)+e.base64}'/>`);this.htmlFormControl.setValue(n)}ngOnChanges(){this.htmlFormControl.setValue(this.obj.ocrContent??"")}ngOnInit(){super.ngOnInit()}constructor(){super(),this.sAztDigitalizeService=(0,t.WQX)(et),this.sAztBase64Service=(0,t.WQX)(ht.D),this.changeBookPageStatusEvent=new t.bkB,this.callAgainOcrBookPageEvent=new t.bkB,this.htmlFormControl=new b.MJ("",{nonNullable:!0})}}return(o=i).\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.VBU({type:o,selectors:[["app-digitalized-edit-book-page"]],inputs:{bookObj:"bookObj",obj:"obj"},outputs:{changeBookPageStatusEvent:"changeBookPageStatusEvent",callAgainOcrBookPageEvent:"callAgainOcrBookPageEvent"},features:[t.Vt3,t.OA$],decls:22,vars:25,consts:[[1,"p-3","bg-slate-100","flex","items-center"],[1,"mr-3","w-full"],[1,"mr-2"],[1,"text-primary","clickable","ml-2",3,"click"],["name","refresh-cw","size","16",3,"ngClass"],[1,"p-3"],[3,"imageUrl","replaceImageEvent"],[3,"formControl","apiKey","init"],[1,"flex-none","items-center","text-right","mt-3"],[1,"btn","btn-secondary","mr-3",3,"click"],[1,"btn","btn-primary",3,"click"],["class","mr-1",4,"ngIf"],[1,"mr-1"]],template:function(e,n){1&e&&(t.j41(0,"div",0)(1,"span",1)(2,"b",2),t.EFF(3),t.nI1(4,"mytranslate"),t.k0s(),t.j41(5,"span",3),t.bIt("click",function(){return n.callAgainOcrBookPageEvent.emit(n.obj)}),t.nrm(6,"lucide-icon",4),t.EFF(7),t.nI1(8,"mytranslate"),t.k0s()()(),t.j41(9,"div",5)(10,"app-digitalized-list-digitalized-images",6),t.bIt("replaceImageEvent",function(s){return n.replaceImage(s)}),t.k0s(),t.nrm(11,"editor",7),t.nI1(12,"getTinyMceKey"),t.nI1(13,"getTinyMceConfig"),t.j41(14,"div",8)(15,"button",9),t.bIt("click",function(){return n.cancelObj()}),t.EFF(16),t.nI1(17,"mytranslate"),t.k0s(),t.j41(18,"button",10),t.bIt("click",function(){return n.saveObj()}),t.DNE(19,M,1,0,"azt-loading-ui",11),t.EFF(20),t.nI1(21,"mytranslate"),t.k0s()()()),2&e&&(t.R7$(3),t.Lme("",t.bMT(4,12,"lang_cms_admin_digitalized_page"),": ",n.obj.currentPage,""),t.R7$(3),t.Y8G("ngClass",t.lJ4(24,Be)),t.R7$(1),t.SpI(" ",t.bMT(8,14,"lang_cms_admin_digitalized_re_digitalized_again")," "),t.R7$(3),t.Y8G("imageUrl",n.obj.imageLink),t.R7$(1),t.FS9("apiKey",t.bMT(12,16,"")),t.Y8G("formControl",n.htmlFormControl)("init",t.bMT(13,18,"admin_for_digitalized")),t.BMQ("style","width: 100%;min-height:500px;",t.$dS),t.R7$(5),t.JRh(t.bMT(17,20,"lang_auto_huy")),t.R7$(3),t.Y8G("ngIf",n.statusObj.loading),t.R7$(1),t.SpI(" ",t.bMT(21,22,"lang_auto_luu")," "))},dependencies:[x.YU,x.bT,b.BC,nt.xn,b.l_,Ut.R,j.WGl,rt,C.wp,C.Hw,C.yc],encapsulation:2}),i})();function A(o,i){if(1&o&&t.nrm(0,"azt-loading-effect",3),2&o){const a=t.XpG();t.Y8G("currentStatusObj",a.statusObj)}}function y(o,i){if(1&o){const a=t.RV6();t.j41(0,"app-digitalized-view-book-page",17),t.bIt("changeBookPageStatusEvent",function(n){t.eBV(a);const r=t.XpG(4);return t.Njj(r.changeBookPageStatus(n))})("callAgainOcrBookPageEvent",function(n){t.eBV(a);const r=t.XpG(4);return t.Njj(r.reDigitalizedOneObj(n))}),t.k0s()}if(2&o){const a=t.XpG(2).$implicit;t.Y8G("obj",a)}}function Ee(o,i){if(1&o){const a=t.RV6();t.j41(0,"app-digitalized-edit-book-page",18),t.bIt("changeBookPageStatusEvent",function(n){t.eBV(a);const r=t.XpG(4);return t.Njj(r.changeBookPageStatus(n))})("callAgainOcrBookPageEvent",function(n){t.eBV(a);const r=t.XpG(4);return t.Njj(r.reDigitalizedOneObj(n))}),t.k0s()}if(2&o){const a=t.XpG(2).$implicit,e=t.XpG(2);t.Y8G("bookObj",e.bookObj)("obj",a)}}function st(o,i){if(1&o&&t.nrm(0,"app-digitalized-processing-book-page",19),2&o){const a=t.XpG(2).$implicit;t.Y8G("obj",a)}}function Te(o,i){if(1&o&&(t.j41(0,"div"),t.DNE(1,y,1,1,"app-digitalized-view-book-page",14),t.DNE(2,Ee,1,2,"app-digitalized-edit-book-page",15),t.DNE(3,st,1,1,"app-digitalized-processing-book-page",16),t.k0s()),2&o){const a=t.XpG().$implicit;t.R7$(1),t.Y8G("ngIf","none"==a.currentStatus),t.R7$(1),t.Y8G("ngIf","show_edit_form"==a.currentStatus),t.R7$(1),t.Y8G("ngIf","calling_ocr_api"==a.currentStatus)}}function Q(o,i){if(1&o&&(t.qex(0),t.DNE(1,Te,4,3,"div",13),t.bVm()),2&o){const a=i.$implicit;t.R7$(1),t.Y8G("ngIf",a.isShow)}}function je(o,i){if(1&o){const a=t.RV6();t.j41(0,"div",4)(1,"div",5)(2,"button",6),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.digitalizedAll())}),t.EFF(3),t.nI1(4,"mytranslate"),t.k0s(),t.j41(5,"button",6),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.runDigitalizedCurrentPage())}),t.EFF(6),t.nI1(7,"mytranslate"),t.k0s(),t.j41(8,"button",7),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.exportData("html"))}),t.EFF(9),t.nI1(10,"mytranslate"),t.k0s(),t.j41(11,"button",7),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.exportData("docx"))}),t.EFF(12),t.nI1(13,"mytranslate"),t.k0s()(),t.j41(14,"div",8),t.DNE(15,Q,2,1,"ng-container",9),t.k0s(),t.j41(16,"div",10)(17,"div",11)(18,"azt-paging",12),t.bIt("goToPaginationPage",function(n){t.eBV(a);const r=t.XpG();return t.Njj(r.goToPage(n))}),t.k0s()()()()}if(2&o){const a=t.XpG();t.R7$(3),t.E5c("",t.bMT(4,9,"lang_cms_admin_digitalized_digitalized_all")," (",a.bookObj.totalDone," / ",a.bookObj.totalPage,")"),t.R7$(3),t.Lme("",t.bMT(7,11,"lang_cms_admin_digitalized_digitalized_current_page")," (",a.totalCurrentItems,")"),t.R7$(3),t.JRh(t.bMT(10,13,"lang_cms_admin_digitalized_digitalized_export_html")),t.R7$(3),t.JRh(t.bMT(13,15,"lang_cms_admin_digitalized_digitalized_export_docx")),t.R7$(3),t.Y8G("ngForOf",a.objs),t.R7$(3),t.Y8G("pageObj",a.pageObj)}}let I=(()=>{var o;class i extends R.H{digitalizedAll(){this.digitalizedObjs(this.objs.filter(e=>"none"==e.currentStatus&&1!=e.isOrc))}runDigitalizedCurrentPage(){this.digitalizedObjs(this.objs.filter(e=>e.isShow&&"none"==e.currentStatus&&1!=e.isOrc))}reDigitalizedOneObj(e){this.digitalizedObjs([e])}digitalizedObjs(e){this.showSuccessSnack(this.commonService.myTranslateInstant("lang_cms_admin_digitalized_for_total_object")+": "+e.length);let n=e.map(s=>s.id);this.objs.forEach(s=>!!n.includes(s.id)&&Object.assign(s,{...s,currentStatus:"calling_ocr_api"}));let r=[];e.forEach(s=>r.push(this.runDigitalizeOneImage(s))),this.waitDestroy(this.sAztConcurrencyApiService.processObservables(1,r).subscribe(s=>{}))}runDigitalizeOneImage(e){return this.sAztDigitalizeService.digitalizeOneImage(e.imageLink,n=>{console.log(`Digitalized for: Id: ${e.id} | Link: ${e.imageLink}`),this.objs.forEach(r=>r.id==e.id&&Object.assign(r,{...r,logMessage:n}))},n=>{console.log(`Digitalized error: Id: ${e.id} | Link: ${e.imageLink} | message: ${n}`),this.objs.forEach(r=>r.id==e.id&&Object.assign(r,{...r,logMessage:n,currentStatus:"none"}))},n=>{this.sAztDigitalizeService.callChangeBookPageDataApi(this.bookId,e.id,n.htmlResult,(r,s)=>{if(!r)return console.log(`Digitalized error: Id: ${e.id} | Link: ${e.imageLink} | message: ${s}`),void this.objs.forEach(l=>l.id==e.id&&Object.assign(l,{...l,logMessage:s,currentStatus:"none"}));this.objs.forEach(l=>l.id==e.id&&Object.assign(l,{...l,logMessage:"",currentStatus:"show_edit_form",ocrContent:n.htmlResult,isOrc:1})),this.bookObj.totalDone=this.objs.filter(l=>l.isOrc).length,console.log(`Digitalized success: Id: ${e.id} | Link: ${e.imageLink}`)})})}changeBookPageStatus(e){this.objs.forEach(n=>n.id==e.id&&Object.assign(n,{...e}))}exportData(e){let n=new Date,r="";if(this.objs.forEach(s=>r+=`<page [page]='${s.currentPage}'/>`+(s.ocrContent??"")),r=this.commonService.decodeHtmlEntities(r),"html"!=e)this.commonService.loadAzotaDocxJs().then(()=>{(0,tt.w)().textToDocxBinary(r,null).then(s=>{let l=`azota-digitalize-book-${n.getDate()}${n.getMonth()+1}${n.getFullYear()}-${n.getTime()}.docx`;const d=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});d&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(d),l)}).catch(s=>{this.showErrorSnack(s)})}).catch(s=>{this.showErrorSnack(s)});else{let s=`azota-digitalize-book-${n.getDate()}${n.getMonth()+1}${n.getFullYear()}-${n.getTime()}.html`;const l=new Blob([r],{type:"text/plain"});l&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(l),s)}}goToPage(e){this.myNavigation(`/azota-digitalized/digitalized-one-book/${this.bookId}/${e}`),this.pageObj.setTotalPages(this.objs.length),this.pageObj.setPageNumber(e);let n=this.pageObj.getViewObjsOfCurrentPage(this.objs).map(r=>r.id);this.objs.forEach(r=>r.isShow=!!n.includes(r.id)),this.totalCurrentItems=this.objs.filter(r=>r.isShow).length}initData(){this.initStatusObj(),this.waitDestroy(this.digitalizedBookPageService.apiDigitalizedBookPageGetObjsGet(this.bookId).subscribe(e=>{if(!e.success||!e.data)return this.errorStatusObj(e.message,!0);this.bookObj=e.data.bookObj,this.objs=e.data.bookPageObjs.map((n,r)=>({...n,isShow:!1,currentPage:r+1,ocrContent:n.ocrContent?this.sAztZipDataService.decodeContentGzip(n.ocrContent):void 0,logMessage:n.isOrc?void 0:"lang_cms_admin_digitalized_not_call_ocr_status",currentStatus:n.isOrc?"show_edit_form":"none",base64Images:[]}))??[],this.goToPage(Number(this.commonService.getMyParam(this.activeRoute,"page")??0)),this.stopStatusObj()}))}ngOnInit(){super.ngOnInit(),this.commonService.translateMetaData({title:"lang_cms_admin_digitalized_one_book_title",description:"lang_cms_admin_digitalized_one_book_title",image:"lang_cms_test_image"}),this.bookId=Number(this.commonService.getMyParam(this.activeRoute,"bookId")??0),this.initData()}constructor(e,n,r,s,l){super(),this.digitalizedBookPageService=e,this.activeRoute=n,this.sAztZipDataService=r,this.sAztDigitalizeService=s,this.sAztConcurrencyApiService=l,this.objs=[],this.bookId=0,this.backTo="/azota-digitalized/list-books",this.pageObj=new J.d(10),this.totalCurrentItems=0}}return(o=i).\u0275fac=function(e){return new(e||o)(t.rXU(Y.gI),t.rXU(_.nX),t.rXU(dt.j),t.rXU(et),t.rXU(De))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-digitalized-digitalized-one-book"]],features:[t.Vt3],decls:4,vars:3,consts:[[3,"headerBackToLink"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],["doneLoading",""],[3,"currentStatusObj"],[1,"mt-5"],[1,"flex","items-center","mb-3","pb-3",2,"border-bottom","1px solid #ccc"],[1,"btn","btn-primary","mr-3",3,"click"],[1,"btn","btn-success","mr-3",3,"click"],[1,"box"],[4,"ngFor","ngForOf"],[1,"col-span-12","flex","flex-wrap","sm:flex-row","sm:flex-nowrap","items-center","mt-3"],[1,"w-full","sm:w-auto","sm:mr-auto"],[3,"pageObj","goToPaginationPage"],[4,"ngIf"],[3,"obj","changeBookPageStatusEvent","callAgainOcrBookPageEvent",4,"ngIf"],[3,"bookObj","obj","changeBookPageStatusEvent","callAgainOcrBookPageEvent",4,"ngIf"],[3,"obj",4,"ngIf"],[3,"obj","changeBookPageStatusEvent","callAgainOcrBookPageEvent"],[3,"bookObj","obj","changeBookPageStatusEvent","callAgainOcrBookPageEvent"],[3,"obj"]],template:function(e,n){if(1&e&&(t.j41(0,"teacher-layout",0),t.DNE(1,A,1,1,"azt-loading-effect",1),t.DNE(2,je,19,17,"ng-template",null,2,t.C5r),t.k0s()),2&e){const r=t.sdS(3);t.Y8G("headerBackToLink",n.backTo),t.R7$(1),t.Y8G("ngIf",1==n.statusObj.loading&&!n.bookObj)("ngIfElse",r)}},dependencies:[x.Sq,x.bT,At.K,ee.q,mt.Q,ye,ne,le,C.wp],encapsulation:2}),i})();class ${static validBookPage(i){const a=i;return a.controls.filter(n=>n.controls.isShow.value).length>0?(i.setErrors(null),null):(a.setErrors({validBookPage:!0}),{identityRevealed:!0})}}var lt=u(15766),ce=u(39712);let Et=(()=>{var o;class i extends R.H{cancel(){this.commonService.myNavigation(this.backTo)}handleUploadComplete(e){e.forEach(n=>{n.url&&this.form.controls.bookPageFormArray.controls.push(new b.gE({id:new b.MJ(0,{nonNullable:!0}),name:new b.MJ(n.name??"",{nonNullable:!0}),imageLink:new b.MJ(n.url,{nonNullable:!0}),isShow:new b.MJ(!0,{nonNullable:!0})}))}),this.form.controls.bookPageFormArray.updateValueAndValidity()}removeBookPageObj(e){let n=this.form.controls.bookPageFormArray.controls.find(r=>r.controls.id.value==e);n?.controls.isShow.setValue(!1),this.form.controls.bookPageFormArray.updateValueAndValidity()}constructor(){super(),this.allUploadToCdnMenuTypes=ce.b8,this.allUploadFileTypes=ce.PO,this.backTo="",this.form=new b.gE({name:new b.MJ("",{nonNullable:!0,validators:[lt.M.noWhiteSpace]}),bookPageFormArray:new b.Yp([],{validators:[$.validBookPage]})})}}return(o=i).\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.VBU({type:o,selectors:[["app-base-create-or-update-book"]],features:[t.Vt3],decls:0,vars:0,template:function(e,n){},encapsulation:2}),i})();var Vt=u(32884),ft=u(27879),pe=u(63349);function de(o,i){if(1&o&&t.nrm(0,"azt-loading-effect",3),2&o){const a=t.XpG();t.Y8G("currentStatusObj",a.statusObj)}}const ge=function(o,i){return[o,i]};function F(o,i){if(1&o){const a=t.RV6();t.j41(0,"div",13)(1,"div",14)(2,"azt-upload-multiple-box",24),t.bIt("uploadComplete",function(n){t.eBV(a);const r=t.XpG(2);return t.Njj(r.handleUploadComplete(n))}),t.j41(3,"div",25),t.nrm(4,"lucide-icon",26),t.EFF(5),t.nI1(6,"mytranslate"),t.k0s()()()()}if(2&o){const a=t.XpG(2);t.R7$(2),t.Y8G("uploadToCdnMenu",a.allUploadToCdnMenuTypes.BUSINESS_PLUGINS)("fileType",t.l_i(7,ge,a.allUploadFileTypes.IMAGE,a.allUploadFileTypes.PDF))("convertPdfToImages",!0)("showProgress",!0),t.R7$(3),t.SpI(" ",t.bMT(6,5,"lang_cms_admin_digitalized_upload_pdf_or_image_files")," ")}}function P(o,i){1&o&&(t.j41(0,"div"),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&o&&(t.R7$(1),t.SpI(" ",t.bMT(2,1,"lang_cms_admin_digitalized_upload_image_to_create_book")," "))}function ct(o,i){if(1&o){const a=t.RV6();t.qex(0),t.j41(1,"div",28)(2,"azt-preview-image-tag",29),t.nrm(3,"img",30),t.k0s(),t.j41(4,"div",7)(5,"span",31),t.EFF(6),t.k0s(),t.j41(7,"span",32),t.bIt("click",function(){const r=t.eBV(a).$implicit,s=t.XpG(3);return t.Njj(s.removeBookPageObj(r.controls.id.value))}),t.EFF(8),t.nI1(9,"mytranslate"),t.k0s()()(),t.bVm()}if(2&o){const a=i.$implicit,e=i.index;t.R7$(1),t.Y8G("hidden",!a.controls.isShow.value),t.R7$(1),t.Y8G("imageUrl",a.controls.imageLink.value),t.R7$(1),t.Y8G("src",a.controls.imageLink.value,t.B4B),t.R7$(3),t.JRh(e+1),t.R7$(2),t.JRh(t.bMT(9,5,"lang_auto_xoa"))}}function he(o,i){if(1&o&&t.DNE(0,ct,10,7,"ng-container",27),2&o){const a=t.XpG(2);t.Y8G("ngForOf",a.form.controls.bookPageFormArray.controls)}}const Ht=function(o){return{"error-border":o}};function Se(o,i){if(1&o){const a=t.RV6();t.j41(0,"div",4)(1,"form",5)(2,"div",6)(3,"div",7)(4,"h3",8),t.EFF(5),t.nI1(6,"mytranslate"),t.k0s(),t.j41(7,"div",9)(8,"button",10),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.cancel())}),t.EFF(9),t.nI1(10,"mytranslate"),t.k0s(),t.j41(11,"button",11),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.saveObj())}),t.EFF(12),t.nI1(13,"mytranslate"),t.k0s()()(),t.j41(14,"div",12)(15,"div",13)(16,"div",14)(17,"label",15),t.EFF(18),t.nI1(19,"mytranslate"),t.k0s()(),t.j41(20,"div",14)(21,"div",16),t.nrm(22,"input",17),t.k0s()()(),t.DNE(23,F,7,10,"div",18),t.nrm(24,"hr",19),t.j41(25,"div",20),t.DNE(26,P,3,3,"div",21),t.DNE(27,he,1,1,"ng-template",null,22,t.C5r),t.k0s()(),t.j41(29,"div",23)(30,"button",10),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.cancel())}),t.EFF(31),t.nI1(32,"mytranslate"),t.k0s(),t.j41(33,"button",11),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.saveObj())}),t.EFF(34),t.nI1(35,"mytranslate"),t.k0s()()()()()}if(2&o){const a=t.sdS(28),e=t.XpG();t.R7$(1),t.Y8G("formGroup",e.form),t.R7$(4),t.SpI(" ",t.bMT(6,14,e.bookId?"lang_cms_admin_edit_book_title":"lang_cms_admin_create_book_title")," "),t.R7$(4),t.JRh(t.bMT(10,16,"lang_auto_huy")),t.R7$(2),t.Y8G("disabled",e.form.invalid),t.R7$(1),t.JRh(t.bMT(13,18,"lang_auto_luu")),t.R7$(6),t.SpI(" ",t.bMT(19,20,"lang_cms_admin_create_book_name")," "),t.R7$(4),t.Y8G("formControl",e.form.controls.name)("ngClass",t.eq3(26,Ht,e.form.controls.name.invalid)),t.R7$(1),t.Y8G("ngIf",!e.bookId),t.R7$(3),t.Y8G("ngIf",e.form.controls.bookPageFormArray.controls.length<=0)("ngIfElse",a),t.R7$(5),t.JRh(t.bMT(32,22,"lang_auto_huy")),t.R7$(2),t.Y8G("disabled",e.form.invalid),t.R7$(1),t.JRh(t.bMT(35,24,"lang_auto_luu"))}}let me=(()=>{var o;class i extends Et{initForm(){}initData(){}saveObj(){this.initStatusObj();let e=this.form.getRawValue();this.waitDestroy(this.digitalizedBookService.apiDigitalizedBookAddObjPost({name:e.name}).subscribe(r=>{if(!r.success||!r.data?.obj)return this.errorStatusObj(r.message,!0);let s={bookId:r.data.obj.id,bookPageObjs:[]};e.bookPageFormArray.forEach(l=>{s.bookPageObjs.push({name:l.name,imageLink:l.imageLink})}),this.waitDestroy(this.digitalizedBookPageService.apiDigitalizedBookPageAddObjsPost(s).subscribe(l=>{if(!l.success)return this.errorStatusObj(l.message,!0);this.successStatusObj("lang_cms_add_success",!0),this.cancel()}))}))}ngOnInit(){super.ngOnInit(),this.commonService.translateMetaData({title:"lang_cms_admin_create_book_title",description:"lang_cms_admin_create_book_title",image:"lang_cms_test_image"}),this.backTo="/azota-digitalized/list-books",this.initData()}constructor(e,n){super(),this.digitalizedBookService=e,this.digitalizedBookPageService=n,this.bookId=0}}return(o=i).\u0275fac=function(e){return new(e||o)(t.rXU(Vt.Z),t.rXU(ft.g))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-digitalized-create-book"]],features:[t.Vt3],decls:4,vars:3,consts:[[3,"headerBackToLink"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],["doneLoading",""],[3,"currentStatusObj"],[1,"mt-5"],[3,"formGroup"],[1,"azt-config-document"],[1,"flex","items-center"],[1,"text-md","uppercase","font-medium","w-full"],[1,"flex-none","items-center"],[1,"btn","w-24","btn-secondary","mr-3",3,"click"],[1,"btn","btn-primary-soft","w-24",3,"disabled","click"],[1,"box","mt-4","p-5"],[1,"grid","grid-cols-12","mb-3"],[1,"col-span-12","lg:col-span-12"],[1,"form-label","mb-0","font-medium","flex","items-center"],[1,"setting-input"],["type","text",1,"form-control",3,"formControl","ngClass"],["class","grid grid-cols-12 mb-3",4,"ngIf"],[1,"mb-3"],[1,"mt-3","mb-3"],[4,"ngIf","ngIfElse"],["viewBookPageTpl",""],[1,"text-right","mt-5"],[3,"uploadToCdnMenu","fileType","convertPdfToImages","showProgress","uploadComplete"],[1,"h-full","w-full","cursor-pointer","text-primary"],["name","cloud-upload","size","24"],[4,"ngFor","ngForOf"],[1,"ml-3","mr-3","mb-3","p-3","bg-slate-100","box","inline-block",3,"hidden"],[1,"clickable",3,"imageUrl"],[1,"clickable",2,"width","250px","height","120px",3,"src"],[1,"w-full","text-pending","font-medium"],[1,"flex-none","text-danger","clickable",3,"click"]],template:function(e,n){if(1&e&&(t.j41(0,"teacher-layout",0),t.DNE(1,de,1,1,"azt-loading-effect",1),t.DNE(2,Se,36,28,"ng-template",null,2,t.C5r),t.k0s()),2&e){const r=t.sdS(3);t.Y8G("headerBackToLink",n.backTo),t.R7$(1),t.Y8G("ngIf",1==n.statusObj.loading)("ngIfElse",r)}},dependencies:[x.YU,x.Sq,x.bT,b.qT,b.me,b.BC,b.cb,b.l_,b.j4,At.K,pe.V,ut,mt.Q,j.WGl,C.wp],encapsulation:2}),i})();function ue(o,i){if(1&o&&t.nrm(0,"azt-loading-effect",3),2&o){const a=t.XpG();t.Y8G("currentStatusObj",a.statusObj)}}const _t=function(o,i){return[o,i]};function Me(o,i){if(1&o){const a=t.RV6();t.j41(0,"div",13)(1,"div",14)(2,"azt-upload-multiple-box",24),t.bIt("uploadComplete",function(n){t.eBV(a);const r=t.XpG(2);return t.Njj(r.handleUploadComplete(n))}),t.j41(3,"div",25),t.nrm(4,"lucide-icon",26),t.EFF(5),t.nI1(6,"mytranslate"),t.k0s()()()()}if(2&o){const a=t.XpG(2);t.R7$(2),t.Y8G("uploadToCdnMenu",a.allUploadToCdnMenuTypes.BUSINESS_PLUGINS)("fileType",t.l_i(7,_t,a.allUploadFileTypes.IMAGE,a.allUploadFileTypes.PDF))("convertPdfToImages",!0)("showProgress",!0),t.R7$(3),t.SpI(" ",t.bMT(6,5,"lang_cms_admin_digitalized_upload_pdf_or_image_files")," ")}}function Tt(o,i){1&o&&(t.j41(0,"div"),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&o&&(t.R7$(1),t.SpI(" ",t.bMT(2,1,"lang_cms_admin_digitalized_upload_image_to_create_book")," "))}function Re(o,i){if(1&o){const a=t.RV6();t.qex(0),t.j41(1,"div",28)(2,"azt-preview-image-tag",29),t.nrm(3,"img",30),t.k0s(),t.j41(4,"div",7)(5,"span",31),t.EFF(6),t.k0s(),t.j41(7,"span",32),t.bIt("click",function(){const r=t.eBV(a).$implicit,s=t.XpG(3);return t.Njj(s.removeBookPageObj(r.controls.id.value))}),t.EFF(8),t.nI1(9,"mytranslate"),t.k0s()()(),t.bVm()}if(2&o){const a=i.$implicit,e=i.index;t.R7$(1),t.Y8G("hidden",!a.controls.isShow.value),t.R7$(1),t.Y8G("imageUrl",a.controls.imageLink.value),t.R7$(1),t.Y8G("src",a.controls.imageLink.value,t.B4B),t.R7$(3),t.JRh(e+1),t.R7$(2),t.JRh(t.bMT(9,5,"lang_auto_xoa"))}}function K(o,i){if(1&o&&t.DNE(0,Re,10,7,"ng-container",27),2&o){const a=t.XpG(2);t.Y8G("ngForOf",a.form.controls.bookPageFormArray.controls)}}const Pe=function(o){return{"error-border":o}};function Ne(o,i){if(1&o){const a=t.RV6();t.j41(0,"div",4)(1,"form",5)(2,"div",6)(3,"div",7)(4,"h3",8),t.EFF(5),t.nI1(6,"mytranslate"),t.k0s(),t.j41(7,"div",9)(8,"button",10),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.cancel())}),t.EFF(9),t.nI1(10,"mytranslate"),t.k0s(),t.j41(11,"button",11),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.saveObj())}),t.EFF(12),t.nI1(13,"mytranslate"),t.k0s()()(),t.j41(14,"div",12)(15,"div",13)(16,"div",14)(17,"label",15),t.EFF(18),t.nI1(19,"mytranslate"),t.k0s()(),t.j41(20,"div",14)(21,"div",16),t.nrm(22,"input",17),t.k0s()()(),t.DNE(23,Me,7,10,"div",18),t.nrm(24,"hr",19),t.j41(25,"div",20),t.DNE(26,Tt,3,3,"div",21),t.DNE(27,K,1,1,"ng-template",null,22,t.C5r),t.k0s()(),t.j41(29,"div",23)(30,"button",10),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.cancel())}),t.EFF(31),t.nI1(32,"mytranslate"),t.k0s(),t.j41(33,"button",11),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.saveObj())}),t.EFF(34),t.nI1(35,"mytranslate"),t.k0s()()()()()}if(2&o){const a=t.sdS(28),e=t.XpG();t.R7$(1),t.Y8G("formGroup",e.form),t.R7$(4),t.SpI(" ",t.bMT(6,14,e.bookId?"lang_cms_admin_edit_book_title":"lang_cms_admin_create_book_title")," "),t.R7$(4),t.JRh(t.bMT(10,16,"lang_auto_huy")),t.R7$(2),t.Y8G("disabled",e.form.invalid),t.R7$(1),t.JRh(t.bMT(13,18,"lang_auto_luu")),t.R7$(6),t.SpI(" ",t.bMT(19,20,"lang_cms_admin_create_book_name")," "),t.R7$(4),t.Y8G("formControl",e.form.controls.name)("ngClass",t.eq3(26,Pe,e.form.controls.name.invalid)),t.R7$(1),t.Y8G("ngIf",!e.bookId),t.R7$(3),t.Y8G("ngIf",e.form.controls.bookPageFormArray.controls.length<=0)("ngIfElse",a),t.R7$(5),t.JRh(t.bMT(32,22,"lang_auto_huy")),t.R7$(2),t.Y8G("disabled",e.form.invalid),t.R7$(1),t.JRh(t.bMT(35,24,"lang_auto_luu"))}}let fe=(()=>{var o;class i extends Et{initForm(e){this.form.controls.name.setValue(e.bookObj.name),e.bookPageObjs.forEach(n=>{this.form.controls.bookPageFormArray.controls.push(new b.gE({id:new b.MJ(n.id,{nonNullable:!0}),name:new b.MJ(n.name,{nonNullable:!0}),imageLink:new b.MJ(n.imageLink,{nonNullable:!0}),isShow:new b.MJ(!0,{nonNullable:!0})}))})}initData(){this.initStatusObj(),this.waitDestroy(this.digitalizedBookService.apiDigitalizedBookGetObjGet(this.bookId).subscribe(e=>{if(!e.success||!e.data)return this.errorStatusObj(e.message,!0);this.initForm(e.data),this.stopStatusObj()}))}saveObj(){this.initStatusObj();let e=this.form.getRawValue();this.waitDestroy(this.digitalizedBookService.apiDigitalizedBookUpdateObjPost({id:this.bookId,name:e.name}).subscribe(r=>{if(!r.success)return this.errorStatusObj(r.message,!0);let s={bookId:this.bookId,ids:e.bookPageFormArray.filter(l=>!l.isShow&&l.id).map(l=>l.id)};if(s.ids.length<=0)return this.successStatusObj("lang_cms_update_success",!0),void this.cancel();this.waitDestroy(this.digitalizedBookPageService.apiDigitalizedBookPageDeleteObjPost(s).subscribe(l=>{if(!l.success)return this.errorStatusObj(l.message,!0);this.successStatusObj("lang_cms_update_success",!0),this.cancel()}))}))}ngOnInit(){super.ngOnInit(),this.commonService.translateMetaData({title:"lang_cms_admin_edit_book_title",description:"lang_cms_admin_edit_book_title",image:"lang_cms_test_image"}),this.bookId=Number(this.commonService.getMyParam(this.activeRoute,"bookId")??0),this.backTo="/azota-digitalized/list-books",this.initData()}constructor(e,n,r){super(),this.digitalizedBookService=e,this.digitalizedBookPageService=n,this.activeRoute=r,this.bookId=0}}return(o=i).\u0275fac=function(e){return new(e||o)(t.rXU(Y.ZD),t.rXU(Y.gI),t.rXU(_.nX))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-digitalized-update-book"]],features:[t.Vt3],decls:4,vars:3,consts:[[3,"headerBackToLink"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],["doneLoading",""],[3,"currentStatusObj"],[1,"mt-5"],[3,"formGroup"],[1,"azt-config-document"],[1,"flex","items-center"],[1,"text-md","uppercase","font-medium","w-full"],[1,"flex-none","items-center"],[1,"btn","w-24","btn-secondary","mr-3",3,"click"],[1,"btn","btn-primary-soft","w-24",3,"disabled","click"],[1,"box","mt-4","p-5"],[1,"grid","grid-cols-12","mb-3"],[1,"col-span-12","lg:col-span-12"],[1,"form-label","mb-0","font-medium","flex","items-center"],[1,"setting-input"],["type","text",1,"form-control",3,"formControl","ngClass"],["class","grid grid-cols-12 mb-3",4,"ngIf"],[1,"mb-3"],[1,"mt-3","mb-3"],[4,"ngIf","ngIfElse"],["viewBookPageTpl",""],[1,"text-right","mt-5"],[3,"uploadToCdnMenu","fileType","convertPdfToImages","showProgress","uploadComplete"],[1,"h-full","w-full","cursor-pointer","text-primary"],["name","cloud-upload","size","24"],[4,"ngFor","ngForOf"],[1,"ml-3","mr-3","mb-3","p-3","bg-slate-100","box","inline-block",3,"hidden"],[1,"clickable",3,"imageUrl"],[1,"clickable",2,"width","250px","height","120px",3,"src"],[1,"w-full","text-pending","font-medium"],[1,"flex-none","text-danger","clickable",3,"click"]],template:function(e,n){if(1&e&&(t.j41(0,"teacher-layout",0),t.DNE(1,ue,1,1,"azt-loading-effect",1),t.DNE(2,Ne,36,28,"ng-template",null,2,t.C5r),t.k0s()),2&e){const r=t.sdS(3);t.Y8G("headerBackToLink",n.backTo),t.R7$(1),t.Y8G("ngIf",1==n.statusObj.loading)("ngIfElse",r)}},dependencies:[x.YU,x.Sq,x.bT,b.qT,b.me,b.BC,b.cb,b.l_,b.j4,At.K,pe.V,ut,mt.Q,j.WGl,C.wp],encapsulation:2}),i})();var Fe=u(75421),_e=u(25329);function Ge(o,i){if(1&o&&t.nrm(0,"azt-loading-effect",4),2&o){const a=t.XpG();t.Y8G("currentStatusObj",a.statusObj)}}function $e(o,i){1&o&&(t.j41(0,"span",25),t.nrm(1,"azt-loading-ui"),t.k0s())}const Wt=function(){return{"mr-1":!0}};function Le(o,i){if(1&o){const a=t.RV6();t.qex(0),t.j41(1,"mat-card",13)(2,"mat-card-content",14)(3,"div",15)(4,"div",6)(5,"b"),t.EFF(6),t.k0s(),t.EFF(7),t.k0s(),t.j41(8,"div",16)(9,"button",17),t.nI1(10,"navigationLocalize"),t.nrm(11,"lucide-icon",18),t.j41(12,"span",19),t.EFF(13),t.nI1(14,"mytranslate"),t.k0s()(),t.j41(15,"a",20),t.nI1(16,"navigationLocalize"),t.nrm(17,"lucide-icon",21),t.EFF(18),t.nI1(19,"mytranslate"),t.k0s(),t.j41(20,"button",22),t.bIt("click",function(){const r=t.eBV(a).$implicit,s=t.XpG(3);return t.Njj(s.deleteObj(r))}),t.DNE(21,$e,2,0,"span",23),t.nrm(22,"lucide-icon",24),t.j41(23,"span",19),t.EFF(24),t.nI1(25,"mytranslate"),t.k0s()()()()()(),t.bVm()}if(2&o){const a=i.$implicit,e=i.index,n=t.XpG(3);t.R7$(6),t.SpI("",e+1,"."),t.R7$(1),t.E5c(" ",a.name," (",a.totalDone," / ",a.totalPage,") "),t.R7$(2),t.Y8G("routerLink",t.bMT(10,13,"/azota-digitalized/digitalized-one-book/"+a.id+"/1")),t.R7$(2),t.Y8G("ngClass",t.lJ4(23,Wt)),t.R7$(2),t.JRh(t.bMT(14,15,"lang_cms_admin_digitalized_digitalized_btn")),t.R7$(2),t.Y8G("routerLink",t.bMT(16,17,"/azota-digitalized/edit-book/"+a.id)),t.R7$(2),t.Y8G("ngClass",t.lJ4(24,Wt)),t.R7$(1),t.SpI(" ",t.bMT(19,19,"lang_auto_sua")," "),t.R7$(3),t.Y8G("ngIf",n.deletingId==a.id),t.R7$(1),t.Y8G("ngClass",t.lJ4(25,Wt)),t.R7$(2),t.JRh(t.bMT(25,21,"lang_auto_xoa"))}}function Ue(o,i){if(1&o&&(t.qex(0),t.j41(1,"div",10)(2,"div",11),t.DNE(3,Le,26,26,"ng-container",12),t.k0s()(),t.bVm()),2&o){const a=t.XpG(2);t.R7$(3),t.Y8G("ngForOf",a.objs)}}function Xe(o,i){1&o&&(t.j41(0,"div",26),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&o&&(t.R7$(1),t.JRh(t.bMT(2,1,"lang_cms_admin_digitalized_there_is_no_book")))}const Ye=function(o){return[o]};function Ve(o,i){if(1&o&&(t.j41(0,"div",5)(1,"span",6),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s(),t.j41(4,"a",7),t.nI1(5,"navigationLocalize"),t.EFF(6),t.nI1(7,"mytranslate"),t.k0s()(),t.DNE(8,Ue,4,1,"ng-container",8),t.DNE(9,Xe,3,3,"ng-template",null,9,t.C5r)),2&o){const a=t.sdS(10),e=t.XpG();t.R7$(2),t.JRh(t.bMT(3,5,"lang_cms_admin_common_digitalize_list_book")),t.R7$(2),t.Y8G("routerLink",t.eq3(11,Ye,t.bMT(5,7,"/azota-digitalized/create-book"))),t.R7$(2),t.JRh(t.bMT(7,9,"lang_common_create")),t.R7$(2),t.Y8G("ngIf",e.objs.length>0)("ngIfElse",a)}}const He=[{path:"",children:[{path:"list-books",component:(()=>{var o;class i extends R.H{deleteObj(e){const n=this.commonService.myTranslateInstant("lang_cms_admin_digitalized_are_your_sure_to_delete_this_book")+`: <b>${e.name}<b/>?`;this.sAztDialogService.open(Fe.u,{data:{content:n},restoreFocus:!1,width:"500px"}).afterClosed().subscribe(r=>{r&&(this.deletingId=e.id,this.waitDestroy(this.digitalizedBookService.apiDigitalizedBookDeleteObjPost({ids:[e.id]}).subscribe(s=>{if(this.deletingId=void 0,!s.success)return this.errorStatusObj(s.message,!0);this.objs=this.objs.filter(l=>l.id!=e.id)})))})}getData(){this.initStatusObj(),this.waitDestroy(this.digitalizedBookService.apiDigitalizedBookGetObjsGet().subscribe(e=>{if(!e.success)return this.errorStatusObj(e.message,!0);this.objs=e.data?.objs??[],this.stopStatusObj()}))}ngOnInit(){super.ngOnInit(),this.getData(),this.commonService.translateMetaData({title:"lang_cms_admin_common_digitalize_list_book",description:"lang_cms_admin_common_digitalize_list_book",image:"lang_cms_test_image"}),this.headerBackTo=this.commonService.getMyQueryParam("backTo")??"/super-role/admin-tool"}constructor(e,n){super(),this.digitalizedBookService=e,this.sAztDialogService=n,this.headerBackTo="",this.objs=[]}}return(o=i).\u0275fac=function(e){return new(e||o)(t.rXU(Y.ZD),t.rXU(It.i))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-digitalized-list-books"]],features:[t.Vt3],decls:5,vars:3,consts:[[3,"headerBackToLink"],[1,"container-fluid","component-wrap","centerBoth","hasBg","mt-3"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],["doneLoading",""],[3,"currentStatusObj"],[1,"flex","items-center","mb-3"],[1,"w-full"],[1,"flex-none","btn","btn-primary",3,"routerLink"],[4,"ngIf","ngIfElse"],["emptyList",""],[1,"card"],[1,"card-body"],[4,"ngFor","ngForOf"],["appearance","outlined",1,"mb-2",2,"background-color","#fff","border","none"],[1,"form-control",2,"overflow-y","auto"],[1,"flex","align-items-center"],[1,"flex-none","items-center"],[1,"btn","btn-sm","btn-success-soft","mr-2",3,"routerLink"],["name","eye","size","18",3,"ngClass"],[1,"azt-hidden","md:inline-block"],[1,"btn","btn-sm","btn-primary-soft","mr-2",3,"routerLink"],["name","square-pen","size","18",3,"ngClass"],[1,"btn","btn-sm","btn-danger-soft",3,"click"],["class","w-4 h-4 flex mr-1",4,"ngIf"],["name","trash-2","size","18",3,"ngClass"],[1,"w-4","h-4","flex","mr-1"],[1,"text-center"]],template:function(e,n){if(1&e&&(t.j41(0,"teacher-layout",0)(1,"div",1),t.DNE(2,Ge,1,1,"azt-loading-effect",2),t.DNE(3,Ve,11,13,"ng-template",null,3,t.C5r),t.k0s()()),2&e){const r=t.sdS(4);t.Y8G("headerBackToLink",n.headerBackTo),t.R7$(2),t.Y8G("ngIf",n.statusObj.loading)("ngIfElse",r)}},dependencies:[_.Wk,x.YU,x.Sq,x.bT,_e.RN,_e.m2,At.K,Ut.R,mt.Q,j.WGl,C.F2,C.wp],encapsulation:2}),i})()},{path:"create-book",component:me},{path:"edit-book/:bookId",component:fe},{path:"digitalized-one-book/:bookId/:page",component:I}]}];let We=(()=>{var o;class i{}return(o=i).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[_.iI.forChild(He),_.iI,q.XE]}),i})(),ve=(()=>{var o;class i{}return(o=i).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({providers:[{provide:nt.vn,useValue:Kt.c.azt_tiny_mce_script_src}],imports:[_.iI,x.MD,b.YN,nt.sv,w.s,b.X1,We,Qt.Q,Rt.L,Mt.Id,Jt.b,j.flO.pick(j.Ptg),St.AC,Dt]}),i})()},17715:function(ze){ze.exports=function(){"use strict";function H(o){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}function x(o,i){for(var a=0;a<i.length;a++){var e=i[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(o,e.key,e)}}function _(o,i,a){return i in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,o}function nt(o,i){var a=Object.keys(o);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(o);i&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(o,n).enumerable})),a.push.apply(a,e)}return a}function t(o){for(var i=1;i<arguments.length;i++){var a=null!=arguments[i]?arguments[i]:{};i%2?nt(Object(a),!0).forEach(function(e){_(o,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(a)):nt(Object(a)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(a,e))})}return o}function W(o){return function Ct(o){if(Array.isArray(o))return X(o)}(o)||function kt(o){if(typeof Symbol<"u"&&Symbol.iterator in Object(o))return Array.from(o)}(o)||function U(o,i){if(o){if("string"==typeof o)return X(o,i);var a=Object.prototype.toString.call(o).slice(8,-1);if("Object"===a&&o.constructor&&(a=o.constructor.name),"Map"===a||"Set"===a)return Array.from(o);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return X(o,i)}}(o)||function jt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(o,i){(null==i||i>o.length)&&(i=o.length);for(var a=0,e=new Array(i);a<i;a++)e[a]=o[a];return e}var Dt=typeof window<"u"&&typeof window.document<"u",j=Dt?window:{},St=!(!Dt||!j.document.documentElement)&&"ontouchstart"in j.document.documentElement,Mt=!!Dt&&"PointerEvent"in j,w="cropper",q="e",R="s",J="n",Y="ne",dt="nw",V="se",gt="sw",Pt="".concat(w,"-crop"),Nt="".concat(w,"-disabled"),C="".concat(w,"-hidden"),ht="".concat(w,"-hide"),Ce="".concat(w,"-invisible"),xt="".concat(w,"-modal"),Ft="".concat(w,"-move"),et="".concat(w,"Action"),wt="".concat(w,"Preview"),Gt="crop",yt="crop",$t="cropend",Ot="cropmove",Lt="cropstart",te="dblclick",ee=Mt?"pointerdown":St?"touchstart":"mousedown",mt=Mt?"pointermove":St?"touchmove":"mousemove",It=Mt?"pointerup pointercancel":St?"touchend touchcancel":"mouseup",Bt="zoom",oe="image/jpeg",xe=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,we=/^data:/,ye=/^data:image\/jpeg;base64,/,Ut=/^img|canvas$/i,re={viewMode:0,dragMode:Gt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Ae=Number.isNaN||j.isNaN;function f(o){return"number"==typeof o&&!Ae(o)}var se=function(i){return i>0&&i<1/0};function Yt(o){return typeof o>"u"}function it(o){return"object"===H(o)&&null!==o}var Ie=Object.prototype.hasOwnProperty;function rt(o){if(!it(o))return!1;try{var i=o.constructor,a=i.prototype;return i&&a&&Ie.call(a,"isPrototypeOf")}catch{return!1}}function M(o){return"function"==typeof o}var Be=Array.prototype.slice;function le(o){return Array.from?Array.from(o):Be.call(o)}function A(o,i){return o&&M(i)&&(Array.isArray(o)||f(o.length)?le(o).forEach(function(a,e){i.call(o,a,e,o)}):it(o)&&Object.keys(o).forEach(function(a){i.call(o,o[a],a,o)})),o}var y=Object.assign||function(i){for(var a=arguments.length,e=new Array(a>1?a-1:0),n=1;n<a;n++)e[n-1]=arguments[n];return it(i)&&e.length>0&&e.forEach(function(r){it(r)&&Object.keys(r).forEach(function(s){i[s]=r[s]})}),i},Ee=/\.\d*(?:0|9){12}\d*$/;function st(o){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return Ee.test(o)?Math.round(o*i)/i:o}var Te=/^width|height|left|top|marginLeft|marginTop$/;function Q(o,i){var a=o.style;A(i,function(e,n){Te.test(n)&&f(e)&&(e="".concat(e,"px")),a[n]=e})}function I(o,i){if(i){if(f(o.length))return void A(o,function(e){I(e,i)});if(o.classList)return void o.classList.add(i);var a=o.className.trim();a?a.indexOf(i)<0&&(o.className="".concat(a," ").concat(i)):o.className=i}}function $(o,i){if(i){if(f(o.length))return void A(o,function(a){$(a,i)});if(o.classList)return void o.classList.remove(i);o.className.indexOf(i)>=0&&(o.className=o.className.replace(i,""))}}function lt(o,i,a){if(i){if(f(o.length))return void A(o,function(e){lt(e,i,a)});a?I(o,i):$(o,i)}}var ce=/([a-z\d])([A-Z])/g;function Et(o){return o.replace(ce,"$1-$2").toLowerCase()}function Vt(o,i){return it(o[i])?o[i]:o.dataset?o.dataset[i]:o.getAttribute("data-".concat(Et(i)))}function ft(o,i,a){it(a)?o[i]=a:o.dataset?o.dataset[i]=a:o.setAttribute("data-".concat(Et(i)),a)}var de=/\s\s*/,ge=function(){var o=!1;if(Dt){var i=!1,a=function(){},e=Object.defineProperty({},"once",{get:function(){return o=!0,i},set:function(r){i=r}});j.addEventListener("test",a,e),j.removeEventListener("test",a,e)}return o}();function F(o,i,a){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=a;i.trim().split(de).forEach(function(r){if(!ge){var s=o.listeners;s&&s[r]&&s[r][a]&&(n=s[r][a],delete s[r][a],0===Object.keys(s[r]).length&&delete s[r],0===Object.keys(s).length&&delete o.listeners)}o.removeEventListener(r,n,e)})}function P(o,i,a){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=a;i.trim().split(de).forEach(function(r){if(e.once&&!ge){var s=o.listeners,l=void 0===s?{}:s;n=function(){delete l[r][a],o.removeEventListener(r,n,e);for(var g=arguments.length,p=new Array(g),c=0;c<g;c++)p[c]=arguments[c];a.apply(o,p)},l[r]||(l[r]={}),l[r][a]&&o.removeEventListener(r,l[r][a],e),l[r][a]=n,o.listeners=l}o.addEventListener(r,n,e)})}function ct(o,i,a){var e;return M(Event)&&M(CustomEvent)?e=new CustomEvent(i,{detail:a,bubbles:!0,cancelable:!0}):(e=document.createEvent("CustomEvent")).initCustomEvent(i,!0,!0,a),o.dispatchEvent(e)}function he(o){var i=o.getBoundingClientRect();return{left:i.left+(window.pageXOffset-document.documentElement.clientLeft),top:i.top+(window.pageYOffset-document.documentElement.clientTop)}}var Ht=j.location,Se=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function me(o){var i=o.match(Se);return null!==i&&(i[1]!==Ht.protocol||i[2]!==Ht.hostname||i[3]!==Ht.port)}function ue(o){var i="timestamp=".concat((new Date).getTime());return o+(-1===o.indexOf("?")?"?":"&")+i}function _t(o){var i=o.rotate,a=o.scaleX,e=o.scaleY,n=o.translateX,r=o.translateY,s=[];f(n)&&0!==n&&s.push("translateX(".concat(n,"px)")),f(r)&&0!==r&&s.push("translateY(".concat(r,"px)")),f(i)&&0!==i&&s.push("rotate(".concat(i,"deg)")),f(a)&&1!==a&&s.push("scaleX(".concat(a,")")),f(e)&&1!==e&&s.push("scaleY(".concat(e,")"));var l=s.length?s.join(" "):"none";return{WebkitTransform:l,msTransform:l,transform:l}}function Tt(o,i){var a=o.pageX,e=o.pageY,n={endX:a,endY:e};return i?n:t({startX:a,startY:e},n)}function K(o){var i=o.aspectRatio,a=o.height,e=o.width,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",r=se(e),s=se(a);if(r&&s){var l=a*i;"contain"===n&&l>e||"cover"===n&&l<e?a=e/i:e=a*i}else r?a=e/i:s&&(e=a*i);return{width:e,height:a}}var fe=String.fromCharCode;var _e=/^data:.*,/;function Wt(o){var a,i=new DataView(o);try{var e,n,r;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var s=i.byteLength,l=2;l+1<s;){if(255===i.getUint8(l)&&225===i.getUint8(l+1)){n=l;break}l+=1}if(n){var g=n+10;if("Exif"===function Fe(o,i,a){var e="";a+=i;for(var n=i;n<a;n+=1)e+=fe(o.getUint8(n));return e}(i,n+4,4)){var p=i.getUint16(g);if(((e=18761===p)||19789===p)&&42===i.getUint16(g+2,e)){var c=i.getUint32(g+4,e);c>=8&&(r=g+c)}}}if(r){var z,v,h=i.getUint16(r,e);for(v=0;v<h;v+=1)if(274===i.getUint16(z=r+12*v+2,e)){a=i.getUint16(z+=8,e),i.setUint16(z,1,e);break}}}catch{a=1}return a}var Ue={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var i=this.element,a=this.options,e=this.container,n=this.cropper,r=Number(a.minContainerWidth),s=Number(a.minContainerHeight);I(n,C),$(i,C);var l={width:Math.max(e.offsetWidth,r>=0?r:200),height:Math.max(e.offsetHeight,s>=0?s:100)};this.containerData=l,Q(n,{width:l.width,height:l.height}),I(i,C),$(n,C)},initCanvas:function(){var i=this.containerData,a=this.imageData,e=this.options.viewMode,n=Math.abs(a.rotate)%180==90,r=n?a.naturalHeight:a.naturalWidth,s=n?a.naturalWidth:a.naturalHeight,l=r/s,d=i.width,g=i.height;i.height*l>i.width?3===e?d=i.height*l:g=i.width/l:3===e?g=i.width/l:d=i.height*l;var p={aspectRatio:l,naturalWidth:r,naturalHeight:s,width:d,height:g};this.canvasData=p,this.limited=1===e||2===e,this.limitCanvas(!0,!0),p.width=Math.min(Math.max(p.width,p.minWidth),p.maxWidth),p.height=Math.min(Math.max(p.height,p.minHeight),p.maxHeight),p.left=(i.width-p.width)/2,p.top=(i.height-p.height)/2,p.oldLeft=p.left,p.oldTop=p.top,this.initialCanvasData=y({},p)},limitCanvas:function(i,a){var e=this.options,n=this.containerData,r=this.canvasData,s=this.cropBoxData,l=e.viewMode,d=r.aspectRatio,g=this.cropped&&s;if(i){var p=Number(e.minCanvasWidth)||0,c=Number(e.minCanvasHeight)||0;l>1?(p=Math.max(p,n.width),c=Math.max(c,n.height),3===l&&(c*d>p?p=c*d:c=p/d)):l>0&&(p?p=Math.max(p,g?s.width:0):c?c=Math.max(c,g?s.height:0):g&&((c=s.height)*d>(p=s.width)?p=c*d:c=p/d));var h=K({aspectRatio:d,width:p,height:c});c=h.height,r.minWidth=p=h.width,r.minHeight=c,r.maxWidth=1/0,r.maxHeight=1/0}if(a)if(l>(g?0:1)){var z=n.width-r.width,v=n.height-r.height;r.minLeft=Math.min(0,z),r.minTop=Math.min(0,v),r.maxLeft=Math.max(0,z),r.maxTop=Math.max(0,v),g&&this.limited&&(r.minLeft=Math.min(s.left,s.left+(s.width-r.width)),r.minTop=Math.min(s.top,s.top+(s.height-r.height)),r.maxLeft=s.left,r.maxTop=s.top,2===l&&(r.width>=n.width&&(r.minLeft=Math.min(0,z),r.maxLeft=Math.max(0,z)),r.height>=n.height&&(r.minTop=Math.min(0,v),r.maxTop=Math.max(0,v))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=n.width,r.maxTop=n.height},renderCanvas:function(i,a){var e=this.canvasData,n=this.imageData;if(a){var r=function Pe(o){var i=o.width,a=o.height,e=o.degree;if(90==(e=Math.abs(e)%180))return{width:a,height:i};var n=e%90*Math.PI/180,r=Math.sin(n),s=Math.cos(n),l=i*s+a*r,d=i*r+a*s;return e>90?{width:d,height:l}:{width:l,height:d}}({width:n.naturalWidth*Math.abs(n.scaleX||1),height:n.naturalHeight*Math.abs(n.scaleY||1),degree:n.rotate||0}),s=r.width,l=r.height,d=e.width*(s/e.naturalWidth),g=e.height*(l/e.naturalHeight);e.left-=(d-e.width)/2,e.top-=(g-e.height)/2,e.width=d,e.height=g,e.aspectRatio=s/l,e.naturalWidth=s,e.naturalHeight=l,this.limitCanvas(!0,!1)}(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=Math.min(Math.max(e.width,e.minWidth),e.maxWidth),e.height=Math.min(Math.max(e.height,e.minHeight),e.maxHeight),this.limitCanvas(!1,!0),e.left=Math.min(Math.max(e.left,e.minLeft),e.maxLeft),e.top=Math.min(Math.max(e.top,e.minTop),e.maxTop),e.oldLeft=e.left,e.oldTop=e.top,Q(this.canvas,y({width:e.width,height:e.height},_t({translateX:e.left,translateY:e.top}))),this.renderImage(i),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(i){var a=this.canvasData,e=this.imageData,n=e.naturalWidth*(a.width/a.naturalWidth),r=e.naturalHeight*(a.height/a.naturalHeight);y(e,{width:n,height:r,left:(a.width-n)/2,top:(a.height-r)/2}),Q(this.image,y({width:e.width,height:e.height},_t(y({translateX:e.left,translateY:e.top},e)))),i&&this.output()},initCropBox:function(){var i=this.options,a=this.canvasData,e=i.aspectRatio||i.initialAspectRatio,n=Number(i.autoCropArea)||.8,r={width:a.width,height:a.height};e&&(a.height*e>a.width?r.height=r.width/e:r.width=r.height*e),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*n),r.height=Math.max(r.minHeight,r.height*n),r.left=a.left+(a.width-r.width)/2,r.top=a.top+(a.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=y({},r)},limitCropBox:function(i,a){var e=this.options,n=this.containerData,r=this.canvasData,s=this.cropBoxData,l=this.limited,d=e.aspectRatio;if(i){var g=Number(e.minCropBoxWidth)||0,p=Number(e.minCropBoxHeight)||0,c=l?Math.min(n.width,r.width,r.width+r.left,n.width-r.left):n.width,h=l?Math.min(n.height,r.height,r.height+r.top,n.height-r.top):n.height;g=Math.min(g,n.width),p=Math.min(p,n.height),d&&(g&&p?p*d>g?p=g/d:g=p*d:g?p=g/d:p&&(g=p*d),h*d>c?h=c/d:c=h*d),s.minWidth=Math.min(g,c),s.minHeight=Math.min(p,h),s.maxWidth=c,s.maxHeight=h}a&&(l?(s.minLeft=Math.max(0,r.left),s.minTop=Math.max(0,r.top),s.maxLeft=Math.min(n.width,r.left+r.width)-s.width,s.maxTop=Math.min(n.height,r.top+r.height)-s.height):(s.minLeft=0,s.minTop=0,s.maxLeft=n.width-s.width,s.maxTop=n.height-s.height))},renderCropBox:function(){var i=this.options,a=this.containerData,e=this.cropBoxData;(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=Math.min(Math.max(e.width,e.minWidth),e.maxWidth),e.height=Math.min(Math.max(e.height,e.minHeight),e.maxHeight),this.limitCropBox(!1,!0),e.left=Math.min(Math.max(e.left,e.minLeft),e.maxLeft),e.top=Math.min(Math.max(e.top,e.minTop),e.maxTop),e.oldLeft=e.left,e.oldTop=e.top,i.movable&&i.cropBoxMovable&&ft(this.face,et,e.width>=a.width&&e.height>=a.height?"move":"all"),Q(this.cropBox,y({width:e.width,height:e.height},_t({translateX:e.left,translateY:e.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),ct(this.element,yt,this.getData())}},Xe={initPreview:function(){var i=this.element,a=this.crossOrigin,e=this.options.preview,n=a?this.crossOriginUrl:this.url,r=i.alt||"The image to preview",s=document.createElement("img");if(a&&(s.crossOrigin=a),s.src=n,s.alt=r,this.viewBox.appendChild(s),this.viewBoxImage=s,e){var l=e;"string"==typeof e?l=i.ownerDocument.querySelectorAll(e):e.querySelector&&(l=[e]),this.previews=l,A(l,function(d){var g=document.createElement("img");ft(d,wt,{width:d.offsetWidth,height:d.offsetHeight,html:d.innerHTML}),a&&(g.crossOrigin=a),g.src=n,g.alt=r,g.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',d.innerHTML="",d.appendChild(g)})}},resetPreview:function(){A(this.previews,function(i){var a=Vt(i,wt);Q(i,{width:a.width,height:a.height}),i.innerHTML=a.html,function pe(o,i){if(it(o[i]))try{delete o[i]}catch{o[i]=void 0}else if(o.dataset)try{delete o.dataset[i]}catch{o.dataset[i]=void 0}else o.removeAttribute("data-".concat(Et(i)))}(i,wt)})},preview:function(){var i=this.imageData,a=this.canvasData,e=this.cropBoxData,n=e.width,r=e.height,s=i.width,l=i.height,d=e.left-a.left-i.left,g=e.top-a.top-i.top;!this.cropped||this.disabled||(Q(this.viewBoxImage,y({width:s,height:l},_t(y({translateX:-d,translateY:-g},i)))),A(this.previews,function(p){var c=Vt(p,wt),h=c.width,z=c.height,v=h,O=z,k=1;n&&(O=r*(k=h/n)),r&&O>z&&(v=n*(k=z/r),O=z),Q(p,{width:v,height:O}),Q(p.getElementsByTagName("img")[0],y({width:s*k,height:l*k},_t(y({translateX:-d*k,translateY:-g*k},i))))}))}},Ye={bind:function(){var i=this.element,a=this.options,e=this.cropper;M(a.cropstart)&&P(i,Lt,a.cropstart),M(a.cropmove)&&P(i,Ot,a.cropmove),M(a.cropend)&&P(i,$t,a.cropend),M(a.crop)&&P(i,yt,a.crop),M(a.zoom)&&P(i,Bt,a.zoom),P(e,ee,this.onCropStart=this.cropStart.bind(this)),a.zoomable&&a.zoomOnWheel&&P(e,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&P(e,te,this.onDblclick=this.dblclick.bind(this)),P(i.ownerDocument,mt,this.onCropMove=this.cropMove.bind(this)),P(i.ownerDocument,It,this.onCropEnd=this.cropEnd.bind(this)),a.responsive&&P(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var i=this.element,a=this.options,e=this.cropper;M(a.cropstart)&&F(i,Lt,a.cropstart),M(a.cropmove)&&F(i,Ot,a.cropmove),M(a.cropend)&&F(i,$t,a.cropend),M(a.crop)&&F(i,yt,a.crop),M(a.zoom)&&F(i,Bt,a.zoom),F(e,ee,this.onCropStart),a.zoomable&&a.zoomOnWheel&&F(e,"wheel",this.onWheel,{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&F(e,te,this.onDblclick),F(i.ownerDocument,mt,this.onCropMove),F(i.ownerDocument,It,this.onCropEnd),a.responsive&&F(window,"resize",this.onResize)}},Ve={resize:function(){if(!this.disabled){var r,s,i=this.options,a=this.container,e=this.containerData,n=a.offsetWidth/e.width;1===n&&a.offsetHeight===e.height||(i.restore&&(r=this.getCanvasData(),s=this.getCropBoxData()),this.render(),i.restore&&(this.setCanvasData(A(r,function(l,d){r[d]=l*n})),this.setCropBoxData(A(s,function(l,d){s[d]=l*n}))))}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(function je(o,i){return o.classList?o.classList.contains(i):o.className.indexOf(i)>-1}(this.dragBox,Pt)?"move":Gt)},wheel:function(i){var a=this,e=Number(this.options.wheelZoomRatio)||.1,n=1;this.disabled||(i.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){a.wheeling=!1},50),i.deltaY?n=i.deltaY>0?1:-1:i.wheelDelta?n=-i.wheelDelta/120:i.detail&&(n=i.detail>0?1:-1),this.zoom(-n*e,i)))},cropStart:function(i){var a=i.buttons,e=i.button;if(!(this.disabled||("mousedown"===i.type||"pointerdown"===i.type&&"mouse"===i.pointerType)&&(f(a)&&1!==a||f(e)&&0!==e||i.ctrlKey))){var s,n=this.options,r=this.pointers;i.changedTouches?A(i.changedTouches,function(l){r[l.identifier]=Tt(l)}):r[i.pointerId||0]=Tt(i),s=Object.keys(r).length>1&&n.zoomable&&n.zoomOnTouch?"zoom":Vt(i.target,et),xe.test(s)&&!1!==ct(this.element,Lt,{originalEvent:i,action:s})&&(i.preventDefault(),this.action=s,this.cropping=!1,"crop"===s&&(this.cropping=!0,I(this.dragBox,xt)))}},cropMove:function(i){var a=this.action;if(!this.disabled&&a){var e=this.pointers;i.preventDefault(),!1!==ct(this.element,Ot,{originalEvent:i,action:a})&&(i.changedTouches?A(i.changedTouches,function(n){y(e[n.identifier]||{},Tt(n,!0))}):y(e[i.pointerId||0]||{},Tt(i,!0)),this.change(i))}},cropEnd:function(i){if(!this.disabled){var a=this.action,e=this.pointers;i.changedTouches?A(i.changedTouches,function(n){delete e[n.identifier]}):delete e[i.pointerId||0],a&&(i.preventDefault(),Object.keys(e).length||(this.action=""),this.cropping&&(this.cropping=!1,lt(this.dragBox,xt,this.cropped&&this.options.modal)),ct(this.element,$t,{originalEvent:i,action:a}))}}},Ke={change:function(i){var at,e=this.canvasData,n=this.containerData,r=this.cropBoxData,s=this.pointers,l=this.action,d=this.options.aspectRatio,g=r.left,p=r.top,c=r.width,h=r.height,z=g+c,v=p+h,O=0,k=0,E=n.width,S=n.height,B=!0;!d&&i.shiftKey&&(d=c&&h?c/h:1),this.limited&&(k=r.minTop,E=(O=r.minLeft)+Math.min(n.width,e.width,e.left+e.width),S=k+Math.min(n.height,e.height,e.top+e.height));var G=s[Object.keys(s)[0]],m={x:G.endX-G.startX,y:G.endY-G.startY},D=function(L){switch(L){case q:z+m.x>E&&(m.x=E-z);break;case"w":g+m.x<O&&(m.x=O-g);break;case J:p+m.y<k&&(m.y=k-p);break;case R:v+m.y>S&&(m.y=S-v)}};switch(l){case"all":g+=m.x,p+=m.y;break;case q:if(m.x>=0&&(z>=E||d&&(p<=k||v>=S))){B=!1;break}D(q),(c+=m.x)<0&&(l="w",g-=c=-c),d&&(p+=(r.height-(h=c/d))/2);break;case J:if(m.y<=0&&(p<=k||d&&(g<=O||z>=E))){B=!1;break}D(J),p+=m.y,(h-=m.y)<0&&(l=R,p-=h=-h),d&&(g+=(r.width-(c=h*d))/2);break;case"w":if(m.x<=0&&(g<=O||d&&(p<=k||v>=S))){B=!1;break}D("w"),g+=m.x,(c-=m.x)<0&&(l=q,g-=c=-c),d&&(p+=(r.height-(h=c/d))/2);break;case R:if(m.y>=0&&(v>=S||d&&(g<=O||z>=E))){B=!1;break}D(R),(h+=m.y)<0&&(l=J,p-=h=-h),d&&(g+=(r.width-(c=h*d))/2);break;case Y:if(d){if(m.y<=0&&(p<=k||z>=E)){B=!1;break}D(J),p+=m.y,c=(h-=m.y)*d}else D(J),D(q),m.x>=0?z<E?c+=m.x:m.y<=0&&p<=k&&(B=!1):c+=m.x,m.y<=0?p>k&&(h-=m.y,p+=m.y):(h-=m.y,p+=m.y);c<0&&h<0?(l=gt,p-=h=-h,g-=c=-c):c<0?(l=dt,g-=c=-c):h<0&&(l=V,p-=h=-h);break;case dt:if(d){if(m.y<=0&&(p<=k||g<=O)){B=!1;break}D(J),p+=m.y,g+=r.width-(c=(h-=m.y)*d)}else D(J),D("w"),m.x<=0?g>O?(c-=m.x,g+=m.x):m.y<=0&&p<=k&&(B=!1):(c-=m.x,g+=m.x),m.y<=0?p>k&&(h-=m.y,p+=m.y):(h-=m.y,p+=m.y);c<0&&h<0?(l=V,p-=h=-h,g-=c=-c):c<0?(l=Y,g-=c=-c):h<0&&(l=gt,p-=h=-h);break;case gt:if(d){if(m.x<=0&&(g<=O||v>=S)){B=!1;break}D("w"),g+=m.x,h=(c-=m.x)/d}else D(R),D("w"),m.x<=0?g>O?(c-=m.x,g+=m.x):m.y>=0&&v>=S&&(B=!1):(c-=m.x,g+=m.x),m.y>=0?v<S&&(h+=m.y):h+=m.y;c<0&&h<0?(l=Y,p-=h=-h,g-=c=-c):c<0?(l=V,g-=c=-c):h<0&&(l=dt,p-=h=-h);break;case V:if(d){if(m.x>=0&&(z>=E||v>=S)){B=!1;break}D(q),h=(c+=m.x)/d}else D(R),D(q),m.x>=0?z<E?c+=m.x:m.y>=0&&v>=S&&(B=!1):c+=m.x,m.y>=0?v<S&&(h+=m.y):h+=m.y;c<0&&h<0?(l=dt,p-=h=-h,g-=c=-c):c<0?(l=gt,g-=c=-c):h<0&&(l=Y,p-=h=-h);break;case"move":this.move(m.x,m.y),B=!1;break;case"zoom":this.zoom(function Me(o){var i=t({},o),a=0;return A(o,function(e,n){delete i[n],A(i,function(r){var s=Math.abs(e.startX-r.startX),l=Math.abs(e.startY-r.startY),d=Math.abs(e.endX-r.endX),g=Math.abs(e.endY-r.endY),p=Math.sqrt(s*s+l*l),h=(Math.sqrt(d*d+g*g)-p)/p;Math.abs(h)>Math.abs(a)&&(a=h)})}),a}(s),i),B=!1;break;case"crop":if(!m.x||!m.y){B=!1;break}at=he(this.cropper),g=G.startX-at.left,p=G.startY-at.top,c=r.minWidth,h=r.minHeight,m.x>0?l=m.y>0?V:Y:m.x<0&&(g-=c,l=m.y>0?gt:dt),m.y<0&&(p-=h),this.cropped||($(this.cropBox,C),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}B&&(r.width=c,r.height=h,r.left=g,r.top=p,this.action=l,this.renderCropBox()),A(s,function(T){T.startX=T.endX,T.startY=T.endY})}},He={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&I(this.dragBox,xt),$(this.cropBox,C),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=y({},this.initialImageData),this.canvasData=y({},this.initialCanvasData),this.cropBoxData=y({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(y(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),$(this.dragBox,xt),I(this.cropBox,C)),this},replace:function(i){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&i&&(this.isImg&&(this.element.src=i),a?(this.url=i,this.image.src=i,this.ready&&(this.viewBoxImage.src=i,A(this.previews,function(e){e.getElementsByTagName("img")[0].src=i}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(i))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,$(this.cropper,Nt)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,I(this.cropper,Nt)),this},destroy:function(){var i=this.element;return i[w]?(i[w]=void 0,this.isImg&&this.replaced&&(i.src=this.originalUrl),this.uncreate(),this):this},move:function(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,e=this.canvasData,n=e.left,r=e.top;return this.moveTo(Yt(i)?i:n+Number(i),Yt(a)?a:r+Number(a))},moveTo:function(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,e=this.canvasData,n=!1;return i=Number(i),a=Number(a),this.ready&&!this.disabled&&this.options.movable&&(f(i)&&(e.left=i,n=!0),f(a)&&(e.top=a,n=!0),n&&this.renderCanvas(!0)),this},zoom:function(i,a){var e=this.canvasData;return i=Number(i),this.zoomTo(e.width*(i=i<0?1/(1-i):1+i)/e.naturalWidth,null,a)},zoomTo:function(i,a,e){var n=this.options,r=this.canvasData,s=r.width,l=r.height,d=r.naturalWidth,g=r.naturalHeight;if((i=Number(i))>=0&&this.ready&&!this.disabled&&n.zoomable){var p=d*i,c=g*i;if(!1===ct(this.element,Bt,{ratio:i,oldRatio:s/d,originalEvent:e}))return this;if(e){var h=this.pointers,z=he(this.cropper),v=h&&Object.keys(h).length?function Re(o){var i=0,a=0,e=0;return A(o,function(n){i+=n.startX,a+=n.startY,e+=1}),{pageX:i/=e,pageY:a/=e}}(h):{pageX:e.pageX,pageY:e.pageY};r.left-=(v.pageX-z.left-r.left)/s*(p-s),r.top-=(v.pageY-z.top-r.top)/l*(c-l)}else rt(a)&&f(a.x)&&f(a.y)?(r.left-=(a.x-r.left)/s*(p-s),r.top-=(a.y-r.top)/l*(c-l)):(r.left-=(p-s)/2,r.top-=(c-l)/2);r.width=p,r.height=c,this.renderCanvas(!0)}return this},rotate:function(i){return this.rotateTo((this.imageData.rotate||0)+Number(i))},rotateTo:function(i){return f(i=Number(i))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=i%360,this.renderCanvas(!0,!0)),this},scaleX:function(i){var a=this.imageData.scaleY;return this.scale(i,f(a)?a:1)},scaleY:function(i){var a=this.imageData.scaleX;return this.scale(f(a)?a:1,i)},scale:function(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,e=this.imageData,n=!1;return i=Number(i),a=Number(a),this.ready&&!this.disabled&&this.options.scalable&&(f(i)&&(e.scaleX=i,n=!0),f(a)&&(e.scaleY=a,n=!0),n&&this.renderCanvas(!0,!0)),this},getData:function(){var s,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.options,e=this.imageData,n=this.canvasData,r=this.cropBoxData;if(this.ready&&this.cropped){var l=e.width/e.naturalWidth;if(A(s={x:r.left-n.left,y:r.top-n.top,width:r.width,height:r.height},function(p,c){s[c]=p/l}),i){var d=Math.round(s.y+s.height),g=Math.round(s.x+s.width);s.x=Math.round(s.x),s.y=Math.round(s.y),s.width=g-s.x,s.height=d-s.y}}else s={x:0,y:0,width:0,height:0};return a.rotatable&&(s.rotate=e.rotate||0),a.scalable&&(s.scaleX=e.scaleX||1,s.scaleY=e.scaleY||1),s},setData:function(i){var a=this.options,e=this.imageData,n=this.canvasData,r={};if(this.ready&&!this.disabled&&rt(i)){var s=!1;a.rotatable&&f(i.rotate)&&i.rotate!==e.rotate&&(e.rotate=i.rotate,s=!0),a.scalable&&(f(i.scaleX)&&i.scaleX!==e.scaleX&&(e.scaleX=i.scaleX,s=!0),f(i.scaleY)&&i.scaleY!==e.scaleY&&(e.scaleY=i.scaleY,s=!0)),s&&this.renderCanvas(!0,!0);var l=e.width/e.naturalWidth;f(i.x)&&(r.left=i.x*l+n.left),f(i.y)&&(r.top=i.y*l+n.top),f(i.width)&&(r.width=i.width*l),f(i.height)&&(r.height=i.height*l),this.setCropBoxData(r)}return this},getContainerData:function(){return this.ready?y({},this.containerData):{}},getImageData:function(){return this.sized?y({},this.imageData):{}},getCanvasData:function(){var i=this.canvasData,a={};return this.ready&&A(["left","top","width","height","naturalWidth","naturalHeight"],function(e){a[e]=i[e]}),a},setCanvasData:function(i){var a=this.canvasData,e=a.aspectRatio;return this.ready&&!this.disabled&&rt(i)&&(f(i.left)&&(a.left=i.left),f(i.top)&&(a.top=i.top),f(i.width)?(a.width=i.width,a.height=i.width/e):f(i.height)&&(a.height=i.height,a.width=i.height*e),this.renderCanvas(!0)),this},getCropBoxData:function(){var a,i=this.cropBoxData;return this.ready&&this.cropped&&(a={left:i.left,top:i.top,width:i.width,height:i.height}),a||{}},setCropBoxData:function(i){var n,r,a=this.cropBoxData,e=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&rt(i)&&(f(i.left)&&(a.left=i.left),f(i.top)&&(a.top=i.top),f(i.width)&&i.width!==a.width&&(n=!0,a.width=i.width),f(i.height)&&i.height!==a.height&&(r=!0,a.height=i.height),e&&(n?a.height=a.width/e:r&&(a.width=a.height*e)),this.renderCropBox()),this},getCroppedCanvas:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var a=this.canvasData,e=function Ne(o,i,a,e){var n=i.aspectRatio,r=i.naturalWidth,s=i.naturalHeight,l=i.rotate,d=void 0===l?0:l,g=i.scaleX,p=void 0===g?1:g,c=i.scaleY,h=void 0===c?1:c,z=a.aspectRatio,v=a.naturalWidth,O=a.naturalHeight,k=e.fillColor,E=void 0===k?"transparent":k,S=e.imageSmoothingEnabled,B=void 0===S||S,at=e.imageSmoothingQuality,G=void 0===at?"low":at,m=e.maxWidth,D=void 0===m?1/0:m,T=e.maxHeight,L=void 0===T?1/0:T,ot=e.minWidth,vt=void 0===ot?0:ot,bt=e.minHeight,pt=void 0===bt?0:bt,Z=document.createElement("canvas"),N=Z.getContext("2d"),zt=K({aspectRatio:z,width:D,height:L}),be=K({aspectRatio:z,width:vt,height:pt},"cover"),Je=Math.min(zt.width,Math.max(be.width,v)),Qe=Math.min(zt.height,Math.max(be.height,O)),Ze=K({aspectRatio:n,width:D,height:L}),qe=K({aspectRatio:n,width:vt,height:pt},"cover"),ti=Math.min(Ze.width,Math.max(qe.width,r)),ei=Math.min(Ze.height,Math.max(qe.height,s)),ii=[-ti/2,-ei/2,ti,ei];return Z.width=st(Je),Z.height=st(Qe),N.fillStyle=E,N.fillRect(0,0,Je,Qe),N.save(),N.translate(Je/2,Qe/2),N.rotate(d*Math.PI/180),N.scale(p,h),N.imageSmoothingEnabled=B,N.imageSmoothingQuality=G,N.drawImage.apply(N,[o].concat(W(ii.map(function(ai){return Math.floor(st(ai))})))),N.restore(),Z}(this.image,this.imageData,a,i);if(!this.cropped)return e;var n=this.getData(),r=n.x,s=n.y,l=n.width,d=n.height,g=e.width/Math.floor(a.naturalWidth);1!==g&&(r*=g,s*=g,l*=g,d*=g);var p=l/d,c=K({aspectRatio:p,width:i.maxWidth||1/0,height:i.maxHeight||1/0}),h=K({aspectRatio:p,width:i.minWidth||0,height:i.minHeight||0},"cover"),z=K({aspectRatio:p,width:i.width||(1!==g?e.width:l),height:i.height||(1!==g?e.height:d)}),v=z.width,O=z.height;v=Math.min(c.width,Math.max(h.width,v)),O=Math.min(c.height,Math.max(h.height,O));var k=document.createElement("canvas"),E=k.getContext("2d");k.width=st(v),k.height=st(O),E.fillStyle=i.fillColor||"transparent",E.fillRect(0,0,v,O);var S=i.imageSmoothingEnabled,at=i.imageSmoothingQuality;E.imageSmoothingEnabled=void 0===S||S,at&&(E.imageSmoothingQuality=at);var L,ot,vt,bt,pt,Z,G=e.width,m=e.height,D=r,T=s;D<=-l||D>G?(D=0,L=0,vt=0,pt=0):D<=0?(vt=-D,D=0,pt=L=Math.min(G,l+D)):D<=G&&(vt=0,pt=L=Math.min(l,G-D)),L<=0||T<=-d||T>m?(T=0,ot=0,bt=0,Z=0):T<=0?(bt=-T,T=0,Z=ot=Math.min(m,d+T)):T<=m&&(bt=0,Z=ot=Math.min(d,m-T));var N=[D,T,L,ot];if(pt>0&&Z>0){var zt=v/l;N.push(vt*zt,bt*zt,pt*zt,Z*zt)}return E.drawImage.apply(E,[e].concat(W(N.map(function(be){return Math.floor(st(be))})))),k},setAspectRatio:function(i){var a=this.options;return!this.disabled&&!Yt(i)&&(a.aspectRatio=Math.max(0,i)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(i){var a=this.options,e=this.dragBox,n=this.face;if(this.ready&&!this.disabled){var r=i===Gt,s=a.movable&&"move"===i;a.dragMode=i=r||s?i:"none",ft(e,et,i),lt(e,Pt,r),lt(e,Ft,s),a.cropBoxMovable||(ft(n,et,i),lt(n,Pt,r),lt(n,Ft,s))}return this}},We=j.Cropper,ve=function(){function o(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function u(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}(this,o),!i||!Ut.test(i.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=i,this.options=y({},re,rt(a)&&a),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return function b(o,i,a){return i&&x(o.prototype,i),a&&x(o,a),o}(o,[{key:"init",value:function(){var n,a=this.element,e=a.tagName.toLowerCase();if(!a[w]){if(a[w]=this,"img"===e){if(this.isImg=!0,n=a.getAttribute("src")||"",this.originalUrl=n,!n)return;n=a.src}else"canvas"===e&&window.HTMLCanvasElement&&(n=a.toDataURL());this.load(n)}}},{key:"load",value:function(a){var e=this;if(a){this.url=a,this.imageData={};var n=this.element,r=this.options;if(!r.rotatable&&!r.scalable&&(r.checkOrientation=!1),!r.checkOrientation||!window.ArrayBuffer)return void this.clone();if(we.test(a))return void(ye.test(a)?this.read(function Ge(o){var i=o.replace(_e,""),a=atob(i),e=new ArrayBuffer(a.length),n=new Uint8Array(e);return A(n,function(r,s){n[s]=a.charCodeAt(s)}),e}(a)):this.clone());var s=new XMLHttpRequest,l=this.clone.bind(this);this.reloading=!0,this.xhr=s,s.onabort=l,s.onerror=l,s.ontimeout=l,s.onprogress=function(){s.getResponseHeader("content-type")!==oe&&s.abort()},s.onload=function(){e.read(s.response)},s.onloadend=function(){e.reloading=!1,e.xhr=null},r.checkCrossOrigin&&me(a)&&n.crossOrigin&&(a=ue(a)),s.open("GET",a,!0),s.responseType="arraybuffer",s.withCredentials="use-credentials"===n.crossOrigin,s.send()}}},{key:"read",value:function(a){var e=this.options,n=this.imageData,r=Wt(a),s=0,l=1,d=1;if(r>1){this.url=function $e(o,i){for(var a=[],n=new Uint8Array(o);n.length>0;)a.push(fe.apply(null,le(n.subarray(0,8192)))),n=n.subarray(8192);return"data:".concat(i,";base64,").concat(btoa(a.join("")))}(a,oe);var g=function Le(o){var i=0,a=1,e=1;switch(o){case 2:a=-1;break;case 3:i=-180;break;case 4:e=-1;break;case 5:i=90,e=-1;break;case 6:i=90;break;case 7:i=90,a=-1;break;case 8:i=-90}return{rotate:i,scaleX:a,scaleY:e}}(r);s=g.rotate,l=g.scaleX,d=g.scaleY}e.rotatable&&(n.rotate=s),e.scalable&&(n.scaleX=l,n.scaleY=d),this.clone()}},{key:"clone",value:function(){var a=this.element,e=this.url,n=a.crossOrigin,r=e;this.options.checkCrossOrigin&&me(e)&&(n||(n="anonymous"),r=ue(e)),this.crossOrigin=n,this.crossOriginUrl=r;var s=document.createElement("img");n&&(s.crossOrigin=n),s.src=r||e,s.alt=a.alt||"The image to crop",this.image=s,s.onload=this.start.bind(this),s.onerror=this.stop.bind(this),I(s,ht),a.parentNode.insertBefore(s,a.nextSibling)}},{key:"start",value:function(){var a=this,e=this.image;e.onload=null,e.onerror=null,this.sizing=!0;var n=j.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(j.navigator.userAgent),r=function(g,p){y(a.imageData,{naturalWidth:g,naturalHeight:p,aspectRatio:g/p}),a.initialImageData=y({},a.imageData),a.sizing=!1,a.sized=!0,a.build()};if(!e.naturalWidth||n){var s=document.createElement("img"),l=document.body||document.documentElement;this.sizingImage=s,s.onload=function(){r(s.width,s.height),n||l.removeChild(s)},s.src=e.src,n||(s.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",l.appendChild(s))}else r(e.naturalWidth,e.naturalHeight)}},{key:"stop",value:function(){var a=this.image;a.onload=null,a.onerror=null,a.parentNode.removeChild(a),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var a=this.element,e=this.options,n=this.image,r=a.parentNode,s=document.createElement("div");s.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var l=s.querySelector(".".concat(w,"-container")),d=l.querySelector(".".concat(w,"-canvas")),g=l.querySelector(".".concat(w,"-drag-box")),p=l.querySelector(".".concat(w,"-crop-box")),c=p.querySelector(".".concat(w,"-face"));this.container=r,this.cropper=l,this.canvas=d,this.dragBox=g,this.cropBox=p,this.viewBox=l.querySelector(".".concat(w,"-view-box")),this.face=c,d.appendChild(n),I(a,C),r.insertBefore(l,a.nextSibling),this.isImg||$(n,ht),this.initPreview(),this.bind(),e.initialAspectRatio=Math.max(0,e.initialAspectRatio)||NaN,e.aspectRatio=Math.max(0,e.aspectRatio)||NaN,e.viewMode=Math.max(0,Math.min(3,Math.round(e.viewMode)))||0,I(p,C),e.guides||I(p.getElementsByClassName("".concat(w,"-dashed")),C),e.center||I(p.getElementsByClassName("".concat(w,"-center")),C),e.background&&I(l,"".concat(w,"-bg")),e.highlight||I(c,Ce),e.cropBoxMovable&&(I(c,Ft),ft(c,et,"all")),e.cropBoxResizable||(I(p.getElementsByClassName("".concat(w,"-line")),C),I(p.getElementsByClassName("".concat(w,"-point")),C)),this.render(),this.ready=!0,this.setDragMode(e.dragMode),e.autoCrop&&this.crop(),this.setData(e.data),M(e.ready)&&P(a,"ready",e.ready,{once:!0}),ct(a,"ready")}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),$(this.element,C))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=We,o}},{key:"setDefaults",value:function(a){y(re,rt(a)&&a)}}]),o}();return y(ve.prototype,Ue,Xe,Ye,Ve,Ke,He),ve}()}}]);