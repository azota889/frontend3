"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[7025],{6408:(B,P,a)=>{a.d(P,{h:()=>w});var e=a(10936),s=a(99974),i=a(26860),D=a(96699);let w=(()=>{class u{constructor(p){this.testMarketQuestionService=p,this.schoolLevelSubjectObjs=[],this.formSchoolInfo=new e.gE({schoolLevel:new e.MJ(0,{nonNullable:!0}),schoolSubject:new e.MJ(0,{nonNullable:!0})})}initialData(){return new Promise(p=>{this.testMarketQuestionService.apiTestMarketQuestionsSubjectLevelsGet().subscribe(l=>{1==l.success?(this.schoolLevelSubjectObjs=l.data?.schoolLevelSubjectObjs??[],this.formSchoolInfo.controls.schoolLevel.setValue(12),this.formSchoolInfo.controls.schoolSubject.setValue(40),this.apiLeechData(void 0).then(d=>{p(d.map(v=>new s.Q(v.id,v.pr,v.type,void 0,v.name,v.examHashId,v.examCategoryId,0,!v.isLeaf,!1,void 0,v.isLeaf)))}).catch(()=>{p([])})):p([])})})}apiLeechData(p){return new Promise(l=>{const d=[];this.testMarketQuestionService.apiTestMarketQuestionsKnowledgeGet(Number(this.formSchoolInfo.controls.schoolLevel.value),Number(this.formSchoolInfo.controls.schoolSubject.value),p).subscribe(v=>{1===v.success&&v.data&&(v.data.objs||[]).forEach(I=>{d.push({pr:p??0,id:I.id??0,name:I.name?I.name:"",examHashId:"",examCategoryId:"",type:"knowledge",isLeaf:I.isLeaf??!1})}),l(d)})})}static#e=this.\u0275fac=function(l){return new(l||u)(i.KVO(D.e2))};static#t=this.\u0275prov=i.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},51783:(B,P,a)=>{a.d(P,{G:()=>_,e:()=>u});var e=a(17509),s=a(71217),i=a(47947),D=a(99974),w=a(26860),T=a(9280);let u=(()=>{class p{constructor(d){this.documentService=d,this.leechApiCacheMaps=new Map,this.lastNodeSelected=[],this.lastNodesSelected=[]}initialData(d=0,v=void 0){return new Promise(g=>{this.apiLeechData(d,v).then(I=>{g(I.map(m=>new D.Q(m.id,m.pr,m.type,m.shareType,m.name,m.examHashId,m.examCategoryId,0,"cate"===m.type,m.isLeaf)))})})}apiLeechData(d,v,g=!1){return new Promise(I=>{let m=this.getCacheKey(d,v);if(g&&this.leechApiCacheMaps.has(m)&&this.leechApiCacheMaps.get(m))return void I(this.leechApiCacheMaps.get(m)??[]);const b=[];let k={categoryId:d,documentType:void 0,shareType:v,fileType:"exam_online",classroomId:void 0,name:void 0,suggestExamPurpose:void 0,lite:1,getGlobal:0,page:1,itemPerPage:-1};this.documentService.apiDocumentsGet(k.categoryId,k.documentType,k.shareType,k.fileType,k.classroomId,k.name,k.suggestExamPurpose,k.lite,k.getGlobal,k.page,k.itemPerPage).subscribe(E=>{1===E.success&&E.data&&((E.data.categoryObjs||[]).forEach(h=>{b.push({pr:d,id:h.id??0,name:h.name??"",examHashId:"",examCategoryId:"",type:"cate",shareType:h.shareType,isLeaf:!1})}),(E.data.documentObjs||[]).forEach(h=>{h.exam&&b.push({pr:d,id:h.exam.id??0,name:h.exam.name??"",examHashId:h.exam.hashId??"",examCategoryId:h.exam.categoryId?.toString()??"",type:"test",shareType:void 0,isLeaf:!0})}),this.leechApiCacheMaps.set(m,b)),I(b)})})}getCacheKey(d,v){return d+"_"+(v??"")}static#e=this.\u0275fac=function(v){return new(v||p)(w.KVO(T.DK))};static#t=this.\u0275prov=w.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})();class _{get data(){return this.dataChange.value}set data(l){this._treeControl.dataNodes=l,this.dataChange.next(l)}findLastTreeNodeSelected(l,d=[]){let g=this.data.find(I=>I.id==l.id&&I.shareType==l.shareType);return g?(d.push({id:g.id,shareType:g.shareType}),g.prNode?this.findLastTreeNodeSelected(g.prNode,d):d.reverse()):d.reverse()}toggleLastNode(l,d=0,v,g){let I=l[d]?l[d]:void 0;if(!I)return g(v);let m=this.data.find(b=>b.id==I?.id&&b.shareType==I?.shareType);if(!m)return g(void 0);this.toggleNode(m,!0,!0,()=>{this.toggleLastNode(l,d+1,m,g)})}connect(l){return this._treeControl.expansionModel.changed.subscribe(d=>{(d.added||d.removed)&&this.handleTreeControl(d)}),(0,e.h)(l.viewChange,this.dataChange).pipe((0,i.T)(()=>this.data))}disconnect(l){}handleTreeControl(l){l.added&&l.added.forEach(d=>this.toggleNode(d,!0,!1,()=>{})),l.removed&&l.removed.slice().reverse().forEach(d=>this.toggleNode(d,!1,!1,()=>{}))}toggleNode(l,d,v=!1,g){if("cate"!=l.type)return g();const I=this.data.indexOf(l);if(d)l.isLoading=!0,this._database.apiLeechData(l.id,l.shareType,v).then(m=>{const b=m.map(k=>new D.Q(k.id,k.pr,k.type,k.shareType,k.name,k.examHashId,k.examCategoryId,l.level+1,"cate"===k.type,!1,l));this.data.splice(I+1,0,...b),this.dataChange.next(this.data),l.isLoading=!1,g()});else{let m=0;for(let b=I+1;b<this.data.length&&this.data[b].level>l.level;b++,m++);this.data.splice(I+1,m),this.dataChange.next(this.data),g()}}constructor(l,d){this._treeControl=l,this._database=d,this.dataChange=new s.t([])}}},99974:(B,P,a)=>{a.d(P,{Q:()=>e});class e{constructor(i,D,w,T,u,_,p,l=1,d=!1,v=!1,g,I){this.id=i,this.pr=D,this.type=w,this.shareType=T,this.item=u,this.examHashId=_,this.examCategoryId=p,this.level=l,this.expandable=d,this.isLoading=v,this.prNode=g,this.isLeaf=I}}},60531:(B,P,a)=>{a.d(P,{O:()=>D});var e=a(26860),s=a(50589),i=a(91930);let D=(()=>{class w{setMode(u){this.browserStorageService.saveSimpleStorage("__editor:mode_open",u)}getMode(){var u=this.browserStorageService.getSimpleStorage("__editor:mode_open")||"editor";return this.browserStorageService.removeSimpleStorage("__editor:mode_open"),u}setFileProcess(u){this.file=u}getFirstFile(){let u=this.file;return this.file=void 0,u}setOutputData(u){this.data=u}getOutputData(){return this.data}redirectToConfig(u){this.data.homework&&u.showHomework(),(this.data.exam||this.data.examOffline)&&u.showExam()}setMatrixData(u,_){_?this.matrix=u:this.browserStorageService.saveSimpleStorage("__editor:matrix-data",JSON.stringify(u))}getMatrixData(){var u=this.browserStorageService.getSimpleStorage("__editor:matrix-data");return this.browserStorageService.removeSimpleStorage("__editor:matrix-data"),u?this.commonService.castJsonToObj(u):this.matrix}constructor(u,_){this.browserStorageService=u,this.commonService=_,this.data={}}static#e=this.\u0275fac=function(_){return new(_||w)(e.KVO(s.z),e.KVO(i.R))};static#t=this.\u0275prov=e.jDH({token:w,factory:w.\u0275fac,providedIn:"root"})}return w})()},85747:(B,P,a)=>{a.d(P,{J:()=>e});class e{get status(){return this.currentStatus}get msg(){return this.currentMessage}setStatus(i){this.currentStatus=!0,this.currentMessage=i}stopStatus(){this.currentStatus=!1,this.currentMessage=void 0}}},5477:(B,P,a)=>{a.d(P,{o:()=>i});var e=a(26860),s=a(91930);let i=(()=>{class D{constructor(T){this.commonService=T}partQuestionSearchText(T){let u=T.content??"",_=T.answers?.findIndex(p=>T.answerResult?.includes(p.key??""));if(void 0!==_&&-1!=_){let p=T.answers?.map(l=>l.content??"")??[];u+="\n"+this.commonService.getCorrectAnsTxt(p,_)}return this.commonService.parseQuestionContent(u)}partQuestionSearchTextByQuestionForm(T){let u=T.questionContent??"";const _=this.commonService.myParseJson(T.answerConfig??""),p=this.commonService.myParseJson(T?.answerResult??"[]")??[""];let l=_?.findIndex(d=>p.includes(d.key??""));if(void 0!==l&&-1!=l){let d=_?.map(v=>v.content??"")??[];u+="\n"+this.commonService.getCorrectAnsTxt(d,l)}return this.commonService.parseQuestionContent(u)}static#e=this.\u0275fac=function(u){return new(u||D)(e.KVO(s.R))};static#t=this.\u0275prov=e.jDH({token:D,factory:D.\u0275fac,providedIn:"root"})}return D})()},54220:(B,P,a)=>{a.d(P,{f:()=>Oe});var e=a(26860),s=a(10936),i=a(25234),D=a(85747),w=a(59640),T=a(15766),u=a(9280),_=a(65162),p=a(61937),l=a(27691),d=a(5382),v=a(64198),g=a(91930),I=a(41426);let m=(()=>{class c{constructor(t,o){this.commonService=t,this.apiUploadService=o,this.sizeDefaultCanvas=1100,this.actionRunAfterConvert=[],this.imageMaps=[],this.pattern_base64=/data:image[^"'\\]+/i,this.pattern_image=/<img[^>]+data:image[^>]+>/g,this.taskConvertBase64ToCanvas=new d.n(50,{function:(n,r)=>{this.callbackBase64ToCanvas&&this.callbackBase64ToCanvas(n,r)}}),this.taskUploadImage=new d.n(10,{function:(n,r)=>{this.callbackUploadImage&&this.callbackUploadImage(n,r)}})}convertQuestions(t,o,n){return new Promise(r=>{this.reset(),t.forEach(f=>{const O=this.commonService.willDeleteParseJson(f.answerConfig||"[]");f.questionContent?.includes("<img ")&&this.replaceImageCdnInContent(f,"questionContent"),f.questionText?.includes("<img ")&&this.replaceImageCdnInContent(f,"questionText"),f.answerMedia?.includes("<img ")&&this.replaceImageCdnInContent(f,"answerMedia"),f.mediaMeta?.includes("<img ")&&this.replaceImageCdnInContent(f,"mediaMeta"),O.forEach(F=>{F.content.includes("<img ")&&this.replaceImageCdnInContent(F,"content")}),this.actionRunAfterConvert.push(()=>{f.answerConfig=JSON.stringify(O)})}),this.imageMaps.forEach(f=>{this.taskConvertBase64ToCanvas.addTask(this,this.startConvertCanvas,[f])}),this.taskConvertBase64ToCanvas.start().then(f=>{if(f.errs.length>0)n(f.errs,void 0);else{let F=0;const C=[],ee=()=>{const M=document.createElement("canvas");M.width=this.sizeDefaultCanvas,M.height=this.sizeDefaultCanvas;const U=M.getContext("2d");U&&(U.fillStyle="white",U.fillRect(0,0,this.sizeDefaultCanvas,this.sizeDefaultCanvas)),C.push({cdn:"",cX:0,cY:0,canvas:M,imgs:[]})};ee(),f.datas.forEach((M,U)=>{var L=C[C.length-1];L.cX+M.canvas.width+4>this.sizeDefaultCanvas?(L.cX=4,L.cY+=F+4,F=0):L.cX+=4,L.cY+M.canvas.height>this.sizeDefaultCanvas&&(ee(),L=C[C.length-1]);var Q=L.canvas.getContext("2d");L.imgs.push({x:L.cX,y:L.cY,width:M.canvas.width,height:M.canvas.height,index:U}),Q?.drawImage(M.canvas,0,0,M.canvas.width,M.canvas.height,L.cX,L.cY,M.canvas.width,M.canvas.height),L.cX+=M.canvas.width,F=F<M.canvas.height?M.canvas.height:F}),C[0].imgs.length>0&&C.forEach(M=>{this.taskUploadImage.addTask(this,this.startUploadFile,[M])}),this.taskUploadImage.start().then(M=>{if(M.errs.length>0)n(f.errs,void 0);else{let U=!0;M.datas.forEach(L=>{L.imgs.forEach(Q=>{const A=f.datas[Q.index];if(A){const Y={link:L.cdn,data:{x:Q.x,y:Q.y,width:Q.width,height:Q.height}};A.objs.forEach(z=>{if(z[A.path])if(this.commonService.isJson(z[A.path])){const te=this.commonService.willDeleteParseJson(z[A.path]);Object.prototype.hasOwnProperty.call(te,"renderedStr")?(te.renderedStr=te.renderedStr.replace(A.base,`@[]${JSON.stringify(Y)}@[]`),z[A.path]=JSON.stringify(te)):z[A.path]=z[A.path].replace(A.base,`@[]${JSON.stringify(Y)}@[]`)}else z[A.path]=z[A.path].replace(A.base,`@[]${JSON.stringify(Y)}@[]`);else U=!1})}})}),U?(this.actionRunAfterConvert.forEach(L=>{L()}),t.forEach((L,Q)=>{let A=this.commonService.willDeleteParseJson(L.mediaMeta||"{}"),Y=o[Q];const z={id:0,name:L.name,extension:"text",content:L.questionContent,groupContent:A.renderedStr,metaData:{isFixAns:Number(L.isFixAns),forcedFixAns:!1,groupType:L.groupType?Number(L.groupType):void 0}};Y&&(z.vMetaEditor=Y.meta),L.questionContent=JSON.stringify([z])}),r()):n(f.errs,void 0,!0)}})}})})}reset(){this.imageMaps=[],this.actionRunAfterConvert=[]}replaceImageCdnInContent(t,o){var n=t[o];if(this.commonService.isJson(t[o])){const O=this.commonService.willDeleteParseJson(t[o]);Object.prototype.hasOwnProperty.call(O,"renderedStr")&&(n=O.renderedStr)}let r=n.matchAll(this.pattern_image);for(;;){let O=r.next();if(O.done)break;let F=O.value[0];var f=this.imageMaps.findIndex(C=>C.base===F&&C.path===o);-1===f?this.imageMaps.push({base:F,cdn:"",data:null,objs:[t],path:o,canvas:document.createElement("canvas")}):this.imageMaps[f].objs.push(t)}}startConvertCanvas(t){return new Promise((o,n)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{let O=1;if(r.width>this.sizeDefaultCanvas&&(O=this.sizeDefaultCanvas/r.width),r.height>this.sizeDefaultCanvas){let C=this.sizeDefaultCanvas/r.height;C<O&&(O=C)}t.canvas.width=r.width*O,t.canvas.height=r.height*O,t.canvas.getContext("2d")?.drawImage(r,0,0,r.width,r.height,0,0,t.canvas.width,t.canvas.height),o(t)},r.onerror=()=>{t.canvas.width=1,t.canvas.height=1;const O=t.canvas.getContext("2d");O&&(O.fillStyle="white",O.fillRect(0,0,1,1)),o(t)};let f=this.pattern_base64.exec(t.base);null!=f?r.src=f[0]:n(new Error("l\u1ed7i regex"))})}startUploadFile(t){return new Promise((o,n)=>{const r=this.dataURLtoFile(t.canvas.toDataURL("image/png",1));(0,v.w4)(r).then(f=>{this.apiUploadService.uploadToCdnProgressForExamQuestionContent(f).subscribe(O=>{O.type!=l.hv.UploadProgress&&(1==O.success&&O.data?o({...t,cdn:O.data.url||""}):n(new Error(this.commonService.translateToKeyParam("lang_auto_khong_upload_duoc_anh_vui_long_thu_lai_sau_loi",O.message??"none"))))})})})}dataURLtoFile(t){let o=this.getFileName(t);for(var n=t.split(","),r=n[0].match(/:(.*?);/),f=atob(n[1]),O=f.length,F=new Uint8Array(O);O--;)F[O]=f.charCodeAt(O);return new File([F],o,{type:r&&r.length>0?r[1]:"png"})}getFileName(t){var o=t.split("").reverse().join(""),n=o.indexOf(";"),r=o.indexOf("/",n);return o.substring(n,r).split("").reverse().join("")}static#e=this.\u0275fac=function(o){return new(o||c)(e.KVO(g.R),e.KVO(I.T))};static#t=this.\u0275prov=e.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var b=a(60531),k=a(5477),E=a(77260),j=a(50589),y=a(84828),h=a(54460),x=a(18718),S=a(81587),N=a(52811),W=a(37469),$=a(6989),H=a(1349),Z=a(50282),K=a(30683),q=a(9691),J=a(39471),X=a(15343),G=a(7919),V=a(73437);function ne(c,R){1&c&&(e.j41(0,"div",38)(1,"span"),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s()()),2&c&&(e.R7$(2),e.JRh(e.bMT(3,1,"lang_auto_vui_long_nhap_ho_va_ten")))}function ae(c,R){1&c&&(e.j41(0,"div",38)(1,"span"),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s()()),2&c&&(e.R7$(2),e.JRh(e.bMT(3,1,"lang_auto_vui_long_nhap_so_dien_thoai")))}function ie(c,R){1&c&&(e.j41(0,"div",38)(1,"span"),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s()()),2&c&&(e.R7$(2),e.JRh(e.bMT(3,1,"lang_student_utils_reques_phone_ten_number")))}function re(c,R){1&c&&(e.j41(0,"div",38)(1,"span"),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s()()),2&c&&(e.R7$(2),e.JRh(e.bMT(3,1,"lang_document_please_enter_the_author_workplace")))}function le(c,R){if(1&c&&(e.j41(0,"div",14)(1,"div",30)(2,"div",31),e.nrm(3,"input",32),e.nI1(4,"mytranslate"),e.DNE(5,ne,4,3,"div",33),e.k0s(),e.j41(6,"div",34),e.nrm(7,"input",35),e.nI1(8,"mytranslate"),e.DNE(9,ae,4,3,"div",33),e.DNE(10,ie,4,3,"div",33),e.k0s(),e.j41(11,"div",36),e.nrm(12,"input",37),e.nI1(13,"mytranslate"),e.DNE(14,re,4,3,"div",33),e.k0s()()()),2&c){const t=e.XpG();e.R7$(3),e.FS9("placeholder",e.bMT(4,7,"lang_auto_nhap_ho_va_ten")),e.R7$(2),e.Y8G("ngIf","0"==t.form.controls.creatorId.value&&!t.form.controls.creatorFullName.value),e.R7$(2),e.FS9("placeholder",e.bMT(8,9,"lang_auto_nhap_so_dien_thoai")),e.R7$(2),e.Y8G("ngIf","0"==t.form.controls.creatorId.value&&!t.form.controls.creatorPhone.value),e.R7$(1),e.Y8G("ngIf","0"==t.form.controls.creatorId.value&&t.form.controls.creatorPhone.value&&10!==t.form.controls.creatorPhone.value.length),e.R7$(2),e.FS9("placeholder",e.bMT(13,11,"lang_document_workplace")),e.R7$(2),e.Y8G("ngIf","0"==t.form.controls.creatorId.value&&!t.form.controls.creatorWorkingAddress.value)}}function ce(c,R){if(1&c){const t=e.RV6();e.j41(0,"mat-tree-node",43),e.nrm(1,"button",44),e.j41(2,"div",45)(3,"input",46),e.bIt("change",function(){const r=e.eBV(t).$implicit,f=e.XpG(2);return e.Njj(f.checklistSelection.toggle(r))}),e.k0s(),e.j41(4,"label",47)(5,"span"),e.EFF(6),e.k0s()()()()}if(2&c){const t=R.$implicit,o=e.XpG(2);e.R7$(3),e.FS9("id","knowledge-"+t.id),e.Y8G("checked",o.checklistSelection.isSelected(t)),e.R7$(1),e.FS9("for","knowledge-"+t.id),e.R7$(2),e.JRh(t.item)}}function he(c,R){if(1&c){const t=e.RV6();e.j41(0,"mat-tree-node",48)(1,"button",49)(2,"span",50),e.nrm(3,"lucide-icon",51),e.k0s()(),e.j41(4,"div",45)(5,"input",52),e.bIt("change",function(){const r=e.eBV(t).$implicit,f=e.XpG(2);return e.Njj(f.todoItemSelectionToggle(r))}),e.k0s(),e.j41(6,"label",47)(7,"span"),e.EFF(8),e.k0s()()()()}if(2&c){const t=R.$implicit,o=e.XpG(2);e.R7$(1),e.BMQ("aria-label","toggle "+t.filename),e.R7$(2),e.FS9("name",o.treeControl.isExpanded(t)?"chevron-down":"chevron-right"),e.R7$(2),e.FS9("id","knowledge-"+t.id),e.Y8G("checked",o.descendantsAllSelected(t))("indeterminate",o.descendantsPartiallySelected(t)),e.R7$(1),e.FS9("for","knowledge-"+t.id),e.R7$(2),e.JRh(t.item)}}function de(c,R){if(1&c&&(e.j41(0,"div",14)(1,"div",3)(2,"div",31)(3,"span",17),e.EFF(4),e.nI1(5,"mytranslate"),e.k0s()(),e.j41(6,"div",39)(7,"mat-tree",40),e.DNE(8,ce,7,4,"mat-tree-node",41),e.DNE(9,he,9,7,"mat-tree-node",42),e.k0s()()()()),2&c){const t=e.XpG();e.R7$(4),e.SpI(" ",e.bMT(5,4,"lang_document_the_knowledge_units_present_in_the_exam")," "),e.R7$(3),e.Y8G("dataSource",t.dataSource)("treeControl",t.treeControl),e.R7$(2),e.Y8G("matTreeNodeDefWhen",t.hasChild)}}function ue(c,R){1&c&&(e.j41(0,"span",58),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&c&&(e.R7$(1),e.SpI("(",e.bMT(2,1,"lang_document_current"),")"))}const me=function(c){return{"font-medium":c}};function fe(c,R){if(1&c&&(e.j41(0,"div",53)(1,"div",54),e.nrm(2,"input",55),e.j41(3,"label",56)(4,"span"),e.EFF(5),e.nI1(6,"mytranslate"),e.k0s(),e.DNE(7,ue,3,3,"span",57),e.k0s()()()),2&c){const t=R.index,o=e.XpG();e.R7$(2),e.FS9("id","week-"+o.listWeek[t]),e.Y8G("formControlName",t),e.R7$(1),e.FS9("for","week-"+o.listWeek[t]),e.Y8G("ngClass",e.eq3(8,me,o.currentSchoolWeeks===o.listWeek[t])),e.R7$(2),e.JRh(e.bMT(6,6,"lang_document_week")+" "+o.listWeek[t]),e.R7$(2),e.Y8G("ngIf",o.currentSchoolWeeks===o.listWeek[t])}}function pe(c,R){1&c&&(e.j41(0,"div",59)(1,"span"),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s()()),2&c&&(e.R7$(2),e.JRh(e.bMT(3,1,"lang_document_please_select_the_time_of_use")))}class ge{}class _e{}let ve=(()=>{class c extends w.H{buildFileTree(t,o){const n=[];return t.forEach(r=>{const f=new ge;f.item=r.name,f.id=r.id,r.children&&(f.children=this.buildFileTree(r.children,o+1)),n.push(f)}),n}descendantsAllSelected(t){return this.treeControl.getDescendants(t).every(n=>this.checklistSelection.isSelected(n))}descendantsPartiallySelected(t){return this.treeControl.getDescendants(t).some(r=>this.checklistSelection.isSelected(r))&&!this.descendantsAllSelected(t)}todoItemSelectionToggle(t){this.checklistSelection.toggle(t);const o=this.treeControl.getDescendants(t);this.checklistSelection.isSelected(t)?this.checklistSelection.select(...o):this.checklistSelection.deselect(...o)}toggleAllCheckBox(){this.isCheckSemesterOne.setValue(this.isCheckAllWeeks.value),this.isCheckSemesterTwo.setValue(this.isCheckAllWeeks.value);const t=this.isCheckAllWeeks.value;this.formArrayListWeek.controls.map(o=>o.setValue(t))}toggleSemesterOneCheckBox(){const t=this.isCheckSemesterOne.value;this.formArrayListWeek.controls.map((o,n)=>(n<18&&o.setValue(t),o)),this.calculateIsCheckAll()}toggleSemesterTwoCheckBox(){const t=this.isCheckSemesterTwo.value;this.formArrayListWeek.controls.map((o,n)=>(n>=18&&o.setValue(t),o)),this.calculateIsCheckAll()}initForm(){this.formArrayListWeek=this.form.controls.weeks,this.formArrayListKnowledge=this.form.controls.knowledgeIds}initKnowledgeCheckbox(t){this.formArrayListKnowledge.clear();for(let o=0;o<t.length;o++){const r=new s.MJ(!1,{nonNullable:!0});this.formArrayListKnowledge.push(r)}}initWeedCheckbox(t){this.formArrayListWeek.clear();for(let o=0;o<t.length;o++){const r=new s.MJ(!1,{nonNullable:!0});this.formArrayListWeek.push(r)}}calculateIsCheckAll(){const t=this.formArrayListWeek.controls.every(o=>o.value);this.isCheckAllWeeks.setValue(t)}ngOnChanges(){this.initForm(),this.initKnowledgeCheckbox(this.listKnowledge),this.dataSource.data=this.buildFileTree(this.listKnowledge,0)}ngOnInit(){super.ngOnInit(),this.initWeedCheckbox(this.listWeek),this.currentSchoolWeeks=this.timeService.getSchoolWeeks(),this.checklistSelection.changed.subscribe(t=>{let o=this.checklistSelection.selected.map(n=>n.id??0);this.listKnowledgeId=o.sort((n,r)=>n-r)??[],this.emitChooseKnowledge.emit(this.listKnowledgeId)}),this.form.controls.weeks.valueChanges.subscribe(t=>{this.calculateIsCheckAll(),this.checkChooseWeeks=t.some(o=>o)})}constructor(t){super(),this.timeService=t,this.listKnowledge=[],this.listWeek=[],this.emitChooseKnowledge=new e.bkB,this.formArrayListKnowledge=new s.Yp([]),this.formArrayListWeek=new s.Yp([]),this.flatNodeMap=new Map,this.nestedNodeMap=new Map,this.selectedParent=null,this.newItemName="",this.checklistSelection=new H.CB(!0),this.listKnowledgeId=[],this.currentSchoolWeeks=0,this.checkChooseWeeks=!1,this.isCheckAllWeeks=new s.MJ(!1,{nonNullable:!0}),this.isCheckSemesterOne=new s.MJ(!1,{nonNullable:!0}),this.isCheckSemesterTwo=new s.MJ(!1,{nonNullable:!0}),this.getLevel=o=>o.level??0,this.isExpandable=o=>o.expandable??!1,this.getChildren=o=>o.children??[],this.hasChild=(o,n)=>n.expandable??!1,this.hasNoContent=(o,n)=>""===n.item,this.transformer=(o,n)=>{const r=this.nestedNodeMap.get(o),f=r&&r.item===o.item?r:new _e;return f.item=o.item,f.level=n,f.id=o.id,f.expandable=!!o.children,this.flatNodeMap.set(f,o),this.nestedNodeMap.set(o,f),f},this.treeFlattener=new K.yj(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new Z.XW(this.getLevel,this.isExpandable),this.dataSource=new K.zw(this.treeControl,this.treeFlattener)}static#e=this.\u0275fac=function(o){return new(o||c)(e.rXU(q.F))};static#t=this.\u0275cmp=e.VBU({type:c,selectors:[["azt-config-document-market"]],inputs:{form:"form",listKnowledge:"listKnowledge",listWeek:"listWeek"},outputs:{emitChooseKnowledge:"emitChooseKnowledge"},features:[e.Vt3,e.OA$],decls:48,vars:29,consts:[[1,"mt-5"],[3,"formGroup"],[1,"box","p-3"],[1,"grid","grid-cols-12"],[1,"col-span-12","lg:col-span-5"],["for","general-name",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-7"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-8"],["type","radio","id","creator-by-me","formControlName","creatorId","value","1",1,"form-check-input"],["for","creator-by-me",1,"form-check-label"],["type","radio","id","creator-by-user-other","formControlName","creatorId","value","0",1,"form-check-input"],["for","creator-by-user-other",1,"form-check-label"],["class","mt-3",4,"ngIf"],[1,"mt-3"],["formArrayName","weeks",1,"list-week","grid","grid-cols-12"],[1,"col-span-12","flex","items-center"],[1,"form-label","mb-0","font-medium","flex","items-center"],[1,"list-week","col-span-12","mt-1"],[1,"flex","flex-row","sm:flex-col","sm:items-center"],[1,"azt-form-check","mr-5","mt-3","sm:mt-0"],["type","checkbox","id","selectSemesterOne",1,"form-check-input",3,"formControl","change"],["for","selectSemesterOne",1,"form-check-label"],["type","checkbox","id","selectSemesterTwo",1,"form-check-input",3,"formControl","change"],["for","selectSemesterTwo",1,"form-check-label"],["type","checkbox","id","selectAllWeeks",1,"form-check-input",3,"formControl","change"],["for","selectAllWeeks",1,"form-check-label"],[1,"grid","grid-cols-12","gap-3","mt-3"],["class","col-span-6 md:col-span-3 lg:col-span-2",4,"ngFor","ngForOf"],["class","col-span-12 mt-2 text-danger text-xs",4,"ngIf"],[1,"grid","grid-cols-12","gap-3"],[1,"col-span-12"],["type","text","name","creatorFullName","formControlName","creatorFullName",1,"form-control",3,"placeholder"],["class","text-danger text-xs mt-2",4,"ngIf"],[1,"col-span-12","md:col-span-4"],["type","text","appOnlyNumber","","name","creatorPhone","formControlName","creatorPhone",1,"form-control",3,"placeholder"],[1,"col-span-12","md:col-span-8"],["type","text","name","creatorWorkingAddress","formControlName","creatorWorkingAddress",1,"form-control",3,"placeholder"],[1,"text-danger","text-xs","mt-2"],[1,"list-knowledge","col-span-12"],[3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",4,"matTreeNodeDef"],["matTreeNodePadding","",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle","","matTreeNodePadding",""],["mat-icon-button","","disabled",""],[1,"azt-form-checked"],["type","checkbox",1,"form-check-input",3,"checked","id","change"],[1,"form-check-label",2,"vertical-align","middle",3,"for"],["matTreeNodePadding",""],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror","w-5","h-5","inline-block",2,"vertical-align","bottom"],["size","20",3,"name"],["type","checkbox",1,"form-check-input",3,"checked","indeterminate","id","change"],[1,"col-span-6","md:col-span-3","lg:col-span-2"],[1,"azt-form-check"],["type","checkbox","value","41556",1,"form-check-input",3,"formControlName","id"],[1,"form-check-label",2,"vertical-align","middle",3,"ngClass","for"],["class","inline-block ml-1",4,"ngIf"],[1,"inline-block","ml-1"],[1,"col-span-12","mt-2","text-danger","text-xs"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),e.EFF(6),e.nI1(7,"mytranslate"),e.k0s()(),e.j41(8,"div",6)(9,"div",7)(10,"div",8),e.nrm(11,"input",9),e.j41(12,"label",10),e.EFF(13),e.nI1(14,"mytranslate"),e.k0s()(),e.j41(15,"div",8),e.nrm(16,"input",11),e.j41(17,"label",12),e.EFF(18),e.nI1(19,"mytranslate"),e.k0s()()()()(),e.DNE(20,le,15,13,"div",13),e.DNE(21,de,10,6,"div",13),e.j41(22,"div",14)(23,"div",15)(24,"div",16)(25,"span",17),e.EFF(26),e.nI1(27,"mytranslate"),e.k0s()(),e.j41(28,"div",18)(29,"div",19)(30,"div",20)(31,"input",21),e.bIt("change",function(){return n.toggleSemesterOneCheckBox()}),e.k0s(),e.j41(32,"label",22),e.EFF(33),e.nI1(34,"mytranslate"),e.k0s()(),e.j41(35,"div",20)(36,"input",23),e.bIt("change",function(){return n.toggleSemesterTwoCheckBox()}),e.k0s(),e.j41(37,"label",24),e.EFF(38),e.nI1(39,"mytranslate"),e.k0s()(),e.j41(40,"div",20)(41,"input",25),e.bIt("change",function(){return n.toggleAllCheckBox()}),e.k0s(),e.j41(42,"label",26),e.EFF(43),e.nI1(44,"mytranslate"),e.k0s()()(),e.j41(45,"div",27),e.DNE(46,fe,8,10,"div",28),e.k0s()(),e.DNE(47,pe,4,3,"div",29),e.k0s()()()()()),2&o&&(e.R7$(1),e.Y8G("formGroup",n.form),e.R7$(5),e.SpI(" ",e.bMT(7,15,"lang_document_author")," "),e.R7$(7),e.SpI(" ",e.bMT(14,17,"lang_document_me")," "),e.R7$(5),e.SpI(" ",e.bMT(19,19,"lang_document_others")," "),e.R7$(2),e.Y8G("ngIf","0"==n.form.controls.creatorId.value),e.R7$(1),e.Y8G("ngIf",n.formArrayListKnowledge.controls.length),e.R7$(5),e.SpI(" ",e.bMT(27,21,"lang_document_time_of_use")," "),e.R7$(5),e.Y8G("formControl",n.isCheckSemesterOne),e.R7$(2),e.SpI(" ",e.bMT(34,23,"lang_config_semester")+" 1"," "),e.R7$(3),e.Y8G("formControl",n.isCheckSemesterTwo),e.R7$(2),e.SpI(" ",e.bMT(39,25,"lang_config_semester")+" 2"," "),e.R7$(3),e.Y8G("formControl",n.isCheckAllWeeks),e.R7$(2),e.SpI(" ",e.bMT(44,27,n.isCheckAllWeeks.value?"lang_student_classroom_list_utils_create_class_new_course_disable":"lang_student_classroom_list_utils_create_class_new_course_choose_all")," "),e.R7$(3),e.Y8G("ngForOf",n.formArrayListWeek.controls),e.R7$(1),e.Y8G("ngIf",!n.checkChooseWeeks))},dependencies:[h.YU,h.Sq,h.bT,J.iY,K.yI,K.yF,K.pO,K.lQ,K.d6,s.qT,s.me,s.Zm,s.Fm,s.BC,s.cb,s.l_,s.j4,s.JD,s.v8,X.WGl,G.Z,S.t,V.wp],encapsulation:2})}return c})();function be(c,R){if(1&c&&e.nrm(0,"azt-loading-effect",3),2&c){const t=e.XpG();e.Y8G("currentStatusObj",t.statusObj)}}function Se(c,R){1&c&&(e.j41(0,"div",30),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&c&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"lang_auto_vui_long_nhap_ten_de_thi")," "))}function Ce(c,R){if(1&c){const t=e.RV6();e.qex(0),e.j41(1,"config-level-subject",31),e.bIt("sendLogPredictSubject",function(n){e.eBV(t);const r=e.XpG(2);return e.Njj(r.getLogPredictSubject(n))}),e.k0s(),e.bVm()}if(2&c){const t=e.XpG(2);e.R7$(1),e.Y8G("form",t.form)("questionContents",t.questionContent)("schoolLevelObjs",t.schoolLevelObjs)}}function je(c,R){if(1&c&&e.nrm(0,"config-level-subject",32),2&c){const t=e.XpG(2);e.Y8G("form",t.form)("schoolLevelObjs",t.schoolLevelObjs)}}function Ie(c,R){1&c&&(e.j41(0,"span",33),e.nrm(1,"azt-loading-ui"),e.k0s())}function xe(c,R){if(1&c){const t=e.RV6();e.j41(0,"div",4)(1,"form",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9)(6,"div",10)(7,"label",11),e.EFF(8),e.nI1(9,"mytranslate"),e.k0s()(),e.j41(10,"div",10)(11,"div",12),e.nrm(12,"input",13),e.nI1(13,"mytranslate"),e.k0s(),e.DNE(14,Se,3,3,"div",14),e.k0s()(),e.j41(15,"div",15),e.DNE(16,Ce,2,3,"ng-container",16),e.DNE(17,je,1,2,"ng-template",null,17,e.C5r),e.k0s(),e.j41(19,"div",18),e.nrm(20,"config-purpose-exam",19),e.k0s(),e.j41(21,"div",20)(22,"div",10)(23,"label",21),e.EFF(24),e.nI1(25,"mytranslate"),e.k0s()(),e.j41(26,"div",10)(27,"div",12),e.nrm(28,"textarea",22),e.nI1(29,"mytranslate"),e.k0s()()()(),e.j41(30,"div",23)(31,"azt-config-document-market",24),e.bIt("emitChooseKnowledge",function(n){e.eBV(t);const r=e.XpG();return e.Njj(r.chooseKnowledge(n))}),e.k0s()(),e.j41(32,"div",25)(33,"div",26)(34,"button",27),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cancelSaveDocumentObj())}),e.EFF(35),e.nI1(36,"mytranslate"),e.k0s(),e.j41(37,"button",28),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.handleSaveDocument())}),e.DNE(38,Ie,2,0,"span",29),e.EFF(39),e.nI1(40,"mytranslate"),e.k0s()()()()()()()}if(2&c){const t=e.sdS(18),o=e.XpG();e.R7$(1),e.Y8G("formGroup",o.form),e.R7$(7),e.SpI(" ",e.bMT(9,17,"lang_auto_ten")," "),e.R7$(4),e.FS9("placeholder",e.bMT(13,19,"lang_auto_nhap_ten")+" ..."),e.R7$(2),e.Y8G("ngIf",o.form.controls.name.errors),e.R7$(2),e.Y8G("ngIf",o.isCreateQuestionToEditor)("ngIfElse",t),e.R7$(4),e.Y8G("purposeList",o.listPurposeObjs)("form",o.form),e.R7$(4),e.SpI(" ",e.bMT(25,21,"lang_auto_mo_ta")," "),e.R7$(4),e.FS9("placeholder",e.bMT(29,23,"lang_core_nhap_mo_ta")+" ..."),e.R7$(3),e.Y8G("form",o.form)("listWeek",o.listWeek)("listKnowledge",o.listKnowledge),e.R7$(4),e.SpI(" ",e.bMT(36,25,"lang_auto_huy")," "),e.R7$(2),e.Y8G("disabled",o.logConfig.status),e.R7$(1),e.Y8G("ngIf",o.logConfig.status),e.R7$(1),e.SpI(" ",e.bMT(40,27,"lang_auto_luu")," ")}}function ke(c,R){if(1&c&&(e.j41(0,"div",34)(1,"div",35)(2,"div",36)(3,"span",37),e.nrm(4,"azt-loading-ui"),e.k0s(),e.j41(5,"div",38),e.EFF(6),e.k0s()()()()),2&c){const t=e.XpG();e.R7$(6),e.JRh(t.logConfig.msg)}}let Oe=(()=>{class c extends w.H{getLogPredictSubject(t){this.predictLogRequestObj=t}chooseKnowledge(t){this.knowledgeList=t}cancelSaveDocumentObj(){this.onBack.emit(!0)}handleSaveDocument(){const t=this.getWeeksChecked(this.listWeek,this.form.controls.weeks.value);if(this.checkErrorValidateSave(t,this.knowledgeList))this.showErrorSnack("lang_cms_utils_folder_name_validate_space");else{if(this.type===i.x.exam&&this.isCreateQuestionToEditor&&this.dataSave.exam&&this.dataSave.exam.questionObj.listQuestions){this.logConfig.setStatus(this.commonService.myTranslateInstant("lang_auto_dang_luu_du_lieu_de_thi")),this.countProcess=0;const o=this.dataSave.exam.questionObj.listQuestions;let n=this.commonService.myTranslateInstant("lang_auto_xay_ra_loi_trong_qua_trinh_xu_ly_hinh_anh_cua_de_thi")??"";this.questionShareSaveService.convertQuestions(o,this.dataSave.exam.rootQuests,(r,f=n,O)=>{this.logConfig.stopStatus(),this.showErrorSnack(f),O&&this.stopStatusObj()}).then(()=>{this.startMainProcessSaveEditor()})}this.type===i.x.exam&&!this.isCreateQuestionToEditor&&this.examObj?.id&&this.saveDocumentMarketQuestionObjs(),this.type!==i.x.exam&&this.attachments.length&&this.saveDocumentMarketQuestionObjs(),console.log(this.attachments,this.type)}}initQuestionShare(){this.questionShareSaveService.callbackBase64ToCanvas=(t,o)=>{let n=this.commonService.myTranslateInstant("lang_auto_dang_xu_ly_hinh_anh_cho_de_thi");this.logConfig.setStatus(`${n} ${Math.floor(t/o*100*.7)}%`)},this.questionShareSaveService.callbackUploadImage=(t,o)=>{let n=this.commonService.myTranslateInstant("lang_auto_dang_xu_ly_hinh_anh_cho_de_thi");this.logConfig.setStatus(`${n} ${Math.floor(t/o*100*.3)+70}%`)}}processSaveQuestionsFromEditor(t,o,n){if(this.dataSave.exam?.questionObj&&this.dataSave.exam?.questionObj.listQuestions){var r=this.dataSave.exam?.questionObj.listQuestions.length;let f=t+100>r?r:t+100,O=this.dataSave.exam?.questionObj.listQuestions.slice(t,f)??[],F=[];for(const C of O)F.push({categoryId:C.categoryId,groupId:C.groupId,name:C.name??"none",metadata:C.metadata,isImage:C.isImage,questionContent:C.questionContent,answerMedia:C.answerMedia,questionText:C.questionText,answerType:C.answerType,answerConfig:C.answerConfig,coordinates:C.coordinates,answerResult:C.answerResult,totalQuestion:C.totalQuestion,tags:C.tags??[],mediaId:C.mediaId,mediaMeta:C.mediaMeta,attachments:C.attachments,version:C.version,isFixAns:C.isFixAns,groupType:C.groupType,__path:C.__path});F.length>0?this.sAztSaveProcessService.saveQuestionObjsFromEditor(this.dataSave,F,o).then(C=>{C&&C.listQuestionId.length>0?(n.listQuestionId=n.listQuestionId.concat(C.listQuestionId),this.processSaveQuestionsFromEditor(f,C.indexSaved,n)):(this.countProcess=0,this.logConfig.stopStatus(),this.showErrorSnack("lang_auto_khong_luu_duoc_noi_dung_cau_hoi_trong_de_vui_long_kiem_tra_lai"))}):this.saveDocumentMarketQuestionObjs(n)}}startMainProcessSaveEditor(){this.dataSave.exam&&this.dataSave.exam.questionObj&&this.processSaveQuestionsFromEditor(0,0,{indexSaved:0,listQuestionId:[]})}GetSubjectAndLevel(){this.initStatusObj(),this.waitDestroy(this.commonListService.apiCommonListSubjectAndLevelsGet(this.commonService.getBusinessDomainUrl()).subscribe(t=>{1==t.success?(this.examSchoolLogObj=t.data?.examSchoolLogObj,this.schoolLevelObjs=t.data?.schoolLevelSubjectObjs??[],this.getListPurposeExam()):this.errorStatusObj(t.message??"")}))}getListPurposeExam(){this.initStatusObj(),this.waitDestroy(this.commonListService.apiCommonListExamPurposesGet().subscribe(t=>{t.success?(this.listPurposeObjs=t.data?.objs??[],this.successStatusObj()):this.errorStatusObj(t.message??"",!0)}))}getKnowledgeData(){const t=this.form.controls.schoolLevel.value,o=this.form.controls.schoolSubject.value;t&&o&&this.waitDestroy(this.knowledgeService.apiKnowledgeGet(t,o).subscribe(n=>{n.list&&(this.listKnowledge=n.list)}))}checkErrorValidateSave(t,o){return!(!this.form.invalid&&("0"!=this.form.controls.creatorId.value||this.form.controls.creatorFullName.value&&this.form.controls.creatorFullName.value&&this.form.controls.creatorPhone.value&&this.form.controls.creatorWorkingAddress.value)&&("0"!=this.form.controls.creatorId.value||10===this.form.controls.creatorPhone.value.length)&&t.length)}fillConfig(){const t=Number(this.commonService.getMyParam(this.activeRoute,"levelId")),o=Number(this.commonService.getMyParam(this.activeRoute,"subjectId"));if(this.examObj?.id)this.waitDestroy(this.documentConfigService.apiDocumentConfigGetExamConfigDataV2Get(this.examObj.hashId??"").subscribe(n=>{if(n.success){const r=n.data?.examObj;this.form.controls.name.setValue(r?.name??""),this.form.controls.description.setValue(r?.description??""),this.form.controls.schoolLevel.setValue(r?.schoolLevelId??t),this.form.controls.schoolSubject.setValue(r?.schoolSubjectId??o),this.form.controls.purposeExam.setValue(n.data?.purposeId??0),this.form.controls.purposeNote.setValue(n.data?.purposeNote??"")}else this.errorStatusObj(n.message??"",!0)}));else if(this.isCreateQuestionToEditor){const n=Number(this.browserStorageService.getSimpleStorage("levelId")??0),r=Number(this.browserStorageService.getSimpleStorage("subjectId")??0);this.form.controls.schoolLevel.setValue(n),this.form.controls.schoolSubject.setValue(r)}else this.form.controls.schoolLevel.setValue(t),this.form.controls.schoolSubject.setValue(o),this.form.controls.name.setValue(this.name)}getWeeksChecked(t,o){let n=[];for(let r=0;r<o.length;r++)o[r]&&t[r]&&n.push(t[r]);return n}createListWeek(){for(let o=0;o<35;o++)this.listWeek.push(o+1)}saveDocumentMarketQuestionObjs(t){const o=this.getWeeksChecked(this.listWeek,this.form.controls.weeks.value);this.logConfig.setStatus("");let n={name:this.form.controls.name.value,type:this.type,schoolLevelId:this.form.controls.schoolLevel.value,schoolSubjectId:this.form.controls.schoolSubject.value,purposeId:this.form.controls.purposeExam.value,purposeNote:this.form.controls.purposeNote.value,description:this.form.controls.description.value,creatorId:Number(this.form.controls.creatorId.value),creatorFullName:this.form.controls.creatorFullName.value,creatorPhone:this.form.controls.creatorPhone.value,creatorWorkingAddress:this.form.controls.creatorWorkingAddress.value,knowledgeIds:this.knowledgeList,weeks:o};switch(this.type){case i.x.exam:if(t&&this.isCreateQuestionToEditor){let r=[];r=t.listQuestionId.map(f=>f??0)??[],n.questionIds=r}this.examObj?.id&&!this.isCreateQuestionToEditor&&(n.examId=this.examObj?.id,n.questionIds=[]);break;case i.x.lecture:case i.x.ref:case i.x.teaching_plan:case i.x.slide:n.attachments=this.attachments}this.waitDestroy(this.documentService.apiDocumentsPost(n).subscribe(r=>{if(r.id){this.successStatusObj("lang_document_successful_sharing",!0);const f="/document-market/list-documents/your-documents/1";this.logConfig.stopStatus(),this.myNavigation(f)}else this.errorStatusObj(""),this.logConfig.stopStatus()}))}ngOnInit(){if(super.ngOnInit(),this.GetSubjectAndLevel(),this.createListWeek(),this.getKnowledgeData(),this.fillConfig(),this.form.controls.schoolSubject.valueChanges.subscribe(t=>{this.getKnowledgeData()}),this.form.controls.schoolLevel.valueChanges.subscribe(t=>{this.getKnowledgeData()}),this.type===i.x.exam&&this.isCreateQuestionToEditor){this.dataSave=this.editorOutputDataService.getOutputData();const t=25;this.questionContent=[],this.dataSave.exam?.questionObj.listQuestions?.forEach((n,r)=>{r<t&&this.questionContent.push(this.partQuestionSearchTextService.partQuestionSearchTextByQuestionForm(n))}),this.form.controls.name.setValue(this.dataSave.exam?.examObj.name??this.dataSave.homework?.name??"")}}constructor(t,o,n,r,f,O,F,C,ee,M,U){super(),this.documentConfigService=t,this.activeRoute=o,this.examService=n,this.documentService=r,this.knowledgeService=f,this.questionShareSaveService=O,this.editorOutputDataService=F,this.partQuestionSearchTextService=C,this.sAztSaveProcessService=ee,this.browserStorageService=M,this.commonListService=U,this.type=i.x.exam,this.isCreateQuestionToEditor=!1,this.attachments=[],this.name="",this.onBack=new e.bkB,this.schoolLevelObjs=[],this.listPurposeObjs=[],this.listKnowledge=[],this.logConfig=new D.J,this.dataSave={},this.saveParts=[],this.questionContent=[],this.countProcess=0,this.knowledgeList=[],this.listWeek=[],this.form=new s.gE({name:new s.MJ("",{nonNullable:!0,validators:[s.k0.required,T.M.noWhiteSpace]}),description:new s.MJ("",{nonNullable:!0}),schoolLevel:new s.MJ(0,{nonNullable:!0,validators:[s.k0.required,s.k0.min(1)]}),schoolSubject:new s.MJ(0,{nonNullable:!0,validators:[s.k0.required,s.k0.min(1)]}),purposeExam:new s.MJ(0,{nonNullable:!0,validators:[s.k0.required,s.k0.min(1)]}),purposeNote:new s.MJ("",{nonNullable:!0}),knowledgeIds:new s.Yp([]),weeks:new s.Yp([]),creatorId:new s.MJ("1",{nonNullable:!0}),creatorFullName:new s.MJ("",{nonNullable:!0}),creatorPhone:new s.MJ("",{nonNullable:!0}),creatorWorkingAddress:new s.MJ("",{nonNullable:!0})}),this.type===i.x.exam&&this.isCreateQuestionToEditor&&this.initQuestionShare()}static#e=this.\u0275fac=function(o){return new(o||c)(e.rXU(u.x_),e.rXU(_.nX),e.rXU(u.RW),e.rXU(p.DK),e.rXU(p.Iu),e.rXU(m),e.rXU(b.O),e.rXU(k.o),e.rXU(E.G),e.rXU(j.z),e.rXU(y.Nz))};static#t=this.\u0275cmp=e.VBU({type:c,selectors:[["azt-config-share-document"]],inputs:{type:"type",isCreateQuestionToEditor:"isCreateQuestionToEditor",attachments:"attachments",name:"name",examObj:"examObj"},outputs:{onBack:"onBack"},features:[e.Vt3],decls:4,vars:3,consts:[[3,"currentStatusObj",4,"ngIf","ngIfElse"],["doneLoading",""],["style","width: 100vw; height: 100vh; position: fixed; z-index: 9999; top: 0; left: 0; display: flex; justify-content: center; align-items: center; background-color: rgba(0, 0, 0, 0.4)",4,"ngIf"],[3,"currentStatusObj"],[1,"intro-y","mt-8","p-3"],[3,"formGroup"],[1,"mx-auto",2,"max-width","1100px"],[1,"setting-block"],[1,"box","mt-2","p-3"],["id","azt-config-name",1,"grid","grid-cols-12"],[1,"col-span-12","lg:col-span-12"],["for","general-name",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"setting-input"],["id","general-name","formControlName","name","type","text",1,"form-control",3,"placeholder"],["class","mt-2 text-danger text-xs fade",4,"ngIf"],[1,"mt-4"],[4,"ngIf","ngIfElse"],["normal",""],[1,"mt-2"],[3,"purposeList","form"],["id","azt-config-desc",1,"grid","grid-cols-12","mt-4"],["for","general-desc",1,"form-label","mb-0","font-medium","flex","items-center"],["id","general-desc","formControlName","description",1,"form-control","w-full",2,"height","150px",3,"placeholder"],[1,"config-document-market"],[3,"form","listWeek","listKnowledge","emitChooseKnowledge"],[1,"mt-5"],[1,"flex","justify-end"],[1,"btn","btn-secondary","w-24","mr-2",3,"click"],[1,"btn","w-24","btn-primary",3,"disabled","click"],["class","w-4 h-4 mr-2",4,"ngIf"],[1,"mt-2","text-danger","text-xs","fade"],[3,"form","questionContents","schoolLevelObjs","sendLogPredictSubject"],[3,"form","schoolLevelObjs"],[1,"w-4","h-4","mr-2"],[2,"width","100vw","height","100vh","position","fixed","z-index","9999","top","0","left","0","display","flex","justify-content","center","align-items","center","background-color","rgba(0, 0, 0, 0.4)"],[2,"text-align","center","color","#000000"],[2,"margin-bottom","10px"],[1,"w-4","h-4","inline-block"],[2,"font-size","20px","margin-top","10px","background-color","#f0f8ffa3","padding","10px","border-radius","5px"]],template:function(o,n){if(1&o&&(e.DNE(0,be,1,1,"azt-loading-effect",0),e.DNE(1,xe,41,29,"ng-template",null,1,e.C5r),e.DNE(3,ke,7,1,"div",2)),2&o){const r=e.sdS(2);e.Y8G("ngIf",n.statusObj.loading)("ngIfElse",r),e.R7$(3),e.Y8G("ngIf",n.logConfig.status&&n.isCreateQuestionToEditor)}},dependencies:[h.bT,s.qT,s.me,s.BC,s.cb,s.j4,s.JD,x.K,S.t,N.R,W.A,$.b,ve,V.wp],encapsulation:2})}return c})()},77260:(B,P,a)=>{a.d(P,{G:()=>T});var e=a(26860),s=a(91930),i=a(5382),D=a(97633),w=a(76671);let T=(()=>{class u{convertBase64OfMathJaxToCdnUrlInQuestions(p,l){return new Promise((d,v)=>{const g=null==l?new i.n(10):new i.n(10,{function:l},0);p.forEach(I=>{g.addTask(this.dataAztMathRawHelper,this.dataAztMathRawHelper.convertBase64OfMathJaxToCdnUrl,[I])}),g.start().then(I=>{0===I.errs.length?d(I.datas):v(I.errs[0])})})}saveQuestionObjsFromEditor(p,l,d){return new Promise(v=>{this.convertBase64OfMathJaxToCdnUrlInQuestions(l,void 0).then(g=>{let I=[];for(let m=0;m<g.length;m++){let b=g[m];b.expandInfo=this.commonService.serializeJson(p.exam?.examObj.expandInfoObj),I.push(b)}this.questionService.apiQuestionsPost({listQuestions:I}).subscribe(m=>{v(m.list?{indexSaved:m.list.length+d,listQuestionId:m.list}:{indexSaved:d,listQuestionId:[]})})}).catch(()=>{v({indexSaved:d,listQuestionId:[]})})})}constructor(p,l){this.questionService=p,this.dataAztMathRawHelper=l,this.commonService=(0,e.WQX)(s.R)}static#e=this.\u0275fac=function(l){return new(l||u)(e.KVO(D.wP),e.KVO(w.c))};static#t=this.\u0275prov=e.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},37469:(B,P,a)=>{a.d(P,{A:()=>E});var e=a(26860),s=a(59640),i=function(j){return j[j.DEFAULT=0]="DEFAULT",j[j.ACCEPT=1]="ACCEPT",j[j.NOT_DO_ANYTHING=2]="NOT_DO_ANYTHING",j}(i||{});class D{acceptPredictSubjectId(y,h){if(!this.predictLogRequestObj)return;let x=this.schoolLevelObjs.find(G=>G.schoolLevel?.id==y),S=x?.schoolLevel?.value??0,N=x?.schoolSubjectObjs.find(G=>G.id==h),W=this.allPredictSubjectObjs.find(G=>!0),$=this.schoolLevelObjs.find(G=>G.schoolSubjectObjs.map(V=>V.id).includes(W?.id??0)),H=W?.from??0,Z=W?.to??0;if(!$||!W||!H||!Z||N&&this.allPredictSubjectIds.includes(N.id))return;let K=0,q=0;if(x?.schoolLevel?.id&&S>=H&&S<=Z){let G=x?.schoolSubjectObjs.find(V=>this.allPredictSubjectIds.includes(V.id));if(G)return K=x.schoolLevel.id,q=G.id,this.predictLogRequestObj.acceptPredictStatus=i.ACCEPT,{schoolLevelId:K,schoolSubjectId:q}}let J=this.allPredictSubjectObjs.find(G=>!0),X=this.schoolLevelObjs.find(G=>G.schoolSubjectObjs.map(V=>V.id).includes(J?.id??0));return J&&X&&X.schoolLevel?.id?(this.predictLogRequestObj.acceptPredictStatus=i.ACCEPT,{schoolLevelId:X.schoolLevel.id,schoolSubjectId:J.id}):void 0}changePredictStatusWhenSubjectIdChanged(y){this.predictLogRequestObj&&(this.predictLogRequestObj.acceptPredictStatus=this.allPredictSubjectIds.includes(y)?i.NOT_DO_ANYTHING:i.DEFAULT)}predictSchoolSubjectByQuestionContent(y,h,x,S){x.length&&h.length&&(this.schoolLevelObjs=h,this.aiService.apiAiPredictSubjectPost({questionContents:x}).subscribe(W=>{if(W.success&&this.predictLogRequestObj){let $=W.data?.schoolSubjectId;if(!$||(this.setAllPredictSubjectIds($),!this.allPredictSubjectObjs.length))return;this.predictLogRequestObj={predictSchoolSubjectId:$,acceptPredictStatus:i.DEFAULT,predictByTotalQuestion:x.length},this.changePredictStatusWhenSubjectIdChanged(y),S(!0)}else S(!1)}))}setAllPredictSubjectIds(y){let h=this.commonService.concatMultipleArray(this.schoolLevelObjs.map(S=>S.schoolSubjectObjs)),x=h.find(S=>S.id==y)?.key??"";this.allPredictSubjectObjs=h.filter(S=>S.key&&S.key==x),this.allPredictSubjectIds=this.allPredictSubjectObjs.map(S=>S.id),this.predictSubjectKey=this.allPredictSubjectObjs.find(S=>!0)?.key??""}constructor(y,h){this.commonService=y,this.aiService=h,this.predictLogRequestObj=void 0,this.allPredictSubjectIds=[],this.predictSubjectKey="",this.allPredictSubjectObjs=[],this.schoolLevelObjs=[]}}var w=a(19280),T=a(54460),u=a(47426),_=a(74960),p=a(4375),l=a(10936),d=a(81587),v=a(73437);let g=(()=>{class j{transform(h,x){if(!h)return"";const S=h.find(W=>W.id==x);return S?S.key??"":""}static#e=this.\u0275fac=function(x){return new(x||j)};static#t=this.\u0275pipe=e.EJ8({name:"aztFindSchoolSubjectById",type:j,pure:!0})}return j})();function I(j,y){if(1&j&&(e.j41(0,"mat-option",15),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&j){const h=y.$implicit;e.Y8G("value",null==h.schoolLevel?null:h.schoolLevel.id),e.R7$(1),e.SpI(" ",e.bMT(2,2,null==h.schoolLevel?null:h.schoolLevel.key)," ")}}function m(j,y){if(1&j&&(e.j41(0,"mat-option",15),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&j){const h=y.$implicit;e.Y8G("value",h.id),e.R7$(1),e.SpI(" ",e.bMT(2,2,h.key)," ")}}function b(j,y){1&j&&(e.j41(0,"div",16),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&j&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"lang_auto_vui_long_chon_khoi_hoc_va_mon_hoc")," "))}function k(j,y){if(1&j){const h=e.RV6();e.j41(0,"div",17)(1,"div",18)(2,"span"),e.EFF(3),e.nI1(4,"mytranslate"),e.nI1(5,"mytranslate"),e.nI1(6,"mytranslate"),e.nI1(7,"mytranslate"),e.nI1(8,"mytranslate"),e.nI1(9,"aztFindSchoolSubjectById"),e.k0s(),e.j41(10,"a",19),e.bIt("click",function(){e.eBV(h);const S=e.XpG();return e.Njj(S.acceptPredictSubjectEvent())}),e.EFF(11),e.nI1(12,"mytranslate"),e.k0s()()()}if(2&j){const h=e.XpG();e.R7$(3),e.SpI(" ",e.bMT(4,2,"lang_testbank_please_double_check_the_subject_for_accuracy")+". "+e.bMT(5,4,"lang_testbank_the_system_recognizes_your_subject_as_a_subject")+" "+e.bMT(6,6,h.sAztPredictLevelAndSubjectService.predictSubjectKey)+", "+e.bMT(7,8,"lang_testbank_you_are_choosing_subject")+" "+e.bMT(8,10,e.i5U(9,12,h.schoolSubjectObjs,h.form.controls.schoolSubject.value))+". "," "),e.R7$(8),e.SpI(" ",e.bMT(12,15,"lang_testbank_click_here_to_change_it_to_the_correct_one")+"."," ")}}let E=(()=>{class j extends s.H{changeSchoolLevelIdEvent(h){let x=this.schoolLevelObjs.find(N=>N.schoolLevel?.id==h);if(!x)return this.form?.controls.schoolSubject.setValue(0);this.schoolSubjectObjs=x?.schoolSubjectObjs??[];let S=this.form.getRawValue();return this.schoolSubjectObjs.map(N=>N.id).includes(S.schoolSubject)?void 0:this.form?.controls.schoolSubject.setValue(0)}acceptPredictSubjectEvent(){let h=this.form.getRawValue(),x=this.sAztPredictLevelAndSubjectService.acceptPredictSubjectId(h.schoolLevel,h.schoolSubject);x&&(this.form?.controls.schoolLevel.setValue(x.schoolLevelId),this.form?.controls.schoolSubject.setValue(x.schoolSubjectId),this.sendLogPredictSubject.emit(this.sAztPredictLevelAndSubjectService.predictLogRequestObj))}updateLevelAndSubjectToForm(h,x){let S=this.schoolLevelObjs.find($=>$.schoolLevel?.id==h),N=S?.schoolSubjectObjs.find($=>$.id==x);S||(h=0),N||(x=0);let W=this.form.getRawValue();W.schoolLevel!=h&&this.form.controls.schoolLevel.setValue(h),W.schoolSubject!=x&&this.form.controls.schoolSubject.setValue(x),this.schoolSubjectObjs=S?.schoolSubjectObjs??[]}initData(){let h=this.form.getRawValue();return h.schoolLevel&&h.schoolSubject?this.updateLevelAndSubjectToForm(h.schoolLevel,h.schoolSubject):this.examSchoolLogObj?this.updateLevelAndSubjectToForm(this.examSchoolLogObj.lastSchoolLevelId??0,this.examSchoolLogObj.lastSchoolSubjectId??0):void this.updateLevelAndSubjectToForm(h.schoolLevel,h.schoolSubject)}ngOnChanges(){this.initData()}ngOnInit(){const h=Number(this.commonService.getMyQueryParam("levelId")),x=Number(this.commonService.getMyQueryParam("subjectId"));h&&x&&(this.form.controls.schoolLevel.setValue(h),this.form.controls.schoolSubject.setValue(x)),this.form?.controls.schoolSubject?.valueChanges.subscribe(()=>{this.sAztPredictLevelAndSubjectService.changePredictStatusWhenSubjectIdChanged(this.form.controls.schoolSubject.value),this.sAztPredictLevelAndSubjectService.predictLogRequestObj&&this.sendLogPredictSubject.emit(this.sAztPredictLevelAndSubjectService.predictLogRequestObj)})}constructor(h){super(),this.aiService=h,this.schoolLevelObjs=[],this.questionContents=[],this.sendLogPredictSubject=new e.bkB,this.schoolSubjectObjs=[],this.sAztPredictLevelAndSubjectService=new D(this.commonService,this.aiService)}static#e=this.\u0275fac=function(x){return new(x||j)(e.rXU(w.E))};static#t=this.\u0275cmp=e.VBU({type:j,selectors:[["config-level-subject"]],inputs:{form:"form",examSchoolLogObj:"examSchoolLogObj",schoolLevelObjs:"schoolLevelObjs",questionContents:"questionContents"},outputs:{sendLogPredictSubject:"sendLogPredictSubject"},features:[e.Vt3,e.OA$],decls:28,vars:19,consts:[[1,"config-level-subject"],[3,"formGroup"],["id","azt-config-level-subject",1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","lg:col-span-6"],[1,"font-medium"],["for","schoolLevel",1,"form-label","flex","items-center"],["appearance","outline"],["formControlName","schoolLevel","name","schoolLevel",3,"selectionChange"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["for","schoolSubject",1,"form-label","flex","items-center"],["id","schoolSubject","formControlName","schoolSubject","name","schoolSubject"],[1,"col-span-12",2,"margin-top","-20px"],["class","text-xs mt-2 text-danger",4,"ngIf"],["class","col-span-12","style","margin-top: -32px",4,"ngIf"],[3,"value"],[1,"text-xs","mt-2","text-danger"],[1,"col-span-12",2,"margin-top","-32px"],[1,"text-xs","text-pending","font-medium"],[1,"btn-text-primary","font-medium",3,"click"]],template:function(x,S){1&x&&(e.j41(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),e.EFF(6),e.nI1(7,"mytranslate"),e.k0s()(),e.j41(8,"mat-form-field",6)(9,"mat-select",7),e.bIt("selectionChange",function(){return S.changeSchoolLevelIdEvent(S.form.controls.schoolLevel.value)}),e.j41(10,"mat-option",8),e.EFF(11),e.nI1(12,"mytranslate"),e.k0s(),e.DNE(13,I,3,4,"mat-option",9),e.k0s()()(),e.j41(14,"div",3)(15,"div",4)(16,"label",10),e.EFF(17),e.nI1(18,"mytranslate"),e.k0s()(),e.j41(19,"mat-form-field",6)(20,"mat-select",11)(21,"mat-option",8),e.EFF(22),e.nI1(23,"mytranslate"),e.k0s(),e.DNE(24,m,3,4,"mat-option",9),e.k0s()()(),e.j41(25,"div",12),e.DNE(26,b,3,3,"div",13),e.k0s(),e.DNE(27,k,13,17,"div",14),e.k0s()()()),2&x&&(e.R7$(1),e.Y8G("formGroup",S.form),e.R7$(5),e.SpI(" ",e.bMT(7,11,"lang_auto_khoi_hoc")," "),e.R7$(4),e.Y8G("value",0),e.R7$(1),e.SpI("",e.bMT(12,13,"lang_auto_---chon_khoi"),"---"),e.R7$(2),e.Y8G("ngForOf",S.schoolLevelObjs),e.R7$(4),e.SpI(" ",e.bMT(18,15,"lang_auto_mon_hoc")," "),e.R7$(4),e.Y8G("value",0),e.R7$(1),e.SpI("",e.bMT(23,17,"lang_auto_---chon_mon"),"---"),e.R7$(2),e.Y8G("ngForOf",S.schoolSubjectObjs),e.R7$(2),e.Y8G("ngIf",(null==S.form||null==S.form.controls||null==S.form.controls.schoolLevel?null:S.form.controls.schoolLevel.invalid)||(null==S.form||null==S.form.controls||null==S.form.controls.schoolSubject?null:S.form.controls.schoolSubject.invalid)),e.R7$(1),e.Y8G("ngIf",S.sAztPredictLevelAndSubjectService.predictLogRequestObj&&!S.sAztPredictLevelAndSubjectService.allPredictSubjectIds.includes(S.form.controls.schoolSubject.value)&&S.form.controls.schoolSubject.value))},dependencies:[T.Sq,T.bT,u.wT,_.rl,p.VO,l.qT,l.BC,l.cb,l.j4,l.JD,d.t,v.wp,g],encapsulation:2})}return j})()},6989:(B,P,a)=>{a.d(P,{b:()=>m});var e=a(59640),s=a(26860),i=a(54460),D=a(47426),w=a(74960),T=a(4375),u=a(10936),_=a(81587),p=a(73437);function l(b,k){if(1&b&&(s.j41(0,"mat-option",14),s.EFF(1),s.nI1(2,"mytranslate"),s.k0s()),2&b){const E=k.$implicit;s.Y8G("value",E.id),s.R7$(1),s.SpI(" ",s.bMT(2,2,E.code)," ")}}function d(b,k){if(1&b&&(s.j41(0,"mat-optgroup",12),s.nI1(1,"mytranslate"),s.DNE(2,l,3,4,"mat-option",13),s.k0s()),2&b){const E=k.$implicit;s.FS9("label",s.bMT(1,2,E.groupName)),s.R7$(2),s.Y8G("ngForOf",E.purposeListInGroup)}}function v(b,k){1&b&&(s.j41(0,"div",15),s.EFF(1),s.nI1(2,"mytranslate"),s.k0s()),2&b&&(s.R7$(1),s.SpI(" ",s.bMT(2,1,"lang_testbank_please_choose_purpose_exam")," "))}function g(b,k){1&b&&(s.j41(0,"div",15),s.EFF(1),s.nI1(2,"mytranslate"),s.k0s()),2&b&&(s.R7$(1),s.SpI(" ",s.bMT(2,1,"lang_testbank_please_enter_purpose_create_exam")," "))}function I(b,k){if(1&b&&(s.j41(0,"div",3)(1,"div",4)(2,"label",16),s.EFF(3),s.nI1(4,"mytranslate"),s.k0s()(),s.j41(5,"div",17),s.nrm(6,"input",18),s.nI1(7,"mytranslate"),s.k0s(),s.DNE(8,g,3,3,"div",10),s.k0s()),2&b){const E=s.XpG();s.R7$(3),s.SpI(" ",s.bMT(4,3,"lang_testbank_enter_create_exam_target")," "),s.R7$(3),s.FS9("placeholder",s.bMT(7,5,"lang_testbank_enter_create_exam_target")+" ..."),s.R7$(2),s.Y8G("ngIf",(4==(null==E.form.controls.purposeExam?null:E.form.controls.purposeExam.value)||8==(null==E.form.controls.purposeExam?null:E.form.controls.purposeExam.value)||12==(null==E.form.controls.purposeExam?null:E.form.controls.purposeExam.value))&&""===(null==E.form.controls.purposeNote||null==E.form.controls.purposeNote.value?null:E.form.controls.purposeNote.value.trim()))}}let m=(()=>{class b extends e.H{convertPurposeList(){this.targetExamGroupObjs=[],this.purposeList.forEach(E=>{const{semester:j}=E;let y=this.targetExamGroupObjs.find(h=>h.semester===j);y||(y={semester:j,groupName:this.getGroupNamePurpose(E.semester??1),purposeListInGroup:[]},this.targetExamGroupObjs.push(y)),y.purposeListInGroup?.push(E)})}getGroupNamePurpose(E){switch(E){case 1:default:return"lang_testbank_semester_one";case 2:return"lang_testbank_semester_two";case 3:return"lang_testbank_another_purpose"}}ngOnInit(){this.convertPurposeList()}constructor(){super(),this.purposeList=[],this.targetExamGroupObjs=[]}static#e=this.\u0275fac=function(j){return new(j||b)};static#t=this.\u0275cmp=s.VBU({type:b,selectors:[["config-purpose-exam"]],inputs:{form:"form",purposeList:"purposeList"},features:[s.Vt3],decls:16,vars:11,consts:[[1,"config-purpose-exan"],[3,"formGroup"],["id","azt-config-purpose-exam",1,"grid","grid-cols-12","gap-5"],[1,"col-span-12"],[1,"font-medium"],[1,"form-label","flex","items-center"],["appearance","outline"],["formControlName","purposeExam","name","purposeExam"],["disabled","",3,"value"],[3,"label",4,"ngFor","ngForOf"],["class","mt-2 text-danger text-xs",4,"ngIf"],["class","col-span-12",4,"ngIf"],[3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mt-2","text-danger","text-xs"],["for","enter_target_create_exam",1,"form-label","flex","items-center"],[1,"setting-input"],["id","enter_target_create_exam","formControlName","purposeNote","type","text",1,"form-control",3,"placeholder"]],template:function(j,y){1&j&&(s.j41(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),s.EFF(6),s.nI1(7,"mytranslate"),s.k0s()(),s.j41(8,"mat-form-field",6)(9,"mat-select",7)(10,"mat-option",8),s.EFF(11),s.nI1(12,"mytranslate"),s.k0s(),s.DNE(13,d,3,4,"mat-optgroup",9),s.k0s()(),s.DNE(14,v,3,3,"div",10),s.k0s(),s.DNE(15,I,9,7,"div",11),s.k0s()()()),2&j&&(s.R7$(1),s.Y8G("formGroup",y.form),s.R7$(5),s.SpI(" ",s.bMT(7,7,"lang_testbank_target_exam")," "),s.R7$(4),s.Y8G("value",0),s.R7$(1),s.SpI("---",s.bMT(12,9,"lang_testbank_choose_purpose"),"---"),s.R7$(2),s.Y8G("ngForOf",y.targetExamGroupObjs),s.R7$(1),s.Y8G("ngIf",0==y.form.controls.purposeExam.value),s.R7$(1),s.Y8G("ngIf",4==(null==y.form.controls.purposeExam?null:y.form.controls.purposeExam.value)||8==(null==y.form.controls.purposeExam?null:y.form.controls.purposeExam.value)||12==(null==y.form.controls.purposeExam?null:y.form.controls.purposeExam.value)))},dependencies:[i.Sq,i.bT,D.wT,D.D7,w.rl,T.VO,u.qT,u.me,u.BC,u.cb,u.j4,u.JD,_.t,p.wp],encapsulation:2})}return b})()},74175:(B,P,a)=>{a.d(P,{W:()=>v});var e=a(47947),s=a(59640),i=a(26860),D=a(10296),w=a(91930),T=a(27691),u=a(54460),_=a(73437);function p(g,I){if(1&g){const m=i.RV6();i.qex(0),i.j41(1,"a",2),i.bIt("click",function(){i.eBV(m);const k=i.XpG();return i.Njj(k.shareFileToFlutter())}),i.j41(2,"span"),i.EFF(3),i.nI1(4,"mytranslate"),i.k0s(),i.SdG(5),i.k0s(),i.bVm()}if(2&g){const m=i.XpG();i.R7$(1),i.Aen(m.style),i.HbH(m.classStyle),i.FS9("target",m.target),i.R7$(2),i.JRh(i.bMT(4,7,m.fileDescription))}}function l(g,I){if(1&g&&(i.j41(0,"a",3)(1,"span"),i.EFF(2),i.nI1(3,"mytranslate"),i.k0s(),i.SdG(4,1),i.k0s()),2&g){const m=i.XpG();i.Aen(m.style),i.HbH(m.classStyle),i.FS9("href",m.dataUrl,i.B4B),i.FS9("target",m.target),i.FS9("download",m.fileName),i.R7$(2),i.JRh(i.bMT(3,9,m.fileDescription))}}const d=["*","*"];let v=(()=>{class g extends s.H{downloadFile(){return this.http.get(this.dataUrl,{responseType:"blob"}).pipe((0,e.T)(m=>m))}shareFileToFlutter(){this.downloadFile().subscribe(m=>{this.shareFileFlutterService.shareFileWithBlob(m,this.fileName)})}ngOnInit(){super.ngOnInit()}constructor(m,b,k){super(),this.shareFileFlutterService=m,this.commonService=b,this.http=k,this.dataUrl="",this.target="",this.fileName="",this.fileDescription="",this.classStyle="",this.style=""}static#e=this.\u0275fac=function(b){return new(b||g)(i.rXU(D.R),i.rXU(w.R),i.rXU(T.Qq))};static#t=this.\u0275cmp=i.VBU({type:g,selectors:[["azt-download-link-item"]],inputs:{dataUrl:"dataUrl",target:"target",fileName:"fileName",fileDescription:"fileDescription",classStyle:"classStyle",style:"style"},features:[i.Vt3],ngContentSelectors:d,decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["NormalWeb",""],[3,"target","click"],[3,"href","target","download"]],template:function(b,k){if(1&b&&(i.NAR(d),i.DNE(0,p,6,9,"ng-container",0),i.DNE(1,l,5,11,"ng-template",null,1,i.C5r)),2&b){const E=i.sdS(2);i.Y8G("ngIf",k.isMobileWebView)("ngIfElse",E)}},dependencies:[u.bT,_.wp],encapsulation:2})}return g})()}}]);