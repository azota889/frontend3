"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[1866],{43166:(w,j,a)=>{a.d(j,{x:()=>c});var u=a(10936),p=a(48891),e=a(62095);let c=(()=>{var d;class m{filter(t,r){return null==t?[]:t=t.filter(l=>this.removeAllSpecialChars((null!=r?l[r]:l).toString()).includes(this.removeAllSpecialChars(this.searchControl.value)))}mergeSchoolLevel(t){let r=[];return t.forEach(l=>null!=l.schoolLevel&&r.push(l.schoolLevel)),r}removeAllSpecialChars(t){return t=(t=this.commonService.myTranslateInstant(t)??t).toLowerCase().trim(),t=this.commonService.convertVietnameseToEnglish(t),t=this.commonService.removeSpecialStringInSearch(t),(t=this.commonService.removeNonAlphabetic(t)).toLowerCase().trim()}constructor(t){this.commonService=t,this.searchControl=new u.MJ("",{nonNullable:!0})}}return(d=m).\u0275fac=function(t){return new(t||d)(p.rXU(e.R))},d.\u0275dir=p.FsC({type:d,selectors:[["","searchInList",""]],exportAs:["searchInList"]}),m})()},50334:(w,j,a)=>{a.d(j,{C:()=>p});var u=a(59640);class p extends u.H{constructor(){super(...arguments),this.nodeObjs=[]}searchByText(c){this.nodeObjs=(c=this.standardSearchText(c)).trim()?this.doSearchByText(c,this.nodeObjs,[]):this.showAndExpandAll(this.nodeObjs)}expand(c){c.isExpand=!0}collapse(c){c.isExpand=!1}doSearchByText(c,d,m){for(var h of d){h.isShow=!1;let t=this.standardSearchText(h.text);(c.includes(t)||t.includes(c))&&(h.isShow=!0,h.isExpand=!0,m.forEach(r=>{r.isShow=!0,r.isExpand=!0})),h.children.length&&(h.children=this.doSearchByText(c,h.children,m.concat(h)))}return d}showAndExpandAll(c){for(var d of c)d.isShow=!0,d.isExpand=!0,d.children=this.showAndExpandAll(d.children);return c}standardSearchText(c){return c=c.toLowerCase(),c=this.commonService.removeSpecialStringInSearch(c),this.commonService.convertVietnameseToEnglish(c)}}},7908:(w,j,a)=>{a.d(j,{n:()=>c});var u=a(48891),p=a(85710),e=a(17776);let c=(()=>{var d;class m{constructor(){this.subscriptions=new p.yU,this.aiElearningService=(0,u.WQX)(e.T5),this.cacheData=[]}getKnowledgeByApi(t,r,l,g,b,S){let C=this.getCacheKey(t,r,l,g),T=this.cacheData.find(f=>f.cacheKey==C);if(null!=T)return b(T.nodes);this.subscriptions.add(this.aiElearningService.aiApiV1ElearningGetKnowledgeTreeGet(t,r,l,g||void 0).subscribe({next:f=>{this.cacheData.push({cacheKey:C,nodes:f.nodes??[]}),b(f.nodes??[])},error:f=>S(f)}))}getObjByObjectiveId(t,r){for(var l of t){if(l.objectiveId==r)return l;let g=this.getObjByObjectiveId(l.children,r);if(null!=g)return g}}getObjById(t,r){for(var l of t){if(l.id==r)return l;let g=this.getObjById(l.children,r);if(null!=g)return g}}getObjByKnowledgeIdOrObjectiveId(t,r,l){for(var g of t){if(g.knowledgeId==r||g.objectiveId==l)return g;let b=this.getObjByKnowledgeIdOrObjectiveId(g.children,r,l);if(null!=b)return b}}getAllObjectiveObjs(t,r){return t.forEach(l=>{l.objectiveId&&r.push({id:l.objectiveId,name:l.title,questionHistories:[]}),l.children.length&&(r=r.concat(this.getAllObjectiveObjs(l.children,[])))}),r}getCacheKey(t,r,l,g){return`${t}_${r}_${l?"true":"false"}_${g??0}`}ngOnDestroy(){this.subscriptions.unsubscribe()}}return(d=m).\u0275fac=function(t){return new(t||d)},d.\u0275prov=u.jDH({token:d,factory:d.\u0275fac,providedIn:"root"}),m})()},98133:(w,j,a)=>{a.d(j,{i:()=>R});var u=a(89163),p=a(33887),e=a(48891),c=a(2915),d=a(32099),m=a(50334),h=a(7908),t=a(54460),r=a(15343),l=a(18718),g=a(76975);const b=n=>({nodeObjs:n}),S=(n,_)=>({"text-pending":n," link-color-hover":_});function C(n,_){if(1&n&&e.nrm(0,"azt-loading-effect",3),2&n){const i=e.XpG();e.Y8G("currentStatusObj",i.statusObj)}}function T(n,_){1&n&&e.eu8(0)}function f(n,_){if(1&n&&(e.j41(0,"table")(1,"tbody"),e.DNE(2,T,1,0,"ng-container",4),e.k0s()()),2&n){const i=e.XpG(),o=e.sdS(4);e.R7$(2),e.Y8G("ngTemplateOutlet",o)("ngTemplateOutletContext",e.eq3(2,b,i.nodeObjs))}}function A(n,_){1&n&&e.nrm(0,"lucide-icon",13)}function E(n,_){1&n&&e.nrm(0,"lucide-icon",14)}function z(n,_){if(1&n&&(e.j41(0,"i"),e.DNE(1,A,1,0,"lucide-icon",11)(2,E,1,0,"lucide-icon",12),e.k0s()),2&n){const i=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",i.isExpand),e.R7$(),e.Y8G("ngIf",!i.isExpand)}}function x(n,_){1&n&&(e.j41(0,"i"),e.nrm(1,"lucide-icon",15),e.k0s())}function D(n,_){1&n&&e.eu8(0)}function y(n,_){if(1&n&&(e.qex(0),e.DNE(1,D,1,0,"ng-container",4),e.bVm()),2&n){const i=e.XpG().$implicit;e.XpG(3);const o=e.sdS(4);e.R7$(),e.Y8G("ngTemplateOutlet",o)("ngTemplateOutletContext",e.eq3(2,b,i.children))}}function B(n,_){if(1&n){const i=e.RV6();e.qex(0),e.j41(1,"tr",7)(2,"td")(3,"div",8),e.bIt("click",function(){const s=e.eBV(i).$implicit,O=e.XpG(3);return e.Njj(O.clickToNode(s))}),e.DNE(4,z,3,2,"i",5)(5,x,2,0,"i",5),e.j41(6,"label",9),e.nrm(7,"span",10),e.nI1(8,"mathJaxContent"),e.nI1(9,"async"),e.nI1(10,"safeContentQuestion"),e.k0s()()()(),e.DNE(11,y,2,4,"ng-container",5),e.bVm()}if(2&n){const i=_.$implicit;e.R7$(),e.Y8G("hidden",!i.isShow),e.R7$(),e.xc7("padding-left",14*(i.level+1),"px"),e.R7$(),e.Y8G("ngClass",e.l_i(14,S,i.isSelected,!i.isSelected)),e.R7$(),e.Y8G("ngIf",i.children.length),e.R7$(),e.Y8G("ngIf",!i.children.length),e.R7$(2),e.Y8G("innerHTML",e.bMT(10,12,e.bMT(9,10,e.bMT(8,8,"L"+(i.level+1)+". "+i.text))),e.npT),e.R7$(4),e.Y8G("ngIf",i.isExpand)}}function k(n,_){if(1&n&&(e.qex(0),e.DNE(1,B,12,17,"ng-container",6),e.bVm()),2&n){const i=_.$implicit;e.R7$(),e.Y8G("ngForOf",i)}}function G(n,_){if(1&n&&e.DNE(0,k,2,1,"ng-container",5),2&n){const i=_.nodeObjs,o=e.XpG();e.Y8G("ngIf",o.asTemplateDataObj(i))}}let L=(()=>{var n;class _ extends m.C{constructor(){super(...arguments),this.allowSelectKnowledgeOrObjective="only_objective",this.selectKnowledgeOrObjectiveEvent=new e.bkB,this.nodeObjs=[],this.sAztKnowledgeObjectiveService=(0,e.WQX)(h.n)}clickToNode(o){return"only_objective"==this.allowSelectKnowledgeOrObjective&&o.data.objectiveId||"knowledge_or_objective"==this.allowSelectKnowledgeOrObjective&&(o.data.knowledgeId||o.data.objectiveId)?this.selectKnowledgeOrObjectiveEvent.emit(o.data):void(o.isExpand?this.collapse(o):this.expand(o))}asTemplateDataObj(o){return o}initData(o,s,O){this.initStatusObj(),this.sAztKnowledgeObjectiveService.getKnowledgeByApi(o,s,!1,O,v=>{this.nodeObjs=this.standardTreeNodes(v,0),this.stopStatusObj()},v=>this.errorStatusObj(v,!0))}standardTreeNodes(o,s){let O=[];return o.forEach(v=>{let I=!1;this.selectedObj?.knowledgeId&&v.knowledgeId==this.selectedObj.knowledgeId&&(I=!0),this.selectedObj?.objectiveId&&v.objectiveId==this.selectedObj.objectiveId&&(I=!0);let K={level:s,typeNode:v.objectiveId?"objective":"knowledge",isExpand:!0,isShow:!0,isSelected:I,text:v.title,data:{...v,children:[]},children:[]};K.children=this.standardTreeNodes(v.children,s+1),O.push(K)}),O}ngOnChanges(o){o.searchContent&&this.searchByText(this.searchContent??"")}ngOnInit(){super.ngOnInit(),this.initData(this.levelId,this.subjectId,this.bookId)}}return(n=_).\u0275fac=(()=>{let i;return function(s){return(i||(i=e.xGo(n)))(s||n)}})(),n.\u0275cmp=e.VBU({type:n,selectors:[["coazt-knowledge-objective-tree"]],inputs:{levelId:"levelId",subjectId:"subjectId",bookId:"bookId",selectedObj:"selectedObj",searchContent:"searchContent",allowSelectKnowledgeOrObjective:"allowSelectKnowledgeOrObjective"},outputs:{selectKnowledgeOrObjectiveEvent:"selectKnowledgeOrObjectiveEvent"},features:[e.Vt3,e.OA$],decls:5,vars:2,consts:[["doneLoading",""],["recursiveListTmpl",""],[3,"currentStatusObj",4,"ngIf","ngIfElse"],[3,"currentStatusObj"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"hidden"],[1,"clickable",3,"click","ngClass"],[1,"form-check-label",2,"line-height","1.5"],[3,"innerHTML"],["name","chevron-down","size","14",4,"ngIf"],["name","chevron-right","size","14",4,"ngIf"],["name","chevron-down","size","14"],["name","chevron-right","size","14"],["name","dot","size","14"]],template:function(o,s){if(1&o&&e.DNE(0,C,1,1,"azt-loading-effect",2)(1,f,3,4,"ng-template",null,0,e.C5r)(3,G,1,1,"ng-template",null,1,e.C5r),2&o){const O=e.sdS(2);e.Y8G("ngIf",s.statusObj.loading)("ngIfElse",O)}},dependencies:[t.YU,t.Sq,t.bT,t.T3,r.WGl,l.K,t.Jj,g.km,g.ep],encapsulation:2}),_})(),R=(()=>{var n;class _ extends p._{searchByText(o){this.searchContent=o}selectKnowledgeOrObjective(o){this.dialogRef.close(o)}btnCloseDialog(){this.dialogRef.close(void 0)}constructor(o,s){super(s,o),this.dialogRef=o,this.data=s}}return(n=_).\u0275fac=function(o){return new(o||n)(e.rXU(u.CP,8),e.rXU(u.Vh,8))},n.\u0275cmp=e.VBU({type:n,selectors:[["coazt-knowledge-objective-dialog"]],features:[e.Vt3],decls:12,vars:14,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"box","p-3"],[1,"pb-3"],[3,"onSearch","isServerSearch","placeholder"],[3,"minHeight"],[3,"selectKnowledgeOrObjectiveEvent","levelId","subjectId","bookId","selectedObj","searchContent","allowSelectKnowledgeOrObjective"],[1,"text-right","border-t","border-slate-200","dark:border-darkmode-400","p-3"],[1,"btn","btn-secondary","w-24",3,"click"]],template:function(o,s){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"azt-search-box",4),e.nI1(5,"mytranslate"),e.bIt("onSearch",function(v){return s.searchByText(v.searchObj)}),e.k0s()(),e.j41(6,"azt-mat-dialog-content",5)(7,"coazt-knowledge-objective-tree",6),e.bIt("selectKnowledgeOrObjectiveEvent",function(v){return s.selectKnowledgeOrObjective(v)}),e.k0s()()(),e.j41(8,"div",7)(9,"button",8),e.bIt("click",function(){return s.btnCloseDialog()}),e.EFF(10),e.nI1(11,"mytranslate"),e.k0s()()()()),2&o&&(e.R7$(4),e.Y8G("isServerSearch",!1)("placeholder",e.bMT(5,10,"lang_common_search_by_name")),e.R7$(2),e.Y8G("minHeight","calc(var(--vh, 1vh) * 100 - 300px)"),e.R7$(),e.Y8G("levelId",s.data.levelId)("subjectId",s.data.subjectId)("bookId",s.data.bookId)("selectedObj",s.data.selectedObj)("searchContent",null==s.searchContent?null:s.searchContent.searchContent)("allowSelectKnowledgeOrObjective",s.data.allowSelectKnowledgeOrObjective),e.R7$(3),e.SpI(" ",e.bMT(11,12,"lang_button_close")," "))},dependencies:[c.U,d.W,L,g.wp],encapsulation:2}),_})()}}]);