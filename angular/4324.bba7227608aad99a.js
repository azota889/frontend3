(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[4324],{32586:(we,it,x)=>{"use strict";x.d(it,{Y:()=>ut});var j=x(59640),Z=x(64198),ct=x(26860);let ut=(()=>{class t extends j.H{constructor(){super(...arguments),this.limitSize=200,this.selectFile=lt=>{const mt=lt.target,at=mt.files;if(at){if(this.limitSize=this.limitSize>200?200:this.limitSize,Array.from(at).find(rt=>(0,Z.hD)(rt.size)>=this.limitSize))return this.showErrorSnack(this.commonService.translateToKeyParam("lang_auto_vui_long_chon_tep_co_kich_thuoc_nho_hon",this.limitSize.toString(),"MB"));const Mt=[];Array.from(at).forEach(rt=>{Mt.push(rt)}),this.emitUploadToEditorComplete(Mt)}mt.value=""}}static#t=this.\u0275fac=function(){let lt;return function(at){return(lt||(lt=ct.xGo(t)))(at||t)}}();static#e=this.\u0275cmp=ct.VBU({type:t,selectors:[["ng-component"]],inputs:{fileType:"fileType",limitSize:"limitSize"},features:[ct.Vt3],decls:0,vars:0,template:function(mt,at){},encapsulation:2})}return t})()},64324:(we,it,x)=>{"use strict";x.r(it),x.d(it,{AzotaDigitalizeModule:()=>Ge});var j=x(54460),Z=x(10936),ct=x(65162),ut=x(69223),t=x(26860),Zt=x(17715);const lt=["image"];function mt(s,w){1&s&&(t.j41(0,"div",6),t.nrm(1,"div",7),t.k0s())}function at(s,w){if(1&s&&(t.j41(0,"div",8),t.EFF(1),t.k0s()),2&s){const o=t.XpG();t.R7$(1),t.JRh(o.loadImageErrorText)}}let Mt=(()=>{class s{constructor(){this.cropperOptions={},this.export=new t.bkB,this.ready=new t.bkB,this.isLoading=!0}ngOnInit(){}ngOnDestroy(){this.cropper&&(this.cropper.destroy(),this.cropper=null)}imageLoaded(o){this.loadError=!1;const h=o.target;this.imageElement=h,this.cropperOptions.checkCrossOrigin&&(h.crossOrigin="anonymous"),h.addEventListener("ready",()=>{this.ready.emit(!0),this.isLoading=!1,this.cropbox&&this.cropper.setCropBoxData(this.cropbox)});let p=NaN;if(this.settings){const{width:f,height:y}=this.settings;p=f/y}this.cropperOptions={aspectRatio:p,checkCrossOrigin:!0,...this.cropperOptions},this.cropper&&(this.cropper.destroy(),this.cropper=void 0),this.cropper=new Zt(h,this.cropperOptions)}imageLoadError(o){this.loadError=!0,this.isLoading=!1}exportCanvas(o){const h=this.cropper.getImageData(),p=this.cropper.getCropBoxData(),f=this.cropper.getCroppedCanvas(),y={imageData:h,cropData:p};new Promise(I=>{if(o)return I({dataUrl:f.toDataURL("image/png")});f.toBlob(J=>I({blob:J}))}).then(I=>{this.export.emit({...y,...I})})}}return s.\u0275fac=function(o){return new(o||s)},s.\u0275cmp=t.VBU({type:s,selectors:[["angular-cropper"]],viewQuery:function(o,h){if(1&o&&t.GBs(lt,7),2&o){let p;t.mGM(p=t.lsd())&&(h.image=p.first)}},inputs:{imageUrl:"imageUrl",settings:"settings",cropbox:"cropbox",loadImageErrorText:"loadImageErrorText",cropperOptions:"cropperOptions"},outputs:{export:"export",ready:"ready"},decls:6,vars:3,consts:[[1,"cropper-wrapper"],["class","loading-block",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"cropper"],["alt","image",3,"src","load","error"],["image",""],[1,"loading-block"],[1,"spinner"],[1,"alert","alert-warning"]],template:function(o,h){1&o&&(t.j41(0,"div",0),t.DNE(1,mt,2,0,"div",1),t.DNE(2,at,2,1,"div",2),t.j41(3,"div",3)(4,"img",4,5),t.bIt("load",function(f){return h.imageLoaded(f)})("error",function(f){return h.imageLoadError(f)}),t.k0s()()()),2&o&&(t.R7$(1),t.Y8G("ngIf",h.isLoading),t.R7$(1),t.Y8G("ngIf",h.loadError),t.R7$(2),t.Y8G("src",h.imageUrl,t.B4B))},dependencies:[j.bT],styles:[':host{display:block}.cropper img{max-width:100%;max-height:100%;height:auto}.cropper-wrapper{position:relative;min-height:80px}.cropper-wrapper .loading-block{position:absolute;top:0;left:0;width:100%;height:100%}.cropper-wrapper .loading-block .spinner{width:31px;height:31px;margin:0 auto;border:2px solid rgba(97,100,193,.98);border-radius:50%;border-left-color:transparent;border-right-color:transparent;-webkit-animation:cssload-spin 425ms infinite linear;position:absolute;top:calc(50% - 15px);left:calc(50% - 15px);animation:cssload-spin 425ms infinite linear}@keyframes cssload-spin{to{transform:rotate(360deg)}}/*!\n * Cropper.js v1.4.1\n * https://fengyuanchen.github.io/cropperjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2018-07-15T09:54:43.167Z\n */.cropper-container{direction:ltr;font-size:0;line-height:0;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.cropper-container img{display:block;height:100%;image-orientation:0deg;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;width:100%}.cropper-wrap-box,.cropper-canvas,.cropper-drag-box,.cropper-crop-box,.cropper-modal{inset:0;position:absolute}.cropper-wrap-box,.cropper-canvas{overflow:hidden}.cropper-drag-box{background-color:#fff;opacity:0}.cropper-modal{background-color:#000;opacity:.5}.cropper-view-box{display:block;height:100%;outline-color:#3399ffbf;outline:1px solid #39f;overflow:hidden;width:100%}.cropper-dashed{border:0 dashed #eee;display:block;opacity:.5;position:absolute}.cropper-dashed.dashed-h{border-bottom-width:1px;border-top-width:1px;height:calc(100% / 3);left:0;top:calc(100% / 3);width:100%}.cropper-dashed.dashed-v{border-left-width:1px;border-right-width:1px;height:100%;left:calc(100% / 3);top:0;width:calc(100% / 3)}.cropper-center{display:block;height:0;left:50%;opacity:.75;position:absolute;top:50%;width:0}.cropper-center:before,.cropper-center:after{background-color:#eee;content:" ";display:block;position:absolute}.cropper-center:before{height:1px;left:-3px;top:0;width:7px}.cropper-center:after{height:7px;left:0;top:-3px;width:1px}.cropper-face,.cropper-line,.cropper-point{display:block;height:100%;opacity:.1;position:absolute;width:100%}.cropper-face{background-color:#fff;left:0;top:0}.cropper-line{background-color:#39f}.cropper-line.line-e{cursor:ew-resize;right:-3px;top:0;width:5px}.cropper-line.line-n{cursor:ns-resize;height:5px;left:0;top:-3px}.cropper-line.line-w{cursor:ew-resize;left:-3px;top:0;width:5px}.cropper-line.line-s{bottom:-3px;cursor:ns-resize;height:5px;left:0}.cropper-point{background-color:#39f;height:5px;opacity:.75;width:5px}.cropper-point.point-e{cursor:ew-resize;margin-top:-3px;right:-3px;top:50%}.cropper-point.point-n{cursor:ns-resize;left:50%;margin-left:-3px;top:-3px}.cropper-point.point-w{cursor:ew-resize;left:-3px;margin-top:-3px;top:50%}.cropper-point.point-s{bottom:-3px;cursor:s-resize;left:50%;margin-left:-3px}.cropper-point.point-ne{cursor:nesw-resize;right:-3px;top:-3px}.cropper-point.point-nw{cursor:nwse-resize;left:-3px;top:-3px}.cropper-point.point-sw{bottom:-3px;cursor:nesw-resize;left:-3px}.cropper-point.point-se{bottom:-3px;cursor:nwse-resize;height:20px;opacity:1;right:-3px;width:20px}@media (min-width: 768px){.cropper-point.point-se{height:15px;width:15px}}@media (min-width: 992px){.cropper-point.point-se{height:10px;width:10px}}@media (min-width: 1200px){.cropper-point.point-se{height:5px;opacity:.75;width:5px}}.cropper-point.point-se:before{background-color:#39f;bottom:-50%;content:" ";display:block;height:200%;opacity:0;position:absolute;right:-50%;width:200%}.cropper-invisible{opacity:0}.cropper-bg{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC)}.cropper-hide{display:block;height:0;position:absolute;width:0}.cropper-hidden{display:none!important}.cropper-move{cursor:move}.cropper-crop{cursor:crosshair}.cropper-disabled .cropper-drag-box,.cropper-disabled .cropper-face,.cropper-disabled .cropper-line,.cropper-disabled .cropper-point{cursor:not-allowed}\n'],encapsulation:2}),s})(),rt=(()=>{class s{}return s.\u0275fac=function(o){return new(o||s)},s.\u0275mod=t.$C({type:s}),s.\u0275inj=t.G2t({imports:[j.MD]}),s})();var V=x(15343),Bt=x(10123),Ct=x(5502),T=x(46584),Nt=x(70050),qt=x(7050),te=x(91100),Pt=x(43234),ht=x(1133),W=x(59640),q=x(73014),ot=x(85710),L=x(73437),Ot=x(91930),Dt=x(5849);let ft=(()=>{class s{constructor(){this.subscriptions=new ot.yU,this.ocrService=(0,t.WQX)(Dt.so),this.commonService=(0,t.WQX)(Ot.R)}digitalizeData(o,h,p,f){if(!o.image.url)return f(o);h("lang_digitalize_call_ocr_api"),this.subscriptions.add(this.ocrService.aiApiV1OcrImageToTextPost({imageUrl:o.image.url}).subscribe({next:y=>{h("lang_digitalize_load_detect_image_script"),this.loadScriptHandleImage(()=>{h("lang_digitalize_call_detect_image_function"),this.imageUtils.detectImage(o.image.fileBytes).then(E=>{o.image.base64Images=E.images.map(N=>({base64:this.uint8ArrayToBase64(new Uint8Array(N.content)),width:N.width,height:N.height,extension:N.extension}));let I=y.data,J={};[I,J]=this.commonService.extractOriginDataOfLatex(I),I=(new L.bt).transform((new L.UN).transform(y.data)),I=this.commonService.replaceBackToOriginDataOfLatex(I,J),I=this.commonService.convertLatexTagToDollarDollar(I),I=this.commonService.replaceAll(I,"<table>","<table class='table table-bordered'>")??I,o.htmlResult=I,f(o)}).catch(E=>p("lang_digitalize_error_when_call_detect_image"))})},error:y=>p(y.error.message)}))}uint8ArrayToBase64(o){let h="";const p=o.byteLength;for(let f=0;f<p;f++)h+=String.fromCharCode(o[f]);return btoa(h)}waitAnswerSheetInitDone(o){if(window.azotaScanAnswerSheet)return o();setTimeout(()=>{this.waitAnswerSheetInitDone(o)},100)}loadScriptHandleImage(o){var h=this;if(this.imageUtils)return o();this.commonService.loadAnswerSheetJs().then((0,q.A)(function*(){h.waitAnswerSheetInitDone((0,q.A)(function*(){h.imageUtils=yield window.azotaScanAnswerSheet.imageUtils(),o()}))})).catch(p=>{this.commonService.snackError("lang_auto_tai_thu_vien_that_bao_vui_long_load_lai_trang_de_thu_lai"),o()})}ngOnDestroy(){this.subscriptions.unsubscribe()}static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var U=function(s){return s[s.NONE=0]="NONE",s[s.PROCESSING=1]="PROCESSING",s[s.PROCESS_ERROR=2]="PROCESS_ERROR",s[s.PROCESSED=3]="PROCESSED",s}(U||{}),vt=function(s){return s[s.CHOOSE_IMAGES=0]="CHOOSE_IMAGES",s[s.PROCESS_IMAGES=1]="PROCESS_IMAGES",s}(vt||{}),Y=x(18718),ee=x(96451),xe=x(64198),_t=x(39712),Gt=x(63709),Et=x(14159),Rt=x(27035),Lt=x(17178),ie=x(63016),Ft=x(47947),Yt=x(20036),jt=x(15351);const Ut=(s,w)=>(s.push(w),s);let Ce=(()=>{class s{processObservables(o,h){return(0,Et.H)(h).pipe((0,Rt.Z)((p,f)=>p.pipe((0,Lt.W)(y=>(console.error("Error in observable:",y),(0,ie.of)(null))),(0,Ft.T)(y=>({result:y,index:f}))),o),function ae(){return(0,jt.N)((s,w)=>{(function Xt(s,w){return(0,jt.N)((0,Yt.S)(s,w,arguments.length>=2,!1,!0))})(Ut,[])(s).subscribe(w)})}(),(0,Ft.T)(p=>p.sort((f,y)=>f.index-y.index).map(f=>f.result)))}static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var Oe=x(41426),De=x(32586),re=x(34068);const oe=["*"];let ne=(()=>{class s extends De.Y{constructor(){super(...arguments),this.emitFiles=new t.bkB}emitUploadToEditorComplete(o){o.length>0&&this.emitFiles.emit(o)}onDrop(o){try{this.emitFiles.emit(o)}catch(h){alert(h)}}static#t=this.\u0275fac=function(){let o;return function(p){return(o||(o=t.xGo(s)))(p||s)}}();static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["azt-upload-multiple-document-to-editor"]],outputs:{emitFiles:"emitFiles"},features:[t.Vt3],ngContentSelectors:oe,decls:5,vars:2,consts:[[1,"upload-document","h-full",3,"appDropZone","click"],[3,"hidden"],["type","file","multiple","",1,"form-control","file-input",3,"accept","change"],["fileSelect",""]],template:function(h,p){if(1&h){const f=t.RV6();t.NAR(),t.j41(0,"div",0),t.bIt("appDropZone",function(E){return p.onDrop(E)})("click",function(){t.eBV(f);const E=t.sdS(3);return t.Njj(E.click())}),t.j41(1,"form",1)(2,"input",2,3),t.bIt("change",function(E){return p.selectFile(E)}),t.k0s()(),t.SdG(4),t.k0s()}2&h&&(t.R7$(1),t.Y8G("hidden",!0),t.R7$(1),t.FS9("accept",p.fileType))},dependencies:[Z.qT,Z.cb,Z.cV,re.F],encapsulation:2})}return s})();function se(s,w){if(1&s&&t.nrm(0,"azt-loading-effect",2),2&s){const o=t.XpG();t.Y8G("currentStatusObj",o.statusObj)("customText",o.statusObj.errorMessage)}}const ce=function(s,w){return[s,w]},le=function(){return{"mr-2":!0}};function Vt(s,w){if(1&s){const o=t.RV6();t.j41(0,"azt-upload-multiple-document-to-editor",3),t.bIt("emitFiles",function(p){t.eBV(o);const f=t.XpG();return t.Njj(f.handleUploadComplete(p))}),t.j41(1,"a",4),t.nrm(2,"lucide-icon",5),t.j41(3,"span"),t.EFF(4),t.nI1(5,"mytranslate"),t.k0s()()()}if(2&s){const o=t.XpG();t.Y8G("fileType",t.l_i(5,ce,o.allUploadFileTypes.PDF,o.allUploadFileTypes.IMAGE)),t.R7$(2),t.Y8G("ngClass",t.lJ4(8,le)),t.R7$(2),t.JRh(t.bMT(5,3,"lang_digitalize_book_upload_file"))}}let he=(()=>{class s extends W.H{handleUploadComplete(o){this.initStatusObj("lang_digitalize_convert_pdf_to_images"),this.convertAllPdfToImages(o).then(h=>{let p=[];h.forEach(f=>{let y=this.apiUploadService.commonUploadFile(this.allUploadToCdnMenuTypes.ADMIN_DIGITALIZE,f,"");p.push(y)}),this.initStatusObj("lang_digitalize_upload_images_to_cdn"),this.sAztConcurrencyApiService.processObservables(this.uploadThread,p).subscribe(f=>{if(f.find(N=>!N?.success))return this.errorStatusObj("lang_digitalize_book_upload_file_error",!0);let E=[],I=f.map(N=>N?.data).filter(this.commonService.notEmpty),J=h.map(N=>this.convertFileToUint8Array(N));this.initStatusObj("lang_digitalize_convert_file_to_byte_array"),Promise.all(J).then(N=>{I.forEach((_e,Kt)=>{let be=this.commonService.getItemAtIndexOfArray(N,Kt);if(null==be)throw Error("lang_digitalize_missing_file_byte_array");E.push({..._e,fileBytes:be,base64Images:[]})}),this.stopStatusObj(),this.uploadData.emit(E)}).catch(N=>console.error("lang_digitalize_convert_to_uint8_array_error: ",N))})})}convertAllPdfToImages(o){var h=this;let p=[];return o.forEach(f=>{if((0,xe.wu)(f.type))return void p.push(new Promise(function(){var E=(0,q.A)(function*(I,J){I([f])});return function(I,J){return E.apply(this,arguments)}}()));let y=new Promise(function(){var E=(0,q.A)(function*(I,J){let N=[],Kt=yield h.withTimeout(h.myPdfService.getImageWithPdf(f),3e5);N.push(...Kt),I(N)});return function(I,J){return E.apply(this,arguments)}}());p.push(y)}),new Promise(function(){var f=(0,q.A)(function*(y,E){Promise.all(p).then(I=>{y(h.commonService.concatMultipleArray(I))}).catch(I=>{h.showErrorSnack("lang_azt_pdf_invalid_format"),y([])})});return function(y,E){return f.apply(this,arguments)}}())}withTimeout(o,h){return new Promise((p,f)=>{const y=setTimeout(()=>{f(new Error("Operation timed out"))},h);o.then(E=>{clearTimeout(y),p(E)}).catch(E=>{clearTimeout(y),f(E)})})}convertFileToUint8Array(o){return new Promise((h,p)=>{const f=new FileReader;f.onload=()=>{if(f.result instanceof ArrayBuffer){const y=new Uint8Array(f.result);h(y)}else p(new Error("Error reading file as ArrayBuffer."))},f.onerror=()=>{p(new Error("Error reading file."))},f.readAsArrayBuffer(o)})}ngOnInit(){super.ngOnInit()}constructor(o,h,p){super(),this.myPdfService=o,this.sAztConcurrencyApiService=h,this.apiUploadService=p,this.uploadData=new t.bkB,this.allUploadToCdnMenuTypes=_t.b8,this.allUploadFileTypes=_t.PO,this.uploadThread=10}static#t=this.\u0275fac=function(h){return new(h||s)(t.rXU(Gt.C),t.rXU(Ce),t.rXU(Oe.T))};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digitalize-pdf-to-images"]],outputs:{uploadData:"uploadData"},features:[t.Vt3],decls:3,vars:2,consts:[[3,"currentStatusObj","customText",4,"ngIf","ngIfElse"],["doneLoading",""],[3,"currentStatusObj","customText"],[3,"fileType","emitFiles"],[1,"btn","btn-primary-soft","w-full"],["name","plus","size","16",3,"ngClass"]],template:function(h,p){if(1&h&&(t.DNE(0,se,1,2,"azt-loading-effect",0),t.DNE(1,Vt,6,9,"ng-template",null,1,t.C5r)),2&h){const f=t.sdS(2);t.Y8G("ngIf",p.statusObj.loading)("ngIfElse",f)}},dependencies:[j.YU,j.bT,Y.K,ne,V.WGl,L.wp],encapsulation:2})}return s})();const Ee=function(s){return{"mb-2":s}},Se=function(s){return{"border-pending":s}};function Ae(s,w){if(1&s){const o=t.RV6();t.j41(0,"div",4)(1,"span",5),t.EFF(2),t.k0s(),t.j41(3,"img",6),t.bIt("click",function(){const f=t.eBV(o).$implicit,y=t.XpG();return t.Njj(y.chooseImageEvent(f))}),t.k0s()()}if(2&s){const o=w.$implicit,h=w.last,p=t.XpG();t.Y8G("ngClass",t.eq3(4,Ee,!h)),t.R7$(2),t.JRh(o.position),t.R7$(1),t.Y8G("src",o.image.url,t.B4B)("ngClass",t.eq3(6,Se,p.listSelectedPositions.includes(o.position)))}}let Ie=(()=>{class s extends W.H{chooseImageEvent(o){let h=this.objs.find(p=>p.position==o.position);h&&(h.isSelected=!h.isSelected,this.listSelectedPositions=this.objs.filter(p=>p.isSelected).map(p=>p.position),this.chooseImages.emit(this.objs.filter(p=>p.isSelected)))}ngOnInit(){super.ngOnInit(),this.listSelectedPositions=this.objs.filter(o=>o.isSelected).map(o=>o.position)}constructor(){super(),this.chooseImages=new t.bkB,this.listSelectedPositions=[]}static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digitalize-choose-images"]],inputs:{objs:"objs"},outputs:{chooseImages:"chooseImages"},features:[t.Vt3],decls:6,vars:6,consts:[[2,"height","60vh","margin-bottom","30px"],[1,"pb-2"],["track","vertical","pointerEventsMethod","scrollbar",1,"w-full",3,"visibility"],["class","relative",3,"ngClass",4,"ngFor","ngForOf"],[1,"relative",3,"ngClass"],[1,"text-pending","font-medium","absolute","right-0","mr-2","pt-1"],[1,"w-full","clickable","mb-1","border-gray",3,"src","ngClass","click"]],template:function(h,p){1&h&&(t.j41(0,"div",0)(1,"div",1),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s(),t.j41(4,"ng-scrollbar",2),t.DNE(5,Ae,4,8,"div",3),t.k0s()()),2&h&&(t.R7$(2),t.Lme("",t.bMT(3,4,"lang_digitalize_book_total_page"),": ",p.objs.length,""),t.R7$(2),t.Y8G("visibility","hover"),t.R7$(1),t.Y8G("ngForOf",p.objs))},dependencies:[j.YU,j.Sq,Ct.Yh,L.wp],encapsulation:2})}return s})();const pe=function(s){return{"mb-2":s}},de=function(s){return{"border-pending":s}};function ge(s,w){if(1&s){const o=t.RV6();t.j41(0,"div",4)(1,"span",5),t.EFF(2),t.k0s(),t.j41(3,"img",6),t.bIt("click",function(){const f=t.eBV(o).$implicit,y=t.XpG();return t.Njj(y.processImage.emit(f))}),t.k0s()()}if(2&s){const o=w.$implicit,h=w.last,p=t.XpG();t.Y8G("ngClass",t.eq3(4,pe,!h)),t.R7$(2),t.JRh(o.position),t.R7$(1),t.Y8G("src",o.image.url,t.B4B)("ngClass",t.eq3(6,de,(null==p.currentObj?null:p.currentObj.position)==o.position))}}let Te=(()=>{class s extends W.H{ngOnInit(){super.ngOnInit(),this.viewObjs=this.objs.filter(o=>o.isSelected)}constructor(){super(),this.processImage=new t.bkB,this.viewObjs=[]}static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digitalize-process-images"]],inputs:{objs:"objs",currentObj:"currentObj"},outputs:{processImage:"processImage"},features:[t.Vt3],decls:6,vars:6,consts:[[2,"height","60vh","margin-bottom","30px"],[1,"pb-2"],["track","vertical","pointerEventsMethod","scrollbar",1,"w-full",3,"visibility"],["class","relative",3,"ngClass",4,"ngFor","ngForOf"],[1,"relative",3,"ngClass"],[1,"text-pending","font-medium","absolute","right-0","mr-2","pt-1"],[1,"w-full","clickable","mb-1","border-gray",3,"src","ngClass","click"]],template:function(h,p){1&h&&(t.j41(0,"div",0)(1,"div",1),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s(),t.j41(4,"ng-scrollbar",2),t.DNE(5,ge,4,8,"div",3),t.k0s()()),2&h&&(t.R7$(2),t.Lme("",t.bMT(3,4,"lang_digitalize_book_total_page"),": ",p.viewObjs.length,""),t.R7$(2),t.Y8G("visibility","hover"),t.R7$(1),t.Y8G("ngForOf",p.viewObjs))},dependencies:[j.YU,j.Sq,Ct.Yh,L.wp],encapsulation:2})}return s})();var ze=x(46899),C=x(70254),$t=x(89163),Ht=x(33887);const pt=["angularCropper"];function Me(s,w){if(1&s){const o=t.RV6();t.qex(0),t.j41(1,"img",9),t.bIt("click",function(){const f=t.eBV(o).$implicit,y=t.XpG(2);return t.Njj(y.chooseImage(f))}),t.nI1(2,"addBase64Extension"),t.k0s(),t.bVm()}if(2&s){const o=w.$implicit;t.R7$(1),t.FS9("src",t.i5U(2,1,o.base64,"png"),t.B4B)}}function bt(s,w){if(1&s&&(t.j41(0,"div",7),t.DNE(1,Me,3,4,"ng-container",8),t.k0s()),2&s){const o=t.XpG();t.R7$(1),t.Y8G("ngForOf",o.base64Images)}}function X(s,w){if(1&s&&(t.nrm(0,"angular-cropper",10,11),t.nI1(2,"addBase64Extension")),2&s){const o=t.XpG();t.Y8G("cropperOptions",o.cropperOptions)("imageUrl",t.i5U(2,2,o.currentBase64Image.base64,"png"))}}let Re=(()=>{class s extends Ht._{chooseImage(o){this.currentBase64Image=o}cropImage(){this.angularCropper?.cropper.getCroppedCanvas().toBlob(o=>{o&&this.commonService.convertBlobToBase64(o,h=>{let p=this.angularCropper?.cropper.getCropBoxData(),f=p?.width,y=p?.height;!f||!y||this.base64Images.push({position:this.base64Images.length,base64:h,width:f,height:y,extension:"png"})})})}closeDialog(){this.dialogRef.close(this.base64Images)}constructor(o,h){super(h,o),this.dialogRef=o,this.data=h,this.base64Images=[],this.cropperOptions={movable:!0,scalable:!1,zoomable:!1,data:{width:240,height:90}},this.base64Images=h.base64Images,this.currentBase64Image=this.commonService.getFirstOfArray(this.base64Images)}static#t=this.\u0275fac=function(h){return new(h||s)(t.rXU($t.CP,8),t.rXU($t.Vh,8))};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-coazt-image-editor"]],viewQuery:function(h,p){if(1&h&&t.GBs(pt,5),2&h){let f;t.mGM(f=t.lsd())&&(p.angularCropper=f.first)}},features:[t.Vt3],decls:11,vars:8,consts:[[1,"box","p-3"],["class","list-base640-images mb-3",4,"ngIf"],[1,"text-center","mb-3"],[1,"btn","btn-primary","mr-2","w-32",3,"click"],[1,"btn","btn-secondary","mr-2","w-32",3,"click"],[2,"height","calc(100vh - 120px)","overflow-x","hidden","overflow-y","scroll"],[3,"cropperOptions","imageUrl",4,"ngIf"],[1,"list-base640-images","mb-3"],[4,"ngFor","ngForOf"],[1,"box","mr-2","mb-2","clickable",3,"src","click"],[3,"cropperOptions","imageUrl"],["angularCropper",""]],template:function(h,p){1&h&&(t.j41(0,"div",0),t.DNE(1,bt,2,1,"div",1),t.j41(2,"div",2)(3,"span",3),t.bIt("click",function(){return p.cropImage()}),t.EFF(4),t.nI1(5,"mytranslate"),t.k0s(),t.j41(6,"span",4),t.bIt("click",function(){return p.closeDialog()}),t.EFF(7),t.nI1(8,"mytranslate"),t.k0s()(),t.j41(9,"div",5),t.DNE(10,X,3,5,"angular-cropper",6),t.k0s()()),2&h&&(t.R7$(1),t.Y8G("ngIf",p.base64Images.length>0),t.R7$(3),t.JRh(t.bMT(5,4,"lang_button_crop")),t.R7$(3),t.JRh(t.bMT(8,6,"lang_button_close")),t.R7$(3),t.Y8G("ngIf",p.currentBase64Image))},dependencies:[j.Sq,j.bT,Mt,L.wp,L.t4],styles:[".list-base640-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ccc;height:50px;width:50px}"]})}return s})();function ue(s,w){if(1&s){const o=t.RV6();t.qex(0),t.j41(1,"img",11),t.bIt("click",function(){const f=t.eBV(o).$implicit,y=t.XpG(2);return t.Njj(y.chooseImage(f))}),t.nI1(2,"addBase64Extension"),t.k0s(),t.bVm()}if(2&s){const o=w.$implicit;t.R7$(1),t.FS9("src",t.i5U(2,1,o.base64,o.extension),t.B4B)}}function R(s,w){if(1&s&&(t.j41(0,"div",9),t.DNE(1,ue,3,4,"ng-container",10),t.k0s()),2&s){const o=t.XpG();t.R7$(1),t.Y8G("ngForOf",o.obj.image.base64Images)}}let z=(()=>{class s extends W.H{constructor(){super(...arguments),this.changeObj=new t.bkB,this.sAztDialogService=(0,t.WQX)(ze.i),this.tinyMceService=(0,t.WQX)(C.f),this.sAztDigitalizeService=(0,t.WQX)(ft),this.htmlFormControl=new Z.MJ("",{nonNullable:!0}),this.initDataEditor={},this.tinyEditorKey=Pt.c.tinyEditorKey,this.showTinyMceEditor=!1}chooseImage(o){this.obj.htmlResult=this.obj.htmlResult.replace("<img>",`<img src='${this.commonService.generateBase64Prefix(o.extension)+o.base64}'/>`),this.htmlFormControl.setValue(this.obj.htmlResult)}cropImageDialog(){let o=[{position:-1,base64:this.sAztDigitalizeService.uint8ArrayToBase64(new Uint8Array(this.obj.image.fileBytes)),width:100,height:100,extension:"png"}],h=this.obj.image.base64Images.map((f,y)=>({...f,position:y}));o=o.concat(h),this.sAztDialogService.open(Re,{data:{base64Images:o},restoreFocus:!1,width:"100vw",maxWidth:"100vw",height:"100vh",backdropClass:"azt-backdrop-full-width-height",disableClose:!0}).afterClosed().subscribe(f=>{null!=f&&(this.obj.image.base64Images=f.slice(1),this.changeObj.emit(this.obj))})}ngOnChanges(){this.htmlFormControl.setValue(this.obj.htmlResult)}ngOnInit(){this.htmlFormControl.setValue(this.obj.htmlResult),this.htmlFormControl.valueChanges.subscribe(()=>{this.obj.htmlResult=this.htmlFormControl.getRawValue(),this.changeObj.emit(this.obj)}),this.initDataEditor=this.tinyMceService.initConfigForAdminForDigitalized(_t.b8.ADMIN)}static#t=this.\u0275fac=function(){let o;return function(p){return(o||(o=t.xGo(s)))(p||s)}}();static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digitalize-preview-result"]],inputs:{obj:"obj"},outputs:{changeObj:"changeObj"},features:[t.Vt3,t.OA$],decls:14,vars:15,consts:[["class","box p-3 mb-3 list-base640-images",4,"ngIf"],[1,"mb-3"],[1,"btn","btn-primary","w-32",3,"click"],[1,"grid","grid-cols-12","gap-5"],[1,"col-span-12"],[1,"box","p-3"],[3,"formControl","apiKey","init"],[1,"mt-8","mb-8"],[3,"innerHTML"],[1,"box","p-3","mb-3","list-base640-images"],[4,"ngFor","ngForOf"],[1,"box","mr-2","mb-2","clickable",3,"src","click"]],template:function(h,p){1&h&&(t.DNE(0,R,2,1,"div",0),t.j41(1,"div",1)(2,"span",2),t.bIt("click",function(){return p.cropImageDialog()}),t.EFF(3),t.nI1(4,"mytranslate"),t.k0s()(),t.j41(5,"div",3)(6,"div",4)(7,"div",5),t.nrm(8,"editor",6)(9,"hr",7)(10,"div",8),t.nI1(11,"safeNormalHtmlContent"),t.nI1(12,"async"),t.nI1(13,"mathJaxContent"),t.k0s()()()),2&h&&(t.Y8G("ngIf",p.obj.image.base64Images.length>0),t.R7$(3),t.JRh(t.bMT(4,7,"lang_button_crop")),t.R7$(5),t.FS9("apiKey",p.tinyEditorKey),t.Y8G("formControl",p.htmlFormControl)("init",p.initDataEditor),t.BMQ("style","width: 100%;min-height:500px;",t.$dS),t.R7$(2),t.Y8G("innerHTML",t.bMT(11,9,t.bMT(12,11,t.bMT(13,13,p.obj.htmlResult))),t.npT))},dependencies:[j.Sq,j.bT,Z.BC,ut.xn,Z.l_,j.Jj,L.wp,L.km,L._y,L.t4],styles:[".list-base640-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ccc;width:200px}"]})}return s})();function je(s,w){if(1&s&&t.nrm(0,"azt-loading-effect",4),2&s){const o=t.XpG();t.Y8G("currentStatusObj",o.statusObj)}}function yt(s,w){if(1&s){const o=t.RV6();t.j41(0,"app-digitalize-pdf-to-images",16),t.bIt("uploadData",function(p){t.eBV(o);const f=t.XpG(2);return t.Njj(f.uploadData(p))}),t.k0s()}}function ke(s,w){if(1&s){const o=t.RV6();t.j41(0,"div",17),t.bIt("click",function(){t.eBV(o);const p=t.XpG(2);return t.Njj(p.showChooseLayout())}),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()}2&s&&(t.R7$(1),t.JRh(t.bMT(2,1,"lang_digitalize_book_go_back_choose_layout")))}function nt(s,w){if(1&s){const o=t.RV6();t.j41(0,"app-digitalize-choose-images",21),t.bIt("chooseImages",function(p){t.eBV(o);const f=t.XpG(3);return t.Njj(f.chooseImages(p))}),t.k0s()}if(2&s){const o=t.XpG(3);t.Y8G("objs",o.objs)}}function Be(s,w){if(1&s){const o=t.RV6();t.j41(0,"app-digitalize-process-images",22),t.bIt("processImage",function(p){t.eBV(o);const f=t.XpG(3);return t.Njj(f.processImage(p))}),t.k0s()}if(2&s){const o=t.XpG(3);t.Y8G("objs",o.objs)("currentObj",o.currentObj)}}function k(s,w){if(1&s&&(t.j41(0,"div",18),t.DNE(1,nt,1,1,"app-digitalize-choose-images",19),t.DNE(2,Be,1,2,"app-digitalize-process-images",20),t.k0s()),2&s){const o=t.XpG(2);t.R7$(1),t.Y8G("ngIf",o.currentLayout==o.allLayouts.CHOOSE_IMAGES),t.R7$(1),t.Y8G("ngIf",o.currentLayout==o.allLayouts.PROCESS_IMAGES)}}function tt(s,w){if(1&s){const o=t.RV6();t.j41(0,"div")(1,"div",12),t.bIt("click",function(){t.eBV(o);const p=t.XpG(3);return t.Njj(p.startProcess())}),t.EFF(2),t.nI1(3,"mytranslate"),t.nI1(4,"mytranslate"),t.k0s()()}if(2&s){const o=t.XpG(3);t.R7$(2),t.E5c("",t.bMT(3,3,"lang_digitalize_book_start_call_orc_api")," (",o.totalSelected," ",t.bMT(4,5,"lang_digitalize_book_total_images"),")")}}function wt(s,w){1&s&&(t.EFF(0),t.nI1(1,"mytranslate")),2&s&&t.SpI(" ",t.bMT(1,1,"lang_digitalize_book_please_choose_image")," ")}function Ne(s,w){if(1&s&&(t.qex(0),t.j41(1,"div",18),t.DNE(2,tt,5,7,"div",23),t.DNE(3,wt,2,3,"ng-template",null,24,t.C5r),t.k0s(),t.bVm()),2&s){const o=t.sdS(4),h=t.XpG(2);t.R7$(2),t.Y8G("ngIf",h.totalSelected>0)("ngIfElse",o)}}function Wt(s,w){if(1&s){const o=t.RV6();t.j41(0,"div")(1,"span",25),t.bIt("click",function(){t.eBV(o);const p=t.XpG(4);return t.Njj(p.processAgain())}),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s()()}2&s&&(t.R7$(2),t.JRh(t.bMT(3,1,"lang_digitalize_book_call_ocr_again")))}function Qt(s,w){if(1&s){const o=t.RV6();t.j41(0,"div")(1,"app-digitalize-preview-result",26),t.bIt("changeObj",function(p){t.eBV(o);const f=t.XpG(4);return t.Njj(f.changeObj(p))}),t.k0s()()}if(2&s){const o=t.XpG(4);t.R7$(1),t.Y8G("obj",o.currentObj)}}function St(s,w){if(1&s&&t.nrm(0,"azt-loading-effect",28),2&s){const o=t.XpG(5);t.Y8G("currentStatusObj",o.processStatusObj)("customText",o.processStatusObj.errorMessage)}}function Pe(s,w){if(1&s&&(t.j41(0,"div"),t.DNE(1,St,1,2,"azt-loading-effect",27),t.k0s()),2&s){const o=t.XpG(4);t.R7$(1),t.Y8G("ngIf",o.processStatusObj.loading)}}function me(s,w){if(1&s&&(t.qex(0),t.DNE(1,Wt,4,3,"div",15),t.DNE(2,Qt,2,1,"div",15),t.DNE(3,Pe,2,1,"div",15),t.bVm()),2&s){const o=t.XpG(3);t.R7$(1),t.Y8G("ngIf",o.currentObj.processStatus==o.allProcessStatuses.PROCESS_ERROR),t.R7$(1),t.Y8G("ngIf",o.currentObj.processStatus==o.allProcessStatuses.PROCESSED),t.R7$(1),t.Y8G("ngIf",o.currentObj.processStatus==o.allProcessStatuses.NONE||o.currentObj.processStatus==o.allProcessStatuses.PROCESSING)}}function fe(s,w){1&s&&(t.qex(0),t.j41(1,"div",18),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s(),t.bVm()),2&s&&(t.R7$(2),t.JRh(t.bMT(3,1,"lang_digitalize_book_please_choose_image")))}function Q(s,w){if(1&s&&(t.qex(0),t.DNE(1,me,4,3,"ng-container",15),t.DNE(2,fe,4,3,"ng-container",15),t.bVm()),2&s){const o=t.XpG(2);t.R7$(1),t.Y8G("ngIf",o.currentObj),t.R7$(1),t.Y8G("ngIf",!o.currentObj)}}function $(s,w){if(1&s){const o=t.RV6();t.j41(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8),t.DNE(4,yt,1,0,"app-digitalize-pdf-to-images",9),t.DNE(5,ke,3,3,"div",10),t.k0s(),t.j41(6,"div",11)(7,"div",12),t.bIt("click",function(){t.eBV(o);const p=t.XpG();return t.Njj(p.downloadData("html"))}),t.EFF(8),t.nI1(9,"mytranslate"),t.k0s()(),t.j41(10,"div",11)(11,"div",12),t.bIt("click",function(){t.eBV(o);const p=t.XpG();return t.Njj(p.downloadData("docx"))}),t.EFF(12),t.nI1(13,"mytranslate"),t.k0s()()(),t.DNE(14,k,3,2,"div",13),t.k0s(),t.j41(15,"div",14),t.DNE(16,Ne,5,2,"ng-container",15),t.DNE(17,Q,3,2,"ng-container",15),t.k0s()()}if(2&s){const o=t.XpG();t.R7$(4),t.Y8G("ngIf",o.currentLayout==o.allLayouts.CHOOSE_IMAGES),t.R7$(1),t.Y8G("ngIf",o.currentLayout==o.allLayouts.PROCESS_IMAGES),t.R7$(3),t.JRh(t.bMT(9,7,"lang_digitalize_book_download_result_html")),t.R7$(4),t.JRh(t.bMT(13,9,"lang_digitalize_book_download_result_docx")),t.R7$(2),t.Y8G("ngIf",o.objs.length>0),t.R7$(2),t.Y8G("ngIf",o.currentLayout==o.allLayouts.CHOOSE_IMAGES),t.R7$(1),t.Y8G("ngIf",o.currentLayout==o.allLayouts.PROCESS_IMAGES)}}const ve=[{path:"",children:[{path:"digitalize-book",component:(()=>{class s extends W.H{startProcess(){this.currentLayout=vt.PROCESS_IMAGES;let o=this.objs.filter(h=>h.isSelected&&![U.PROCESSING,U.PROCESSED].includes(h.processStatus));this.currentObj=this.commonService.getFirstOfArray(o),this.callOrcApi(o,0)}processAgain(){let o=this.objs.filter(h=>h.isSelected&&![U.PROCESSING,U.PROCESSED].includes(h.processStatus));this.callOrcApi(o,0)}callOrcApi(o,h=0,p=1){if(h>=o.length)return void(this.processStatusObj.loading=!1);h<=0&&o.forEach(E=>E.processStatus=U.PROCESSING);let y=o.slice(h,h+p).map(E=>this.runDigitalizeOneImage(E));Promise.all(y).then(()=>{this.callOrcApi(o,h+p,p)})}runDigitalizeOneImage(o){return new Promise((h,p)=>{this.sAztDigitalizeService.digitalizeData(o,f=>{this.processStatusObj={loading:!0,errorMessage:f,mustShowErrorBox:!1}},f=>{o.processStatus=U.PROCESS_ERROR,this.replaceCurrentObj(o),h()},f=>{o={...f,processStatus:U.PROCESSED},this.replaceCurrentObj(o),h()})})}replaceCurrentObj(o){let h=this.objs.find(p=>p.position==o.position);null!=h&&(Object.assign(h,o),h.position==this.currentObj?.position&&Object.assign(this.currentObj,o))}chooseImages(o){let h=o.map(p=>p.position);this.objs.forEach(p=>p.isSelected=!!h.includes(p.position)||p.isSelected),this.totalSelected=this.objs.filter(p=>p.isSelected).length}processImage(o){let h=this.objs.find(p=>p.position==o.position);h&&(this.currentObj=h)}showChooseLayout(){this.currentLayout=vt.CHOOSE_IMAGES}changeObj(o){let h=this.objs.find(p=>p.position==o.position);h&&Object.assign(h,o)}uploadData(o){this.objs=o.map((h,p)=>({image:h,htmlResult:"",position:p+1,isSelected:!1,processStatus:U.NONE}))}downloadData(o){let h=new Date,p="";if(this.objs.forEach(f=>{p+=`<page [page]='${f.position}'/>`+(f.processStatus==U.PROCESSED?f.htmlResult:"")}),p=this.commonService.decodeHtmlEntities(p),"html"!=o)p=this.commonService.convertDollarDollarToLatexTag(p),this.commonService.loadAzotaDocxJs().then(()=>{azotaDocx.textToDocxBinary(p,null).then(f=>{let y=`azota-digitalize-book-${h.getDate()}${h.getMonth()+1}${h.getFullYear()}-${h.getTime()}.docx`;const E=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});E&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(E),y)}).catch(f=>{this.showErrorSnack(f)})}).catch(f=>{this.showErrorSnack(f)});else{let f=`azota-digitalize-book-${h.getDate()}${h.getMonth()+1}${h.getFullYear()}-${h.getTime()}.html`;const y=new Blob([p],{type:"text/plain"});y&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(y),f)}}ngOnInit(){super.ngOnInit(),this.commonService.translateMetaData({title:"lang_cms_admin_common_digitalize_book",description:"lang_cms_admin_common_digitalize_book",image:"lang_cms_test_image"}),this.headerBackTo=this.commonService.getMyQueryParam("backTo")??"/super-role/admin-tool"}constructor(){super(),this.sAztDigitalizeService=(0,t.WQX)(ft),this.processStatusObj={loading:!1,errorMessage:"",mustShowErrorBox:!1},this.headerBackTo="",this.objs=[],this.totalSelected=0,this.currentLayout=vt.CHOOSE_IMAGES,this.allLayouts=vt,this.allProcessStatuses=U}static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-digitalize-book"]],features:[t.Vt3],decls:5,vars:3,consts:[[3,"headerBackToLink"],[1,"container-fluid","component-wrap","centerBoth","hasBg","mt-3"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],["doneLoading",""],[3,"currentStatusObj"],[1,"grid","grid-cols-12","gap-5"],[1,"col-span-3"],[1,"box","p-3","mb-3","grid","grid-cols-12","gap-2"],[1,"col-span-12"],[3,"uploadData",4,"ngIf"],["class","btn btn-primary-soft w-full",3,"click",4,"ngIf"],[1,"col-span-6"],[1,"btn","btn-primary","w-full",3,"click"],["class","box p-3",4,"ngIf"],[1,"col-span-9"],[4,"ngIf"],[3,"uploadData"],[1,"btn","btn-primary-soft","w-full",3,"click"],[1,"box","p-3"],[3,"objs","chooseImages",4,"ngIf"],[3,"objs","currentObj","processImage",4,"ngIf"],[3,"objs","chooseImages"],[3,"objs","currentObj","processImage"],[4,"ngIf","ngIfElse"],["notSelectAnyObj",""],[1,"mb-3","btn","btn-pending",3,"click"],[3,"obj","changeObj"],[3,"currentStatusObj","customText",4,"ngIf"],[3,"currentStatusObj","customText"]],template:function(h,p){if(1&h&&(t.j41(0,"teacher-layout",0)(1,"div",1),t.DNE(2,je,1,1,"azt-loading-effect",2),t.DNE(3,$,18,11,"ng-template",null,3,t.C5r),t.k0s()()),2&h){const f=t.sdS(4);t.Y8G("headerBackToLink",p.headerBackTo),t.R7$(2),t.Y8G("ngIf",p.statusObj.loading)("ngIfElse",f)}},dependencies:[j.bT,Y.K,ee.Q,he,Ie,Te,z,L.wp],encapsulation:2})}return s})()}]}];let Jt=(()=>{class s{static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275mod=t.$C({type:s});static#i=this.\u0275inj=t.G2t({imports:[ct.iI.forChild(ve),ct.iI,ht.XE]})}return s})(),Ge=(()=>{class s{static#t=this.\u0275fac=function(h){return new(h||s)};static#e=this.\u0275mod=t.$C({type:s});static#i=this.\u0275inj=t.G2t({providers:[{provide:ut.vn,useValue:Pt.c.azt_tiny_mce_script_src}],imports:[ct.iI,j.MD,Z.YN,ut.sv,T.s,Z.X1,Jt,te.Q,Nt.L,Ct.Id,qt.b,V.flO.pick(V.Ptg),Bt.AC,rt]})}return s})()},17715:function(we){we.exports=function(){"use strict";function it(r){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function j(r,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function ct(r,e,a){return e in r?Object.defineProperty(r,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[e]=a,r}function ut(r,e){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(r,c).enumerable})),a.push.apply(a,i)}return a}function t(r){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(a),!0).forEach(function(i){ct(r,i,a[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):ut(Object(a)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(a,i))})}return r}function Zt(r){return function lt(r){if(Array.isArray(r))return kt(r)}(r)||function mt(r){if(typeof Symbol<"u"&&Symbol.iterator in Object(r))return Array.from(r)}(r)||function at(r,e){if(r){if("string"==typeof r)return kt(r,e);var a=Object.prototype.toString.call(r).slice(8,-1);if("Object"===a&&r.constructor&&(a=r.constructor.name),"Map"===a||"Set"===a)return Array.from(r);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return kt(r,e)}}(r)||function Mt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kt(r,e){(null==e||e>r.length)&&(e=r.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=r[a];return i}var rt=typeof window<"u"&&typeof window.document<"u",V=rt?window:{},Bt=!(!rt||!V.document.documentElement)&&"ontouchstart"in V.document.documentElement,Ct=!!rt&&"PointerEvent"in V,T="cropper",W="w",q="s",ot="n",L="ne",Ot="nw",Dt="se",ft="sw",U="".concat(T,"-crop"),vt="".concat(T,"-disabled"),Y="".concat(T,"-hidden"),ee="".concat(T,"-hide"),xe="".concat(T,"-invisible"),_t="".concat(T,"-modal"),Gt="".concat(T,"-move"),Et="".concat(T,"Action"),Rt="".concat(T,"Preview"),Lt="crop",Yt="crop",jt="cropend",Xt="cropmove",Ut="cropstart",ae="dblclick",re=Ct?"pointerdown":Bt?"touchstart":"mousedown",oe=Ct?"pointermove":Bt?"touchmove":"mousemove",ne=Ct?"pointerup pointercancel":Bt?"touchend touchcancel":"mouseup",Vt="zoom",he="image/jpeg",Ee=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,Se=/^data:/,Ae=/^data:image\/jpeg;base64,/,Ie=/^img|canvas$/i,ge={viewMode:0,dragMode:Lt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},ze=Number.isNaN||V.isNaN;function C(r){return"number"==typeof r&&!ze(r)}var $t=function(e){return e>0&&e<1/0};function Ht(r){return typeof r>"u"}function pt(r){return"object"===it(r)&&null!==r}var Me=Object.prototype.hasOwnProperty;function bt(r){if(!pt(r))return!1;try{var e=r.constructor,a=e.prototype;return e&&a&&Me.call(a,"isPrototypeOf")}catch{return!1}}function X(r){return"function"==typeof r}var Re=Array.prototype.slice;function ue(r){return Array.from?Array.from(r):Re.call(r)}function R(r,e){return r&&X(e)&&(Array.isArray(r)||C(r.length)?ue(r).forEach(function(a,i){e.call(r,a,i,r)}):pt(r)&&Object.keys(r).forEach(function(a){e.call(r,r[a],a,r)})),r}var z=Object.assign||function(e){for(var a=arguments.length,i=new Array(a>1?a-1:0),c=1;c<a;c++)i[c-1]=arguments[c];return pt(e)&&i.length>0&&i.forEach(function(n){pt(n)&&Object.keys(n).forEach(function(l){e[l]=n[l]})}),e},je=/\.\d*(?:0|9){12}\d*$/;function yt(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return je.test(r)?Math.round(r*e)/e:r}var ke=/^width|height|left|top|marginLeft|marginTop$/;function nt(r,e){var a=r.style;R(e,function(i,c){ke.test(c)&&C(i)&&(i="".concat(i,"px")),a[c]=i})}function k(r,e){if(e){if(C(r.length))return void R(r,function(i){k(i,e)});if(r.classList)return void r.classList.add(e);var a=r.className.trim();a?a.indexOf(e)<0&&(r.className="".concat(a," ").concat(e)):r.className=e}}function tt(r,e){if(e){if(C(r.length))return void R(r,function(a){tt(a,e)});if(r.classList)return void r.classList.remove(e);r.className.indexOf(e)>=0&&(r.className=r.className.replace(e,""))}}function wt(r,e,a){if(e){if(C(r.length))return void R(r,function(i){wt(i,e,a)});a?k(r,e):tt(r,e)}}var Ne=/([a-z\d])([A-Z])/g;function Wt(r){return r.replace(Ne,"$1-$2").toLowerCase()}function Qt(r,e){return pt(r[e])?r[e]:r.dataset?r.dataset[e]:r.getAttribute("data-".concat(Wt(e)))}function St(r,e,a){pt(a)?r[e]=a:r.dataset?r.dataset[e]=a:r.setAttribute("data-".concat(Wt(e)),a)}var me=/\s\s*/,fe=function(){var r=!1;if(rt){var e=!1,a=function(){},i=Object.defineProperty({},"once",{get:function(){return r=!0,e},set:function(n){e=n}});V.addEventListener("test",a,i),V.removeEventListener("test",a,i)}return r}();function Q(r,e,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=a;e.trim().split(me).forEach(function(n){if(!fe){var l=r.listeners;l&&l[n]&&l[n][a]&&(c=l[n][a],delete l[n][a],0===Object.keys(l[n]).length&&delete l[n],0===Object.keys(l).length&&delete r.listeners)}r.removeEventListener(n,c,i)})}function $(r,e,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=a;e.trim().split(me).forEach(function(n){if(i.once&&!fe){var l=r.listeners,d=void 0===l?{}:l;c=function(){delete d[n][a],r.removeEventListener(n,c,i);for(var m=arguments.length,u=new Array(m),g=0;g<m;g++)u[g]=arguments[g];a.apply(r,u)},d[n]||(d[n]={}),d[n][a]&&r.removeEventListener(n,d[n][a],i),d[n][a]=c,r.listeners=d}r.addEventListener(n,c,i)})}function At(r,e,a){var i;return X(Event)&&X(CustomEvent)?i=new CustomEvent(e,{detail:a,bubbles:!0,cancelable:!0}):(i=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,a),r.dispatchEvent(i)}function ve(r){var e=r.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var Jt=V.location,Ge=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function s(r){var e=r.match(Ge);return null!==e&&(e[1]!==Jt.protocol||e[2]!==Jt.hostname||e[3]!==Jt.port)}function w(r){var e="timestamp=".concat((new Date).getTime());return r+(-1===r.indexOf("?")?"?":"&")+e}function o(r){var e=r.rotate,a=r.scaleX,i=r.scaleY,c=r.translateX,n=r.translateY,l=[];C(c)&&0!==c&&l.push("translateX(".concat(c,"px)")),C(n)&&0!==n&&l.push("translateY(".concat(n,"px)")),C(e)&&0!==e&&l.push("rotate(".concat(e,"deg)")),C(a)&&1!==a&&l.push("scaleX(".concat(a,")")),C(i)&&1!==i&&l.push("scaleY(".concat(i,")"));var d=l.length?l.join(" "):"none";return{WebkitTransform:d,msTransform:d,transform:d}}function p(r,e){var a=r.pageX,i=r.pageY,c={endX:a,endY:i};return e?c:t({startX:a,startY:i},c)}function y(r){var e=r.aspectRatio,a=r.height,i=r.width,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",n=$t(i),l=$t(a);if(n&&l){var d=a*e;"contain"===c&&d>i||"cover"===c&&d<i?a=i/e:i=a*e}else n?a=i/e:l&&(i=a*e);return{width:i,height:a}}var J=String.fromCharCode;var _e=/^data:.*,/;function He(r){var a,e=new DataView(r);try{var i,c,n;if(255===e.getUint8(0)&&216===e.getUint8(1))for(var l=e.byteLength,d=2;d+1<l;){if(255===e.getUint8(d)&&225===e.getUint8(d+1)){c=d;break}d+=1}if(c){var m=c+10;if("Exif"===function N(r,e,a){var i="";a+=e;for(var c=e;c<a;c+=1)i+=J(r.getUint8(c));return i}(e,c+4,4)){var u=e.getUint16(m);if(((i=18761===u)||19789===u)&&42===e.getUint16(m+2,i)){var g=e.getUint32(m+4,i);g>=8&&(n=m+g)}}}if(n){var D,O,v=e.getUint16(n,i);for(O=0;O<v;O+=1)if(274===e.getUint16(D=n+12*O+2,i)){a=e.getUint16(D+=8,i),e.setUint16(D,1,i);break}}}catch{a=1}return a}var Qe={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,a=this.options,i=this.container,c=this.cropper,n=Number(a.minContainerWidth),l=Number(a.minContainerHeight);k(c,Y),tt(e,Y);var d={width:Math.max(i.offsetWidth,n>=0?n:200),height:Math.max(i.offsetHeight,l>=0?l:100)};this.containerData=d,nt(c,{width:d.width,height:d.height}),k(e,Y),tt(c,Y)},initCanvas:function(){var e=this.containerData,a=this.imageData,i=this.options.viewMode,c=Math.abs(a.rotate)%180==90,n=c?a.naturalHeight:a.naturalWidth,l=c?a.naturalWidth:a.naturalHeight,d=n/l,_=e.width,m=e.height;e.height*d>e.width?3===i?_=e.height*d:m=e.width/d:3===i?m=e.width/d:_=e.height*d;var u={aspectRatio:d,naturalWidth:n,naturalHeight:l,width:_,height:m};this.canvasData=u,this.limited=1===i||2===i,this.limitCanvas(!0,!0),u.width=Math.min(Math.max(u.width,u.minWidth),u.maxWidth),u.height=Math.min(Math.max(u.height,u.minHeight),u.maxHeight),u.left=(e.width-u.width)/2,u.top=(e.height-u.height)/2,u.oldLeft=u.left,u.oldTop=u.top,this.initialCanvasData=z({},u)},limitCanvas:function(e,a){var i=this.options,c=this.containerData,n=this.canvasData,l=this.cropBoxData,d=i.viewMode,_=n.aspectRatio,m=this.cropped&&l;if(e){var u=Number(i.minCanvasWidth)||0,g=Number(i.minCanvasHeight)||0;d>1?(u=Math.max(u,c.width),g=Math.max(g,c.height),3===d&&(g*_>u?u=g*_:g=u/_)):d>0&&(u?u=Math.max(u,m?l.width:0):g?g=Math.max(g,m?l.height:0):m&&((g=l.height)*_>(u=l.width)?u=g*_:g=u/_));var v=y({aspectRatio:_,width:u,height:g});g=v.height,n.minWidth=u=v.width,n.minHeight=g,n.maxWidth=1/0,n.maxHeight=1/0}if(a)if(d>(m?0:1)){var D=c.width-n.width,O=c.height-n.height;n.minLeft=Math.min(0,D),n.minTop=Math.min(0,O),n.maxLeft=Math.max(0,D),n.maxTop=Math.max(0,O),m&&this.limited&&(n.minLeft=Math.min(l.left,l.left+(l.width-n.width)),n.minTop=Math.min(l.top,l.top+(l.height-n.height)),n.maxLeft=l.left,n.maxTop=l.top,2===d&&(n.width>=c.width&&(n.minLeft=Math.min(0,D),n.maxLeft=Math.max(0,D)),n.height>=c.height&&(n.minTop=Math.min(0,O),n.maxTop=Math.max(0,O))))}else n.minLeft=-n.width,n.minTop=-n.height,n.maxLeft=c.width,n.maxTop=c.height},renderCanvas:function(e,a){var i=this.canvasData,c=this.imageData;if(a){var n=function E(r){var e=r.width,a=r.height,i=r.degree;if(90==(i=Math.abs(i)%180))return{width:a,height:e};var c=i%90*Math.PI/180,n=Math.sin(c),l=Math.cos(c),d=e*l+a*n,_=e*n+a*l;return i>90?{width:_,height:d}:{width:d,height:_}}({width:c.naturalWidth*Math.abs(c.scaleX||1),height:c.naturalHeight*Math.abs(c.scaleY||1),degree:c.rotate||0}),l=n.width,d=n.height,_=i.width*(l/i.naturalWidth),m=i.height*(d/i.naturalHeight);i.left-=(_-i.width)/2,i.top-=(m-i.height)/2,i.width=_,i.height=m,i.aspectRatio=l/d,i.naturalWidth=l,i.naturalHeight=d,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,nt(this.canvas,z({width:i.width,height:i.height},o({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var a=this.canvasData,i=this.imageData,c=i.naturalWidth*(a.width/a.naturalWidth),n=i.naturalHeight*(a.height/a.naturalHeight);z(i,{width:c,height:n,left:(a.width-c)/2,top:(a.height-n)/2}),nt(this.image,z({width:i.width,height:i.height},o(z({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox:function(){var e=this.options,a=this.canvasData,i=e.aspectRatio||e.initialAspectRatio,c=Number(e.autoCropArea)||.8,n={width:a.width,height:a.height};i&&(a.height*i>a.width?n.height=n.width/i:n.width=n.height*i),this.cropBoxData=n,this.limitCropBox(!0,!0),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),n.width=Math.max(n.minWidth,n.width*c),n.height=Math.max(n.minHeight,n.height*c),n.left=a.left+(a.width-n.width)/2,n.top=a.top+(a.height-n.height)/2,n.oldLeft=n.left,n.oldTop=n.top,this.initialCropBoxData=z({},n)},limitCropBox:function(e,a){var i=this.options,c=this.containerData,n=this.canvasData,l=this.cropBoxData,d=this.limited,_=i.aspectRatio;if(e){var m=Number(i.minCropBoxWidth)||0,u=Number(i.minCropBoxHeight)||0,g=d?Math.min(c.width,n.width,n.width+n.left,c.width-n.left):c.width,v=d?Math.min(c.height,n.height,n.height+n.top,c.height-n.top):c.height;m=Math.min(m,c.width),u=Math.min(u,c.height),_&&(m&&u?u*_>m?u=m/_:m=u*_:m?u=m/_:u&&(m=u*_),v*_>g?v=g/_:g=v*_),l.minWidth=Math.min(m,g),l.minHeight=Math.min(u,v),l.maxWidth=g,l.maxHeight=v}a&&(d?(l.minLeft=Math.max(0,n.left),l.minTop=Math.max(0,n.top),l.maxLeft=Math.min(c.width,n.left+n.width)-l.width,l.maxTop=Math.min(c.height,n.top+n.height)-l.height):(l.minLeft=0,l.minTop=0,l.maxLeft=c.width-l.width,l.maxTop=c.height-l.height))},renderCropBox:function(){var e=this.options,a=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&St(this.face,Et,i.width>=a.width&&i.height>=a.height?"move":"all"),nt(this.cropBox,z({width:i.width,height:i.height},o({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),At(this.element,Yt,this.getData())}},Je={initPreview:function(){var e=this.element,a=this.crossOrigin,i=this.options.preview,c=a?this.crossOriginUrl:this.url,n=e.alt||"The image to preview",l=document.createElement("img");if(a&&(l.crossOrigin=a),l.src=c,l.alt=n,this.viewBox.appendChild(l),this.viewBoxImage=l,i){var d=i;"string"==typeof i?d=e.ownerDocument.querySelectorAll(i):i.querySelector&&(d=[i]),this.previews=d,R(d,function(_){var m=document.createElement("img");St(_,Rt,{width:_.offsetWidth,height:_.offsetHeight,html:_.innerHTML}),a&&(m.crossOrigin=a),m.src=c,m.alt=n,m.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',_.innerHTML="",_.appendChild(m)})}},resetPreview:function(){R(this.previews,function(e){var a=Qt(e,Rt);nt(e,{width:a.width,height:a.height}),e.innerHTML=a.html,function Pe(r,e){if(pt(r[e]))try{delete r[e]}catch{r[e]=void 0}else if(r.dataset)try{delete r.dataset[e]}catch{r.dataset[e]=void 0}else r.removeAttribute("data-".concat(Wt(e)))}(e,Rt)})},preview:function(){var e=this.imageData,a=this.canvasData,i=this.cropBoxData,c=i.width,n=i.height,l=e.width,d=e.height,_=i.left-a.left-e.left,m=i.top-a.top-e.top;!this.cropped||this.disabled||(nt(this.viewBoxImage,z({width:l,height:d},o(z({translateX:-_,translateY:-m},e)))),R(this.previews,function(u){var g=Qt(u,Rt),v=g.width,D=g.height,O=v,M=D,S=1;c&&(M=n*(S=v/c)),n&&M>D&&(O=c*(S=D/n),M=D),nt(u,{width:O,height:M}),nt(u.getElementsByTagName("img")[0],z({width:l*S,height:d*S},o(z({translateX:-_*S,translateY:-m*S},e))))}))}},Ke={bind:function(){var e=this.element,a=this.options,i=this.cropper;X(a.cropstart)&&$(e,Ut,a.cropstart),X(a.cropmove)&&$(e,Xt,a.cropmove),X(a.cropend)&&$(e,jt,a.cropend),X(a.crop)&&$(e,Yt,a.crop),X(a.zoom)&&$(e,Vt,a.zoom),$(i,re,this.onCropStart=this.cropStart.bind(this)),a.zoomable&&a.zoomOnWheel&&$(i,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&$(i,ae,this.onDblclick=this.dblclick.bind(this)),$(e.ownerDocument,oe,this.onCropMove=this.cropMove.bind(this)),$(e.ownerDocument,ne,this.onCropEnd=this.cropEnd.bind(this)),a.responsive&&$(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,a=this.options,i=this.cropper;X(a.cropstart)&&Q(e,Ut,a.cropstart),X(a.cropmove)&&Q(e,Xt,a.cropmove),X(a.cropend)&&Q(e,jt,a.cropend),X(a.crop)&&Q(e,Yt,a.crop),X(a.zoom)&&Q(e,Vt,a.zoom),Q(i,re,this.onCropStart),a.zoomable&&a.zoomOnWheel&&Q(i,"wheel",this.onWheel,{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&Q(i,ae,this.onDblclick),Q(e.ownerDocument,oe,this.onCropMove),Q(e.ownerDocument,ne,this.onCropEnd),a.responsive&&Q(window,"resize",this.onResize)}},Ze={resize:function(){if(!this.disabled){var n,l,e=this.options,a=this.container,i=this.containerData,c=a.offsetWidth/i.width;1===c&&a.offsetHeight===i.height||(e.restore&&(n=this.getCanvasData(),l=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(R(n,function(d,_){n[_]=d*c})),this.setCropBoxData(R(l,function(d,_){l[_]=d*c}))))}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(function Be(r,e){return r.classList?r.classList.contains(e):r.className.indexOf(e)>-1}(this.dragBox,U)?"move":Lt)},wheel:function(e){var a=this,i=Number(this.options.wheelZoomRatio)||.1,c=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){a.wheeling=!1},50),e.deltaY?c=e.deltaY>0?1:-1:e.wheelDelta?c=-e.wheelDelta/120:e.detail&&(c=e.detail>0?1:-1),this.zoom(-c*i,e)))},cropStart:function(e){var a=e.buttons,i=e.button;if(!(this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(C(a)&&1!==a||C(i)&&0!==i||e.ctrlKey))){var l,c=this.options,n=this.pointers;e.changedTouches?R(e.changedTouches,function(d){n[d.identifier]=p(d)}):n[e.pointerId||0]=p(e),l=Object.keys(n).length>1&&c.zoomable&&c.zoomOnTouch?"zoom":Qt(e.target,Et),Ee.test(l)&&!1!==At(this.element,Ut,{originalEvent:e,action:l})&&(e.preventDefault(),this.action=l,this.cropping=!1,"crop"===l&&(this.cropping=!0,k(this.dragBox,_t)))}},cropMove:function(e){var a=this.action;if(!this.disabled&&a){var i=this.pointers;e.preventDefault(),!1!==At(this.element,Xt,{originalEvent:e,action:a})&&(e.changedTouches?R(e.changedTouches,function(c){z(i[c.identifier]||{},p(c,!0))}):z(i[e.pointerId||0]||{},p(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var a=this.action,i=this.pointers;e.changedTouches?R(e.changedTouches,function(c){delete i[c.identifier]}):delete i[e.pointerId||0],a&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,wt(this.dragBox,_t,this.cropped&&this.options.modal)),At(this.element,jt,{originalEvent:e,action:a}))}}},qe={change:function(e){var dt,i=this.canvasData,c=this.containerData,n=this.cropBoxData,l=this.pointers,d=this.action,_=this.options.aspectRatio,m=n.left,u=n.top,g=n.width,v=n.height,D=m+g,O=u+v,M=0,S=0,P=c.width,F=c.height,B=!0;!_&&e.shiftKey&&(_=g&&v?g/v:1),this.limited&&(S=n.minTop,P=(M=n.minLeft)+Math.min(c.width,i.width,i.left+i.width),F=S+Math.min(c.height,i.height,i.top+i.height));var K=l[Object.keys(l)[0]],b={x:K.endX-K.startX,y:K.endY-K.startY},A=function(et){switch(et){case"e":D+b.x>P&&(b.x=P-D);break;case W:m+b.x<M&&(b.x=M-m);break;case ot:u+b.y<S&&(b.y=S-u);break;case q:O+b.y>F&&(b.y=F-O)}};switch(d){case"all":m+=b.x,u+=b.y;break;case"e":if(b.x>=0&&(D>=P||_&&(u<=S||O>=F))){B=!1;break}A("e"),(g+=b.x)<0&&(d=W,m-=g=-g),_&&(u+=(n.height-(v=g/_))/2);break;case ot:if(b.y<=0&&(u<=S||_&&(m<=M||D>=P))){B=!1;break}A(ot),u+=b.y,(v-=b.y)<0&&(d=q,u-=v=-v),_&&(m+=(n.width-(g=v*_))/2);break;case W:if(b.x<=0&&(m<=M||_&&(u<=S||O>=F))){B=!1;break}A(W),m+=b.x,(g-=b.x)<0&&(d="e",m-=g=-g),_&&(u+=(n.height-(v=g/_))/2);break;case q:if(b.y>=0&&(O>=F||_&&(m<=M||D>=P))){B=!1;break}A(q),(v+=b.y)<0&&(d=ot,u-=v=-v),_&&(m+=(n.width-(g=v*_))/2);break;case L:if(_){if(b.y<=0&&(u<=S||D>=P)){B=!1;break}A(ot),u+=b.y,g=(v-=b.y)*_}else A(ot),A("e"),b.x>=0?D<P?g+=b.x:b.y<=0&&u<=S&&(B=!1):g+=b.x,b.y<=0?u>S&&(v-=b.y,u+=b.y):(v-=b.y,u+=b.y);g<0&&v<0?(d=ft,u-=v=-v,m-=g=-g):g<0?(d=Ot,m-=g=-g):v<0&&(d=Dt,u-=v=-v);break;case Ot:if(_){if(b.y<=0&&(u<=S||m<=M)){B=!1;break}A(ot),u+=b.y,m+=n.width-(g=(v-=b.y)*_)}else A(ot),A(W),b.x<=0?m>M?(g-=b.x,m+=b.x):b.y<=0&&u<=S&&(B=!1):(g-=b.x,m+=b.x),b.y<=0?u>S&&(v-=b.y,u+=b.y):(v-=b.y,u+=b.y);g<0&&v<0?(d=Dt,u-=v=-v,m-=g=-g):g<0?(d=L,m-=g=-g):v<0&&(d=ft,u-=v=-v);break;case ft:if(_){if(b.x<=0&&(m<=M||O>=F)){B=!1;break}A(W),m+=b.x,v=(g-=b.x)/_}else A(q),A(W),b.x<=0?m>M?(g-=b.x,m+=b.x):b.y>=0&&O>=F&&(B=!1):(g-=b.x,m+=b.x),b.y>=0?O<F&&(v+=b.y):v+=b.y;g<0&&v<0?(d=L,u-=v=-v,m-=g=-g):g<0?(d=Dt,m-=g=-g):v<0&&(d=Ot,u-=v=-v);break;case Dt:if(_){if(b.x>=0&&(D>=P||O>=F)){B=!1;break}A("e"),v=(g+=b.x)/_}else A(q),A("e"),b.x>=0?D<P?g+=b.x:b.y>=0&&O>=F&&(B=!1):g+=b.x,b.y>=0?O<F&&(v+=b.y):v+=b.y;g<0&&v<0?(d=Ot,u-=v=-v,m-=g=-g):g<0?(d=ft,m-=g=-g):v<0&&(d=L,u-=v=-v);break;case"move":this.move(b.x,b.y),B=!1;break;case"zoom":this.zoom(function h(r){var e=t({},r),a=0;return R(r,function(i,c){delete e[c],R(e,function(n){var l=Math.abs(i.startX-n.startX),d=Math.abs(i.startY-n.startY),_=Math.abs(i.endX-n.endX),m=Math.abs(i.endY-n.endY),u=Math.sqrt(l*l+d*d),v=(Math.sqrt(_*_+m*m)-u)/u;Math.abs(v)>Math.abs(a)&&(a=v)})}),a}(l),e),B=!1;break;case"crop":if(!b.x||!b.y){B=!1;break}dt=ve(this.cropper),m=K.startX-dt.left,u=K.startY-dt.top,g=n.minWidth,v=n.minHeight,b.x>0?d=b.y>0?Dt:L:b.x<0&&(m-=g,d=b.y>0?ft:Ot),b.y<0&&(u-=v),this.cropped||(tt(this.cropBox,Y),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}B&&(n.width=g,n.height=v,n.left=m,n.top=u,this.action=d,this.renderCropBox()),R(l,function(G){G.startX=G.endX,G.startY=G.endY})}},ti={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&k(this.dragBox,_t),tt(this.cropBox,Y),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=z({},this.initialImageData),this.canvasData=z({},this.initialCanvasData),this.cropBoxData=z({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(z(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),tt(this.dragBox,_t),k(this.cropBox,Y)),this},replace:function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&e&&(this.isImg&&(this.element.src=e),a?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,R(this.previews,function(i){i.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,tt(this.cropper,vt)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,k(this.cropper,vt)),this},destroy:function(){var e=this.element;return e[T]?(e[T]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,c=i.left,n=i.top;return this.moveTo(Ht(e)?e:c+Number(e),Ht(a)?a:n+Number(a))},moveTo:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,c=!1;return e=Number(e),a=Number(a),this.ready&&!this.disabled&&this.options.movable&&(C(e)&&(i.left=e,c=!0),C(a)&&(i.top=a,c=!0),c&&this.renderCanvas(!0)),this},zoom:function(e,a){var i=this.canvasData;return e=Number(e),this.zoomTo(i.width*(e=e<0?1/(1-e):1+e)/i.naturalWidth,null,a)},zoomTo:function(e,a,i){var c=this.options,n=this.canvasData,l=n.width,d=n.height,_=n.naturalWidth,m=n.naturalHeight;if((e=Number(e))>=0&&this.ready&&!this.disabled&&c.zoomable){var u=_*e,g=m*e;if(!1===At(this.element,Vt,{ratio:e,oldRatio:l/_,originalEvent:i}))return this;if(i){var v=this.pointers,D=ve(this.cropper),O=v&&Object.keys(v).length?function f(r){var e=0,a=0,i=0;return R(r,function(c){e+=c.startX,a+=c.startY,i+=1}),{pageX:e/=i,pageY:a/=i}}(v):{pageX:i.pageX,pageY:i.pageY};n.left-=(O.pageX-D.left-n.left)/l*(u-l),n.top-=(O.pageY-D.top-n.top)/d*(g-d)}else bt(a)&&C(a.x)&&C(a.y)?(n.left-=(a.x-n.left)/l*(u-l),n.top-=(a.y-n.top)/d*(g-d)):(n.left-=(u-l)/2,n.top-=(g-d)/2);n.width=u,n.height=g,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return C(e=Number(e))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var a=this.imageData.scaleY;return this.scale(e,C(a)?a:1)},scaleY:function(e){var a=this.imageData.scaleX;return this.scale(C(a)?a:1,e)},scale:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.imageData,c=!1;return e=Number(e),a=Number(a),this.ready&&!this.disabled&&this.options.scalable&&(C(e)&&(i.scaleX=e,c=!0),C(a)&&(i.scaleY=a,c=!0),c&&this.renderCanvas(!0,!0)),this},getData:function(){var l,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.options,i=this.imageData,c=this.canvasData,n=this.cropBoxData;if(this.ready&&this.cropped){var d=i.width/i.naturalWidth;if(R(l={x:n.left-c.left,y:n.top-c.top,width:n.width,height:n.height},function(u,g){l[g]=u/d}),e){var _=Math.round(l.y+l.height),m=Math.round(l.x+l.width);l.x=Math.round(l.x),l.y=Math.round(l.y),l.width=m-l.x,l.height=_-l.y}}else l={x:0,y:0,width:0,height:0};return a.rotatable&&(l.rotate=i.rotate||0),a.scalable&&(l.scaleX=i.scaleX||1,l.scaleY=i.scaleY||1),l},setData:function(e){var a=this.options,i=this.imageData,c=this.canvasData,n={};if(this.ready&&!this.disabled&&bt(e)){var l=!1;a.rotatable&&C(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,l=!0),a.scalable&&(C(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,l=!0),C(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,l=!0)),l&&this.renderCanvas(!0,!0);var d=i.width/i.naturalWidth;C(e.x)&&(n.left=e.x*d+c.left),C(e.y)&&(n.top=e.y*d+c.top),C(e.width)&&(n.width=e.width*d),C(e.height)&&(n.height=e.height*d),this.setCropBoxData(n)}return this},getContainerData:function(){return this.ready?z({},this.containerData):{}},getImageData:function(){return this.sized?z({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,a={};return this.ready&&R(["left","top","width","height","naturalWidth","naturalHeight"],function(i){a[i]=e[i]}),a},setCanvasData:function(e){var a=this.canvasData,i=a.aspectRatio;return this.ready&&!this.disabled&&bt(e)&&(C(e.left)&&(a.left=e.left),C(e.top)&&(a.top=e.top),C(e.width)?(a.width=e.width,a.height=e.width/i):C(e.height)&&(a.height=e.height,a.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var a,e=this.cropBoxData;return this.ready&&this.cropped&&(a={left:e.left,top:e.top,width:e.width,height:e.height}),a||{}},setCropBoxData:function(e){var c,n,a=this.cropBoxData,i=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&bt(e)&&(C(e.left)&&(a.left=e.left),C(e.top)&&(a.top=e.top),C(e.width)&&e.width!==a.width&&(c=!0,a.width=e.width),C(e.height)&&e.height!==a.height&&(n=!0,a.height=e.height),i&&(c?a.height=a.width/i:n&&(a.width=a.height*i)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var a=this.canvasData,i=function I(r,e,a,i){var c=e.aspectRatio,n=e.naturalWidth,l=e.naturalHeight,d=e.rotate,_=void 0===d?0:d,m=e.scaleX,u=void 0===m?1:m,g=e.scaleY,v=void 0===g?1:g,D=a.aspectRatio,O=a.naturalWidth,M=a.naturalHeight,S=i.fillColor,P=void 0===S?"transparent":S,F=i.imageSmoothingEnabled,B=void 0===F||F,dt=i.imageSmoothingQuality,K=void 0===dt?"low":dt,b=i.maxWidth,A=void 0===b?1/0:b,G=i.maxHeight,et=void 0===G?1/0:G,gt=i.minWidth,It=void 0===gt?0:gt,Tt=i.minHeight,xt=void 0===Tt?0:Tt,st=document.createElement("canvas"),H=st.getContext("2d"),zt=y({aspectRatio:D,width:A,height:et}),ye=y({aspectRatio:D,width:It,height:xt},"cover"),Le=Math.min(zt.width,Math.max(ye.width,O)),Fe=Math.min(zt.height,Math.max(ye.height,M)),Xe=y({aspectRatio:c,width:A,height:et}),Ue=y({aspectRatio:c,width:It,height:xt},"cover"),Ve=Math.min(Xe.width,Math.max(Ue.width,n)),$e=Math.min(Xe.height,Math.max(Ue.height,l)),ii=[-Ve/2,-$e/2,Ve,$e];return st.width=yt(Le),st.height=yt(Fe),H.fillStyle=P,H.fillRect(0,0,Le,Fe),H.save(),H.translate(Le/2,Fe/2),H.rotate(_*Math.PI/180),H.scale(u,v),H.imageSmoothingEnabled=B,H.imageSmoothingQuality=K,H.drawImage.apply(H,[r].concat(Zt(ii.map(function(ai){return Math.floor(yt(ai))})))),H.restore(),st}(this.image,this.imageData,a,e);if(!this.cropped)return i;var c=this.getData(),n=c.x,l=c.y,d=c.width,_=c.height,m=i.width/Math.floor(a.naturalWidth);1!==m&&(n*=m,l*=m,d*=m,_*=m);var u=d/_,g=y({aspectRatio:u,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),v=y({aspectRatio:u,width:e.minWidth||0,height:e.minHeight||0},"cover"),D=y({aspectRatio:u,width:e.width||(1!==m?i.width:d),height:e.height||(1!==m?i.height:_)}),O=D.width,M=D.height;O=Math.min(g.width,Math.max(v.width,O)),M=Math.min(g.height,Math.max(v.height,M));var S=document.createElement("canvas"),P=S.getContext("2d");S.width=yt(O),S.height=yt(M),P.fillStyle=e.fillColor||"transparent",P.fillRect(0,0,O,M);var F=e.imageSmoothingEnabled,dt=e.imageSmoothingQuality;P.imageSmoothingEnabled=void 0===F||F,dt&&(P.imageSmoothingQuality=dt);var et,gt,It,Tt,xt,st,K=i.width,b=i.height,A=n,G=l;A<=-d||A>K?(A=0,et=0,It=0,xt=0):A<=0?(It=-A,A=0,xt=et=Math.min(K,d+A)):A<=K&&(It=0,xt=et=Math.min(d,K-A)),et<=0||G<=-_||G>b?(G=0,gt=0,Tt=0,st=0):G<=0?(Tt=-G,G=0,st=gt=Math.min(b,_+G)):G<=b&&(Tt=0,st=gt=Math.min(_,b-G));var H=[A,G,et,gt];if(xt>0&&st>0){var zt=O/d;H.push(It*zt,Tt*zt,xt*zt,st*zt)}return P.drawImage.apply(P,[i].concat(Zt(H.map(function(ye){return Math.floor(yt(ye))})))),S},setAspectRatio:function(e){var a=this.options;return!this.disabled&&!Ht(e)&&(a.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var a=this.options,i=this.dragBox,c=this.face;if(this.ready&&!this.disabled){var n=e===Lt,l=a.movable&&"move"===e;a.dragMode=e=n||l?e:"none",St(i,Et,e),wt(i,U,n),wt(i,Gt,l),a.cropBoxMovable||(St(c,Et,e),wt(c,U,n),wt(c,Gt,l))}return this}},ei=V.Cropper,Ye=function(){function r(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function x(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),!e||!Ie.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=z({},ge,bt(a)&&a),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return function Z(r,e,a){return e&&j(r.prototype,e),a&&j(r,a),r}(r,[{key:"init",value:function(){var c,a=this.element,i=a.tagName.toLowerCase();if(!a[T]){if(a[T]=this,"img"===i){if(this.isImg=!0,c=a.getAttribute("src")||"",this.originalUrl=c,!c)return;c=a.src}else"canvas"===i&&window.HTMLCanvasElement&&(c=a.toDataURL());this.load(c)}}},{key:"load",value:function(a){var i=this;if(a){this.url=a,this.imageData={};var c=this.element,n=this.options;if(!n.rotatable&&!n.scalable&&(n.checkOrientation=!1),!n.checkOrientation||!window.ArrayBuffer)return void this.clone();if(Se.test(a))return void(Ae.test(a)?this.read(function Kt(r){var e=r.replace(_e,""),a=atob(e),i=new ArrayBuffer(a.length),c=new Uint8Array(i);return R(c,function(n,l){c[l]=a.charCodeAt(l)}),i}(a)):this.clone());var l=new XMLHttpRequest,d=this.clone.bind(this);this.reloading=!0,this.xhr=l,l.onabort=d,l.onerror=d,l.ontimeout=d,l.onprogress=function(){l.getResponseHeader("content-type")!==he&&l.abort()},l.onload=function(){i.read(l.response)},l.onloadend=function(){i.reloading=!1,i.xhr=null},n.checkCrossOrigin&&s(a)&&c.crossOrigin&&(a=w(a)),l.open("GET",a,!0),l.responseType="arraybuffer",l.withCredentials="use-credentials"===c.crossOrigin,l.send()}}},{key:"read",value:function(a){var i=this.options,c=this.imageData,n=He(a),l=0,d=1,_=1;if(n>1){this.url=function be(r,e){for(var a=[],c=new Uint8Array(r);c.length>0;)a.push(J.apply(null,ue(c.subarray(0,8192)))),c=c.subarray(8192);return"data:".concat(e,";base64,").concat(btoa(a.join("")))}(a,he);var m=function We(r){var e=0,a=1,i=1;switch(r){case 2:a=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,a=-1;break;case 8:e=-90}return{rotate:e,scaleX:a,scaleY:i}}(n);l=m.rotate,d=m.scaleX,_=m.scaleY}i.rotatable&&(c.rotate=l),i.scalable&&(c.scaleX=d,c.scaleY=_),this.clone()}},{key:"clone",value:function(){var a=this.element,i=this.url,c=a.crossOrigin,n=i;this.options.checkCrossOrigin&&s(i)&&(c||(c="anonymous"),n=w(i)),this.crossOrigin=c,this.crossOriginUrl=n;var l=document.createElement("img");c&&(l.crossOrigin=c),l.src=n||i,l.alt=a.alt||"The image to crop",this.image=l,l.onload=this.start.bind(this),l.onerror=this.stop.bind(this),k(l,ee),a.parentNode.insertBefore(l,a.nextSibling)}},{key:"start",value:function(){var a=this,i=this.image;i.onload=null,i.onerror=null,this.sizing=!0;var c=V.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(V.navigator.userAgent),n=function(m,u){z(a.imageData,{naturalWidth:m,naturalHeight:u,aspectRatio:m/u}),a.initialImageData=z({},a.imageData),a.sizing=!1,a.sized=!0,a.build()};if(!i.naturalWidth||c){var l=document.createElement("img"),d=document.body||document.documentElement;this.sizingImage=l,l.onload=function(){n(l.width,l.height),c||d.removeChild(l)},l.src=i.src,c||(l.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",d.appendChild(l))}else n(i.naturalWidth,i.naturalHeight)}},{key:"stop",value:function(){var a=this.image;a.onload=null,a.onerror=null,a.parentNode.removeChild(a),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var a=this.element,i=this.options,c=this.image,n=a.parentNode,l=document.createElement("div");l.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var d=l.querySelector(".".concat(T,"-container")),_=d.querySelector(".".concat(T,"-canvas")),m=d.querySelector(".".concat(T,"-drag-box")),u=d.querySelector(".".concat(T,"-crop-box")),g=u.querySelector(".".concat(T,"-face"));this.container=n,this.cropper=d,this.canvas=_,this.dragBox=m,this.cropBox=u,this.viewBox=d.querySelector(".".concat(T,"-view-box")),this.face=g,_.appendChild(c),k(a,Y),n.insertBefore(d,a.nextSibling),this.isImg||tt(c,ee),this.initPreview(),this.bind(),i.initialAspectRatio=Math.max(0,i.initialAspectRatio)||NaN,i.aspectRatio=Math.max(0,i.aspectRatio)||NaN,i.viewMode=Math.max(0,Math.min(3,Math.round(i.viewMode)))||0,k(u,Y),i.guides||k(u.getElementsByClassName("".concat(T,"-dashed")),Y),i.center||k(u.getElementsByClassName("".concat(T,"-center")),Y),i.background&&k(d,"".concat(T,"-bg")),i.highlight||k(g,xe),i.cropBoxMovable&&(k(g,Gt),St(g,Et,"all")),i.cropBoxResizable||(k(u.getElementsByClassName("".concat(T,"-line")),Y),k(u.getElementsByClassName("".concat(T,"-point")),Y)),this.render(),this.ready=!0,this.setDragMode(i.dragMode),i.autoCrop&&this.crop(),this.setData(i.data),X(i.ready)&&$(a,"ready",i.ready,{once:!0}),At(a,"ready")}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),tt(this.element,Y))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=ei,r}},{key:"setDefaults",value:function(a){z(ge,bt(a)&&a)}}]),r}();return z(Ye.prototype,Qe,Je,Ke,Ze,qe,ti),Ye}()}}]);