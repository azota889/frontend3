"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[4695],{57003:($,y,a)=>{a.d(y,{Q:()=>V});var e=a(81519),c=a(10936),P=a(34514),t=a(47426),C=a(89163),o=a(99503),m=a(79347),p=a(33887),u=a(38009),x=a(9691),A=a(80037),k=a(48485),s=a(26860),U=a(33634),Y=a(51913),T=a(3780),B=a(54460),f=a(81587),b=a(27985),R=a(52811),G=a(9842),X=a(73437);function H(d,z){1&d&&(s.j41(0,"div",5),s.nrm(1,"azt-loading-ui"),s.k0s())}function K(d,z){if(1&d&&(s.j41(0,"div",27)(1,"div",28),s.nrm(2,"azt-list-classroom-checkbox",29),s.k0s()()),2&d){const h=s.XpG(2);s.R7$(2),s.Y8G("form",h.form)("classroomGroupData",h.classroomWithGroup)("examClassroomObjs",h.examClassroomObjs)("permissionName",h.permissionTypes.exam)}}function Q(d,z){if(1&d&&(s.j41(0,"div",27)(1,"div",30)(2,"div",31)(3,"h3",32),s.EFF(4),s.nI1(5,"mytranslate"),s.k0s()(),s.nrm(6,"list-student-checkbox",33),s.k0s()()),2&d){const h=s.XpG(2);s.R7$(4),s.SpI(" ",s.bMT(5,5,"lang_test_config_student_list")," "),s.R7$(2),s.Y8G("form",h.form)("classroomGroupData",h.classroomWithGroup)("examStudentObjs",h.data.examStudents)("permissionName",h.permissionTypes.exam)}}function E(d,z){if(1&d){const h=s.RV6();s.j41(0,"div",6)(1,"form",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"div",11),s.EFF(6),s.nI1(7,"mytranslate"),s.k0s()(),s.j41(8,"div",12)(9,"div",13)(10,"div",14)(11,"input",15),s.bIt("change",function(){s.eBV(h);const w=s.XpG();return s.Njj(w.clearAllCheckBox(0))}),s.k0s(),s.j41(12,"label",16),s.EFF(13),s.nI1(14,"mytranslate"),s.k0s()(),s.j41(15,"div",17)(16,"input",18),s.bIt("change",function(){s.eBV(h);const w=s.XpG();return s.Njj(w.clearAllCheckBox(2))}),s.k0s(),s.j41(17,"label",19),s.EFF(18),s.nI1(19,"mytranslate"),s.k0s()(),s.j41(20,"div",20)(21,"input",21),s.bIt("change",function(){s.eBV(h);const w=s.XpG();return s.Njj(w.clearAllCheckBox(3))}),s.k0s(),s.j41(22,"label",22),s.EFF(23),s.nI1(24,"mytranslate"),s.k0s()()()(),s.DNE(25,K,3,4,"div",23),s.DNE(26,Q,7,7,"div",23),s.k0s()()()(),s.j41(27,"div",24)(28,"button",25),s.bIt("click",function(){s.eBV(h);const w=s.XpG();return s.Njj(w.closeDialog())}),s.EFF(29),s.nI1(30,"mytranslate"),s.k0s(),s.j41(31,"button",26),s.bIt("click",function(){s.eBV(h);const w=s.XpG();return s.Njj(w.savePublishExam("save"))}),s.EFF(32),s.nI1(33,"mytranslate"),s.k0s()()}if(2&d){const h=s.XpG();s.R7$(1),s.Y8G("formGroup",h.form),s.R7$(5),s.SpI(" ",s.bMT(7,13,"lang_testbank_test_config_who_tested")," "),s.R7$(5),s.Y8G("value",0),s.R7$(2),s.SpI(" ",s.bMT(14,15,"lang_testbank_test_config_all_people")," "),s.R7$(3),s.Y8G("value",2),s.R7$(2),s.SpI(" ",s.bMT(19,17,"lang_testbank_test_config_assigne_class")," "),s.R7$(3),s.Y8G("value",3),s.R7$(2),s.SpI(" ",s.bMT(24,19,"lang_testbank_test_config_assigne_student")," "),s.R7$(2),s.Y8G("ngIf",2===h.form.controls.whoAllow.value),s.R7$(1),s.Y8G("ngIf",3===h.form.controls.whoAllow.value),s.R7$(3),s.SpI(" ",s.bMT(30,21,"lang_auto_huy")," "),s.R7$(2),s.Y8G("disabled",3===h.form.controls.whoAllow.value&&h.form.controls.studentIds.errors||2===h.form.controls.whoAllow.value&&h.form.controls.classroomFormArray.errors),s.R7$(1),s.SpI(" ",s.bMT(33,23,"lang_auto_luu")," ")}}let V=(()=>{class d extends p._{clearAllCheckBox(h){1==h?this.isSelectClassroom=!1:2==h&&(this.isSelectClassroom=!0)}closeDialog(h){this.dialogRef.close(h)}savePublishExam(h){this.initStatusObj();let O="publish"===h?1:void 0;var w=this.form.getRawValue();const N=this.sAztClassroomCheckboxService.getClassroomIdsCheckedInGroup(this.form.controls.classroomFormArray);let W=[];if(3==w.whoAllow&&w.studentIds&&w.studentIds.length){let L=this.commonService.arrayToDictionary(w.studentIds,_=>_.classroomId.toString());Object.entries(L).forEach(([_,v],I)=>{let j=this.commonService.getFirstOfArray(v)?.classroomId;j&&W?.push({classroomId:j,assignStudentIds:v.map(M=>M.studentId)})})}else W=void 0;let Z={whoAllow:w.whoAllow,isPublished:O??void 0,classroomIds:N,assignStudents:W,isSaveConfig:0};var D=this.permissionService.hasEditPermission("exam",this.obj)?this.documentConfigService.apiDocumentConfigSaveExamConfigPost(this.hashId,Z):this.documentConfigService.apiDocumentConfigSaveExamDataForConfigClassroomPost(this.hashId,Z);this.waitDestroy(D.subscribe(L=>{1==L.success?(this.successStatusObj(),this.showSuccessSnack("lang_auto_luu_thanh_cong"),this.closeDialog(L.data?.obj)):this.errorStatusObj(L.message??"",!0)}))}getExamDataByHashId(h){this.initStatusObj(),this.waitDestroy(this.documentConfigService.apiDocumentConfigGetExamDataForConfigClassroomV2Get(h).subscribe(O=>{if(1==O.success){if(null!=O.data){var N,w=O.data?.examObj;if(!(N=this.castObj(w)))return;N.limitQuestionGroupsParse=this.commonService.myParseJson(w.limitQuestionGroups??""),this.obj=N,this.hashId=this.obj.hashId??"",this.classroomWithGroup=O.data.classroomGroupObjs??new Array,this.classroomObjs=this.commonService.concatMultipleArray(O.data.classroomGroupObjs.map(W=>W.classroomObjs)),this.examClassroomObjs=O.data.examClassroomObjs??[],this.form.patchValue({whoAllow:this.obj.whoAllow}),this.isSelectClassroom=2==this.obj.whoAllow,this.successStatusObj()}}else this.errorStatusObj(O.message??"",!0)}))}ngOnInit(){super.ngOnInit(),this.getExamDataByHashId(this.hashId)}constructor(h,O,w,N,W){super(N,w),this.documentConfigService=h,this.permissionService=O,this.dialogRef=w,this.data=N,this.sAztClassroomCheckboxService=W,this.permissionTypes=u.t,this.checkDialogFastContent=[],this.classroomObjs=[],this.examClassroomObjs=[],this.isSelectClassroom=!1,this.hashId="",this.classroomWithGroup=[],this.hashId=N.hashId,this.form=new c.gE({whoAllow:new c.MJ(0,{nonNullable:!0}),classroomFormArray:new c.Yp([]),studentIds:new c.Yp([])},{validators:[A.j.classroomInGroupCheckBoxValidator,k.H.studentCheckBoxValidator]})}static#t=this.\u0275fac=function(O){return new(O||d)(s.rXU(U.x),s.rXU(Y.p),s.rXU(C.CP,8),s.rXU(C.Vh,8),s.rXU(T.Q))};static#e=this.\u0275cmp=s.VBU({type:d,selectors:[["config-online-exam-dialog"]],features:[s.Jv_([{provide:e.$O,useClass:o.fb,deps:[t.Ju,P.ij]},{provide:e.vq,useFactory:m.Yw,deps:[x.F]}]),s.Vt3],decls:6,vars:2,consts:[[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],["class","loading flex items-center justify-center",4,"ngIf","ngIfElse"],["doneLoading",""],[1,"loading","flex","items-center","justify-center"],[1,"col-md-12","setting"],[3,"formGroup"],[1,"setting-base"],["id","azt-config-who-allow",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12","lg:col-span-3","pr-2"],[1,"mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-9"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-5"],["id","config-who-all","formControlName","whoAllow","type","radio",1,"form-check-input",3,"value","change"],["for","config-who-all",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0","mr-5"],["id","config-who-class","formControlName","whoAllow","type","radio",1,"form-check-input",3,"value","change"],["for","config-who-class",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0"],["id","config-who-student","formControlName","whoAllow","type","radio",1,"form-check-input",3,"value","change"],["for","config-who-student",1,"form-check-label"],["class","col-span-12 mt-4",4,"ngIf"],[1,"text-right","mt-4"],["azt-track-service","config-exam-classroom-6-a-m4KztM",1,"btn","w-24","btn-secondary","mr-3",3,"click"],["azt-track-service","config-exam-classroom-brv1ZZTsfLY",1,"btn","w-24","btn-primary",3,"disabled","click"],[1,"col-span-12","mt-4"],[1,"azt-list-classroom"],[3,"form","classroomGroupData","examClassroomObjs","permissionName"],[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","items-center"],[1,"mr-auto"],[3,"form","classroomGroupData","examStudentObjs","permissionName"]],template:function(O,w){if(1&O&&(s.j41(0,"div",0)(1,"div",1)(2,"div",2),s.DNE(3,H,2,0,"div",3),s.DNE(4,E,34,25,"ng-template",null,4,s.C5r),s.k0s()()()),2&O){const N=s.sdS(5);s.R7$(3),s.Y8G("ngIf",w.statusObj.loading)("ngIfElse",N)}},dependencies:[B.bT,c.qT,c.me,c.Fm,c.BC,c.cb,c.j4,c.JD,f.t,b.D,R.R,G.M,X.wp],encapsulation:2})}return d})()},9842:($,y,a)=>{a.d(y,{M:()=>Ot});var e=a(10936),c=a(38009),P=a(59640),t=a(26860),C=a(54460),o=a(5502),m=a(74151),p=a(27208),u=a(89163),x=a(33887),A=a(68774),k=a(65544),s=a(47712),U=a(18718),Y=a(2915),T=a(69135),B=a(32099),f=a(73437);function b(i,S){if(1&i&&t.nrm(0,"azt-loading-effect",7),2&i){const n=t.XpG();t.Y8G("currentStatusObj",n.statusObj)}}function R(i,S){1&i&&(t.qex(0),t.j41(1,"div",23)(2,"span",24),t.EFF(3),t.nI1(4,"mytranslate"),t.k0s()(),t.bVm()),2&i&&(t.R7$(3),t.JRh(t.bMT(4,1,"lang_testbank_no_students_selected")))}function G(i,S){if(1&i){const n=t.RV6();t.j41(0,"div",29)(1,"div",30)(2,"input",31),t.bIt("change",function(){t.eBV(n);const l=t.XpG(5);return t.Njj(l.calculateFormData())}),t.k0s(),t.j41(3,"label",32,33),t.nI1(5,"mytranslate"),t.EFF(6),t.nI1(7,"mytranslate"),t.k0s()()()}if(2&i){const n=t.sdS(4),r=t.XpG().$implicit;t.R7$(2),t.FS9("id","azt-checkbox-student-"+r.id),t.Y8G("formControl",r.isChecked),t.R7$(1),t.FS9("for","azt-checkbox-student-"+r.id),t.Y8G("matTooltip",t.bMT(5,8,r.fullName))("isDisabledTooltip",!1)("matTooltipDisabled",n.isDisabled)("matTooltipShowDelay",500),t.R7$(3),t.SpI(" ",t.bMT(7,10,r.fullName)," ")}}function X(i,S){if(1&i&&(t.qex(0),t.DNE(1,G,8,12,"div",28),t.bVm()),2&i){const n=S.$implicit;t.R7$(1),t.Y8G("ngIf",n.isShowStudent)}}function H(i,S){1&i&&(t.j41(0,"div",23),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&i&&(t.R7$(1),t.SpI(" ",t.bMT(2,1,"lang_student_classroom_list_detail_not_student")," "))}function K(i,S){if(1&i&&(t.j41(0,"div",25),t.DNE(1,X,2,1,"ng-container",26),t.k0s(),t.DNE(2,H,3,3,"div",27)),2&i){const n=t.XpG(3);t.R7$(1),t.Y8G("ngForOf",n.studentObjs),t.R7$(1),t.Y8G("ngIf",0==n.totalStudentsShow)}}function Q(i,S){if(1&i){const n=t.RV6();t.qex(0),t.j41(1,"div",10)(2,"div",11)(3,"span"),t.EFF(4),t.nI1(5,"mytranslate"),t.k0s(),t.j41(6,"div",12)(7,"azt-search-box",13),t.bIt("onSearch",function(l){t.eBV(n);const g=t.XpG(2);return t.Njj(g.onSearchBox(l.searchObj))}),t.nI1(8,"mytranslate"),t.k0s()()(),t.j41(9,"div",14)(10,"div",15)(11,"input",16),t.bIt("change",function(){t.eBV(n);const l=t.XpG(2);return t.Njj(l.selectAllStudentOfClass())}),t.k0s(),t.j41(12,"label",17),t.EFF(13),t.nI1(14,"mytranslate"),t.k0s()(),t.j41(15,"div",18)(16,"input",19),t.bIt("change",function(){t.eBV(n);const l=t.XpG(2);return t.Njj(l.calculateFormData())}),t.k0s(),t.j41(17,"label",20),t.EFF(18),t.nI1(19,"mytranslate"),t.k0s()()()(),t.j41(20,"div")(21,"azt-mat-dialog-content",21),t.DNE(22,R,5,3,"ng-container",8),t.DNE(23,K,3,2,"ng-template",null,22,t.C5r),t.k0s()(),t.bVm()}if(2&i){const n=t.sdS(24),r=t.XpG(2);t.R7$(4),t.JRh(r.data.classroomName+(r.totalStudentsSelected?" ("+t.bMT(5,11,"lang_auto_da_chon")+": "+r.totalStudentsSelected+")":"")),t.R7$(3),t.Y8G("isServerSearch",!1)("styleInput","form-control-sm ")("placeholder",t.bMT(8,13,"lang_student_classroom_list_detail_search_name_student")),t.R7$(4),t.Y8G("formControl",r.selectAllFormControl),t.R7$(2),t.SpI(" ",t.bMT(14,15,r.selectAllFormControl.value?"lang_remove_all":"lang_select_all")," "),t.R7$(3),t.Y8G("formControl",r.showCheckedFormControl),t.R7$(2),t.SpI(" ",t.bMT(19,17,"lang_testbank_selected_students")," "),t.R7$(3),t.Y8G("defaultHeight",40),t.R7$(1),t.Y8G("ngIf",r.totalStudentsSelected<=0&&r.showCheckedFormControl.value)("ngIfElse",n)}}function E(i,S){1&i&&(t.j41(0,"div",23)(1,"span"),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s()()),2&i&&(t.R7$(2),t.JRh(t.bMT(3,1,"lang_core_class_has_no_student")))}function V(i,S){if(1&i&&(t.DNE(0,Q,25,19,"ng-container",8),t.DNE(1,E,4,3,"ng-template",null,9,t.C5r)),2&i){const n=t.sdS(2),r=t.XpG();t.Y8G("ngIf",r.studentObjs.length>0)("ngIfElse",n)}}let d=(()=>{class i extends x._{btnCloseDialog(){if(this.studentObjs.length<=0)return this.dialogRef.close();let n={classroomId:this.data.classroomId,classroomName:this.data.classroomName,studentIdsSelected:this.studentObjs.filter(r=>r.isChecked.value).map(r=>r.id)};this.dialogRef.close(n)}onSearchBox(n){this.searchContentObj=n,this.calculateFormData()}selectAllStudentOfClass(){this.studentObjs.map(n=>n.isChecked.setValue(this.selectAllFormControl.value)),this.calculateFormData()}calculateFormData(){let n=this.commonService.convertVietnameseToEnglish(this.searchContentObj.searchContent).toLowerCase().trim();this.studentObjs.forEach(r=>{const l=this.commonService.convertVietnameseToEnglish(r.fullName??"").toLowerCase().trim();let g=""==n||l.includes(n);r.isShowStudent=(!this.showCheckedFormControl.value||r.isChecked.value)&&g}),this.totalStudentsSelected=this.studentObjs.filter(r=>r.isChecked.value).length,this.selectAllFormControl.setValue(this.totalStudentsSelected==this.studentObjs.length),this.totalStudentsShow=this.studentObjs.filter(r=>r.isShowStudent).length}getData(){this.initStatusObj(),this.waitDestroy(this.studentProfileV2Service.apiStudentProfileV2GetObjsByClassroomIdGet(this.data.classroomId).subscribe(n=>{if(!n.success)return this.errorStatusObj(n.message,!0);let r=n.data?.studentObjs??[];r=0==n.data?.classroomObj.sortType?this.sortService.sortFirstNameStudents(this.commonService.myClone(r)??[]):this.sortService.sortArrayByMultipleObjectKeyAsc(this.commonService.myClone(r)??[],"pos","id"),this.initFormData(r),this.stopStatusObj()}))}initFormData(n){this.studentObjs=n.map(r=>({...r,isShowStudent:!0,isChecked:new e.MJ(this.data.studentIdsSelected.includes(r.id),{nonNullable:!0})})),this.calculateFormData()}ngOnInit(){this.getData()}constructor(n,r,l,g){super(g,l),this.sortService=n,this.studentProfileV2Service=r,this.dialogRef=l,this.data=g,this.selectAllFormControl=new e.MJ(!1,{nonNullable:!0}),this.showCheckedFormControl=new e.MJ(!1,{nonNullable:!0}),this.studentObjs=[],this.totalStudentsSelected=0,this.totalStudentsShow=0,this.searchContentObj=new p.Z}static#t=this.\u0275fac=function(r){return new(r||i)(t.rXU(A.g),t.rXU(k.m_),t.rXU(u.CP,8),t.rXU(u.Vh,8))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["azt-assign-student-dialog"]],features:[t.Vt3],decls:10,vars:5,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-0"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],["doneLoading",""],[1,"p-3","text-right"],["azt-track-service","azt-dialog-warning-3FIn9IaXN",1,"btn","w-24","btn-primary",3,"click"],[3,"currentStatusObj"],[4,"ngIf","ngIfElse"],["emptyStudents",""],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","flex-col","sm:flex-row","sm:h-auto","sm:items-center"],[1,"font-medium","mr-auto"],[1,"w-full","relative","flex","items-center","mt-2"],[3,"isServerSearch","styleInput","placeholder","onSearch"],[1,"flex","items-center","mt-2","sm:mt-0"],[1,"form-check","mr-3"],["id","selected-all","type","checkbox",1,"form-check-input",3,"formControl","change"],["for","selected-all",1,"form-check-label"],[1,"form-check"],["id","show-student-checked","type","checkbox",1,"form-check-input",3,"formControl","change"],["for","show-student-checked",1,"form-check-label"],[3,"defaultHeight"],["checkedBox",""],[1,"h-full","flex","items-center","justify-center","p-5"],[1,"mx-auto"],[1,"grid","grid-cols-12","gap-3","p-3"],[4,"ngFor","ngForOf"],["class","h-full flex items-center justify-center p-5",4,"ngIf"],["class","col-span-12 md:col-span-4 mt-2",4,"ngIf"],[1,"col-span-12","md:col-span-4","mt-2"],[1,"azt-checkbox-item"],["type","checkbox",1,"form-check-input",3,"id","formControl","change"],[1,"form-check-label","truncate",2,"vertical-align","middle",3,"matTooltip","isDisabledTooltip","matTooltipDisabled","matTooltipShowDelay","for"],["c","isDisabled"]],template:function(r,l){if(1&r&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2),t.DNE(3,b,1,1,"azt-loading-effect",3),t.DNE(4,V,3,2,"ng-template",null,4,t.C5r),t.k0s()(),t.j41(6,"div",5)(7,"button",6),t.bIt("click",function(){return l.btnCloseDialog()}),t.EFF(8),t.nI1(9,"mytranslate"),t.k0s()()()),2&r){const g=t.sdS(5);t.R7$(3),t.Y8G("ngIf",l.statusObj.loading)("ngIfElse",g),t.R7$(5),t.SpI(" ",t.bMT(9,3,"lang_cms_common_ok")," ")}},dependencies:[C.Sq,C.bT,s.oV,e.Zm,e.BC,e.l_,U.K,Y.U,T.f,B.W,f.wp],encapsulation:2})}return i})();var z=a(51913),h=a(3780),O=a(46899),w=a(17818),N=a(45785),W=a(56551),Z=a(15343),D=a(91032),L=a(95825);const _=function(i,S){return{"bg-primary text-white font-medium":i,"hover:bg-slate-100 dark:hover:bg-darkmode-400":S}};function v(i,S){if(1&i){const n=t.RV6();t.j41(0,"button",45),t.bIt("click",function(){t.eBV(n);const l=t.XpG();return t.Njj(l.selectByGroupId(void 0))}),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()}if(2&i){const n=t.XpG();t.Y8G("ngClass",t.l_i(5,_,0===n.mapClassroomGroupDataToForm.groupIdSelected,0!==n.mapClassroomGroupDataToForm.groupIdSelected)),t.R7$(1),t.Lme(" ",t.bMT(2,3,"lang_auto_tat_ca")," (",n.mapClassroomGroupDataToForm.totalAllClassrooms,") ")}}const I=function(i,S){return{"bg-primary text-white font-medium":i," hover:bg-slate-100 dark:hover:bg-darkmode-400":S}};function j(i,S){if(1&i){const n=t.RV6();t.j41(0,"button",48),t.bIt("click",function(){t.eBV(n);const l=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.selectByGroupId(l.groupObj))}),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()}if(2&i){const n=t.XpG().$implicit,r=t.XpG(2);t.Y8G("ngClass",t.l_i(4,I,r.mapClassroomGroupDataToForm.groupIdSelected===n.groupObj.id,r.mapClassroomGroupDataToForm.groupIdSelected!==n.groupObj.id)),t.R7$(1),t.SpI(" ",t.bMT(2,2,n.groupObj.name)+" ("+n.groupObj.totalAllClassrooms+")"," ")}}function M(i,S){if(1&i&&(t.qex(0),t.DNE(1,j,3,7,"button",47),t.bVm()),2&i){const n=S.$implicit;t.R7$(1),t.Y8G("ngIf",n.groupObj.isShowGroup)}}function J(i,S){if(1&i&&(t.qex(0),t.DNE(1,M,2,1,"ng-container",46),t.bVm()),2&i){const n=t.XpG();t.R7$(1),t.Y8G("ngForOf",n.mapClassroomGroupDataToForm.groupObjs)}}function ot(i,S){if(1&i){const n=t.RV6();t.j41(0,"button",49),t.bIt("click",function(){t.eBV(n);const l=t.XpG();return t.Njj(l.sAztMatDrawerService.openDrawer())}),t.nI1(1,"mytranslate"),t.qSk(),t.j41(2,"svg",50),t.nrm(3,"rect",51)(4,"path",52)(5,"path",53),t.k0s()()}2&i&&t.FS9("matTooltip",t.bMT(1,1,"lang_auto_mo_menu"))}function tt(i,S){if(1&i){const n=t.RV6();t.j41(0,"button",54),t.bIt("click",function(){t.eBV(n);const l=t.XpG();return t.Njj(l.sAztMatDrawerService.closeDrawer())}),t.nI1(1,"mytranslate"),t.qSk(),t.j41(2,"svg",50),t.nrm(3,"rect",51)(4,"path",52)(5,"path",55),t.k0s()()}2&i&&t.FS9("matTooltip",t.bMT(1,1,"lang_auto_dong_menu"))}function et(i,S){if(1&i&&(t.j41(0,"span",56),t.EFF(1),t.k0s()),2&i){const n=t.XpG();t.R7$(1),t.SpI(" ",(n.filterObj.isShowChecked?1:0)+(n.filterObj.isShowNotChecked?1:0)," ")}}function nt(i,S){if(1&i&&(t.qex(0),t.j41(1,"span",62),t.EFF(2),t.nI1(3,"mytranslate"),t.k0s(),t.EFF(4),t.nI1(5,"mytranslate"),t.bVm()),2&i){const n=t.XpG().$implicit;t.R7$(2),t.JRh(t.bMT(3,2,n.groupObj.name)),t.R7$(2),t.SpI(" ","("+n.groupObj.totalAllClassrooms+" "+t.bMT(5,4,"lang_testbank_test_list_classes")+")"," ")}}function at(i,S){if(1&i&&(t.j41(0,"span",68),t.EFF(1),t.nI1(2,"slice"),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&i){const n=t.XpG(2).$implicit;t.FS9("matTooltip",n.classroomObj.name),t.R7$(1),t.SpI(" ",t.brH(2,4,n.classroomObj.name,0,25)+"..."," "),t.R7$(3),t.Lme("(",n.classroomObj.studentIdsSelected.length,"/",n.classroomObj.countStudents,")")}}function rt(i,S){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.j41(2,"span"),t.EFF(3),t.k0s()()),2&i){const n=t.XpG(2).$implicit;t.R7$(1),t.SpI(" ",n.classroomObj.name," "),t.R7$(2),t.Lme("(",n.classroomObj.studentIdsSelected.length,"/",n.classroomObj.countStudents,")")}}function it(i,S){1&i&&(t.j41(0,"span",69),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&i&&(t.R7$(1),t.SpI(" ",t.bMT(2,1,"lang_testbank_test_config_share")," "))}const lt=function(i){return{"text-success font-medium":i}};function ct(i,S){if(1&i){const n=t.RV6();t.qex(0),t.j41(1,"div",63),t.bIt("click",function(){t.eBV(n);const l=t.XpG().$implicit,g=t.XpG(2);return t.Njj(g.selectClassroomEvent(l.groupObj,l.classroomObj))}),t.j41(2,"span",64),t.nrm(3,"lucide-icon",65),t.k0s(),t.DNE(4,at,5,8,"span",66),t.DNE(5,rt,4,3,"span",13),t.DNE(6,it,3,3,"span",67),t.nI1(7,"fullPermission"),t.k0s(),t.bVm()}if(2&i){const n=t.XpG().$implicit;let r,l;t.R7$(1),t.Y8G("ngClass",t.eq3(7,lt,n.classroomObj.studentIdsSelected.length>0)),t.R7$(3),t.Y8G("ngIf",(null!==(r=null==n.classroomObj.name?null:n.classroomObj.name.length)&&void 0!==r?r:0)>25),t.R7$(1),t.Y8G("ngIf",(null!==(l=null==n.classroomObj.name?null:n.classroomObj.name.length)&&void 0!==l?l:0)<=25),t.R7$(1),t.Y8G("ngIf",!t.i5U(7,4,n.classroomObj,"classroom"))}}const _t=function(i){return{"grid-column":i}};function mt(i,S){if(1&i&&(t.j41(0,"div",61),t.DNE(1,nt,6,6,"ng-container",13),t.DNE(2,ct,8,9,"ng-container",13),t.k0s()),2&i){const n=S.$implicit;t.Y8G("ngStyle",t.eq3(3,_t,"group"==n.type?"span 12 / span 12":"")),t.R7$(1),t.Y8G("ngIf","group"==n.type),t.R7$(1),t.Y8G("ngIf","classroom"==n.type&&n.classroomObj)}}function dt(i,S){if(1&i&&(t.qex(0),t.j41(1,"ng-scrollbar",57)(2,"cdk-virtual-scroll-viewport",58)(3,"div",59),t.DNE(4,mt,3,5,"div",60),t.k0s()()(),t.bVm()),2&i){const n=t.XpG();t.R7$(1),t.Y8G("visibility","hover"),t.R7$(3),t.Y8G("cdkVirtualForOf",n.mapClassroomGroupDataToVirtualScroll)}}function ut(i,S){1&i&&(t.j41(0,"div",70),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&i&&(t.R7$(1),t.SpI(" ",t.bMT(2,1,"lang_student_classroom_list_class_null")," "))}const ht=function(i,S){return{"classroom-box-in-full-screen-in-mobile":i,"classroom-box-in-full-screen-in-desktop":S}},pt=function(i,S){return{"w-85":i,"w-56":S}},ft=function(i){return{"ml-3":i}};let gt=(()=>{class i extends P.H{searchByClassroomName(n){this.searchByClassroomContentObj=n,this.checkIsFilter(),this.calculateClassroomInfo()}searchByGroupName(n){this.searchByGroupContentObj=n,this.checkIsFilter(),this.calculateClassroomInfo()}changeFilter(){this.checkIsFilter(),this.calculateClassroomInfo()}clearFilter(){this.filterObj={isShowChecked:!1,isShowNotChecked:!1},this.checkIsFilter(),this.calculateClassroomInfo()}checkIsFilter(){return 0!=this.mapClassroomGroupDataToForm.groupIdSelected||this.filterObj.isShowChecked||this.filterObj.isShowNotChecked||""!=this.searchByClassroomContentObj.searchContent.trim()}selectByGroupId(n){this.mapClassroomGroupDataToForm.groupIdSelected=n?.id??0,this.calculateClassroomInfo(),this.scrollable?.scrollTo({top:0,duration:0}),this.isMobileDevice&&this.sAztMatDrawerService.closeDrawer()}selectClassroomEvent(n,r){this.sAztDialogService.open(d,{data:{classroomId:r.id,classroomName:r.name,studentIdsSelected:this.studentsSelected.find(g=>g.classroomId==r.id)?.studentIdsSelected??[]},width:"1000px",autoFocus:!1}).afterClosed().subscribe(g=>{g&&this.chooseStudentsEvent.emit(g)})}calculateClassroomInfo(){this.doFilterData(),this.countFilterData(),this.calculateVirtualScrollData()}doFilterData(){const n=this.searchByClassroomContentObj.searchContent?this.commonService.convertVietnameseToEnglish(this.searchByClassroomContentObj.searchContent).toLowerCase().trim():"",r=this.searchByGroupContentObj.searchContent?this.commonService.convertVietnameseToEnglish(this.searchByGroupContentObj.searchContent).toLowerCase().trim():"";this.mapClassroomGroupDataToForm.groupObjs.forEach(l=>{const g=this.commonService.convertVietnameseToEnglish(l.groupObj.name??"");l.groupObj.isShowGroup=""==r||g.toLowerCase().trim().includes(r),l.classroomObjs.forEach(F=>{if(F.isShowClassroom=!0,!this.checkIsFilter())return;const q=this.commonService.convertVietnameseToEnglish(F.name);let st=0==this.mapClassroomGroupDataToForm.groupIdSelected||l.groupObj.id==this.mapClassroomGroupDataToForm.groupIdSelected,vt=""==n||q.toLowerCase().trim().includes(n);F.isShowClassroom=st&&vt&&(this.filterObj.isShowChecked&&F.studentIdsSelected.length>0||this.filterObj.isShowNotChecked&&F.studentIdsSelected.length<=0||!this.filterObj.isShowChecked&&!this.filterObj.isShowNotChecked)})})}countFilterData(){this.mapClassroomGroupDataToForm.groupObjs.forEach(n=>{n.groupObj.totalAllClassrooms=n.classroomObjs.length,n.groupObj.totalViewClassrooms=n.classroomObjs.filter(r=>r.isShowClassroom).length}),this.mapClassroomGroupDataToForm.totalAllClassrooms=this.mapClassroomGroupDataToForm.groupObjs.reduce((n,r)=>n+r.groupObj.totalAllClassrooms,0),this.mapClassroomGroupDataToForm.totalViewClassrooms=this.mapClassroomGroupDataToForm.groupObjs.reduce((n,r)=>n+r.groupObj.totalViewClassrooms,0)}calculateVirtualScrollData(){var n=[];this.mapClassroomGroupDataToForm.groupObjs.filter(r=>r.groupObj.totalViewClassrooms>0).forEach(r=>{n.push({type:"group",groupObj:r.groupObj,classroomObj:void 0}),r.classroomObjs.filter(l=>l.isShowClassroom).forEach(l=>{n.push({type:"classroom",groupObj:r.groupObj,classroomObj:l})})}),this.mapClassroomGroupDataToVirtualScroll=n}initClassroomData(){this.classroomGroupData=this.classroomGroupData.map(n=>({groupObj:n.groupObj,isOwned:n.isOwned,classroomObjs:n.classroomObjs.filter(r=>null!=r.permissionObj&&this.permissionService.hasCreatePermission(this.listPermissionTypes[this.permissionName],r))})),this.mapClassroomGroupDataToForm.groupObjs=this.classroomGroupData.map(n=>({groupObj:{...n.groupObj,isShowGroup:!0,totalAllClassrooms:0,totalViewClassrooms:0},isOwned:n.isOwned,classroomObjs:n.classroomObjs.map(r=>{let l=this.studentsSelected.find(g=>g.classroomId==r.id)?.studentIdsSelected??[];return{...r,studentIdsSelected:l,isShowClassroom:!0}})})),this.calculateClassroomInfo()}ngOnChanges(){this.initClassroomData()}ngOnInit(){super.ngOnInit(),this.classroomGroupData.forEach(n=>n.classroomObjs.map(r=>r.name=this.commonService.myTranslateInstant(r.name)??"")),this.initClassroomData()}constructor(n,r,l,g){super(),this.sAztMatDrawerService=n,this.permissionService=r,this.sAztClassroomCheckboxService=l,this.sAztDialogService=g,this.permissionName=c.t.exam,this.defaultCssClass="classroom-box-in-single-page",this.chooseStudentsEvent=new t.bkB,this.studentsSelected=[],this.mapClassroomGroupDataToForm={groupObjs:[],groupIdSelected:0,totalAllClassrooms:0,totalViewClassrooms:0},this.mapClassroomGroupDataToVirtualScroll=[],this.listPermissionTypes=c.t,this.searchByClassroomContentObj=new p.Z,this.searchByGroupContentObj=new p.Z,this.filterObj={isShowChecked:!1,isShowNotChecked:!1}}static#t=this.\u0275fac=function(r){return new(r||i)(t.rXU(m.n),t.rXU(z.p),t.rXU(h.Q),t.rXU(O.i))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["azt-list-classroom-view-tree"]],viewQuery:function(r,l){if(1&r&&t.GBs(o.Yh,7),2&r){let g;t.mGM(g=t.lsd())&&(l.scrollable=g.first)}},inputs:{classroomGroupData:"classroomGroupData",permissionName:"permissionName",defaultCssClass:"defaultCssClass",studentsSelected:"studentsSelected"},outputs:{chooseStudentsEvent:"chooseStudentsEvent"},features:[t.Jv_([m.n]),t.Vt3,t.OA$],decls:66,vars:55,consts:[["maximize","",1,"azt-list-classroom-by-group"],["maximize","maximize"],[1,"azt-drawer-container",3,"ngClass","hasBackdrop"],[3,"ngClass","mode","opened","openedChange"],["drawer",""],[1,"box","h-full","border","border-slate-200/60","dark:border-darkmode-400"],[1,"flex","rounded-md","border-b","border-slate-200","dark:border-darkmode-400","p-2","text-slate-500",2,"border-bottom-right-radius","0","border-bottom-left-radius","0"],[1,"search-box"],[3,"isServerSearch","placeholder","searchContentObj","styleInput","onSearch"],[2,"height","calc(100% - 50px)"],["track","vertical","pointerEventsMethod","scrollbar",1,"w-full",3,"visibility"],[1,"p-2"],["azt-track-service","azt-list-classroom-checkbox-TUrZzBy9T","class","flex items-center px-3 py-2 rounded-md w-full",3,"ngClass","click",4,"ngIf"],[4,"ngIf"],[1,"azt-drawer-content","h-full",3,"ngClass"],[1,"box","border","border-slate-200","dark:border-darkmode-400","h-full"],[1,"flex","items-center","rounded-md","border-b","border-slate-200","dark:border-darkmode-400","p-2","text-slate-500",2,"border-bottom-right-radius","0","border-bottom-left-radius","0"],["azt-track-service","azt-list-classroom-checkbox-WB1u8XZHUS","class","btn btn-sm mr-2",3,"matTooltip","click",4,"ngIf"],["azt-track-service","azt-list-classroom-checkbox-q2BPTM5lPo","class","btn btn-sm mr-2",3,"matTooltip","click",4,"ngIf"],[1,"flex","ml-auto"],[1,"mr-2"],[1,"filter","mr-2"],[1,"btn","btn-sm",3,"matMenuTriggerFor"],[1,"w-4","h-4","inline-block"],["name","filter","size","18"],[1,"azt-hidden","md:block","ml-2"],["class","p-1 ml-1 items-center justify-center rounded-full text-xs bg-primary text-white cursor-pointer font-medium","style","display: inline-flex; width: 15px; height: 15px; font-size: 10px",4,"ngIf"],[1,"flex","items-center"],[3,"maximize"],["menuFilter","matMenu"],[1,"dropdown-menu","show","relative","w-56"],[1,"dropdown-content"],["azt-track-service","azt-list-classroom-checkbox-mJWF3uWTQJ","for","isShowChecked",1,"dropdown-item","cursor-pointer",3,"click"],[1,"form-check","form-switch","ml-auto"],["id","isShowChecked","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],["azt-track-service","azt-list-classroom-checkbox-pFWk_nWN9o","for","isShowNotChecked",1,"dropdown-item","cursor-pointer",3,"click"],["id","isShowNotChecked","type","checkbox",1,"show-code","form-check-input","ml-2",3,"checked","change"],[1,"dropdown-divider"],[1,"flex","p-1"],[1,"btn","btn-secondary","py-1","px-2","ml-auto","mr-2"],["azt-track-service","azt-list-classroom-checkbox-3OFGLRY5fa",3,"click"],["azt-track-service","azt-list-classroom-checkbox-iJlkvwO36n",1,"btn","btn-danger","py-1","px-2",3,"click"],[1,"w-full",2,"height","calc(100% - 50px)"],[4,"ngIf","ngIfElse"],["emptyClassroom",""],["azt-track-service","azt-list-classroom-checkbox-TUrZzBy9T",1,"flex","items-center","px-3","py-2","rounded-md","w-full",3,"ngClass","click"],[4,"ngFor","ngForOf"],["azt-track-service","azt-list-classroom-checkbox-hUXQqnl7px","class","flex items-center px-3 py-2 rounded-md w-full text-left",3,"ngClass","click",4,"ngIf"],["azt-track-service","azt-list-classroom-checkbox-hUXQqnl7px",1,"flex","items-center","px-3","py-2","rounded-md","w-full","text-left",3,"ngClass","click"],["azt-track-service","azt-list-classroom-checkbox-WB1u8XZHUS",1,"btn","btn-sm","mr-2",3,"matTooltip","click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"lucide","lucide-menu","w-4","h-4"],["x","3","y","3","width","18","height","18","rx","2","ry","2"],["d","M9 3v18"],["d","m14 9 3 3-3 3"],["azt-track-service","azt-list-classroom-checkbox-q2BPTM5lPo",1,"btn","btn-sm","mr-2",3,"matTooltip","click"],["d","m16 15-3-3 3-3"],[1,"p-1","ml-1","items-center","justify-center","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium",2,"display","inline-flex","width","15px","height","15px","font-size","10px"],["track","vertical",1,"h-full",3,"visibility"],["scrollViewport","","itemSize","10"],[1,"grid","grid-cols-12","gap-3","p-3","pt-2"],["class","col-span-12 md:col-span-6",3,"ngStyle",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"col-span-12","md:col-span-6",3,"ngStyle"],[1,"font-bold"],["azt-track-service","azt-list-classroom-view-tree-o6QRGuakJ",1,"flex","items-center","clickable","hover:text-primary",3,"ngClass","click"],[1,"w-4","h-4","inline-block","mr-2"],["name","align-justify"],[3,"matTooltip",4,"ngIf"],["class","ml-2 py-0.5 px-2 rounded-full text-xs bg-primary text-white cursor-pointer font-medium",4,"ngIf"],[3,"matTooltip"],[1,"ml-2","py-0.5","px-2","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium"],[1,"flex","items-center","justify-center",2,"height","200px"]],template:function(r,l){if(1&r&&(t.j41(0,"div",0,1)(2,"mat-drawer-container",2)(3,"mat-drawer",3,4),t.bIt("openedChange",function(F){return l.sAztMatDrawerService.openedChange(F)}),t.j41(5,"div",5)(6,"div",6)(7,"div",7)(8,"azt-search-box",8),t.bIt("onSearch",function(F){return l.searchByGroupName(F.searchObj)}),t.nI1(9,"mytranslate"),t.k0s()()(),t.j41(10,"div",9)(11,"ng-scrollbar",10)(12,"div",11),t.DNE(13,v,3,8,"button",12),t.DNE(14,J,2,1,"ng-container",13),t.k0s()()()()(),t.j41(15,"mat-drawer-content")(16,"div",14)(17,"div",15)(18,"div",16),t.DNE(19,ot,6,3,"button",17),t.DNE(20,tt,6,3,"button",18),t.j41(21,"div",19)(22,"div",20)(23,"azt-search-box",8),t.bIt("onSearch",function(F){return l.searchByClassroomName(F.searchObj)}),t.nI1(24,"mytranslate"),t.k0s()(),t.j41(25,"div",21)(26,"button",22)(27,"span",23),t.nrm(28,"lucide-icon",24),t.k0s(),t.j41(29,"span",25),t.EFF(30),t.nI1(31,"mytranslate"),t.DNE(32,et,2,1,"span",26),t.k0s()()(),t.j41(33,"div",27),t.nrm(34,"azt-maximize-box",28),t.k0s(),t.j41(35,"mat-menu",null,29)(37,"div",30)(38,"ul",31)(39,"li")(40,"label",32),t.bIt("click",function(F){return F.stopPropagation()}),t.EFF(41),t.nI1(42,"mytranslate"),t.j41(43,"div",33)(44,"input",34),t.bIt("change",function(){return l.filterObj.isShowChecked=!l.filterObj.isShowChecked,l.changeFilter()}),t.k0s()()()(),t.j41(45,"li")(46,"label",35),t.bIt("click",function(F){return F.stopPropagation()}),t.EFF(47),t.nI1(48,"mytranslate"),t.j41(49,"div",33)(50,"input",36),t.bIt("change",function(){return l.filterObj.isShowNotChecked=!l.filterObj.isShowNotChecked,l.changeFilter()}),t.k0s()()()(),t.j41(51,"li"),t.nrm(52,"hr",37),t.k0s(),t.j41(53,"li")(54,"div",38)(55,"button",39),t.EFF(56),t.nI1(57,"mytranslate"),t.k0s(),t.j41(58,"div",40),t.bIt("click",function(F){return F.stopPropagation()}),t.j41(59,"button",41),t.bIt("click",function(){return l.clearFilter()}),t.EFF(60),t.nI1(61,"mytranslate"),t.k0s()()()()()()()()(),t.j41(62,"div",42),t.DNE(63,dt,5,2,"ng-container",43),t.DNE(64,ut,3,3,"ng-template",null,44,t.C5r),t.k0s()()()()()()),2&r){const g=t.sdS(1),F=t.sdS(36),q=t.sdS(65);t.R7$(2),t.HbH(l.defaultCssClass),t.Y8G("ngClass",t.l_i(47,ht,l.isMobileDevice,!l.isMobileDevice))("hasBackdrop",l.sAztMatDrawerService.hasBackdrop),t.R7$(1),t.FS9("opened",l.sAztMatDrawerService.isOpenSideNav?"true":"false"),t.Y8G("ngClass",t.l_i(50,pt,l.isMobileDevice,!l.isMobileDevice))("mode",l.sAztMatDrawerService.mode),t.R7$(5),t.Y8G("isServerSearch",!1)("placeholder",t.bMT(9,33,"lang_azt_search_class_group"))("searchContentObj",l.searchByGroupContentObj)("styleInput","pr-10 py-1"),t.R7$(3),t.Y8G("visibility","hover"),t.R7$(2),t.Y8G("ngIf",!l.searchByGroupContentObj.searchContent),t.R7$(1),t.Y8G("ngIf",l.mapClassroomGroupDataToForm.groupObjs.length>1),t.R7$(2),t.Y8G("ngClass",t.eq3(53,ft,!l.isMobileDevice&&l.sAztMatDrawerService.isOpenSideNav)),t.R7$(3),t.Y8G("ngIf",!l.sAztMatDrawerService.isOpenSideNav||l.isMobileDevice),t.R7$(1),t.Y8G("ngIf",l.sAztMatDrawerService.isOpenSideNav&&!l.isMobileDevice),t.R7$(3),t.Y8G("isServerSearch",!1)("placeholder",t.bMT(24,35,"lang_azt_search_class"))("searchContentObj",l.searchByClassroomContentObj)("styleInput","py-1"),t.R7$(3),t.Y8G("matMenuTriggerFor",F),t.R7$(4),t.SpI(" ",t.bMT(31,37,"lang_testbank_tested_list_sort")," "),t.R7$(2),t.Y8G("ngIf",l.filterObj.isShowChecked||l.filterObj.isShowNotChecked),t.R7$(2),t.Y8G("maximize",g),t.R7$(7),t.SpI(" ",t.bMT(42,39,"lang_azt_selected_classes")," "),t.R7$(3),t.Y8G("checked",l.filterObj.isShowChecked),t.R7$(3),t.SpI(" ",t.bMT(48,41,"lang_azt_unselected_classes")," "),t.R7$(3),t.Y8G("checked",l.filterObj.isShowNotChecked),t.R7$(6),t.JRh(t.bMT(57,43,"lang_button_close")),t.R7$(4),t.JRh(t.bMT(61,45,"lang_button_delete")),t.R7$(3),t.Y8G("ngIf",l.mapClassroomGroupDataToForm.totalViewClassrooms>0)("ngIfElse",q)}},dependencies:[C.YU,C.Sq,C.bT,C.B3,w.kk,w.Cp,N.qe,N.$C,N.$l,s.oV,W.yg,W.E$,W.d6,o.Yh,o.Gl,Z.WGl,D.e,B.W,L.g,C.P9,f.wp,f.gC],encapsulation:2})}return i})();function bt(i,S){1&i&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&i&&(t.R7$(1),t.JRh(t.bMT(2,1,"lang_testbank_test_config_you_not_yet_student")))}function Ct(i,S){if(1&i){const n=t.RV6();t.j41(0,"div")(1,"azt-list-classroom-view-tree",1),t.bIt("chooseStudentsEvent",function(l){t.eBV(n);const g=t.XpG();return t.Njj(g.chooseStudentsEvent(l))}),t.k0s(),t.j41(2,"div",2)(3,"div",3),t.DNE(4,bt,3,3,"span",0),t.k0s()()()}if(2&i){const n=t.XpG();t.R7$(1),t.Y8G("classroomGroupData",n.classroomGroupData)("studentsSelected",n.studentsSelected)("permissionName",n.permissionName),t.R7$(3),t.Y8G("ngIf",n.form.controls.studentIds.errors)}}let Ot=(()=>{class i extends P.H{chooseStudentsEvent(n){let r=this.form.controls.studentIds.controls.filter(l=>l.controls.classroomId.value!=n.classroomId);this.form.controls.studentIds.clear(),r.forEach(l=>{this.form.controls.studentIds.push(l)}),n.studentIdsSelected.forEach(l=>{this.form.controls.studentIds.push(new e.gE({classroomId:new e.MJ(n.classroomId,{nonNullable:!0}),studentId:new e.MJ(l,{nonNullable:!0})}))}),this.calculateStudentsSelected()}initStudentsControl(){this.form.controls.studentIds.clear(),this.examStudentObjs.forEach(n=>{this.form.controls.studentIds.push(new e.gE({classroomId:new e.MJ(n.classroomId,{nonNullable:!0}),studentId:new e.MJ(n.studentId,{nonNullable:!0})}))}),this.calculateStudentsSelected()}calculateStudentsSelected(){let n=[],r=this.commonService.arrayToDictionary(this.form.controls.studentIds.getRawValue(),l=>l.classroomId.toString());Object.entries(r).forEach(([l,g],F)=>{let q=this.commonService.getFirstOfArray(g)?.classroomId;q&&n.push({classroomId:q,classroomName:"",studentIdsSelected:g.map(st=>st.studentId)})}),this.studentsSelected=n}ngOnInit(){super.ngOnInit(),this.initStudentsControl()}constructor(){super(),this.examStudentObjs=[],this.permissionName=c.t.exam,this.studentsSelected=[]}static#t=this.\u0275fac=function(r){return new(r||i)};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["list-student-checkbox"]],inputs:{form:"form",classroomGroupData:"classroomGroupData",examStudentObjs:"examStudentObjs",permissionName:"permissionName"},features:[t.Vt3],decls:1,vars:1,consts:[[4,"ngIf"],[3,"classroomGroupData","studentsSelected","permissionName","chooseStudentsEvent"],[1,"mt-2"],[1,"text-xs","font-medium","text-danger"]],template:function(r,l){1&r&&t.DNE(0,Ct,5,4,"div",0),2&r&&t.Y8G("ngIf",l.form)},dependencies:[C.bT,gt,f.wp],encapsulation:2})}return i})()},92654:($,y,a)=>{a.d(y,{x:()=>u});var e=a(51698),c=a(82716),P=a(33860),t=a(57003),C=a(92274),o=a(26860),m=a(91930),p=a(46899);let u=(()=>{class x{doExamAction(k,s){switch(s){case C.$.CONFIG_EXAM_CLASSROOM:return this.showConfigExamClassroomDialog(k);case C.$.SHOW_EXAM_DETAIL:this.showExamDetailDialog(k);break;case C.$.SHARE_OFFLINE_RESULT:this.showOfflineShareDialog(k);break;case C.$.COPY_EXAM_LINK:this.copyExamLink()}return this.returnUndefinedOutput()}copyExamLink(){this.commonService.snackSuccess("lang_auto_sao_chep_thanh_cong")}showConfigExamClassroomDialog(k){return new e.c(s=>{this.sAztDialogService.open(t.Q,{width:"900px",data:{hashId:k.examObj.hashId,examStudents:k.examObj?.examStudents??[]},restoreFocus:!1}).afterClosed().subscribe(Y=>{Y?(s.next({reloadData:!0}),s.complete()):(s.next(void 0),s.complete())})})}showExamDetailDialog(k){let s={obj:{...k.examObj,countQuestion:0,showFrontend:1,editable:!0,allowStudentView:!0},globalLadingPage:k.globalLadingPage,curCateId:k.categoryId,isOnLib:0,isShow:!0,showDelete:!0};this.sAztDialogService.open(P.c,{width:"800px",maxWidth:"90vw",enterAnimationDuration:"0ms",exitAnimationDuration:"0ms",data:s,restoreFocus:!1}).afterClosed().subscribe(Y=>{})}showOfflineShareDialog(k){this.sAztDialogService.open(c.h,{width:"1000px",data:{examHashId:k.examObj.hashId,useDialog:!0},restoreFocus:!1})}returnUndefinedOutput(){return new e.c(k=>{k.next(void 0),k.complete()})}constructor(k,s){this.commonService=k,this.sAztDialogService=s}static#t=this.\u0275fac=function(s){return new(s||x)(o.KVO(m.R),o.KVO(p.i))};static#e=this.\u0275prov=o.jDH({token:x,factory:x.\u0275fac,providedIn:"root"})}return x})()},31291:($,y,a)=>{a.d(y,{n:()=>t});var e=a(43362),c=a(26860),P=a(91930);let t=(()=>{class C{sortExamByColumn(m,p,u){return p==e.N.BY_NAME?this.sortExamByName(m,u):p==e.N.BY_PUBLISH_STATUS?this.sortExamByPublishStatus(m,u):p==e.N.BY_UPDATED_DATE?this.sortExamByDateUpdated(m,u):p==e.N.BY_ATTENDED?this.sortExamByAttended(m,u):this.sortExamByName(m,u)}sortExamByName(m,p){var u=[...m.rootCategoryObjs??[]],x=[...m.rootDocumentObjs??[]];return 1==p?{categoryObjs:this._sortCateByName(u),documentObjs:this._sortDocumentByName(x)}:{categoryObjs:this._sortCateByName(u).reverse(),documentObjs:this._sortDocumentByName(x).reverse()}}sortExamByPublishStatus(m,p){var u=[...m.rootDocumentObjs??[]];return 1==p?{categoryObjs:m.currentCategoryObjs,documentObjs:this._sortDocumentByPublish(u,u?.length)}:{categoryObjs:m.currentCategoryObjs,documentObjs:this._sortDocumentByPublish(u,u?.length).reverse()}}sortExamByDateUpdated(m,p){var u=this.commonService.castObj(m.rootCategoryObjs),x=this.commonService.castObj(m.rootDocumentObjs);return 1==p?{categoryObjs:this._sortCateByDateUpdateExam(u??[]),documentObjs:this._sortDocumentByUpdateTime(x??[])}:{categoryObjs:this._sortCateByDateUpdateExam(u??[]).reverse(),documentObjs:this._sortDocumentByUpdateTime(x??[]).reverse()}}sortExamByAttended(m,p){var u=this.commonService.castObj(m.rootDocumentObjs);return 1==p?{categoryObjs:m.currentCategoryObjs,documentObjs:this._sortDocumentByAttended(u??[])}:{categoryObjs:m.currentCategoryObjs,documentObjs:this._sortDocumentByAttended(u??[]).reverse()}}_sortCateByName(m){return m?.sort((p,u)=>(p.name?.trim()??"").localeCompare(u.name?.trim()??""))??[]}_sortDocumentByName(m){return m?.sort((p,u)=>(p.name?.trim()??"").localeCompare(u.name?.trim()??""))??[]}_sortDocumentByPublish(m,p){let u=[],x=[];for(let A=0;A<(p??0);A++)0==m?.[A].isPublished&&u.push(m[A]),1==m?.[A].isPublished&&x.push(m[A]);return u.concat(x)}_sortCateByDateUpdateExam(m){return m.sort((p,u)=>Number(new Date(p.updatedAt??""))-Number(new Date(u.updatedAt??""))),m}_sortDocumentByUpdateTime(m){return m?.sort((p,u)=>Number(new Date(p.updatedAt??""))-Number(new Date(u.updatedAt??"")))}_sortDocumentByAttended(m){return m?.sort((p,u)=>Number(p.attended)-Number(u.attended))}constructor(m){this.commonService=m}static#t=this.\u0275fac=function(p){return new(p||C)(c.KVO(P.R))};static#e=this.\u0275prov=c.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()},92274:($,y,a)=>{a.d(y,{$:()=>e});var e=function(c){return c[c.CONFIG_EXAM_CLASSROOM=0]="CONFIG_EXAM_CLASSROOM",c[c.SHOW_EXAM_DETAIL=1]="SHOW_EXAM_DETAIL",c[c.SHARE_OFFLINE_RESULT=2]="SHARE_OFFLINE_RESULT",c[c.COPY_EXAM_LINK=3]="COPY_EXAM_LINK",c}(e||{})},45306:($,y,a)=>{a.d(y,{d:()=>e});var e=function(c){return c[c.OFFLINE_CONFIG=0]="OFFLINE_CONFIG",c[c.CONFIG_EXAM=1]="CONFIG_EXAM",c[c.EDIT_EXAM=2]="EDIT_EXAM",c[c.POWER_POINT=3]="POWER_POINT",c[c.STATISTIC=4]="STATISTIC",c[c.TESTED_LIST=5]="TESTED_LIST",c}(e||{})},43362:($,y,a)=>{a.d(y,{N:()=>e});var e=function(c){return c[c.BY_NAME=0]="BY_NAME",c[c.BY_PUBLISH_STATUS=1]="BY_PUBLISH_STATUS",c[c.BY_UPDATED_DATE=2]="BY_UPDATED_DATE",c[c.BY_ATTENDED=3]="BY_ATTENDED",c}(e||{})},45168:($,y,a)=>{a.d(y,{C:()=>e});var e=function(c){return c[c.multipleChoice=1]="multipleChoice",c[c.essay=3]="essay",c[c.trueFalse=5]="trueFalse",c[c.fill=4]="fill",c}(e||{})},51221:($,y,a)=>{a.d(y,{$:()=>e});var e=function(c){return c.COPY="copy",c.CUT="cut",c.DELETE="delete",c}(e||{})},9306:($,y,a)=>{a.d(y,{Y:()=>e});var e=function(c){return c[c.EXAM_CATEGORY=0]="EXAM_CATEGORY",c[c.EXAM=1]="EXAM",c}(e||{})},30977:($,y,a)=>{a.d(y,{g:()=>t});var e=a(51221),c=a(9306),P=a(26860);let t=(()=>{class C{constructor(){this.clipboardObjs=[]}setActionToClipboard(m,p,u,x){var A={id:m,name:x,type:p,action:u};this.clipboardObjs.filter(s=>s.id==A.id&&s.type==A.type).length>0?this.clipboardObjs.forEach(s=>{s.id==A.id&&s.type==A.type&&(s.action=A.action)}):this.clipboardObjs.push(A)}hasInClipboard(m,p){return this.clipboardObjs.filter(x=>x.id==m&&x.type==p).length>0}hasCopyFolderActionInClipboard(){var m=!1;return this.clipboardObjs.forEach(p=>{p.type==c.Y.EXAM_CATEGORY&&p.action==e.$.COPY&&(m=!0)}),m}getActionOfDocumentObj(m,p){var u=this.clipboardObjs.filter(x=>x.id==m&&x.type==p);if(u&&u.length>0)return u[0].action}removeDocumentInClipboard(m,p){for(var u=0;u<this.clipboardObjs.length;u++)this.clipboardObjs[u].id==m&&this.clipboardObjs[u].type==p&&this.clipboardObjs.splice(u,1)}isPasteToSelfFolder(m){var p=!1;return this.clipboardObjs.forEach(u=>{u.id==m&&u.type==c.Y.EXAM_CATEGORY&&u.action==e.$.COPY&&(p=!0)}),p}getCurrentClipBoard(){return this.clipboardObjs}resetClipBoardAfterPasteOrCancelAllActions(){this.clipboardObjs=[]}static#t=this.\u0275fac=function(p){return new(p||C)};static#e=this.\u0275prov=P.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()},48485:($,y,a)=>{a.d(y,{H:()=>e});class e{static studentCheckBoxValidator(P){const C=P.controls.whoAllow,o=P.controls.studentIds;return C&&o?3!=C.value||e.countCheckBox(o)>=1?(o.setErrors(null),null):(o.setErrors({studentCheckBoxValidator:!0}),{identityRevealed:!0}):null}static countCheckBox(P){return P.getRawValue().length}}},62538:($,y,a)=>{a.d(y,{O:()=>Y});var e=a(26860),c=a(45168),P=a(59640),t=a(67638),C=a(54460),o=a(73437);const m=["table"];function p(T,B){if(1&T&&(e.j41(0,"td",6),e.EFF(1),e.nI1(2,"formatOfflineExamHashIdToNumber"),e.k0s()),2&T){const f=B.$implicit,b=B.index;e.BMQ("excelRow",1)("excelColumn",b+1),e.R7$(1),e.SpI(" ",e.bMT(2,3,null==f?null:f.offlineMixQuestionHashId)," ")}}function u(T,B){if(1&T&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&T){const f=e.XpG(2).$implicit,b=e.XpG().$implicit;e.R7$(1),e.SpI(" ",e.bMT(2,1,f.offlineQuestionObjs[b].answer)," ")}}function x(T,B){1&T&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&T&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"lang_core_essay_question")," "))}function A(T,B){if(1&T&&(e.j41(0,"span"),e.DNE(1,u,3,3,"span",7),e.DNE(2,x,3,3,"span",7),e.k0s()),2&T){const f=e.XpG().$implicit,b=e.XpG().$implicit;e.R7$(1),e.Y8G("ngIf",!(null!=f.offlineQuestionObjs&&null!=f.offlineQuestionObjs[b]&&f.offlineQuestionObjs[b].isEssay)),e.R7$(1),e.Y8G("ngIf",null==f.offlineQuestionObjs||null==f.offlineQuestionObjs[b]?null:f.offlineQuestionObjs[b].isEssay)}}function k(T,B){if(1&T&&(e.j41(0,"td",6),e.DNE(1,A,3,2,"span",7),e.k0s()),2&T){const f=B.$implicit,b=B.index,R=e.XpG().$implicit;let G;e.BMQ("excelRow",R+2)("excelColumn",b+1),e.R7$(1),e.Y8G("ngIf",(null!==(G=null==f.offlineQuestionObjs?null:f.offlineQuestionObjs.length)&&void 0!==G?G:0)>R)}}const s=function(){return[]};function U(T,B){if(1&T&&(e.j41(0,"tr")(1,"td",3),e.EFF(2),e.k0s(),e.DNE(3,k,2,3,"td",4),e.k0s()),2&T){const f=B.$implicit,b=e.XpG();let R;e.R7$(1),e.BMQ("excelRow",f+2)("excelColumn",0),e.R7$(1),e.SpI(" ",f+b.startQuestionIndex," "),e.R7$(1),e.Y8G("ngForOf",null!==(R=null==b.obj?null:b.obj.offlineMixQuestionObjs)&&void 0!==R?R:e.lJ4(4,s))}}let Y=(()=>{class T extends P.H{calculateMaxQuestion(){let f=0;return this.obj.offlineMixQuestionObjs&&this.obj.offlineMixQuestionObjs.forEach(b=>{f<(b.offlineQuestionObjs?.length??0)&&(f=b.offlineQuestionObjs?.length??0)}),f}processData(){for(let f=0;f<this.obj.offlineMixQuestionObjs.length;f++)for(let b=0;b<this.obj.offlineMixQuestionObjs[f].offlineQuestionObjs.length;b++)this.obj.offlineMixQuestionObjs[f].offlineQuestionObjs[b].answerType===this.offlineAnswerType.trueFalse&&(this.obj.offlineMixQuestionObjs[f].offlineQuestionObjs[b].answer=this.convertAnswerTrueFalse(this.obj.offlineMixQuestionObjs[f].offlineQuestionObjs[b].answer))}convertAnswerTrueFalse(f){const b=f.split(","),R=this.commonService.myClone(this.answerChoiceMap),G=this.commonService.myTranslateInstant("lang_testbank_correct_answer_to_offline_exam"),X=this.commonService.myTranslateInstant("lang_testbank_wrong_answer_to_offline_exam");return R.map(K=>b.includes(K)?G:X).join("")}ngOnChanges(){this.processData(),this.isExported=!1,this.maxQuestionIndex=this.calculateMaxQuestion(),this.totalExamCode=this.obj.offlineMixQuestionObjs?.length??0}ngAfterViewChecked(){0==this.isExported&&(this.isExported=!0,setTimeout(()=>{this.exportDataDone.emit(this.exportExcelService.exportHtmlTableToExcelBlob(this.table,!0))},0))}constructor(f){super(),this.exportExcelService=f,this.startQuestionIndex=1,this.exportDataDone=new e.bkB,this.maxQuestionIndex=0,this.totalExamCode=0,this.isExported=!1,this.offlineAnswerType=c.C,this.answerChoiceMap=["A","B","C","D"]}static#t=this.\u0275fac=function(b){return new(b||T)(e.rXU(t.x))};static#e=this.\u0275cmp=e.VBU({type:T,selectors:[["azt-export-excel-for-answersheet"]],viewQuery:function(b,R){if(1&b&&e.GBs(m,5),2&b){let G;e.mGM(G=e.lsd())&&(R.table=G.first)}},inputs:{obj:"obj",startQuestionIndex:"startQuestionIndex"},outputs:{exportDataDone:"exportDataDone"},features:[e.Vt3,e.OA$],decls:14,vars:16,consts:[[1,"table","table-bordered",2,"display","none"],["table",""],["rowspan","2","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["class","text-center azt-excel-cell","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',1,"text-center","azt-excel-cell"],[4,"ngIf"]],template:function(b,R){if(1&b&&(e.j41(0,"table",0,1)(2,"tbody")(3,"tr")(4,"td",2),e.EFF(5),e.nI1(6,"mytranslate"),e.k0s(),e.j41(7,"td",3),e.EFF(8),e.nI1(9,"mytranslate"),e.k0s()(),e.j41(10,"tr"),e.DNE(11,p,3,5,"td",4),e.k0s(),e.DNE(12,U,4,5,"tr",5),e.nI1(13,"createEmptyArray"),e.k0s()()),2&b){let G;e.R7$(4),e.BMQ("excelRow",0)("excelColumn",0),e.R7$(1),e.SpI(" ",e.bMT(6,9,"lang_testbank_answersheet_question_title")," "),e.R7$(2),e.BMQ("colspan",R.totalExamCode)("excelRow",0)("excelColumn",1),e.R7$(1),e.SpI(" ",e.bMT(9,11,"lang_auto_ma_de_thi")," "),e.R7$(3),e.Y8G("ngForOf",null!==(G=null==R.obj?null:R.obj.offlineMixQuestionObjs)&&void 0!==G?G:e.lJ4(15,s)),e.R7$(1),e.Y8G("ngForOf",e.bMT(13,13,R.maxQuestionIndex))}},dependencies:[C.Sq,C.bT,o.wp,o.IX,o.c],encapsulation:2})}return T})()},82716:($,y,a)=>{a.d(y,{h:()=>Q});var e=a(10936),c=a(89163),P=a(33887),t=a(38009),C=a(80037),o=a(26860),m=a(2145),p=a(3780),u=a(54460),x=a(64160),A=a(15343),k=a(81587),s=a(27985),U=a(52811),Y=a(73437);function T(E,V){1&E&&(o.j41(0,"div",8)(1,"span",9),o.nrm(2,"azt-loading-ui"),o.k0s(),o.j41(3,"span",10),o.EFF(4,"Loading..."),o.k0s()())}function B(E,V){if(1&E){const d=o.RV6();o.j41(0,"div",26)(1,"azt-list-classroom-checkbox",27),o.bIt("changeCheckboxEvent",function(h){o.eBV(d);const O=o.XpG(3);return o.Njj(O.changeStatusOfflineShare(h))}),o.k0s()()}if(2&E){const d=o.XpG(3);o.R7$(1),o.Y8G("form",d.form)("classroomGroupData",d.classroomWithGroup)("shareClassroomIds",d.shareClassroomIds)("permissionName",d.permissionTypes.exam)("defaultCssClass","classroom-box-in-dialog")}}function f(E,V){if(1&E){const d=o.RV6();o.j41(0,"div",28),o.nrm(1,"input",29),o.j41(2,"button",30),o.bIt("click",function(){o.eBV(d);const h=o.XpG(3);return o.Njj(h.showCopySuccess())}),o.j41(3,"span",31),o.nrm(4,"lucide-icon",32),o.k0s(),o.EFF(5),o.nI1(6,"mytranslate"),o.k0s()()}if(2&E){const d=o.XpG(3);o.R7$(1),o.Y8G("value",d.linkCopy),o.R7$(1),o.Y8G("cdkCopyToClipboard",d.copyLinkToClipboard()),o.R7$(3),o.SpI(" ",o.bMT(6,3,"lang_auto_sao_chep")," ")}}function b(E,V){1&E&&(o.j41(0,"div",33)(1,"p",34),o.EFF(2),o.nI1(3,"mytranslate"),o.k0s()()),2&E&&(o.R7$(2),o.JRh(o.bMT(3,1,"lang_auto_chua_duoc_cau_hinh_tra_de_thi")))}function R(E,V){if(1&E){const d=o.RV6();o.qex(0),o.j41(1,"div",14)(2,"div",15)(3,"input",16),o.bIt("change",function(){o.eBV(d);const h=o.XpG(2);return o.Njj(h.changeStatusOfflineShare(void 0))}),o.k0s(),o.j41(4,"label",17),o.EFF(5),o.nI1(6,"mytranslate"),o.k0s()(),o.j41(7,"div",18)(8,"input",19),o.bIt("change",function(){o.eBV(d);const h=o.XpG(2);return o.Njj(h.changeStatusOfflineShare(void 0))}),o.k0s(),o.j41(9,"label",20),o.EFF(10),o.nI1(11,"mytranslate"),o.k0s()(),o.j41(12,"div",18)(13,"input",21),o.bIt("change",function(){o.eBV(d);const h=o.XpG(2);return o.Njj(h.changeStatusOfflineShare(void 0))}),o.k0s(),o.j41(14,"label",22),o.EFF(15),o.nI1(16,"mytranslate"),o.k0s()()(),o.DNE(17,B,2,5,"div",23),o.DNE(18,f,7,5,"div",24),o.DNE(19,b,4,3,"div",25),o.nI1(20,"fullPermission"),o.bVm()}if(2&E){const d=o.XpG(2);o.R7$(3),o.Y8G("value",0),o.R7$(2),o.JRh(o.bMT(6,9,"lang_auto_khong")),o.R7$(3),o.Y8G("value",1),o.R7$(2),o.JRh(o.bMT(11,11,"lang_auto_tat_ca_cac_lop")),o.R7$(3),o.Y8G("value",2),o.R7$(2),o.JRh(o.bMT(16,13,"lang_auto_tuy_chon_theo_lop")),o.R7$(2),o.Y8G("ngIf",2===d.form.controls.chooseOption.value),o.R7$(1),o.Y8G("ngIf",1===d.form.controls.chooseOption.value||2===d.form.controls.chooseOption.value&&!d.form.controls.classroomFormArray.errors),o.R7$(1),o.Y8G("ngIf",!o.i5U(20,15,d.examWithPermissionObj,"exam"))}}function G(E,V){1&E&&(o.j41(0,"div",36)(1,"p",34),o.EFF(2),o.nI1(3,"mytranslate"),o.k0s()()),2&E&&(o.R7$(2),o.JRh(o.bMT(3,1,"lang_auto_chua_duoc_cau_hinh_tra_de_thi")))}function X(E,V){if(1&E&&(o.DNE(0,G,4,3,"div",35),o.nI1(1,"fullPermission")),2&E){const d=o.XpG(2);o.Y8G("ngIf",!o.i5U(1,1,d.examWithPermissionObj,"exam"))}}function H(E,V){if(1&E&&(o.j41(0,"form",11),o.DNE(1,R,21,18,"ng-container",12),o.nI1(2,"fullPermission"),o.DNE(3,X,2,4,"ng-template",null,13,o.C5r),o.k0s()),2&E){const d=o.sdS(4),z=o.XpG();o.Y8G("formGroup",z.form),o.R7$(1),o.Y8G("ngIf",o.i5U(2,3,z.examWithPermissionObj,"exam"))("ngIfElse",d)}}function K(E,V){if(1&E){const d=o.RV6();o.j41(0,"div",37)(1,"button",38),o.bIt("click",function(){o.eBV(d);const h=o.XpG();return o.Njj(h.btnCloseDialog(!1))}),o.EFF(2),o.nI1(3,"mytranslate"),o.k0s()()}2&E&&(o.R7$(2),o.SpI(" ",o.bMT(3,1,"lang_auto_dong")," "))}let Q=(()=>{class E extends P._{btnCloseDialog(d){this.dialogRef.close(d)}copyLinkToClipboard(){let d=this.commonService.getCurrentDomain();return this.linkCopy=`${d}/de-thi/${this.examWithPermissionObj?.hashId}?offline=${this.offlineCode}`,this.linkCopy}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong")}getCodeOfflineShare(){this.initStatusObj(),this.waitDestroy(this.offlineShareService.apiOfflineShareGetObjGet(this.examHashId).subscribe(d=>{1==d.success?(this.offlineCode=d.data?.shareHashId??"",this.shareClassroomIds=d.data?.shareClassroomIds??[],this.examWithPermissionObj=d.data?.examObj,this.classroomWithGroup=[{groupObj:{id:-1,name:this.commonService.myTranslateInstant("lang_testbank_share_offline_default_group")},isOwned:!0,classroomObjs:d.data?.classroomObjs??[]}],this.form.controls.chooseOption.setValue(d.data?.showOfflineResult??0),this.successStatusObj()):this.errorStatusObj(d.message??"",!0)}))}changeStatusOfflineShare(d){if(2==this.form.getRawValue().chooseOption&&this.form.controls.classroomFormArray.errors?.classroomCheckBoxValidatorWithoutWhoAllow)return;let z=this.form.getRawValue().chooseOption;const h=2!=z?[]:this.sAztClassroomCheckboxService.getClassroomIdsCheckedInGroup(this.form.controls.classroomFormArray);this.waitDestroy(this.offlineShareService.apiOfflineShareChangeStatusPost({examHashId:this.examWithPermissionObj?.hashId??"",status:z,classroomIds:h}).subscribe(w=>{1==w.success?this.offlineCode=w.data?.shareHashId??"":this.errorStatusObj(w.message??"",!0)}))}ngAfterContentChecked(){this.changeDetector.detectChanges()}ngOnInit(){super.ngOnInit(),this.getCodeOfflineShare()}constructor(d,z,h,O,w){super(O,h),this.changeDetector=d,this.offlineShareService=z,this.dialogRef=h,this.sAztClassroomCheckboxService=w,this.examHashId="",this.useDialog=!1,this.permissionTypes=t.t,this.offlineCode="",this.linkCopy="",this.examWithPermissionObj=void 0,this.classroomWithGroup=[],this.shareClassroomIds=[],this.examHashId=O.examHashId?O.examHashId:this.examHashId,this.useDialog=O?O.useDialog:this.useDialog,this.form=new e.gE({chooseOption:new e.MJ(0,{nonNullable:!0}),whoAllow:new e.MJ(0,{nonNullable:!0}),classroomFormArray:new e.Yp([])},{validators:[C.j.classroomInGroupCheckBoxValidatorWithoutWhoAllow]})}static#t=this.\u0275fac=function(z){return new(z||E)(o.rXU(o.gRc),o.rXU(m.i$),o.rXU(c.CP,8),o.rXU(c.Vh,8),o.rXU(p.Q))};static#e=this.\u0275cmp=o.VBU({type:E,selectors:[["azt-offline-share"]],inputs:{examHashId:"examHashId",useDialog:"useDialog"},features:[o.Vt3],decls:11,vars:6,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-3"],[1,"text-base","font-medium"],[1,"p-3","pt-0"],["class","flex justify-center items-center",4,"ngIf","ngIfElse"],["doneLoading",""],["class","text-right mt-3",4,"ngIf"],[1,"flex","justify-center","items-center"],[1,"w-4","h-4","inline-block"],[1,"sr-only","ml-2"],[3,"formGroup"],[4,"ngIf","ngIfElse"],["noFullPermission",""],[1,"flex","flex-col","sm:flex-row","mb-3"],[1,"form-check","mr-8"],["formControlName","chooseOption","id","notAllow","type","radio",1,"form-check-input",3,"value","change"],["for","notAllow",1,"form-check-label"],[1,"form-check","mr-8","mt-2","sm:mt-0"],["formControlName","chooseOption","id","allAllow","type","radio",1,"form-check-input",3,"value","change"],["for","allAllow",1,"form-check-label"],["formControlName","chooseOption","id","customAllow","type","radio",1,"form-check-input",3,"value","change"],["for","customAllow",1,"form-check-label"],["class","azt-list-classroom",4,"ngIf"],["class","azt-copy relative",4,"ngIf"],["class","mt-0",4,"ngIf"],[1,"azt-list-classroom"],[3,"form","classroomGroupData","shareClassroomIds","permissionName","defaultCssClass","changeCheckboxEvent"],[1,"azt-copy","relative"],["type","text","readonly","",1,"form-control","py-3","px-4","border-transparent","bg-slate-100","pr-10","text-primary",2,"padding-right","120px","cursor","pointer",3,"value"],["azt-track-service","practice-detail-isTsISlyAY",1,"btn","btn-outline-primary","absolute","my-auto","inset-y-0","right-0",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"cdkCopyToClipboard","click"],[1,"w-4","h-4","inline-block","mr-2"],["name","copy","size","20"],[1,"mt-0"],[1,"note"],["class","text-center",4,"ngIf"],[1,"text-center"],[1,"text-right","mt-3"],["azt-track-service","azt-offline-share-hrBGx7oL2r",1,"btn","w-24","btn-secondary",3,"click"]],template:function(z,h){if(1&z&&(o.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),o.EFF(4),o.nI1(5,"mytranslate"),o.k0s()(),o.j41(6,"div",4),o.DNE(7,T,5,0,"div",5),o.DNE(8,H,5,6,"ng-template",null,6,o.C5r),o.DNE(10,K,4,3,"div",7),o.k0s()()()),2&z){const O=o.sdS(9);o.R7$(4),o.JRh(o.bMT(5,4,"lang_auto_tra_ket_qua_thi_offline")),o.R7$(3),o.Y8G("ngIf",h.statusObj.loading)("ngIfElse",O),o.R7$(3),o.Y8G("ngIf",h.useDialog)}},dependencies:[u.bT,x.dF,e.qT,e.me,e.Fm,e.BC,e.cb,e.j4,e.JD,A.WGl,k.t,s.D,U.R,Y.wp,Y.gC],encapsulation:2})}return E})()},33860:($,y,a)=>{a.d(y,{c:()=>Z});var e=a(26860),c=a(89163),P=a(33887),t=a(25539),C=a(18148),o=a(30657),m=a(9280),p=a(10296),u=a(51913),x=a(91513),A=a(24506),k=a(2145),s=a(42032),U=a(54460),Y=a(64160),T=a(17818),B=a(47712),f=a(15343),b=a(63958),R=a(52654),G=a(2915),X=a(62538),H=a(52811),K=a(22783),Q=a(73437);function E(D,L){if(1&D&&(e.j41(0,"a",38),e.nI1(1,"mytranslate"),e.j41(2,"span",28),e.nrm(3,"lucide-icon",39),e.k0s()()),2&D){e.XpG(2);const _=e.sdS(3);e.FS9("matTooltip",e.bMT(1,2,"lang_auto_tai_ve")),e.Y8G("matMenuTriggerFor",_)}}function V(D,L){if(1&D){const _=e.RV6();e.j41(0,"a",40),e.bIt("click",function(){e.eBV(_);const I=e.XpG(2);return e.Njj(I.showCopySuccess())}),e.nI1(1,"mytranslate"),e.j41(2,"span",5),e.nrm(3,"lucide-icon",41),e.k0s(),e.j41(4,"span"),e.EFF(5),e.nI1(6,"mytranslate"),e.k0s()()}if(2&D){const _=e.XpG(2);e.FS9("matTooltip",e.bMT(1,3,"lang_auto_copy_link_de_thi")),e.Y8G("cdkCopyToClipboard",_.copyLinkExam()),e.R7$(5),e.JRh(e.bMT(6,5,"lang_auto_copy_link"))}}function d(D,L){1&D&&(e.j41(0,"div",42)(1,"span",43),e.nrm(2,"azt-loading-ui"),e.k0s(),e.j41(3,"span",44),e.EFF(4),e.nI1(5,"mytranslate"),e.k0s()()),2&D&&(e.R7$(4),e.JRh(e.bMT(5,1,"lang_auto_dang_chuan_bi_tai_lieu_doing")))}function z(D,L){if(1&D&&(e.j41(0,"div",45),e.nrm(1,"div",46),e.nI1(2,"safeNormalHtmlContent"),e.k0s()),2&D){const _=e.XpG(2);e.R7$(1),e.Y8G("innerHtml",e.bMT(2,1,_.data.headerContent),e.npT)}}function h(D,L){if(1&D&&e.nrm(0,"azt-loaded-img",47),2&D){const _=e.XpG(2);e.Y8G("imgSrc",_.data.obj.examHeader)}}function O(D,L){if(1&D&&e.nrm(0,"azt-question-standalone-for-preview",49),2&D){const _=e.XpG(),v=_.$implicit,I=_.index,j=e.XpG(2);e.Y8G("examObj",j.examObj)("questionObj",v)("follower",j.followerRenderQuest)("curQuestionIndex",I)("isShowExplain",j.showExplanation)}}function w(D,L){if(1&D&&(e.qex(0),e.DNE(1,O,1,5,"azt-question-standalone-for-preview",48),e.bVm()),2&D){const _=e.XpG(2);e.R7$(1),e.Y8G("ngIf",_.examObj)}}function N(D,L){if(1&D){const _=e.RV6();e.qex(0),e.j41(1,"div",18)(2,"div",19)(3,"div",20)(4,"div",21)(5,"div",22),e.DNE(6,E,4,4,"a",23),e.DNE(7,V,7,7,"a",24),e.j41(8,"button",25),e.bIt("click",function(){e.eBV(_);const I=e.XpG();return e.Njj(I.showAllExplanation())}),e.EFF(9),e.nI1(10,"mytranslate"),e.nI1(11,"mytranslate"),e.k0s()()(),e.j41(12,"div",26)(13,"a",27)(14,"span",28),e.nrm(15,"lucide-icon",29),e.k0s()()()(),e.j41(16,"azt-mat-dialog-content",30),e.DNE(17,d,6,3,"div",31),e.j41(18,"div",32),e.nrm(19,"div",33),e.DNE(20,z,3,3,"div",34),e.DNE(21,h,1,1,"azt-loaded-img",35),e.DNE(22,w,2,1,"ng-container",36),e.nrm(23,"div",37),e.k0s()()()(),e.bVm()}if(2&D){const _=e.XpG();e.R7$(6),e.Y8G("ngIf",!(null!=_.data&&_.data.globalLadingPage||_.data.allowHeader)),e.R7$(1),e.Y8G("ngIf",0==(null==_.data?null:_.data.isOnLib)&&!(null!=_.data&&_.data.globalLadingPage)),e.R7$(2),e.SpI(" ",_.showExplanation?e.bMT(10,8,"lang_auto_an_giai_thich"):e.bMT(11,10,"lang_auto_xem_giai_thich")," "),e.R7$(7),e.Y8G("defaultHeight",70),e.R7$(1),e.Y8G("ngIf",_.statusObj.loading),e.R7$(3),e.Y8G("ngIf",_.data.allowHeader&&!_.statusObj.loading),e.R7$(1),e.Y8G("ngIf",null==_.data||null==_.data.obj?null:_.data.obj.examHeader),e.R7$(1),e.Y8G("ngForOf",_.questionList)}}function W(D,L){if(1&D){const _=e.RV6();e.j41(0,"azt-export-excel-for-answersheet",50),e.bIt("exportDataDone",function(I){e.eBV(_);const j=e.XpG();return e.Njj(j.exportDataDone(I))}),e.k0s()}if(2&D){const _=e.XpG();let v;e.Y8G("startQuestionIndex",null!==(v=null==_.examObj?null:_.examObj.startQuestionIndex)&&void 0!==v?v:1)("obj",_.exportExcelData)}}let Z=(()=>{class D extends P._{handlerCloseDialog(_){_&&this.dialogRef.close()}copyLinkExam(){return`${this.commonService.getCurrentDomain()}/de-thi/${this.data?.obj?.hashId}`}showCopySuccess(){this.commonService.snackSuccess("lang_auto_sao_chep_thanh_cong")}showAllExplanation(){this.showExplanation=!this.showExplanation}downloadExam(_,v){if(!_||!this.data.obj)return;const I=this.commonService.myTranslateInstant("lang_auto_dang_khoi_tao_du_lieu")??"",j=this.printAddInfo.templateType??0,M={nameSchool:this.printAddInfo.nameSchool??"",nameSubject:this.printAddInfo.nameSubject??""};C.L.openLoadingEffect(`${I}...`),this.data.obj.hideGroupQuestion=0,this.exportSAztDocxService.downloadExam(v,{...this.data.obj,editable:!1,allowStudentView:!0},void 0,void 0,this.cloneQuestionList,M,j,void 0,void 0,void 0,!0).then(()=>{}).catch(J=>{this.showErrorSnack(J.message)})}downloadExamAnswer(){this.waitDestroy(this.offlineExamExportService.apiOfflineExamExportExportResultOfRawExamGet(this.examObj?.hashId??"").subscribe(_=>{if(!_.success)return this.errorStatusObj(_.message??"");let v=_.data?.obj;v?.offlineMixQuestionObjs&&v.offlineMixQuestionObjs.length>0&&(this.exportExcelData=this.commonService.myClone(v))}))}exportDataDone(_){const v=this.createNameExam("answerexcel",!1);this.shareFileFlutterService.shareFileWithBlob(_,v)}redirectToDownloadExamPdf(_){window.open(this.commonService.getLocalRouter(`/admin/testbank/export-exam-to-pdf/${this.examObj?.id}?isShowExplain=${_}`),"_blank")}getConfigExam(){const _=this.data?.globalLadingPage?this.documentConfigService.apiDocumentConfigGetGlobalExamConfigDataGet(this.examObj?.hashId??""):this.documentConfigService.apiDocumentConfigGetExamConfigDataV2Get(this.examObj?.hashId??"");this.waitDestroy(_.subscribe(v=>{if(!v.success)return this.errorStatusObj(v.message,!1);let I=0,j=0;this.questionList.forEach((M,J)=>{M.labelIndex=J,v.data?.resetQuestionIndex&&M.groupInfo&&M.groupInfo.groupId&&(I!=M.groupInfo.groupId&&(I=M.groupInfo.groupId,j=0),M.labelIndex=j,j++)}),this.successStatusObj()}))}getData(_){this.initStatusObj();const v=this.data?.globalLadingPage?this.examService.apiExamGetGlobalQuestionsIdGet(_?.id??0):this.permissionService.hasViewPermission("exam",_)?this.examService.apiExamGetQuestionsIdGet(_?.id??0):void 0;if(!v)return this.showErrorSnack("lang_auto_ban_khong_co_quyen_thuc_thi_chuc_nang_nay");v.subscribe(I=>{const j=this.commonService.castJsonToClassObjs(t.I,JSON.stringify(I.data?.questionObjs||[]))??[];this.followerRenderQuest.setNumQuest(j.length),j.forEach(M=>{M.isRoleTeacher=!0}),this.cloneQuestionList=this.commonService.myClone(j),this.questionList=j,this.examObj=I.data?.examObj,this.getConfigExam()})}createNameExam(_,v){const I=this.examObj?.name??"";let j;switch(_){case"answersheet":j=this.printAnswersheetService.exportFileNameOfAnswerSheet(0,I,"");break;case"answerexcel":j=this.printAnswersheetService.exportFileNameOfAnswerExcelOffline(0,I,"");break;default:j=this.printAnswersheetService.exportFileNameOfExamOffline(0,I,"",void 0)}return v&&(j=this.commonService.replaceAll(j,"_","-")??""),j+("answersheet"===_?".pdf":"answerexcel"===_?".xlsx":".docx")}ngOnChanges(){this.data?.obj&&this.getData(this.data.obj)}ngOnInit(){super.ngOnInit(),this.data?.obj&&this.getData(this.data.obj)}constructor(_,v,I,j,M,J,ot,tt,et){super(et,tt),this.documentConfigService=_,this.shareFileFlutterService=v,this.permissionService=I,this.exportSAztDocxService=j,this.examService=M,this.offlineExamExportService=J,this.printAnswersheetService=ot,this.dialogRef=tt,this.data=et,this.closeDialog=new e.bkB,this.questionList=[],this.cloneQuestionList=[],this.followerRenderQuest=new o.e,this.printAddInfo={},this.showExplanation=!1}static#t=this.\u0275fac=function(v){return new(v||D)(e.rXU(m.x_),e.rXU(p.R),e.rXU(u.p),e.rXU(x.c),e.rXU(A.R),e.rXU(k.qG),e.rXU(s.Q),e.rXU(c.CP,8),e.rXU(c.Vh,8))};static#e=this.\u0275cmp=e.VBU({type:D,selectors:[["azt-preview-exam"]],outputs:{closeDialog:"closeDialog"},features:[e.Vt3,e.OA$],decls:36,vars:25,consts:[[4,"ngIf"],["menuDownload","matMenu"],[1,"dropdown-menu","show","relative","w-72"],[1,"dropdown-content"],[3,"vipPackageType","classCSSCustom","isShowBadgeVip","isAction","checkAction","closeDialog"],[1,"w-4","h-4","mr-2","flex-none"],["name","file-check","size","18"],[1,"mr-3"],["name","file-text","size","18"],["azt-track-service","azt-preview-exam-ef7yEq6a3",1,"dropdown-item",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"w-4","h-4","mr-2","flex-none","lucide"],["d","M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"],["d","M14 2v4a2 2 0 0 0 2 2h4"],["d","M12 18v-6"],["d","m9 15 3 3 3-3"],["azt-track-service","azt-preview-exam--mJB2JKFgNu",1,"dropdown-item",3,"click"],["name","file-spreadsheet","size","18"],[3,"startQuestionIndex","obj","exportDataDone",4,"ngIf"],[1,"az-dialog-info"],[1,"box",2,"overflow-x","hidden"],[1,"flex","items-center","p-2","bg-slate-100","dark:bg-darkmode-400"],[1,"mr-auto"],[1,"flex","items-center","mr-2"],["class","btn btn-sm btn-outline-secondary btn-transparent mr-2",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["azt-track-service","azt-preview-exam-dgdyLZO48Hq","class","btn btn-sm btn-outline-secondary btn-transparent mr-2",3,"matTooltip","cdkCopyToClipboard","click",4,"ngIf"],["azt-track-service","azt-preview-exam-WEwBr57UW",1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"click"],[1,"ml-auto"],["azt-track-service","azt-preview-exam-y2xqBN7DlGX",1,"btn","btn-transparent","btn-outline-danger","btn-sm",3,"mat-dialog-close"],[1,"w-4","h-4","flex-none"],["name","x","size","18"],[1,"mt-3",3,"defaultHeight"],["class","flex justify-center items-center h-40",4,"ngIf"],["id","boxContentQuestion",1,"p-2"],[1,"pt-3"],["class","box p-3 mb-3",4,"ngIf"],["style","display: block","class","mt-5",3,"imgSrc",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"py-5"],[1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"matTooltip","matMenuTriggerFor"],["name","download","size","18"],["azt-track-service","azt-preview-exam-dgdyLZO48Hq",1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"matTooltip","cdkCopyToClipboard","click"],["name","copy","size","18"],[1,"flex","justify-center","items-center","h-40"],[1,"w-4","h-4","inline-block"],[1,"sr-only","ml-2"],[1,"box","p-3","mb-3"],[2,"line-height","1.5",3,"innerHtml"],[1,"mt-5",2,"display","block",3,"imgSrc"],[3,"examObj","questionObj","follower","curQuestionIndex","isShowExplain",4,"ngIf"],[3,"examObj","questionObj","follower","curQuestionIndex","isShowExplain"],[3,"startQuestionIndex","obj","exportDataDone"]],template:function(v,I){1&v&&(e.DNE(0,N,24,12,"ng-container",0),e.nI1(1,"viewPermission"),e.j41(2,"mat-menu",null,1)(4,"div",2)(5,"ul",3)(6,"li")(7,"azt-check-vip-account",4),e.bIt("checkAction",function(M){return I.downloadExam(M,!1)})("closeDialog",function(M){return I.handlerCloseDialog(M)}),e.j41(8,"span",5),e.nrm(9,"lucide-icon",6),e.k0s(),e.j41(10,"span",7),e.EFF(11),e.nI1(12,"mytranslate"),e.k0s()()(),e.j41(13,"li")(14,"azt-check-vip-account",4),e.bIt("checkAction",function(M){return I.downloadExam(M,!0)})("closeDialog",function(M){return I.handlerCloseDialog(M)}),e.j41(15,"span",5),e.nrm(16,"lucide-icon",8),e.k0s(),e.j41(17,"span",7),e.EFF(18),e.nI1(19,"mytranslate"),e.k0s()()(),e.j41(20,"li")(21,"a",9),e.bIt("click",function(){return I.redirectToDownloadExamPdf(0)}),e.qSk(),e.j41(22,"svg",10),e.nrm(23,"path",11)(24,"path",12)(25,"path",13)(26,"path",14),e.k0s(),e.EFF(27),e.nI1(28,"mytranslate"),e.k0s()(),e.joV(),e.j41(29,"li")(30,"a",15),e.bIt("click",function(){return I.downloadExamAnswer()}),e.j41(31,"span",5),e.nrm(32,"lucide-icon",16),e.k0s(),e.EFF(33),e.nI1(34,"mytranslate"),e.k0s()()()()(),e.DNE(35,W,1,2,"azt-export-excel-for-answersheet",17)),2&v&&(e.Y8G("ngIf",e.i5U(1,14,null==I.data?null:I.data.obj,"exam")||(null==I.data?null:I.data.globalLadingPage)),e.R7$(7),e.Y8G("vipPackageType","VIP_FOR_TEACHER")("classCSSCustom","dropdown-item cursor-pointer")("isShowBadgeVip",!0)("isAction",!0),e.R7$(4),e.SpI(" ",e.bMT(12,17,"lang_testbank_download_exam_in_docx")," "),e.R7$(3),e.Y8G("vipPackageType","VIP_FOR_TEACHER")("classCSSCustom","dropdown-item cursor-pointer")("isShowBadgeVip",!0)("isAction",!0),e.R7$(4),e.SpI(" ",e.bMT(19,19,"lang_azt_download_exam_paper_with_detailed_answers_in_docx")," "),e.R7$(9),e.SpI(" ",e.bMT(28,21,"lang_auto_tai_xuong_de_thi")+" PDF"," "),e.R7$(6),e.SpI(" ",e.bMT(34,23,"lang_testbank_download_exam_answer_in_excel")," "),e.R7$(2),e.Y8G("ngIf",null!=I.exportExcelData))},dependencies:[U.Sq,U.bT,Y.dF,c.tx,T.kk,T.Cp,B.oV,f.WGl,b.H,R.a,G.U,X.O,H.R,K.F,Q.wp,Q._y,Q.eL],encapsulation:2})}return D})()}}]);