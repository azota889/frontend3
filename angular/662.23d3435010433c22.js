"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[662],{7468:(p,l,r)=>{r.d(l,{$:()=>d});var m=r(60723),e=r(23353),o=r(70860),i=r(92381);class d extends i.N{constructor(n,s,h,a,_){super(),this.cdnService=n,this.commonService=s,this.configRenderService=h,this.callBack=a,this.callbackFall=_}render(n,s,h,a){if(n.indexOf("@[]")<0)return a&&a(),n;let g,_=/@\[\]\{[^@]+\}@\[\]/g,c=n,u=new Map;for(;null!==(g=_.exec(n));){let v=g[0],f=v.split("@[]")[1],E=this.commonService.willDeleteParseJson(f),C=E.link,I=m.G.generateIdRequired(10);c=c.replace(v,`<div id='${I}' class='img-docx skeleton-box-loading' style='width: ${E.data.width*this.ratioImage}px;height: ${E.data.height*this.ratioImage}px'></div>`),u.has(C)?u.get(C)?.push({id:I,data:E.data}):u.set(C,[{id:I,data:E.data}])}return this.startLoadImage(u).then(()=>{a&&a()}).catch(v=>{this.callbackFall&&this.callbackFall(v)}),c}startLoadImage(n){return new Promise((s,h)=>{var a=0;n.size>0?n.forEach((_,c)=>{this.loadImage(c,this.cdnService).then(u=>{if(this.processImageQuestion(u,_,h),this.loadingManager.delete(u.id),this.callBack)for(let g of _)this.callBack(g.id,g.renderStr);++a===n.size&&s()}).catch(()=>{const u=c.split("/");var g=this.commonService.myTranslateInstant("lang_testbank_render_cant_download_the_image")??"";h(new o.l("LOAD_IMAGE",[u[u.length-1]],g))})}):s()})}processImageQuestion(n,s,h){s.forEach(a=>{try{const _=document.createElement("canvas");a.data.width=-1===a.data.width?n.width:a.data.width,a.data.height=-1===a.data.height?n.height:a.data.height,_.width=a.data.width,_.height=a.data.height,_.getContext("2d")?.drawImage(n,a.data.x,a.data.y,a.data.width,a.data.height,0,0,_.width,_.height);let u=this.isCropImage?e.rj.cropCanvas(_):_;u=this.isCanvasEmpty(u)?_:u,a.renderStr=`<img id='${a.id}' class='img-docx' alt='error...' src='${u.toDataURL()}' style='width: ${u.width*this.ratioImage}px;height: auto'>`}catch{const c=n.src;return void h(new o.l("CROP_IMAGE",[c[c.length-1]],"Kh\xf4ng c\u1eaft \u0111\u01b0\u1ee3c n\u1ed9i dung trong h\xecnh \u1ea3nh"))}})}isCanvasEmpty(n){const s=document.createElement("canvas");return s.width=n.width,s.height=n.height,n.toDataURL()===s.toDataURL()}}},92381:(p,l,r)=>{r.d(l,{N:()=>i});var m=r(60723),e=r(23353),o=r(61713);class i{constructor(){this.isCropImage=!0,this.loadingManager=new Map,this.ratioImage=.65}setCallback(t){}setApiCache(t){}setLoadingManager(t){this.loadingManager=t}loadImage(t,n){return new Promise((s,h)=>{let a=m.G.generateIdRequired(10);this.loadingManager.set(a,t),(0,o.dr)(t,n).then(_=>{s(_),this.loadingManager.delete(a)}).catch(()=>{this.loadingManager.delete(a),h(new Error)})})}loadImageToBase64(t,n){return new Promise((s,h)=>{const a=new Image;a.crossOrigin="anonymous",a.setAttribute("count","1");let _=m.G.generateIdRequired(10);this.loadingManager.set(_,t),a.onload=()=>{const c=document.createElement("canvas");c.width=a.width,c.height=a.height,c.getContext("2d")?.drawImage(a,0,0,a.width,a.height,0,0,c.width,c.height);const g=this.isCropImage?e.rj.cropCanvas(c):c;let v=`<img id='${_}' class='img-docx' alt='error...' src='${g.toDataURL()}' style='width: ${g.width*this.ratioImage}px;height: auto'>`;s(v),this.loadingManager.delete(_)},a.onerror=()=>{this.loadingManager.delete(_);const c=a.getAttribute("count");c&&1==Number(c)?(a.src=n.getMyCdn(t),a.setAttribute("count","2")):c&&Number(c)<5?(a.setAttribute("count",c+1),a.src=n.getMyCdn(t)+"?t="+(new Date).getTime()):h(new Error)},a.src=n.getMyCdn(t)})}}},72164:(p,l,r)=>{r.d(l,{e:()=>i});var m=r(19347),e=r(47496),o=r(65879);let i=(()=>{class d extends e.Q{constructor(n,s){super(),this.data=n,this.dialogRef=s}}return d.\u0275fac=function(n){return new(n||d)(o.Y36(m.WI),o.Y36(m.so))},d.\u0275cmp=o.Xpm({type:d,selectors:[["ng-component"]],features:[o.qOj],decls:0,vars:0,template:function(n,s){},encapsulation:2}),d})()},2783:(p,l,r)=>{r.d(l,{C:()=>o});var m=r(65879),e=r(19347);let o=(()=>{class i{constructor(t){this.dialog=t,this.open=(n,s)=>this.dialog.open(n,s)}}return i.\u0275fac=function(t){return new(t||i)(m.LFG(e.uw))},i.\u0275prov=m.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},22749:(p,l,r)=>{r.d(l,{O:()=>d});var m=r(47496),e=r(65879),o=r(96814),i=r(40750);let d=(()=>{class t extends m.Q{}return t.\u0275fac=function(){let n;return function(h){return(n||(n=e.n5z(t)))(h||t)}}(),t.\u0275cmp=e.Xpm({type:t,selectors:[["azt-dynamic-hook"]],inputs:{content:"content"},features:[e.qOj],decls:5,vars:9,consts:[[3,"innerHTML"]],template:function(s,h){1&s&&(e._UZ(0,"span",0),e.ALo(1,"safeContentQuestion"),e.ALo(2,"async"),e.ALo(3,"mathJaxContent"),e.ALo(4,"replaceHookMedia")),2&s&&e.Q6J("innerHTML",e.lcZ(1,1,e.lcZ(2,3,e.lcZ(3,5,e.lcZ(4,7,h.content)))),e.oJD)},dependencies:[o.Ov,i.Pc,i.ES,i.EA],encapsulation:2}),t})()},70860:(p,l,r)=>{r.d(l,{W:()=>o,l:()=>e});var m=r(7468);class e{constructor(d,t,n,s){this.type=d,this.data=t,this.message=n,this.questionNumber=s}}class o{initService(){const d=new m.$(this.cdnService,this.commonService,this.configRenderService,(t,n)=>{this.callbackPushImage&&this.caller&&this.callbackPushImage.call(this.caller,t,n)},t=>{this.callbackFall&&this.caller&&this.callbackFall.call(this.caller,t)});d.isCropImage=this.configRenderService.getIsCropImage(),this.services.push(d)}render(d,t){return this.services.forEach(n=>{d=n.render(d??"",[],void 0,t)}),d??""}constructor(d,t,n,s){this.cdnService=d,this.commonService=t,this.configRenderService=n,this.callbackFall=s,this.services=[],this.initService()}}},43389:(p,l,r)=>{r.d(l,{l:()=>_});var m=r(47496),e=r(65879),o=r(96814),i=r(16007),d=r(40750);function t(c,u){if(1&c&&(e.O4$(),e.kcU(),e._UZ(0,"mat-progress-bar",10)),2&c){const g=e.oxw();e.Q6J("value",g.progress_value)}}function n(c,u){if(1&c&&(e.O4$(),e.kcU(),e.TgZ(0,"div",11),e._uU(1),e.qZA()),2&c){const g=e.oxw();e.xp6(1),e.Oqu(g.getMsg())}}function s(c,u){if(1&c){const g=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"div",12),e._uU(1),e.ALo(2,"mytranslate"),e.TgZ(3,"a",13),e.NdJ("click",function(){e.CHM(g);const f=e.oxw();return e.KtG(f.isShowErrorsBox=!f.isShowErrorsBox)}),e._uU(4),e.ALo(5,"mytranslate"),e.ALo(6,"mytranslate"),e.qZA()()}if(2&c){const g=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,2,"lang_auto_da_xay_ra_loi_trong_qua_trinh_trao_doi_du_lieu_")," "),e.xp6(3),e.hij(" ",g.isShowErrorsBox?e.lcZ(5,4,"lang_auto_an_chi_tiet"):e.lcZ(6,6,"lang_auto_xem_chi_tiet")," ")}}function h(c,u){if(1&c&&(e.O4$(),e.kcU(),e.TgZ(0,"div",12),e._uU(1),e.qZA()),2&c){const g=e.oxw();e.xp6(1),e.hij(" ",g.LogErrorsRequest," ")}}function a(c,u){if(1&c&&(e.O4$(),e.kcU(),e.TgZ(0,"div",14),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&c){const g=e.oxw();e.xp6(1),e.Oqu(g.customText?g.customText:e.lcZ(2,1,"lang_auto_dang_tai_du_lieu")+"...")}}let _=(()=>{class c extends m.Q{constructor(){super(...arguments),this.progress_value=-1,this.LogErrorsRequest=!1,this.customText="",this.isShowErrorsBox=!1}getMsg(){let g="";return 100==this.progress_value||0==this.progress_value?(g=this.commonService.myTranslateInstant("lang_auto_dang_xu_ly")??"",`${g} ...`):(g=this.commonService.myTranslateInstant("lang_auto_dang_tai_tep_tin_len_he_thong")??"",`${g}... ${this.progress_value} %`)}}return c.\u0275fac=function(){let u;return function(v){return(u||(u=e.n5z(c)))(v||c)}}(),c.\u0275cmp=e.Xpm({type:c,selectors:[["azt-loading-effect"]],inputs:{progress_value:"progress_value",LogErrorsRequest:"LogErrorsRequest",customText:"customText"},features:[e.qOj],decls:12,vars:5,consts:[[1,"box-loading","h-full"],[1,"text-center","py-4"],["version","1.1","id","jobing-j-drawit","id","Layer_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","x","0px","y","0px","viewBox","0 0 109 92.9",0,"xml","space","preserve",1,"w-12","mx-auto",2,"enable-background","new 0 0 109 92.9"],["d","M90.8,52c3.5,6.2,7.1,11.7,9.8,17.7c4.4,9.7-2.9,20.7-13.8,20.9c-11.8,0.2-23.7,0.2-35.5,0 c-11-0.1-17.6-12.2-12-21.7c0.4-0.8,1.8-1.4,2.7-1.4c9.9-0.1,19.7-0.1,29.6-0.1c9.8,0,15.9-4.6,18.7-14C90.4,53.2,90.5,52.9,90.8,52 z",1,"azt-svg-loading","jobing-j"],["d","M39.6,90.3c-6.8,0-13.8,0.8-20.5-0.2c-9.7-1.4-15-12.8-10.3-21.3c5.9-10.9,12.1-21.6,18.5-32.2 c5.5-9,18.6-8.7,24.2,0.2c0.7,1.1,0.8,1.9,0.1,3.1C46.7,48.3,42,57,36.8,65.3c-5.3,8.4-3.8,18.8,2.5,24.6 C39.5,89.9,39.5,90.2,39.6,90.3z",1,"azt-svg-loading","jobing-j"],["d","M32.5,27.3c3.3-5.7,6.1-11,9.4-16c5.9-9.1,19.4-9.2,25.1,0c6.5,10.4,12.6,21,18.3,31.7 c4.8,9-1.5,19.9-11.5,20.7c-1.6,0.1-2.6-0.2-3.5-1.8c-4.8-8.6-9.8-17.1-14.7-25.6c-4.7-8.3-12.5-11.6-21.7-9.2 C33.6,27.1,33.3,27.1,32.5,27.3z",1,"azt-svg-loading","jobing-j"],["style","margin-bottom: 30px; border-radius: 5px","mode","buffer",3,"value",4,"ngIf"],["class","note text-center font-weight-bold",4,"ngIf","ngIfElse"],["class","alert alert-danger mt-3","role","alert",4,"ngIf"],["notLoading",""],["mode","buffer",2,"margin-bottom","30px","border-radius","5px",3,"value"],[1,"note","text-center","font-weight-bold"],["role","alert",1,"alert","alert-danger","mt-3"],["azt-track-service","loading-effect-5TYv52U-wgq","href","javscript:void(0)",3,"click"],[1,"note","text-center","font-medium"]],template:function(g,v){if(1&g&&(e.TgZ(0,"div",0)(1,"div",1),e.O4$(),e.TgZ(2,"svg",2),e._UZ(3,"path",3)(4,"path",4)(5,"path",5),e.qZA()(),e.YNc(6,t,1,1,"mat-progress-bar",6),e.YNc(7,n,2,1,"div",7),e.YNc(8,s,7,8,"div",8),e.YNc(9,h,2,1,"div",8),e.YNc(10,a,3,3,"ng-template",null,9,e.W1O),e.qZA()),2&g){const f=e.MAs(11);e.xp6(6),e.Q6J("ngIf",-1!=v.progress_value),e.xp6(1),e.Q6J("ngIf",-1!=v.progress_value)("ngIfElse",f),e.xp6(1),e.Q6J("ngIf",!1!==v.LogErrorsRequest),e.xp6(1),e.Q6J("ngIf",v.isShowErrorsBox)}},dependencies:[o.O5,i.pW,d.JV],encapsulation:2}),c})()},60723:(p,l)=>{l.G=void 0,l.G=class m{static generateIdRequired(o){let i="";for(let n=0;n<o;n++)i+="abcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(36*Math.random()));return Math.floor(Date.now()/1e3)+i}}},65097:(p,l,r)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PartsParser=void 0;const m=r(49288),e=r(90957),o=r(39963),i=r(15647),d=r(42292),t=r(58446);class n{constructor(h){this.__idCssElement="qv_style_element",this.baseConfigEventListener=[],this.imgMaps=[],this.services=new Array;const a=this.__pushServices([new e.FirstPartService(this.baseConfigEventListener),new m.ImagePartService(this.baseConfigEventListener),new d.DocxImagePartService(this.baseConfigEventListener),new i.LibrariesPartService(this.baseConfigEventListener,h),new o.FindAnsPartService(this.baseConfigEventListener),new t.LatexPartService(this.baseConfigEventListener)]);this.__pushCss(a)}__pushCss(h){if(!document.getElementById(this.__idCssElement)&&document.head){const _=document.createElement("style");_.id=this.__idCssElement,_.innerHTML=h.replace(/  /g," ").replace(/\n/g," ").replace(/\t/g," "),document.head.appendChild(_)}}__pushServices(h){let a="";return h.forEach(_=>{_.outCss().forEach(u=>{a+=`.${u.className} { ${u.content} } \n`}),this.services.push(_)}),a}start(h){const a=document.createElement("div");return h.forEach(_=>{const c=document.createElement("p");c.classList.add("qv_line"),this.services.forEach(u=>{u.pushImages(this.imgMaps),_=u.parse(_)}),c.innerHTML=_.text||"",a.appendChild(c)}),0===a.innerText.indexOf(n.IgnoreChar)?a.innerText.replace(n.IgnoreChar,""):a.outerHTML}register(h){this.imgMaps=h}configEventListener(h){h.forEach(a=>{-1===this.baseConfigEventListener.findIndex(_=>_.eventName===a.eventName)&&this.baseConfigEventListener.push(a)})}doneRenderQuestions(){this.services.forEach(h=>{h.onEndAll()})}}l.PartsParser=n,n.IgnoreChar="{!ignore}"},94235:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.BaseCaller=void 0,l.BaseCaller=class r{getQuestion(e,o,i,d,t,n){return new Promise(s=>{s([])})}}},20926:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.BeautyImageCrop=void 0;class r{static getRGB(e,o,i,d){return{red:d[4*(i.width*o+e)],green:d[4*(i.width*o+e)+1],blue:d[4*(i.width*o+e)+2],opacity:d[4*(i.width*o+e)+3]}}static isEmpty(e){return 255==e.red&&255==e.green&&255==e.blue||0===e.opacity}static scanX(e,o,i){for(var d=e?1:-1,t=e?0:o.width-1;e?t<o.width:t>-1;t+=d)for(var n=0;n<o.height;n++)if(!r.isEmpty(r.getRGB(t,n,o,i.data)))return t;return 0}static scanY(e,o,i){for(var d=e?1:-1,t=e?0:o.height-1;e?t<o.height:t>-1;t+=d)for(var n=0;n<o.width;n++)if(!r.isEmpty(r.getRGB(n,t,o,i.data)))return t;return 0}static cropImage(e,o,i){const t=e.canvas,n=document.createElement("canvas"),s=n.getContext("2d");var h=r.scanY(!0,t,o)-5,a=r.scanY(!1,t,o)+5,_=r.scanX(!0,t,o)-5,c=r.scanX(!1,t,o)+5;i&&(i.top||(a=0),i.bottom||(a=t.height),i.left||i.right?(i.left||(a=0),i.right||(a=t.width)):c=t.width+_);var u=c-_,g=a-h;return n.width=u,n.height=g,s?.drawImage(t,_,h,u,g,0,0,u,g),n}static removeBg(e){const o=document.createElement("canvas"),i=o.getContext("2d");if(i){o.width=e.width,o.height=e.height,i.drawImage(e,0,0);for(var d=i.getImageData(0,0,o.width,o.height),t=d.data,n=0;n<t.length;n+=4)t[n]>=185&&t[n+1]>=185&&t[n+2]>=185&&(t[n+3]=0);i.putImageData(d,0,0)}return o}static cropCanvas(e,o){const i=e.getContext("2d");if(i){var d=i.getImageData(0,0,e.width,e.height);return r.cropImage(i,d,o)}return e}}l.BeautyImageCrop=r},23353:(p,l,r)=>{l.rj=void 0;r(94235);const o=r(20926);Object.defineProperty(l,"rj",{enumerable:!0,get:function(){return o.BeautyImageCrop}});r(65097)},42292:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.DocxImagePartService=void 0;class r{constructor(e){this.pattern_check=/@\[\]{"link":"[^"]+","data":{[^}]+}}@\[\]/i,this.images=[],this.indexImageLink=[],this.style=document.createElement("style"),this.baseConfigEventListener=e,document.head.appendChild(this.style)}parse(e){let d,o=0,i=e.text||"";for(;null!==(d=this.pattern_check.exec(i));){try{var t=JSON.parse(d[0].split("@[]")[1]);t.data={x:Math.floor(t.data.x),y:Math.floor(t.data.y),width:Math.floor(t.data.width),height:Math.floor(t.data.height)},this.indexImageLink.push(t.link),i=i.replace(this.pattern_check,`<div class="background_question_${this.indexImageLink.length-1}"><img width="1024" height="1024" src="${t.link}"></div>`),this.style.textContent+=`.background_question_${this.indexImageLink.length-1} {margin: 0 3px; width: ${t.data.width}px; height: ${t.data.height}px; display: inline-block;vertical-align: middle; overflow: hidden;} .background_question_${this.indexImageLink.length-1} img { margin-top: -${t.data.y}px; margin-left: -${t.data.x}px;}`}catch{i=i.replace(this.pattern_check,"")}o++>1e4&&(i="")}return Object.assign(Object.assign({},e),{text:i})}outCss(){return[]}pushImages(e){this.images=e}onEndAll(){}}l.DocxImagePartService=r,r.NAME_SERVICE="image_part:"},39963:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.FindAnsPartService=void 0,l.FindAnsPartService=class r{constructor(e){this.pattern_check=/\[[ABCDEFGHI]:[^\]]+\]/i,this.images=[],this.baseConfigEventListener=e}parse(e){let d,o=0,i=e.text||"";for(;null!==(d=this.pattern_check.exec(i));){const t=d[0].replace("[","").replace("]",""),n=t.substring(0,1),s=document.createElement("span");s.classList.add("qv_string_eng_ans"),s.innerHTML=n;const h=t.substring(2),a=document.createElement("span");a.classList.add("qv_string_eng"),a.innerHTML=h,a.appendChild(s),i=i.replace(this.pattern_check,a.outerHTML),o++>1e4&&(i="")}return Object.assign(Object.assign({},e),{text:i})}outCss(){return[{className:"qv_string_eng",content:"\n                    cursor: pointer;\n                    padding: 0 5px;\n                    font-weight: bold;\n                    text-decoration: underline;\n                    position: relative;\n                    height: 40px;\n                    display: inline-block;\n                "},{className:"qv_string_eng_ans",content:"\n                    position: absolute;\n                    top: 20px;\n                    left: 45%;\n                "}]}pushImages(e){this.images=e}onEndAll(){}}},90957:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.FirstPartService=void 0,l.FirstPartService=class r{constructor(e){this.images=[],this.baseConfigEventListener=e}parse(e){return Object.assign({},e)}outCss(){return[{className:"qv_line",content:"\n                    margin: 0 !important;\n                "},{className:"qv_qts_image",content:"\n                    width: 100%;\n                "},{className:"qv_ats_image",content:"\n                    width: 60%;\n                "}]}pushImages(e){this.images=e}onEndAll(){}}},49288:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.ImagePartService=void 0;class r{constructor(e){this.pattern_check=/\[!img:[afhci]+[\dABCDEFGHI]+\]/i,this.images=[],this.baseConfigEventListener=e}parse(e){let d,o=0,i=e.text||"";for(;null!==(d=this.pattern_check.exec(i));){const t=d[0].replace("[!img:","").replace("]",""),n=this.images.find(s=>s.id===t);if(n){const s=document.createElement("img");s.crossOrigin="anonymous",s.classList.add(0===t.indexOf("af")?"qv_full_a_img":0===t.indexOf("f")?"qv_full_img":"qv_img"),s.src=n.link,i=i.replace(this.pattern_check,s.outerHTML)}else{const s=document.createElement("span");s.innerHTML="(Th\xeam h\xecnh \u1ea3nh)",s.classList.add("qv_none_image"),i=i.replace(this.pattern_check,s.outerHTML)}o++>1e4&&(i="")}return Object.assign(Object.assign({},e),{text:i})}outCss(){return[{className:"qv_full_a_img",content:"\n                    cursor: pointer;\n                    width: 60%\n                "},{className:"qv_full_img",content:"\n                    cursor: pointer;\n                    width: 100%\n                "},{className:"qv_img",content:"\n                    cursor: pointer;\n                    height: 25px;\n                "},{className:"qv_none_image",content:"\n                    display: inline-block;\n                    color: #2262ae;\n                    cursor: pointer;\n                "}]}pushImages(e){this.images=e}onEndAll(){}}l.ImagePartService=r,r.NAME_SERVICE="image_part:"},58446:(p,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.LatexPartService=void 0;class r{constructor(e){this.images=[],this.baseConfigEventListener=e}parse(e){let o=e.text||"";return Object.assign(Object.assign({},e),{text:o})}outCss(){return[]}pushImages(e){this.images=e}onEndAll(){}}l.LatexPartService=r,r.NAME_SERVICE="latex:"},15647:(p,l,r)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.LibrariesHelper=l.LibrariesPartService=void 0;const m=r(65097);class e{constructor(t,n){this.pattern_check=/^(\[@[CTG]\d+:[^\]]+\]\.)+((\[@Q\d+:[^\]]+\])|(\[[^@:]+\]))$/i,this.pattern_content=/\[(.*?)\]/i,this.images=[],this.baseConfigEventListener=[],this.baseConfigEventListener=t,this.cacheProcess=new i(n,this.baseConfigEventListener)}parse(t){let n=0,s=t.text||"";if(this.pattern_check.test(s)){let h=[];for(;null!==this.pattern_content.exec(s);){const c=this.pattern_content.exec(s);if(!c)break;h.push(c[1]),s=s.substring(0,c.index)+s.substring(c.index+c[0].length)}const a=o.convertStringToTypeObject(h),_={numberQuestion:1,path:a[0],useCache:!0};"Random"===a[0].type?("G"===a[1].type?(_.groupId=a[1].id,_.examId=a[2].id):(_.catId="C"===a[1].type?a[1].id:void 0,_.examId="T"===a[1].type?a[1].id:void 0,_.questionId="Q"===a[1].type?a[1].id:void 0),_.numberQuestion=a[0].id):_.questionId=a[0].id,s=m.PartsParser.IgnoreChar+this.cacheProcess.pushCaller(_),n++>1e4&&(s="")}return Object.assign(Object.assign({},t),{text:s})}outCss(){return[]}pushImages(t){this.images=t}onEndAll(){this.cacheProcess.startCaller()}}l.LibrariesPartService=e,e.NAME_SERVICE="libraries_part:";class o{static convertStringToTypeObject(t){const n=[];return t.forEach(s=>{let h=s.substring(1,2),a=Number(o.pattern_number.exec(s)),_="";if(o.char_types.includes(h)){let c=s.indexOf(":");-1!==c&&(_=s.substring(c))}else h="Random";n.push({name:_,id:a,type:h,content:s})}),n.reverse()}}l.LibrariesHelper=o,o.pattern_number=/\d+/i,o.char_types="CTGQH";class i{constructor(t,n){this.eventDoneKey=e.NAME_SERVICE+"done",this.cacheObjs=[],this.baseCaller=t,this.baseConfigEventListener=n}pushEventValue(){const t=this.baseConfigEventListener.filter(s=>0===s.eventName.indexOf(this.eventDoneKey));let n=[];t.forEach(s=>{const h=this.cacheObjs.filter(_=>"done"===_.step);s.func.call(s.caller,h)&&n.push(s.eventName)}),n.forEach(s=>{const h=this.baseConfigEventListener.findIndex(a=>a.eventName===s);-1!==h&&this.baseConfigEventListener.splice(h,1)})}pushCaller(t){const n=t.catId+"_"+t.examId+"_"+t.groupId+"_"+t.questionId+"_"+t.numberQuestion;var s=this.cacheObjs.find(h=>h.key===n);return s||this.cacheObjs.push(s={key:n,value:[],step:"init",pars:t,count:0}),s.count++,n+"_"+s?.count}startCaller(){this.cacheObjs.forEach(t=>{t.count=0,"init"===t.step?(t.step="call",this.baseCaller.getQuestion(t.pars.numberQuestion,t.pars.useCache,t.pars.catId,t.pars.examId,t.pars.questionId,t.pars.groupId).then(n=>{t.step="done",t.value=n,this.pushEventValue()})):"done"===t.step&&this.pushEventValue()})}}}}]);