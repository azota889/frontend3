"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[5879],{81899:(J,P,n)=>{n.d(P,{J:()=>w});var e=n(56223),o=n(41019),i=n(65879),E=n(23655);let w=(()=>{class m{constructor(g){this.testMarketQuestionService=g,this.schoolLevelSubjectObjs=[],this.formSchoolInfo=new e.cw({schoolLevel:new e.NI(0,{nonNullable:!0}),schoolSubject:new e.NI(0,{nonNullable:!0})})}initialData(){return new Promise(g=>{this.testMarketQuestionService.apiTestMarketQuestionsSubjectLevelsGet().subscribe(u=>{1==u.success?(this.schoolLevelSubjectObjs=u.data?.schoolLevelSubjectObjs??[],this.formSchoolInfo.controls.schoolLevel.setValue(12),this.formSchoolInfo.controls.schoolSubject.setValue(40),this.apiLeechData(void 0).then(h=>{g(h.map(S=>new o.Z(S.id,S.pr,S.type,void 0,S.name,S.examHashId,S.examCategoryId,0,!S.isLeaf,!1,void 0,S.isLeaf)))}).catch(()=>{g([])})):g([])})})}apiLeechData(g){return new Promise(u=>{const h=[];this.testMarketQuestionService.apiTestMarketQuestionsKnowledgeGet(Number(this.formSchoolInfo.controls.schoolLevel.value),Number(this.formSchoolInfo.controls.schoolSubject.value),g).subscribe(S=>{1===S.success&&S.data&&(S.data.objs||[]).forEach(x=>{h.push({pr:g??0,id:x.id??0,name:x.name?x.name:"",examHashId:"",examCategoryId:"",type:"knowledge",isLeaf:x.isLeaf??!1})}),u(h)})})}}return m.\u0275fac=function(g){return new(g||m)(i.LFG(E.Q_))},m.\u0275prov=i.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},4565:(J,P,n)=>{n.d(P,{$:()=>m,n:()=>_});var e=n(63019),o=n(65619),i=n(37398),E=n(41019),w=n(65879),y=n(71518);let m=(()=>{class g{constructor(h){this.documentService=h,this.leechApiCacheMaps=new Map,this.lastNodeSelected=[],this.lastNodesSelected=[]}initialData(h=0,S=void 0){return new Promise(f=>{this.apiLeechData(h,S).then(x=>{f(x.map(d=>new E.Z(d.id,d.pr,d.type,d.shareType,d.name,d.examHashId,d.examCategoryId,0,"cate"===d.type,d.isLeaf)))})})}apiLeechData(h,S,f=!1){return new Promise(x=>{let d=this.getCacheKey(h,S);if(f&&this.leechApiCacheMaps.has(d)&&this.leechApiCacheMaps.get(d))return void x(this.leechApiCacheMaps.get(d)??[]);const C=[];let A={categoryId:h,documentType:void 0,shareType:S,fileType:"exam_online",classroomId:void 0,name:void 0,suggestExamPurpose:void 0,lite:1,getGlobal:0,page:1,itemPerPage:-1};this.documentService.apiDocumentsGet(A.categoryId,A.documentType,A.shareType,A.fileType,A.classroomId,A.name,A.suggestExamPurpose,A.lite,A.getGlobal,A.page,A.itemPerPage).subscribe(L=>{1===L.success&&L.data&&((L.data.categoryObjs||[]).forEach(c=>{C.push({pr:h,id:c.id??0,name:c.name??"",examHashId:"",examCategoryId:"",type:"cate",shareType:c.shareType,isLeaf:!1})}),(L.data.documentObjs||[]).forEach(c=>{c.exam&&C.push({pr:h,id:c.exam.id??0,name:c.exam.name??"",examHashId:c.exam.hashId??"",examCategoryId:c.exam.categoryId?.toString()??"",type:"test",shareType:void 0,isLeaf:!0})}),this.leechApiCacheMaps.set(d,C)),x(C)})})}getCacheKey(h,S){return h+"_"+(S??"")}}return g.\u0275fac=function(h){return new(h||g)(w.LFG(y.Zg))},g.\u0275prov=w.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})();class _{get data(){return this.dataChange.value}set data(u){this._treeControl.dataNodes=u,this.dataChange.next(u)}findLastTreeNodeSelected(u,h=[]){let f=this.data.find(x=>x.id==u.id&&x.shareType==u.shareType);return f?(h.push({id:f.id,shareType:f.shareType}),f.prNode?this.findLastTreeNodeSelected(f.prNode,h):h.reverse()):h.reverse()}toggleLastNode(u,h=0,S,f){let x=u[h]?u[h]:void 0;if(!x)return f(S);let d=this.data.find(C=>C.id==x?.id&&C.shareType==x?.shareType);if(!d)return f(void 0);this.toggleNode(d,!0,!0,()=>{this.toggleLastNode(u,h+1,d,f)})}connect(u){return this._treeControl.expansionModel.changed.subscribe(h=>{(h.added||h.removed)&&this.handleTreeControl(h)}),(0,e.T)(u.viewChange,this.dataChange).pipe((0,i.U)(()=>this.data))}disconnect(u){}handleTreeControl(u){u.added&&u.added.forEach(h=>this.toggleNode(h,!0,!1,()=>{})),u.removed&&u.removed.slice().reverse().forEach(h=>this.toggleNode(h,!1,!1,()=>{}))}toggleNode(u,h,S=!1,f){if("cate"!=u.type)return f();const x=this.data.indexOf(u);if(h)u.isLoading=!0,this._database.apiLeechData(u.id,u.shareType,S).then(d=>{const C=d.map(A=>new E.Z(A.id,A.pr,A.type,A.shareType,A.name,A.examHashId,A.examCategoryId,u.level+1,"cate"===A.type,!1,u));this.data.splice(x+1,0,...C),this.dataChange.next(this.data),u.isLoading=!1,f()});else{let d=0;for(let C=x+1;C<this.data.length&&this.data[C].level>u.level;C++,d++);this.data.splice(x+1,d),this.dataChange.next(this.data),f()}}constructor(u,h){this._treeControl=u,this._database=h,this.dataChange=new o.X([])}}},41019:(J,P,n)=>{n.d(P,{Z:()=>e});class e{constructor(i,E,w,y,m,_,g,u=1,h=!1,S=!1,f,x){this.id=i,this.pr=E,this.type=w,this.shareType=y,this.item=m,this.examHashId=_,this.examCategoryId=g,this.level=u,this.expandable=h,this.isLoading=S,this.prNode=f,this.isLeaf=x}}},59694:(J,P,n)=>{n.d(P,{O:()=>E});var e=n(65879),o=n(88489),i=n(46558);let E=(()=>{class w{constructor(m,_){this.browserStorageService=m,this.commonService=_,this.data={}}setMode(m){this.browserStorageService.saveSimpleStorage("__editor:mode_open",m)}getMode(){var m=this.browserStorageService.getSimpleStorage("__editor:mode_open")||"editor";return this.browserStorageService.removeSimpleStorage("__editor:mode_open"),m}setFileProcess(m){this.file=m}getFirstFile(){let m=this.file;return this.file=void 0,m}setOutputData(m){this.data=m}getOutputData(){return this.data}redirectToConfig(m){this.data.homework&&m.showHomework(),(this.data.exam||this.data.examOffline)&&m.showExam()}setMatrixData(m,_){_?this.matrix=m:this.browserStorageService.saveSimpleStorage("__editor:matrix-data",JSON.stringify(m))}getMatrixData(){var m=this.browserStorageService.getSimpleStorage("__editor:matrix-data");return this.browserStorageService.removeSimpleStorage("__editor:matrix-data"),m?this.commonService.castJsonToObj(m):this.matrix}}return w.\u0275fac=function(m){return new(m||w)(e.LFG(o.n),e.LFG(i.z))},w.\u0275prov=e.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})()},2016:(J,P,n)=>{n.d(P,{H:()=>e});class e{get status(){return this.currentStatus}get msg(){return this.currentMessage}setStatus(i){this.currentStatus=!0,this.currentMessage=i}stopStatus(){this.currentStatus=!1,this.currentMessage=void 0}}},11460:(J,P,n)=>{n.d(P,{r:()=>i});var e=n(65879),o=n(46558);let i=(()=>{class E{constructor(y){this.commonService=y}partQuestionSearchText(y){let m=y.content??"",_=y.answers?.findIndex(g=>y.answerResult?.includes(g.key??""));if(void 0!==_&&-1!=_){let g=y.answers?.map(u=>u.content??"")??[];m+="\n"+this.commonService.getCorrectAnsTxt(g,_)}return this.commonService.parseQuestionContent(m)}partQuestionSearchTextByQuestionForm(y){let m=y.questionContent??"";const _=this.commonService.myParseJson(y.answerConfig??""),g=this.commonService.myParseJson(y?.answerResult??"[]")??[""];let u=_?.findIndex(h=>g.includes(h.key??""));if(void 0!==u&&-1!=u){let h=_?.map(S=>S.content??"")??[];m+="\n"+this.commonService.getCorrectAnsTxt(h,u)}return this.commonService.parseQuestionContent(m)}}return E.\u0275fac=function(y){return new(y||E)(e.LFG(o.z))},E.\u0275prov=e.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()},54901:(J,P,n)=>{n.d(P,{v:()=>Le});var e=n(65879),o=n(56223),i=n(66623),E=n(2016),w=n(37734),y=n(91765),m=n(71518),_=n(12044),g=n(50014),u=n(69862),h=n(70731),S=n(61713),f=n(46558),x=n(84672);let d=(()=>{class l{constructor(t,s){this.commonService=t,this.apiUploadService=s,this.sizeDefaultCanvas=1100,this.actionRunAfterConvert=[],this.imageMaps=[],this.pattern_base64=/data:image[^"'\\]+/i,this.pattern_image=/<img[^>]+data:image[^>]+>/g,this.taskConvertBase64ToCanvas=new h.Q(50,{function:(a,r)=>{this.callbackBase64ToCanvas&&this.callbackBase64ToCanvas(a,r)}}),this.taskUploadImage=new h.Q(10,{function:(a,r)=>{this.callbackUploadImage&&this.callbackUploadImage(a,r)}})}convertQuestions(t,s,a){return new Promise(r=>{this.reset(),t.forEach(p=>{const O=this.commonService.willDeleteParseJson(p.answerConfig||"[]");p.questionContent?.includes("<img ")&&this.replaceImageCdnInContent(p,"questionContent"),p.questionText?.includes("<img ")&&this.replaceImageCdnInContent(p,"questionText"),p.answerMedia?.includes("<img ")&&this.replaceImageCdnInContent(p,"answerMedia"),p.mediaMeta?.includes("<img ")&&this.replaceImageCdnInContent(p,"mediaMeta"),O.forEach(N=>{N.content.includes("<img ")&&this.replaceImageCdnInContent(N,"content")}),this.actionRunAfterConvert.push(()=>{p.answerConfig=JSON.stringify(O)})}),this.imageMaps.forEach(p=>{this.taskConvertBase64ToCanvas.addTask(this,this.startConvertCanvas,[p])}),this.taskConvertBase64ToCanvas.start().then(p=>{if(p.errs.length>0)a(p.errs,void 0);else{let N=0;const j=[],ee=()=>{const Z=document.createElement("canvas");Z.width=this.sizeDefaultCanvas,Z.height=this.sizeDefaultCanvas;const B=Z.getContext("2d");B&&(B.fillStyle="white",B.fillRect(0,0,this.sizeDefaultCanvas,this.sizeDefaultCanvas)),j.push({cdn:"",cX:0,cY:0,canvas:Z,imgs:[]})};ee(),p.datas.forEach((Z,B)=>{var D=j[j.length-1];D.cX+Z.canvas.width+4>this.sizeDefaultCanvas?(D.cX=4,D.cY+=N+4,N=0):D.cX+=4,D.cY+Z.canvas.height>this.sizeDefaultCanvas&&(ee(),D=j[j.length-1]);var R=D.canvas.getContext("2d");D.imgs.push({x:D.cX,y:D.cY,width:Z.canvas.width,height:Z.canvas.height,index:B}),R?.drawImage(Z.canvas,0,0,Z.canvas.width,Z.canvas.height,D.cX,D.cY,Z.canvas.width,Z.canvas.height),D.cX+=Z.canvas.width,N=N<Z.canvas.height?Z.canvas.height:N}),j[0].imgs.length>0&&j.forEach(Z=>{this.taskUploadImage.addTask(this,this.startUploadFile,[Z])}),this.taskUploadImage.start().then(Z=>{if(Z.errs.length>0)a(p.errs,void 0);else{let B=!0;Z.datas.forEach(D=>{D.imgs.forEach(R=>{const M=p.datas[R.index];if(M){const G={link:D.cdn,data:{x:R.x,y:R.y,width:R.width,height:R.height}};M.objs.forEach(F=>{if(F[M.path])if(this.commonService.isJson(F[M.path])){const te=this.commonService.willDeleteParseJson(F[M.path]);Object.prototype.hasOwnProperty.call(te,"renderedStr")?(te.renderedStr=te.renderedStr.replace(M.base,`@[]${JSON.stringify(G)}@[]`),F[M.path]=JSON.stringify(te)):F[M.path]=F[M.path].replace(M.base,`@[]${JSON.stringify(G)}@[]`)}else F[M.path]=F[M.path].replace(M.base,`@[]${JSON.stringify(G)}@[]`);else B=!1})}})}),B?(this.actionRunAfterConvert.forEach(D=>{D()}),t.forEach((D,R)=>{let M=this.commonService.willDeleteParseJson(D.mediaMeta||"{}"),G=s[R];const F={id:0,name:D.name,extension:"text",content:D.questionContent,groupContent:M.renderedStr,metaData:{isFixAns:Number(D.isFixAns),forcedFixAns:!1,groupType:D.groupType?Number(D.groupType):void 0}};G&&(F.vMetaEditor=G.meta),D.questionContent=JSON.stringify([F])}),r()):a(p.errs,void 0,!0)}})}})})}reset(){this.imageMaps=[],this.actionRunAfterConvert=[]}replaceImageCdnInContent(t,s){var a=t[s];if(this.commonService.isJson(t[s])){const O=this.commonService.willDeleteParseJson(t[s]);Object.prototype.hasOwnProperty.call(O,"renderedStr")&&(a=O.renderedStr)}let r=a.matchAll(this.pattern_image);for(;;){let O=r.next();if(O.done)break;let N=O.value[0];var p=this.imageMaps.findIndex(j=>j.base===N&&j.path===s);-1===p?this.imageMaps.push({base:N,cdn:"",data:null,objs:[t],path:s,canvas:document.createElement("canvas")}):this.imageMaps[p].objs.push(t)}}startConvertCanvas(t){return new Promise((s,a)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{let O=1;if(r.width>this.sizeDefaultCanvas&&(O=this.sizeDefaultCanvas/r.width),r.height>this.sizeDefaultCanvas){let j=this.sizeDefaultCanvas/r.height;j<O&&(O=j)}t.canvas.width=r.width*O,t.canvas.height=r.height*O,t.canvas.getContext("2d")?.drawImage(r,0,0,r.width,r.height,0,0,t.canvas.width,t.canvas.height),s(t)},r.onerror=()=>{t.canvas.width=1,t.canvas.height=1;const O=t.canvas.getContext("2d");O&&(O.fillStyle="white",O.fillRect(0,0,1,1)),s(t)};let p=this.pattern_base64.exec(t.base);null!=p?r.src=p[0]:a(new Error("l\u1ed7i regex"))})}startUploadFile(t){return new Promise((s,a)=>{const r=this.dataURLtoFile(t.canvas.toDataURL("image/png",1));(0,S.hv)(r).then(p=>{this.apiUploadService.uploadToCdnProgressForExamQuestionContent(p).subscribe(O=>{O.type!=u.dt.UploadProgress&&(1==O.success&&O.data?s({...t,cdn:O.data.url||""}):a(new Error(this.commonService.translateToKeyParam("lang_auto_khong_upload_duoc_anh_vui_long_thu_lai_sau_loi",O.message??"none"))))})})})}dataURLtoFile(t){let s=this.getFileName(t);for(var a=t.split(","),r=a[0].match(/:(.*?);/),p=atob(a[1]),O=p.length,N=new Uint8Array(O);O--;)N[O]=p.charCodeAt(O);return new File([N],s,{type:r&&r.length>0?r[1]:"png"})}getFileName(t){var s=t.split("").reverse().join(""),a=s.indexOf(";"),r=s.indexOf("/",a);return s.substring(a,r).split("").reverse().join("")}}return l.\u0275fac=function(t){return new(t||l)(e.LFG(f.z),e.LFG(x.W))},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})();var C=n(59694),A=n(11460),L=n(40687),b=n(88489),I=n(87325),c=n(96814),v=n(43389),T=n(67679),U=n(71646),Q=n(26425),W=n(18727),H=n(78337),$=n(41894),K=n(98445),X=n(84003),V=n(32296),q=n(37722),z=n(76024),Y=n(36727);function ne(l,k){1&l&&(e.TgZ(0,"div",38)(1,"span"),e._uU(2),e.ALo(3,"mytranslate"),e.qZA()()),2&l&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"lang_auto_vui_long_nhap_ho_va_ten")))}function ae(l,k){1&l&&(e.TgZ(0,"div",38)(1,"span"),e._uU(2),e.ALo(3,"mytranslate"),e.qZA()()),2&l&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"lang_auto_vui_long_nhap_so_dien_thoai")))}function ie(l,k){1&l&&(e.TgZ(0,"div",38)(1,"span"),e._uU(2),e.ALo(3,"mytranslate"),e.qZA()()),2&l&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"lang_student_utils_reques_phone_ten_number")))}function re(l,k){1&l&&(e.TgZ(0,"div",38)(1,"span"),e._uU(2),e.ALo(3,"mytranslate"),e.qZA()()),2&l&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"lang_document_please_enter_the_author_workplace")))}function le(l,k){if(1&l&&(e.TgZ(0,"div",14)(1,"div",30)(2,"div",31),e._UZ(3,"input",32),e.ALo(4,"mytranslate"),e.YNc(5,ne,4,3,"div",33),e.qZA(),e.TgZ(6,"div",34),e._UZ(7,"input",35),e.ALo(8,"mytranslate"),e.YNc(9,ae,4,3,"div",33),e.YNc(10,ie,4,3,"div",33),e.qZA(),e.TgZ(11,"div",36),e._UZ(12,"input",37),e.ALo(13,"mytranslate"),e.YNc(14,re,4,3,"div",33),e.qZA()()()),2&l){const t=e.oxw();e.xp6(3),e.s9C("placeholder",e.lcZ(4,7,"lang_auto_nhap_ho_va_ten")),e.xp6(2),e.Q6J("ngIf","0"==t.form.controls.creatorId.value&&!t.form.controls.creatorFullName.value),e.xp6(2),e.s9C("placeholder",e.lcZ(8,9,"lang_auto_nhap_so_dien_thoai")),e.xp6(2),e.Q6J("ngIf","0"==t.form.controls.creatorId.value&&!t.form.controls.creatorPhone.value),e.xp6(1),e.Q6J("ngIf","0"==t.form.controls.creatorId.value&&t.form.controls.creatorPhone.value&&10!==t.form.controls.creatorPhone.value.length),e.xp6(2),e.s9C("placeholder",e.lcZ(13,11,"lang_document_workplace")),e.xp6(2),e.Q6J("ngIf","0"==t.form.controls.creatorId.value&&!t.form.controls.creatorWorkingAddress.value)}}function ce(l,k){if(1&l){const t=e.EpF();e.TgZ(0,"mat-tree-node",43),e._UZ(1,"button",44),e.TgZ(2,"div",45)(3,"input",46),e.NdJ("change",function(){const r=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.checklistSelection.toggle(r))}),e.qZA(),e.TgZ(4,"label",47)(5,"span"),e._uU(6),e.qZA()()()()}if(2&l){const t=k.$implicit,s=e.oxw(2);e.xp6(3),e.s9C("id","knowledge-"+t.id),e.Q6J("checked",s.checklistSelection.isSelected(t)),e.xp6(1),e.s9C("for","knowledge-"+t.id),e.xp6(2),e.Oqu(t.item)}}function ue(l,k){if(1&l){const t=e.EpF();e.TgZ(0,"mat-tree-node",48)(1,"button",49)(2,"span",50),e._UZ(3,"lucide-icon",51),e.qZA()(),e.TgZ(4,"div",45)(5,"input",52),e.NdJ("change",function(){const r=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.todoItemSelectionToggle(r))}),e.qZA(),e.TgZ(6,"label",47)(7,"span"),e._uU(8),e.qZA()()()()}if(2&l){const t=k.$implicit,s=e.oxw(2);e.xp6(1),e.uIk("aria-label","toggle "+t.filename),e.xp6(2),e.s9C("name",s.treeControl.isExpanded(t)?"chevron-down":"chevron-right"),e.xp6(2),e.s9C("id","knowledge-"+t.id),e.Q6J("checked",s.descendantsAllSelected(t))("indeterminate",s.descendantsPartiallySelected(t)),e.xp6(1),e.s9C("for","knowledge-"+t.id),e.xp6(2),e.Oqu(t.item)}}function he(l,k){if(1&l&&(e.TgZ(0,"div",14)(1,"div",3)(2,"div",31)(3,"span",17),e._uU(4),e.ALo(5,"mytranslate"),e.qZA()(),e.TgZ(6,"div",39)(7,"mat-tree",40),e.YNc(8,ce,7,4,"mat-tree-node",41),e.YNc(9,ue,9,7,"mat-tree-node",42),e.qZA()()()()),2&l){const t=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,4,"lang_document_the_knowledge_units_present_in_the_exam")," "),e.xp6(3),e.Q6J("dataSource",t.dataSource)("treeControl",t.treeControl),e.xp6(2),e.Q6J("matTreeNodeDefWhen",t.hasChild)}}function de(l,k){1&l&&(e.TgZ(0,"span",58),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&l&&(e.xp6(1),e.hij("(",e.lcZ(2,1,"lang_document_current"),")"))}const me=function(l){return{"font-medium":l}};function ge(l,k){if(1&l&&(e.TgZ(0,"div",53)(1,"div",54),e._UZ(2,"input",55),e.TgZ(3,"label",56)(4,"span"),e._uU(5),e.ALo(6,"mytranslate"),e.qZA(),e.YNc(7,de,3,3,"span",57),e.qZA()()()),2&l){const t=k.index,s=e.oxw();e.xp6(2),e.s9C("id","week-"+s.listWeek[t]),e.Q6J("formControlName",t),e.xp6(1),e.s9C("for","week-"+s.listWeek[t]),e.Q6J("ngClass",e.VKq(8,me,s.currentSchoolWeeks===s.listWeek[t])),e.xp6(2),e.Oqu(e.lcZ(6,6,"lang_document_week")+" "+s.listWeek[t]),e.xp6(2),e.Q6J("ngIf",s.currentSchoolWeeks===s.listWeek[t])}}function pe(l,k){1&l&&(e.TgZ(0,"div",59)(1,"span"),e._uU(2),e.ALo(3,"mytranslate"),e.qZA()()),2&l&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"lang_document_please_select_the_time_of_use")))}class fe{}class _e{}let ve=(()=>{class l extends w.Q{buildFileTree(t,s){const a=[];return t.forEach(r=>{const p=new fe;p.item=r.name,p.id=r.id,r.children&&(p.children=this.buildFileTree(r.children,s+1)),a.push(p)}),a}descendantsAllSelected(t){return this.treeControl.getDescendants(t).every(a=>this.checklistSelection.isSelected(a))}descendantsPartiallySelected(t){return this.treeControl.getDescendants(t).some(r=>this.checklistSelection.isSelected(r))&&!this.descendantsAllSelected(t)}todoItemSelectionToggle(t){this.checklistSelection.toggle(t);const s=this.treeControl.getDescendants(t);this.checklistSelection.isSelected(t)?this.checklistSelection.select(...s):this.checklistSelection.deselect(...s)}toggleAllCheckBox(){this.isCheckSemesterOne.setValue(this.isCheckAllWeeks.value),this.isCheckSemesterTwo.setValue(this.isCheckAllWeeks.value);const t=this.isCheckAllWeeks.value;this.formArrayListWeek.controls.map(s=>s.setValue(t))}toggleSemesterOneCheckBox(){const t=this.isCheckSemesterOne.value;this.formArrayListWeek.controls.map((s,a)=>(a<18&&s.setValue(t),s)),this.calculateIsCheckAll()}toggleSemesterTwoCheckBox(){const t=this.isCheckSemesterTwo.value;this.formArrayListWeek.controls.map((s,a)=>(a>=18&&s.setValue(t),s)),this.calculateIsCheckAll()}initForm(){this.formArrayListWeek=this.form.controls.weeks,this.formArrayListKnowledge=this.form.controls.knowledgeIds}initKnowledgeCheckbox(t){this.formArrayListKnowledge.clear();for(let s=0;s<t.length;s++){const r=new o.NI(!1,{nonNullable:!0});this.formArrayListKnowledge.push(r)}}initWeedCheckbox(t){this.formArrayListWeek.clear();for(let s=0;s<t.length;s++){const r=new o.NI(!1,{nonNullable:!0});this.formArrayListWeek.push(r)}}calculateIsCheckAll(){const t=this.formArrayListWeek.controls.every(s=>s.value);this.isCheckAllWeeks.setValue(t)}ngOnChanges(){this.initForm(),this.initKnowledgeCheckbox(this.listKnowledge),this.dataSource.data=this.buildFileTree(this.listKnowledge,0)}ngOnInit(){super.ngOnInit(),this.initWeedCheckbox(this.listWeek),this.currentSchoolWeeks=this.timeService.getSchoolWeeks(),this.checklistSelection.changed.subscribe(t=>{let s=this.checklistSelection.selected.map(a=>a.id??0);this.listKnowledgeId=s.sort((a,r)=>a-r)??[],this.emitChooseKnowledge.emit(this.listKnowledgeId)}),this.form.controls.weeks.valueChanges.subscribe(t=>{this.calculateIsCheckAll(),this.checkChooseWeeks=t.some(s=>s)})}constructor(t){super(),this.timeService=t,this.listKnowledge=[],this.listWeek=[],this.emitChooseKnowledge=new e.vpe,this.formArrayListKnowledge=new o.Oe([]),this.formArrayListWeek=new o.Oe([]),this.flatNodeMap=new Map,this.nestedNodeMap=new Map,this.selectedParent=null,this.newItemName="",this.checklistSelection=new H.Ov(!0),this.listKnowledgeId=[],this.currentSchoolWeeks=0,this.checkChooseWeeks=!1,this.isCheckAllWeeks=new o.NI(!1,{nonNullable:!0}),this.isCheckSemesterOne=new o.NI(!1,{nonNullable:!0}),this.isCheckSemesterTwo=new o.NI(!1,{nonNullable:!0}),this.getLevel=s=>s.level??0,this.isExpandable=s=>s.expandable??!1,this.getChildren=s=>s.children??[],this.hasChild=(s,a)=>a.expandable??!1,this.hasNoContent=(s,a)=>""===a.item,this.transformer=(s,a)=>{const r=this.nestedNodeMap.get(s),p=r&&r.item===s.item?r:new _e;return p.item=s.item,p.level=a,p.id=s.id,p.expandable=!!s.children,this.flatNodeMap.set(p,s),this.nestedNodeMap.set(s,p),p},this.treeFlattener=new K.JZ(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new $.C2(this.getLevel,this.isExpandable),this.dataSource=new K.kc(this.treeControl,this.treeFlattener)}}return l.\u0275fac=function(t){return new(t||l)(e.Y36(X.D))},l.\u0275cmp=e.Xpm({type:l,selectors:[["azt-config-document-market"]],inputs:{form:"form",listKnowledge:"listKnowledge",listWeek:"listWeek"},outputs:{emitChooseKnowledge:"emitChooseKnowledge"},features:[e.qOj,e.TTD],decls:48,vars:29,consts:[[1,"mt-5"],[3,"formGroup"],[1,"box","p-3"],[1,"grid","grid-cols-12"],[1,"col-span-12","lg:col-span-5"],["for","general-name",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-7"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-8"],["type","radio","id","creator-by-me","formControlName","creatorId","value","1",1,"form-check-input"],["for","creator-by-me",1,"form-check-label"],["type","radio","id","creator-by-user-other","formControlName","creatorId","value","0",1,"form-check-input"],["for","creator-by-user-other",1,"form-check-label"],["class","mt-3",4,"ngIf"],[1,"mt-3"],["formArrayName","weeks",1,"list-week","grid","grid-cols-12"],[1,"col-span-12","flex","items-center"],[1,"form-label","mb-0","font-medium","flex","items-center"],[1,"list-week","col-span-12","mt-1"],[1,"flex","flex-row","sm:flex-col","sm:items-center"],[1,"azt-form-check","mr-5","mt-3","sm:mt-0"],["type","checkbox","id","selectSemesterOne",1,"form-check-input",3,"formControl","change"],["for","selectSemesterOne",1,"form-check-label"],["type","checkbox","id","selectSemesterTwo",1,"form-check-input",3,"formControl","change"],["for","selectSemesterTwo",1,"form-check-label"],["type","checkbox","id","selectAllWeeks",1,"form-check-input",3,"formControl","change"],["for","selectAllWeeks",1,"form-check-label"],[1,"grid","grid-cols-12","gap-3","mt-3"],["class","col-span-6 md:col-span-3 lg:col-span-2",4,"ngFor","ngForOf"],["class","col-span-12 mt-2 text-danger text-xs",4,"ngIf"],[1,"grid","grid-cols-12","gap-3"],[1,"col-span-12"],["type","text","name","creatorFullName","formControlName","creatorFullName",1,"form-control",3,"placeholder"],["class","text-danger text-xs mt-2",4,"ngIf"],[1,"col-span-12","md:col-span-4"],["type","text","appOnlyNumber","","name","creatorPhone","formControlName","creatorPhone",1,"form-control",3,"placeholder"],[1,"col-span-12","md:col-span-8"],["type","text","name","creatorWorkingAddress","formControlName","creatorWorkingAddress",1,"form-control",3,"placeholder"],[1,"text-danger","text-xs","mt-2"],[1,"list-knowledge","col-span-12"],[3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",4,"matTreeNodeDef"],["matTreeNodePadding","",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle","","matTreeNodePadding",""],["mat-icon-button","","disabled",""],[1,"azt-form-checked"],["type","checkbox",1,"form-check-input",3,"checked","id","change"],[1,"form-check-label",2,"vertical-align","middle",3,"for"],["matTreeNodePadding",""],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror","w-5","h-5","inline-block",2,"vertical-align","bottom"],[3,"name"],["type","checkbox",1,"form-check-input",3,"checked","indeterminate","id","change"],[1,"col-span-6","md:col-span-3","lg:col-span-2"],[1,"azt-form-check"],["type","checkbox","value","41556",1,"form-check-input",3,"formControlName","id"],[1,"form-check-label",2,"vertical-align","middle",3,"ngClass","for"],["class","inline-block ml-1",4,"ngIf"],[1,"inline-block","ml-1"],[1,"col-span-12","mt-2","text-danger","text-xs"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),e._uU(6),e.ALo(7,"mytranslate"),e.qZA()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8),e._UZ(11,"input",9),e.TgZ(12,"label",10),e._uU(13),e.ALo(14,"mytranslate"),e.qZA()(),e.TgZ(15,"div",8),e._UZ(16,"input",11),e.TgZ(17,"label",12),e._uU(18),e.ALo(19,"mytranslate"),e.qZA()()()()(),e.YNc(20,le,15,13,"div",13),e.YNc(21,he,10,6,"div",13),e.TgZ(22,"div",14)(23,"div",15)(24,"div",16)(25,"span",17),e._uU(26),e.ALo(27,"mytranslate"),e.qZA()(),e.TgZ(28,"div",18)(29,"div",19)(30,"div",20)(31,"input",21),e.NdJ("change",function(){return s.toggleSemesterOneCheckBox()}),e.qZA(),e.TgZ(32,"label",22),e._uU(33),e.ALo(34,"mytranslate"),e.qZA()(),e.TgZ(35,"div",20)(36,"input",23),e.NdJ("change",function(){return s.toggleSemesterTwoCheckBox()}),e.qZA(),e.TgZ(37,"label",24),e._uU(38),e.ALo(39,"mytranslate"),e.qZA()(),e.TgZ(40,"div",20)(41,"input",25),e.NdJ("change",function(){return s.toggleAllCheckBox()}),e.qZA(),e.TgZ(42,"label",26),e._uU(43),e.ALo(44,"mytranslate"),e.qZA()()(),e.TgZ(45,"div",27),e.YNc(46,ge,8,10,"div",28),e.qZA()(),e.YNc(47,pe,4,3,"div",29),e.qZA()()()()()),2&t&&(e.xp6(1),e.Q6J("formGroup",s.form),e.xp6(5),e.hij(" ",e.lcZ(7,15,"lang_document_author")," "),e.xp6(7),e.hij(" ",e.lcZ(14,17,"lang_document_me")," "),e.xp6(5),e.hij(" ",e.lcZ(19,19,"lang_document_others")," "),e.xp6(2),e.Q6J("ngIf","0"==s.form.controls.creatorId.value),e.xp6(1),e.Q6J("ngIf",s.formArrayListKnowledge.controls.length),e.xp6(5),e.hij(" ",e.lcZ(27,21,"lang_document_time_of_use")," "),e.xp6(5),e.Q6J("formControl",s.isCheckSemesterOne),e.xp6(2),e.hij(" ",e.lcZ(34,23,"lang_config_semester")+" 1"," "),e.xp6(3),e.Q6J("formControl",s.isCheckSemesterTwo),e.xp6(2),e.hij(" ",e.lcZ(39,25,"lang_config_semester")+" 2"," "),e.xp6(3),e.Q6J("formControl",s.isCheckAllWeeks),e.xp6(2),e.hij(" ",e.lcZ(44,27,s.isCheckAllWeeks.value?"lang_student_classroom_list_utils_create_class_new_course_disable":"lang_student_classroom_list_utils_create_class_new_course_choose_all")," "),e.xp6(3),e.Q6J("ngForOf",s.formArrayListWeek.controls),e.xp6(1),e.Q6J("ngIf",!s.checkChooseWeeks))},dependencies:[c.mk,c.sg,c.O5,V.RK,K.fQ,K.ah,K.eu,K.gi,K.uo,o._Y,o.Fj,o.Wl,o._,o.JJ,o.JL,o.oH,o.sg,o.u,o.CE,q.Nh5,z.Y,T.M,Y.JV],encapsulation:2}),l})();function Se(l,k){if(1&l&&e._UZ(0,"azt-loading-effect",3),2&l){const t=e.oxw();e.Q6J("currentStatusObj",t.statusObj)}}function be(l,k){1&l&&(e.TgZ(0,"div",30),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"lang_auto_vui_long_nhap_ten_de_thi")," "))}function Ce(l,k){if(1&l){const t=e.EpF();e.ynx(0),e.TgZ(1,"config-level-subject",31),e.NdJ("sendLogPredictSubject",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getLogPredictSubject(a))}),e.qZA(),e.BQk()}if(2&l){const t=e.oxw(2);e.xp6(1),e.Q6J("form",t.form)("questionContents",t.questionContent)("schoolLevelObjs",t.schoolLevelObjs)}}function xe(l,k){if(1&l&&e._UZ(0,"config-level-subject",32),2&l){const t=e.oxw(2);e.Q6J("form",t.form)("schoolLevelObjs",t.schoolLevelObjs)}}function je(l,k){1&l&&(e.TgZ(0,"span",33),e._UZ(1,"azt-loading-ui"),e.qZA())}function Ae(l,k){if(1&l){const t=e.EpF();e.TgZ(0,"div",4)(1,"form",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9)(6,"div",10)(7,"label",11),e._uU(8),e.ALo(9,"mytranslate"),e.qZA()(),e.TgZ(10,"div",10)(11,"div",12),e._UZ(12,"input",13),e.ALo(13,"mytranslate"),e.qZA(),e.YNc(14,be,3,3,"div",14),e.qZA()(),e.TgZ(15,"div",15),e.YNc(16,Ce,2,3,"ng-container",16),e.YNc(17,xe,1,2,"ng-template",null,17,e.W1O),e.qZA(),e.TgZ(19,"div",18),e._UZ(20,"config-purpose-exam",19),e.qZA(),e.TgZ(21,"div",20)(22,"div",10)(23,"label",21),e._uU(24),e.ALo(25,"mytranslate"),e.qZA()(),e.TgZ(26,"div",10)(27,"div",12),e._UZ(28,"textarea",22),e.ALo(29,"mytranslate"),e.qZA()()()(),e.TgZ(30,"div",23)(31,"azt-config-document-market",24),e.NdJ("emitChooseKnowledge",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.chooseKnowledge(a))}),e.qZA()(),e.TgZ(32,"div",25)(33,"div",26)(34,"button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cancelSaveDocumentObj())}),e._uU(35),e.ALo(36,"mytranslate"),e.qZA(),e.TgZ(37,"button",28),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleSaveDocument())}),e.YNc(38,je,2,0,"span",29),e._uU(39),e.ALo(40,"mytranslate"),e.qZA()()()()()()()}if(2&l){const t=e.MAs(18),s=e.oxw();e.xp6(1),e.Q6J("formGroup",s.form),e.xp6(7),e.hij(" ",e.lcZ(9,17,"lang_auto_ten")," "),e.xp6(4),e.s9C("placeholder",e.lcZ(13,19,"lang_auto_nhap_ten")+" ..."),e.xp6(2),e.Q6J("ngIf",s.form.controls.name.errors),e.xp6(2),e.Q6J("ngIf",s.isCreateQuestionToEditor)("ngIfElse",t),e.xp6(4),e.Q6J("purposeList",s.listPurposeObjs)("form",s.form),e.xp6(4),e.hij(" ",e.lcZ(25,21,"lang_auto_mo_ta")," "),e.xp6(4),e.s9C("placeholder",e.lcZ(29,23,"lang_core_nhap_mo_ta")+" ..."),e.xp6(3),e.Q6J("form",s.form)("listWeek",s.listWeek)("listKnowledge",s.listKnowledge),e.xp6(4),e.hij(" ",e.lcZ(36,25,"lang_auto_huy")," "),e.xp6(2),e.Q6J("disabled",s.logConfig.status),e.xp6(1),e.Q6J("ngIf",s.logConfig.status),e.xp6(1),e.hij(" ",e.lcZ(40,27,"lang_auto_luu")," ")}}function Oe(l,k){if(1&l&&(e.TgZ(0,"div",34)(1,"div",35)(2,"div",36)(3,"span",37),e._UZ(4,"azt-loading-ui"),e.qZA(),e.TgZ(5,"div",38),e._uU(6),e.qZA()()()()),2&l){const t=e.oxw();e.xp6(6),e.Oqu(t.logConfig.msg)}}let Le=(()=>{class l extends w.Q{getLogPredictSubject(t){this.predictLogRequestObj=t}chooseKnowledge(t){this.knowledgeList=t}cancelSaveDocumentObj(){this.onBack.emit(!0)}handleSaveDocument(){const t=this.getWeeksChecked(this.listWeek,this.form.controls.weeks.value);if(this.checkErrorValidateSave(t,this.knowledgeList))this.showErrorSnack("lang_cms_utils_folder_name_validate_space");else{if(this.type===i.R.exam&&this.isCreateQuestionToEditor&&this.dataSave.exam&&this.dataSave.exam.questionObj.listQuestions){this.logConfig.setStatus(this.commonService.myTranslateInstant("lang_auto_dang_luu_du_lieu_de_thi")),this.countProcess=0;const s=this.dataSave.exam.questionObj.listQuestions;let a=this.commonService.myTranslateInstant("lang_auto_xay_ra_loi_trong_qua_trinh_xu_ly_hinh_anh_cua_de_thi")??"";this.questionShareSaveService.convertQuestions(s,this.dataSave.exam.rootQuests,(r,p=a,O)=>{this.logConfig.stopStatus(),this.showErrorSnack(p),O&&this.stopStatusObj()}).then(()=>{this.startMainProcessSaveEditor()})}this.type===i.R.exam&&!this.isCreateQuestionToEditor&&this.examObj?.id&&this.saveDocumentMarketQuestionObjs(),this.type!==i.R.exam&&this.attachments.length&&this.saveDocumentMarketQuestionObjs(),console.log(this.attachments,this.type)}}initQuestionShare(){this.questionShareSaveService.callbackBase64ToCanvas=(t,s)=>{let a=this.commonService.myTranslateInstant("lang_auto_dang_xu_ly_hinh_anh_cho_de_thi");this.logConfig.setStatus(`${a} ${Math.floor(t/s*100*.7)}%`)},this.questionShareSaveService.callbackUploadImage=(t,s)=>{let a=this.commonService.myTranslateInstant("lang_auto_dang_xu_ly_hinh_anh_cho_de_thi");this.logConfig.setStatus(`${a} ${Math.floor(t/s*100*.3)+70}%`)}}processSaveQuestionsFromEditor(t,s,a){if(this.dataSave.exam?.questionObj&&this.dataSave.exam?.questionObj.listQuestions){var r=this.dataSave.exam?.questionObj.listQuestions.length;let p=t+100>r?r:t+100,O=this.dataSave.exam?.questionObj.listQuestions.slice(t,p)??[],N=[];for(const j of O)N.push({categoryId:j.categoryId,groupId:j.groupId,name:j.name??"none",metadata:j.metadata,isImage:j.isImage,questionContent:j.questionContent,answerMedia:j.answerMedia,questionText:j.questionText,answerType:j.answerType,answerConfig:j.answerConfig,coordinates:j.coordinates,answerResult:j.answerResult,totalQuestion:j.totalQuestion,tags:j.tags??[],mediaId:j.mediaId,mediaMeta:j.mediaMeta,attachments:j.attachments,version:j.version,isFixAns:j.isFixAns,groupType:j.groupType,__path:j.__path});N.length>0?this.sAztSaveProcessService.saveQuestionObjsFromEditor(this.dataSave,N,s).then(j=>{j&&j.listQuestionId.length>0?(a.listQuestionId=a.listQuestionId.concat(j.listQuestionId),this.processSaveQuestionsFromEditor(p,j.indexSaved,a)):(this.countProcess=0,this.logConfig.stopStatus(),this.showErrorSnack("lang_auto_khong_luu_duoc_noi_dung_cau_hoi_trong_de_vui_long_kiem_tra_lai"))}):this.saveDocumentMarketQuestionObjs(a)}}startMainProcessSaveEditor(){this.dataSave.exam&&this.dataSave.exam.questionObj&&this.processSaveQuestionsFromEditor(0,0,{indexSaved:0,listQuestionId:[]})}GetSubjectAndLevel(){this.initStatusObj(),this.waitDestroy(this.commonListService.apiCommonListSubjectAndLevelsGet(this.commonService.getBusinessDomainUrl()).subscribe(t=>{1==t.success?(this.examSchoolLogObj=t.data?.examSchoolLogObj,this.schoolLevelObjs=t.data?.schoolLevelSubjectObjs??[],this.getListPurposeExam()):this.errorStatusObj(t.message??"")}))}getListPurposeExam(){this.initStatusObj(),this.waitDestroy(this.commonListService.apiCommonListExamPurposesGet().subscribe(t=>{t.success?(this.listPurposeObjs=t.data?.objs??[],this.successStatusObj()):this.errorStatusObj(t.message??"",!0)}))}getKnowledgeData(){const t=this.form.controls.schoolLevel.value,s=this.form.controls.schoolSubject.value;t&&s&&this.waitDestroy(this.knowledgeService.apiKnowledgeGet(t,s).subscribe(a=>{a.list&&(this.listKnowledge=a.list)}))}checkErrorValidateSave(t,s){return!(!this.form.invalid&&("0"!=this.form.controls.creatorId.value||this.form.controls.creatorFullName.value&&this.form.controls.creatorFullName.value&&this.form.controls.creatorPhone.value&&this.form.controls.creatorWorkingAddress.value)&&("0"!=this.form.controls.creatorId.value||10===this.form.controls.creatorPhone.value.length)&&t.length)}fillConfig(){const t=Number(this.commonService.getMyParam(this.activeRoute,"levelId")),s=Number(this.commonService.getMyParam(this.activeRoute,"subjectId"));if(this.examObj?.id)this.waitDestroy(this.documentConfigService.apiDocumentConfigGetExamConfigDataV2Get(this.examObj.hashId??"").subscribe(a=>{if(a.success){const r=a.data?.examObj;this.form.controls.name.setValue(r?.name??""),this.form.controls.description.setValue(r?.description??""),this.form.controls.schoolLevel.setValue(r?.schoolLevelId??t),this.form.controls.schoolSubject.setValue(r?.schoolSubjectId??s),this.form.controls.purposeExam.setValue(a.data?.purposeId??0),this.form.controls.purposeNote.setValue(a.data?.purposeNote??"")}else this.errorStatusObj(a.message??"",!0)}));else if(this.isCreateQuestionToEditor){const a=Number(this.browserStorageService.getSimpleStorage("levelId")??0),r=Number(this.browserStorageService.getSimpleStorage("subjectId")??0);this.form.controls.schoolLevel.setValue(a),this.form.controls.schoolSubject.setValue(r)}else this.form.controls.schoolLevel.setValue(t),this.form.controls.schoolSubject.setValue(s),this.form.controls.name.setValue(this.name)}getWeeksChecked(t,s){let a=[];for(let r=0;r<s.length;r++)s[r]&&t[r]&&a.push(t[r]);return a}createListWeek(){for(let s=0;s<35;s++)this.listWeek.push(s+1)}saveDocumentMarketQuestionObjs(t){const s=this.getWeeksChecked(this.listWeek,this.form.controls.weeks.value);this.logConfig.setStatus("");let a={name:this.form.controls.name.value,type:this.type,schoolLevelId:this.form.controls.schoolLevel.value,schoolSubjectId:this.form.controls.schoolSubject.value,purposeId:this.form.controls.purposeExam.value,purposeNote:this.form.controls.purposeNote.value,description:this.form.controls.description.value,creatorId:Number(this.form.controls.creatorId.value),creatorFullName:this.form.controls.creatorFullName.value,creatorPhone:this.form.controls.creatorPhone.value,creatorWorkingAddress:this.form.controls.creatorWorkingAddress.value,knowledgeIds:this.knowledgeList,weeks:s};switch(this.type){case i.R.exam:if(t&&this.isCreateQuestionToEditor){let r=[];r=t.listQuestionId.map(p=>p??0)??[],a.questionIds=r}this.examObj?.id&&!this.isCreateQuestionToEditor&&(a.examId=this.examObj?.id,a.questionIds=[]);break;case i.R.lecture:case i.R.ref:case i.R.teaching_plan:case i.R.slide:a.attachments=this.attachments}this.waitDestroy(this.documentService.apiDocumentsPost(a).subscribe(r=>{if(r.id){this.successStatusObj("lang_document_successful_sharing",!0);const p="/document-market/list-documents/your-documents/1";this.logConfig.stopStatus(),this.myNavigation(p)}else this.errorStatusObj(""),this.logConfig.stopStatus()}))}ngOnInit(){if(super.ngOnInit(),this.GetSubjectAndLevel(),this.createListWeek(),this.getKnowledgeData(),this.fillConfig(),this.form.controls.schoolSubject.valueChanges.subscribe(t=>{this.getKnowledgeData()}),this.form.controls.schoolLevel.valueChanges.subscribe(t=>{this.getKnowledgeData()}),this.type===i.R.exam&&this.isCreateQuestionToEditor){this.dataSave=this.editorOutputDataService.getOutputData();const t=25;this.questionContent=[],this.dataSave.exam?.questionObj.listQuestions?.forEach((a,r)=>{r<t&&this.questionContent.push(this.partQuestionSearchTextService.partQuestionSearchTextByQuestionForm(a))}),this.form.controls.name.setValue(this.dataSave.exam?.examObj.name??this.dataSave.homework?.name??"")}}constructor(t,s,a,r,p,O,N,j,ee,Z,B){super(),this.documentConfigService=t,this.activeRoute=s,this.examService=a,this.documentService=r,this.knowledgeService=p,this.questionShareSaveService=O,this.editorOutputDataService=N,this.partQuestionSearchTextService=j,this.sAztSaveProcessService=ee,this.browserStorageService=Z,this.commonListService=B,this.type=i.R.exam,this.isCreateQuestionToEditor=!1,this.attachments=[],this.name="",this.onBack=new e.vpe,this.schoolLevelObjs=[],this.listPurposeObjs=[],this.listKnowledge=[],this.logConfig=new E.H,this.dataSave={},this.saveParts=[],this.questionContent=[],this.countProcess=0,this.knowledgeList=[],this.listWeek=[],this.form=new o.cw({name:new o.NI("",{nonNullable:!0,validators:[o.kI.required,y._.noWhiteSpace]}),description:new o.NI("",{nonNullable:!0}),schoolLevel:new o.NI(0,{nonNullable:!0,validators:[o.kI.required,o.kI.min(1)]}),schoolSubject:new o.NI(0,{nonNullable:!0,validators:[o.kI.required,o.kI.min(1)]}),purposeExam:new o.NI(0,{nonNullable:!0,validators:[o.kI.required,o.kI.min(1)]}),purposeNote:new o.NI("",{nonNullable:!0}),knowledgeIds:new o.Oe([]),weeks:new o.Oe([]),creatorId:new o.NI("1",{nonNullable:!0}),creatorFullName:new o.NI("",{nonNullable:!0}),creatorPhone:new o.NI("",{nonNullable:!0}),creatorWorkingAddress:new o.NI("",{nonNullable:!0})}),this.type===i.R.exam&&this.isCreateQuestionToEditor&&this.initQuestionShare()}}return l.\u0275fac=function(t){return new(t||l)(e.Y36(m.Cq),e.Y36(_.gz),e.Y36(m.Oe),e.Y36(g.Zg),e.Y36(g.zH),e.Y36(d),e.Y36(C.O),e.Y36(A.r),e.Y36(L.a),e.Y36(b.n),e.Y36(I.o7))},l.\u0275cmp=e.Xpm({type:l,selectors:[["azt-config-share-document"]],inputs:{type:"type",isCreateQuestionToEditor:"isCreateQuestionToEditor",attachments:"attachments",name:"name",examObj:"examObj"},outputs:{onBack:"onBack"},features:[e.qOj],decls:4,vars:3,consts:[[3,"currentStatusObj",4,"ngIf","ngIfElse"],["doneLoading",""],["style","width: 100vw; height: 100vh; position: fixed; z-index: 9999; top: 0; left: 0; display: flex; justify-content: center; align-items: center; background-color: rgba(0, 0, 0, 0.4)",4,"ngIf"],[3,"currentStatusObj"],[1,"intro-y","mt-8","p-3"],[3,"formGroup"],[1,"mx-auto",2,"max-width","1100px"],[1,"setting-block"],[1,"box","mt-2","p-3"],["id","azt-config-name",1,"grid","grid-cols-12"],[1,"col-span-12","lg:col-span-12"],["for","general-name",1,"form-label","mb-0","font-medium","flex","items-center"],[1,"setting-input"],["id","general-name","formControlName","name","type","text",1,"form-control",3,"placeholder"],["class","mt-2 text-danger text-xs fade",4,"ngIf"],[1,"mt-4"],[4,"ngIf","ngIfElse"],["normal",""],[1,"mt-2"],[3,"purposeList","form"],["id","azt-config-desc",1,"grid","grid-cols-12","mt-4"],["for","general-desc",1,"form-label","mb-0","font-medium","flex","items-center"],["id","general-desc","formControlName","description",1,"form-control","w-full",2,"height","150px",3,"placeholder"],[1,"config-document-market"],[3,"form","listWeek","listKnowledge","emitChooseKnowledge"],[1,"mt-5"],[1,"flex","justify-end"],[1,"btn","btn-secondary","w-24","mr-2",3,"click"],[1,"btn","w-24","btn-primary",3,"disabled","click"],["class","w-4 h-4 mr-2",4,"ngIf"],[1,"mt-2","text-danger","text-xs","fade"],[3,"form","questionContents","schoolLevelObjs","sendLogPredictSubject"],[3,"form","schoolLevelObjs"],[1,"w-4","h-4","mr-2"],[2,"width","100vw","height","100vh","position","fixed","z-index","9999","top","0","left","0","display","flex","justify-content","center","align-items","center","background-color","rgba(0, 0, 0, 0.4)"],[2,"text-align","center","color","#000000"],[2,"margin-bottom","10px"],[1,"w-4","h-4","inline-block"],[2,"font-size","20px","margin-top","10px","background-color","#f0f8ffa3","padding","10px","border-radius","5px"]],template:function(t,s){if(1&t&&(e.YNc(0,Se,1,1,"azt-loading-effect",0),e.YNc(1,Ae,41,29,"ng-template",null,1,e.W1O),e.YNc(3,Oe,7,1,"div",2)),2&t){const a=e.MAs(2);e.Q6J("ngIf",s.statusObj.loading)("ngIfElse",a),e.xp6(3),e.Q6J("ngIf",s.logConfig.status&&s.isCreateQuestionToEditor)}},dependencies:[c.O5,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,v.l,T.M,U.n,Q.Z,W.u,ve,Y.JV],encapsulation:2}),l})()},40687:(J,P,n)=>{n.d(P,{a:()=>y});var e=n(65879),o=n(46558),i=n(70731),E=n(24276),w=n(32169);let y=(()=>{class m{convertBase64OfMathJaxToCdnUrlInQuestions(g,u){return new Promise((h,S)=>{const f=null==u?new i.Q(10):new i.Q(10,{function:u},0);g.forEach(x=>{f.addTask(this.dataAztMathRawHelper,this.dataAztMathRawHelper.convertBase64OfMathJaxToCdnUrl,[x])}),f.start().then(x=>{0===x.errs.length?h(x.datas):S(x.errs[0])})})}saveQuestionObjsFromEditor(g,u,h){return new Promise(S=>{this.convertBase64OfMathJaxToCdnUrlInQuestions(u,void 0).then(f=>{let x=[];for(let d=0;d<f.length;d++){let C=f[d];C.expandInfo=this.commonService.serializeJson(g.exam?.examObj.expandInfoObj),x.push(C)}this.questionService.apiQuestionsPost({listQuestions:x}).subscribe(d=>{S(d.list?{indexSaved:d.list.length+h,listQuestionId:d.list}:{indexSaved:h,listQuestionId:[]})})}).catch(()=>{S({indexSaved:h,listQuestionId:[]})})})}constructor(g,u){this.questionService=g,this.dataAztMathRawHelper=u,this.commonService=(0,e.f3M)(o.z)}}return m.\u0275fac=function(g){return new(g||m)(e.LFG(E.aE),e.LFG(w.n))},m.\u0275prov=e.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},26425:(J,P,n)=>{n.d(P,{Z:()=>L});var e=n(65879),o=n(37734),i=function(b){return b[b.DEFAULT=0]="DEFAULT",b[b.ACCEPT=1]="ACCEPT",b[b.NOT_DO_ANYTHING=2]="NOT_DO_ANYTHING",b}(i||{});class E{acceptPredictSubjectId(I,c){if(!this.predictLogRequestObj)return;let v=this.schoolLevelObjs.find(z=>z.schoolLevel?.id==I),T=v?.schoolLevel?.value??0,U=v?.schoolSubjectObjs.find(z=>z.id==c),Q=this.allPredictSubjectObjs.find(z=>!0),W=this.schoolLevelObjs.find(z=>z.schoolSubjectObjs.map(Y=>Y.id).includes(Q?.id??0)),H=Q?.from??0,$=Q?.to??0;if(!W||!Q||!H||!$||U&&this.allPredictSubjectIds.includes(U.id))return;let K=0,X=0;if(v?.schoolLevel?.id&&T>=H&&T<=$){let z=v?.schoolSubjectObjs.find(Y=>this.allPredictSubjectIds.includes(Y.id));if(z)return K=v.schoolLevel.id,X=z.id,this.predictLogRequestObj.acceptPredictStatus=i.ACCEPT,{schoolLevelId:K,schoolSubjectId:X}}let V=this.allPredictSubjectObjs.find(z=>!0),q=this.schoolLevelObjs.find(z=>z.schoolSubjectObjs.map(Y=>Y.id).includes(V?.id??0));return V&&q&&q.schoolLevel?.id?(this.predictLogRequestObj.acceptPredictStatus=i.ACCEPT,{schoolLevelId:q.schoolLevel.id,schoolSubjectId:V.id}):void 0}changePredictStatusWhenSubjectIdChanged(I){this.predictLogRequestObj&&(this.predictLogRequestObj.acceptPredictStatus=this.allPredictSubjectIds.includes(I)?i.NOT_DO_ANYTHING:i.DEFAULT)}predictSchoolSubjectByQuestionContent(I,c,v,T){v.length&&c.length&&(this.schoolLevelObjs=c,this.aiService.apiAiPredictSubjectPost({questionContents:v}).subscribe(Q=>{if(Q.success&&this.predictLogRequestObj){let W=Q.data?.schoolSubjectId;if(!W||(this.setAllPredictSubjectIds(W),!this.allPredictSubjectObjs.length))return;this.predictLogRequestObj={predictSchoolSubjectId:W,acceptPredictStatus:i.DEFAULT,predictByTotalQuestion:v.length},this.changePredictStatusWhenSubjectIdChanged(I),T(!0)}else T(!1)}))}setAllPredictSubjectIds(I){let c=this.commonService.concatMultipleArray(this.schoolLevelObjs.map(T=>T.schoolSubjectObjs)),v=c.find(T=>T.id==I)?.key??"";this.allPredictSubjectObjs=c.filter(T=>T.key&&T.key==v),this.allPredictSubjectIds=this.allPredictSubjectObjs.map(T=>T.id),this.predictSubjectKey=this.allPredictSubjectObjs.find(T=>!0)?.key??""}constructor(I,c){this.commonService=I,this.aiService=c,this.predictLogRequestObj=void 0,this.allPredictSubjectIds=[],this.predictSubjectKey="",this.allPredictSubjectObjs=[],this.schoolLevelObjs=[]}}var w=n(64728),y=n(96814),m=n(23680),_=n(64170),g=n(98525),u=n(56223),h=n(67679),S=n(36727);let f=(()=>{class b{transform(c,v){if(!c)return"";const T=c.find(Q=>Q.id==v);return T?T.key??"":""}}return b.\u0275fac=function(c){return new(c||b)},b.\u0275pipe=e.Yjl({name:"aztFindSchoolSubjectById",type:b,pure:!0}),b})();function x(b,I){if(1&b&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&b){const c=I.$implicit;e.Q6J("value",null==c.schoolLevel?null:c.schoolLevel.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,null==c.schoolLevel?null:c.schoolLevel.key)," ")}}function d(b,I){if(1&b&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&b){const c=I.$implicit;e.Q6J("value",c.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,c.key)," ")}}function C(b,I){1&b&&(e.TgZ(0,"div",16),e._uU(1),e.ALo(2,"mytranslate"),e.qZA()),2&b&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"lang_auto_vui_long_chon_khoi_hoc_va_mon_hoc")," "))}function A(b,I){if(1&b){const c=e.EpF();e.TgZ(0,"div",17)(1,"div",18)(2,"span"),e._uU(3),e.ALo(4,"mytranslate"),e.ALo(5,"mytranslate"),e.ALo(6,"mytranslate"),e.ALo(7,"mytranslate"),e.ALo(8,"mytranslate"),e.ALo(9,"aztFindSchoolSubjectById"),e.qZA(),e.TgZ(10,"a",19),e.NdJ("click",function(){e.CHM(c);const T=e.oxw();return e.KtG(T.acceptPredictSubjectEvent())}),e._uU(11),e.ALo(12,"mytranslate"),e.qZA()()()}if(2&b){const c=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,2,"lang_testbank_please_double_check_the_subject_for_accuracy")+". "+e.lcZ(5,4,"lang_testbank_the_system_recognizes_your_subject_as_a_subject")+" "+e.lcZ(6,6,c.sAztPredictLevelAndSubjectService.predictSubjectKey)+", "+e.lcZ(7,8,"lang_testbank_you_are_choosing_subject")+" "+e.lcZ(8,10,e.xi3(9,12,c.schoolSubjectObjs,c.form.controls.schoolSubject.value))+". "," "),e.xp6(8),e.hij(" ",e.lcZ(12,15,"lang_testbank_click_here_to_change_it_to_the_correct_one")+"."," ")}}let L=(()=>{class b extends o.Q{changeSchoolLevelIdEvent(c){let v=this.schoolLevelObjs.find(U=>U.schoolLevel?.id==c);if(!v)return this.form?.controls.schoolSubject.setValue(0);this.schoolSubjectObjs=v?.schoolSubjectObjs??[];let T=this.form.getRawValue();return this.schoolSubjectObjs.map(U=>U.id).includes(T.schoolSubject)?void 0:this.form?.controls.schoolSubject.setValue(0)}acceptPredictSubjectEvent(){let c=this.form.getRawValue(),v=this.sAztPredictLevelAndSubjectService.acceptPredictSubjectId(c.schoolLevel,c.schoolSubject);v&&(this.form?.controls.schoolLevel.setValue(v.schoolLevelId),this.form?.controls.schoolSubject.setValue(v.schoolSubjectId),this.sendLogPredictSubject.emit(this.sAztPredictLevelAndSubjectService.predictLogRequestObj))}updateLevelAndSubjectToForm(c,v){let T=this.schoolLevelObjs.find(W=>W.schoolLevel?.id==c),U=T?.schoolSubjectObjs.find(W=>W.id==v);T||(c=0),U||(v=0);let Q=this.form.getRawValue();Q.schoolLevel!=c&&this.form.controls.schoolLevel.setValue(c),Q.schoolSubject!=v&&this.form.controls.schoolSubject.setValue(v),this.schoolSubjectObjs=T?.schoolSubjectObjs??[]}initData(){let c=this.form.getRawValue();return c.schoolLevel&&c.schoolSubject?this.updateLevelAndSubjectToForm(c.schoolLevel,c.schoolSubject):this.examSchoolLogObj?this.updateLevelAndSubjectToForm(this.examSchoolLogObj.lastSchoolLevelId??0,this.examSchoolLogObj.lastSchoolSubjectId??0):void this.updateLevelAndSubjectToForm(c.schoolLevel,c.schoolSubject)}ngOnChanges(){this.initData()}ngOnInit(){const c=Number(this.commonService.getMyQueryParam("levelId")),v=Number(this.commonService.getMyQueryParam("subjectId"));c&&v&&(this.form.controls.schoolLevel.setValue(c),this.form.controls.schoolSubject.setValue(v)),this.form?.controls.schoolSubject?.valueChanges.subscribe(()=>{this.sAztPredictLevelAndSubjectService.changePredictStatusWhenSubjectIdChanged(this.form.controls.schoolSubject.value),this.sAztPredictLevelAndSubjectService.predictLogRequestObj&&this.sendLogPredictSubject.emit(this.sAztPredictLevelAndSubjectService.predictLogRequestObj)})}constructor(c){super(),this.aiService=c,this.schoolLevelObjs=[],this.questionContents=[],this.sendLogPredictSubject=new e.vpe,this.schoolSubjectObjs=[],this.sAztPredictLevelAndSubjectService=new E(this.commonService,this.aiService)}}return b.\u0275fac=function(c){return new(c||b)(e.Y36(w.p))},b.\u0275cmp=e.Xpm({type:b,selectors:[["config-level-subject"]],inputs:{form:"form",examSchoolLogObj:"examSchoolLogObj",schoolLevelObjs:"schoolLevelObjs",questionContents:"questionContents"},outputs:{sendLogPredictSubject:"sendLogPredictSubject"},features:[e.qOj,e.TTD],decls:28,vars:19,consts:[[1,"config-level-subject"],[3,"formGroup"],["id","azt-config-level-subject",1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","lg:col-span-6"],[1,"font-medium"],["for","schoolLevel",1,"form-label","flex","items-center"],["appearance","outline"],["formControlName","schoolLevel","name","schoolLevel",3,"selectionChange"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["for","schoolSubject",1,"form-label","flex","items-center"],["id","schoolSubject","formControlName","schoolSubject","name","schoolSubject"],[1,"col-span-12",2,"margin-top","-20px"],["class","text-xs mt-2 text-danger",4,"ngIf"],["class","col-span-12","style","margin-top: -32px",4,"ngIf"],[3,"value"],[1,"text-xs","mt-2","text-danger"],[1,"col-span-12",2,"margin-top","-32px"],[1,"text-xs","text-pending","font-medium"],[1,"btn-text-primary","font-medium",3,"click"]],template:function(c,v){1&c&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),e._uU(6),e.ALo(7,"mytranslate"),e.qZA()(),e.TgZ(8,"mat-form-field",6)(9,"mat-select",7),e.NdJ("selectionChange",function(){return v.changeSchoolLevelIdEvent(v.form.controls.schoolLevel.value)}),e.TgZ(10,"mat-option",8),e._uU(11),e.ALo(12,"mytranslate"),e.qZA(),e.YNc(13,x,3,4,"mat-option",9),e.qZA()()(),e.TgZ(14,"div",3)(15,"div",4)(16,"label",10),e._uU(17),e.ALo(18,"mytranslate"),e.qZA()(),e.TgZ(19,"mat-form-field",6)(20,"mat-select",11)(21,"mat-option",8),e._uU(22),e.ALo(23,"mytranslate"),e.qZA(),e.YNc(24,d,3,4,"mat-option",9),e.qZA()()(),e.TgZ(25,"div",12),e.YNc(26,C,3,3,"div",13),e.qZA(),e.YNc(27,A,13,17,"div",14),e.qZA()()()),2&c&&(e.xp6(1),e.Q6J("formGroup",v.form),e.xp6(5),e.hij(" ",e.lcZ(7,11,"lang_auto_khoi_hoc")," "),e.xp6(4),e.Q6J("value",0),e.xp6(1),e.hij("",e.lcZ(12,13,"lang_auto_---chon_khoi"),"---"),e.xp6(2),e.Q6J("ngForOf",v.schoolLevelObjs),e.xp6(4),e.hij(" ",e.lcZ(18,15,"lang_auto_mon_hoc")," "),e.xp6(4),e.Q6J("value",0),e.xp6(1),e.hij("",e.lcZ(23,17,"lang_auto_---chon_mon"),"---"),e.xp6(2),e.Q6J("ngForOf",v.schoolSubjectObjs),e.xp6(2),e.Q6J("ngIf",(null==v.form||null==v.form.controls||null==v.form.controls.schoolLevel?null:v.form.controls.schoolLevel.invalid)||(null==v.form||null==v.form.controls||null==v.form.controls.schoolSubject?null:v.form.controls.schoolSubject.invalid)),e.xp6(1),e.Q6J("ngIf",v.sAztPredictLevelAndSubjectService.predictLogRequestObj&&!v.sAztPredictLevelAndSubjectService.allPredictSubjectIds.includes(v.form.controls.schoolSubject.value)&&v.form.controls.schoolSubject.value))},dependencies:[y.sg,y.O5,m.ey,_.KE,g.gD,u._Y,u.JJ,u.JL,u.sg,u.u,h.M,S.JV,f],encapsulation:2}),b})()},18727:(J,P,n)=>{n.d(P,{u:()=>d});var e=n(37734),o=n(65879),i=n(96814),E=n(23680),w=n(64170),y=n(98525),m=n(56223),_=n(67679),g=n(36727);function u(C,A){if(1&C&&(o.TgZ(0,"mat-option",14),o._uU(1),o.ALo(2,"mytranslate"),o.qZA()),2&C){const L=A.$implicit;o.Q6J("value",L.id),o.xp6(1),o.hij(" ",o.lcZ(2,2,L.code)," ")}}function h(C,A){if(1&C&&(o.TgZ(0,"mat-optgroup",12),o.ALo(1,"mytranslate"),o.YNc(2,u,3,4,"mat-option",13),o.qZA()),2&C){const L=A.$implicit;o.s9C("label",o.lcZ(1,2,L.groupName)),o.xp6(2),o.Q6J("ngForOf",L.purposeListInGroup)}}function S(C,A){1&C&&(o.TgZ(0,"div",15),o._uU(1),o.ALo(2,"mytranslate"),o.qZA()),2&C&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"lang_testbank_please_choose_purpose_exam")," "))}function f(C,A){1&C&&(o.TgZ(0,"div",15),o._uU(1),o.ALo(2,"mytranslate"),o.qZA()),2&C&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"lang_testbank_please_enter_purpose_create_exam")," "))}function x(C,A){if(1&C&&(o.TgZ(0,"div",3)(1,"div",4)(2,"label",16),o._uU(3),o.ALo(4,"mytranslate"),o.qZA()(),o.TgZ(5,"div",17),o._UZ(6,"input",18),o.ALo(7,"mytranslate"),o.qZA(),o.YNc(8,f,3,3,"div",10),o.qZA()),2&C){const L=o.oxw();o.xp6(3),o.hij(" ",o.lcZ(4,3,"lang_testbank_enter_create_exam_target")," "),o.xp6(3),o.s9C("placeholder",o.lcZ(7,5,"lang_testbank_enter_create_exam_target")+" ..."),o.xp6(2),o.Q6J("ngIf",(4==(null==L.form.controls.purposeExam?null:L.form.controls.purposeExam.value)||8==(null==L.form.controls.purposeExam?null:L.form.controls.purposeExam.value)||12==(null==L.form.controls.purposeExam?null:L.form.controls.purposeExam.value))&&""===(null==L.form.controls.purposeNote||null==L.form.controls.purposeNote.value?null:L.form.controls.purposeNote.value.trim()))}}let d=(()=>{class C extends e.Q{convertPurposeList(){this.targetExamGroupObjs=[],this.purposeList.forEach(L=>{const{semester:b}=L;let I=this.targetExamGroupObjs.find(c=>c.semester===b);I||(I={semester:b,groupName:this.getGroupNamePurpose(L.semester??1),purposeListInGroup:[]},this.targetExamGroupObjs.push(I)),I.purposeListInGroup?.push(L)})}getGroupNamePurpose(L){switch(L){case 1:default:return"lang_testbank_semester_one";case 2:return"lang_testbank_semester_two";case 3:return"lang_testbank_another_purpose"}}ngOnInit(){this.convertPurposeList()}constructor(){super(),this.purposeList=[],this.targetExamGroupObjs=[]}}return C.\u0275fac=function(L){return new(L||C)},C.\u0275cmp=o.Xpm({type:C,selectors:[["config-purpose-exam"]],inputs:{form:"form",purposeList:"purposeList"},features:[o.qOj],decls:16,vars:11,consts:[[1,"config-purpose-exan"],[3,"formGroup"],["id","azt-config-purpose-exam",1,"grid","grid-cols-12","gap-5"],[1,"col-span-12"],[1,"font-medium"],[1,"form-label","flex","items-center"],["appearance","outline"],["formControlName","purposeExam","name","purposeExam"],["disabled","",3,"value"],[3,"label",4,"ngFor","ngForOf"],["class","mt-2 text-danger text-xs",4,"ngIf"],["class","col-span-12",4,"ngIf"],[3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mt-2","text-danger","text-xs"],["for","enter_target_create_exam",1,"form-label","flex","items-center"],[1,"setting-input"],["id","enter_target_create_exam","formControlName","purposeNote","type","text",1,"form-control",3,"placeholder"]],template:function(L,b){1&L&&(o.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),o._uU(6),o.ALo(7,"mytranslate"),o.qZA()(),o.TgZ(8,"mat-form-field",6)(9,"mat-select",7)(10,"mat-option",8),o._uU(11),o.ALo(12,"mytranslate"),o.qZA(),o.YNc(13,h,3,4,"mat-optgroup",9),o.qZA()(),o.YNc(14,S,3,3,"div",10),o.qZA(),o.YNc(15,x,9,7,"div",11),o.qZA()()()),2&L&&(o.xp6(1),o.Q6J("formGroup",b.form),o.xp6(5),o.hij(" ",o.lcZ(7,7,"lang_testbank_target_exam")," "),o.xp6(4),o.Q6J("value",0),o.xp6(1),o.hij("---",o.lcZ(12,9,"lang_testbank_choose_purpose"),"---"),o.xp6(2),o.Q6J("ngForOf",b.targetExamGroupObjs),o.xp6(1),o.Q6J("ngIf",0==b.form.controls.purposeExam.value),o.xp6(1),o.Q6J("ngIf",4==(null==b.form.controls.purposeExam?null:b.form.controls.purposeExam.value)||8==(null==b.form.controls.purposeExam?null:b.form.controls.purposeExam.value)||12==(null==b.form.controls.purposeExam?null:b.form.controls.purposeExam.value)))},dependencies:[i.sg,i.O5,E.ey,E.Nv,w.KE,y.gD,m._Y,m.Fj,m.JJ,m.JL,m.sg,m.u,_.M,g.JV],encapsulation:2}),C})()},89310:(J,P,n)=>{n.d(P,{P:()=>S});var e=n(37398),o=n(37734),i=n(65879),E=n(97151),w=n(46558),y=n(69862),m=n(96814),_=n(36727);function g(f,x){if(1&f){const d=i.EpF();i.ynx(0),i.TgZ(1,"a",2),i.NdJ("click",function(){i.CHM(d);const A=i.oxw();return i.KtG(A.shareFileToFlutter())}),i.TgZ(2,"span"),i._uU(3),i.ALo(4,"mytranslate"),i.qZA(),i.Hsn(5),i.qZA(),i.BQk()}if(2&f){const d=i.oxw();i.xp6(1),i.Akn(d.style),i.Tol(d.classStyle),i.s9C("target",d.target),i.xp6(2),i.Oqu(i.lcZ(4,7,d.fileDescription))}}function u(f,x){if(1&f&&(i.TgZ(0,"a",3)(1,"span"),i._uU(2),i.ALo(3,"mytranslate"),i.qZA(),i.Hsn(4,1),i.qZA()),2&f){const d=i.oxw();i.Akn(d.style),i.Tol(d.classStyle),i.s9C("href",d.dataUrl,i.LSH),i.s9C("target",d.target),i.s9C("download",d.fileName),i.xp6(2),i.Oqu(i.lcZ(3,9,d.fileDescription))}}const h=["*","*"];let S=(()=>{class f extends o.Q{downloadFile(){return this.http.get(this.dataUrl,{responseType:"blob"}).pipe((0,e.U)(d=>d))}shareFileToFlutter(){this.downloadFile().subscribe(d=>{this.shareFileFlutterService.shareFileWithBlob(d,this.fileName)})}ngOnInit(){super.ngOnInit()}constructor(d,C,A){super(),this.shareFileFlutterService=d,this.commonService=C,this.http=A,this.dataUrl="",this.target="",this.fileName="",this.fileDescription="",this.classStyle="",this.style=""}}return f.\u0275fac=function(d){return new(d||f)(i.Y36(E.g),i.Y36(w.z),i.Y36(y.eN))},f.\u0275cmp=i.Xpm({type:f,selectors:[["azt-download-link-item"]],inputs:{dataUrl:"dataUrl",target:"target",fileName:"fileName",fileDescription:"fileDescription",classStyle:"classStyle",style:"style"},features:[i.qOj],ngContentSelectors:h,decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["NormalWeb",""],[3,"target","click"],[3,"href","target","download"]],template:function(d,C){if(1&d&&(i.F$t(h),i.YNc(0,g,6,9,"ng-container",0),i.YNc(1,u,5,11,"ng-template",null,1,i.W1O)),2&d){const A=i.MAs(2);i.Q6J("ngIf",C.isMobileWebView)("ngIfElse",A)}},dependencies:[m.O5,_.JV],encapsulation:2}),f})()}}]);