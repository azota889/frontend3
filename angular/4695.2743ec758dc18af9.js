"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[4695],{57003:(Y,z,n)=>{n.d(z,{Q:()=>W});var t=n(81519),r=n(10936),L=n(34514),e=n(47426),x=n(89163),o=n(99503),U=n(79347),c=n(33887),d=n(38009),_=n(9691),D=n(80037),k=n(48485),s=n(48891),M=n(33634),K=n(51913),E=n(3780),G=n(54460),T=n(81587),h=n(27985),A=n(52811),V=n(9842),Z=n(76975);function q(u,v){1&u&&(s.j41(0,"div",5),s.nrm(1,"azt-loading-ui"),s.k0s())}function J(u,v){if(1&u&&(s.j41(0,"div",27)(1,"div",28),s.nrm(2,"azt-list-classroom-checkbox",29),s.k0s()()),2&u){const p=s.XpG(2);s.R7$(2),s.Y8G("form",p.form)("classroomGroupData",p.classroomWithGroup)("examClassroomObjs",p.examClassroomObjs)("permissionName",p.permissionTypes.exam)}}function Q(u,v){if(1&u&&(s.j41(0,"div",27)(1,"div",30)(2,"div",31)(3,"h3",32),s.EFF(4),s.nI1(5,"mytranslate"),s.k0s()(),s.nrm(6,"list-student-checkbox",33),s.k0s()()),2&u){const p=s.XpG(2);s.R7$(4),s.SpI(" ",s.bMT(5,5,"lang_test_config_student_list")," "),s.R7$(2),s.Y8G("form",p.form)("classroomGroupData",p.classroomWithGroup)("examStudentObjs",p.data.examStudents)("permissionName",p.permissionTypes.exam)}}function O(u,v){if(1&u){const p=s.RV6();s.j41(0,"div",6)(1,"form",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"div",11),s.EFF(6),s.nI1(7,"mytranslate"),s.k0s()(),s.j41(8,"div",12)(9,"div",13)(10,"div",14)(11,"input",15),s.bIt("change",function(){s.eBV(p);const I=s.XpG();return s.Njj(I.clearAllCheckBox(0))}),s.k0s(),s.j41(12,"label",16),s.EFF(13),s.nI1(14,"mytranslate"),s.k0s()(),s.j41(15,"div",17)(16,"input",18),s.bIt("change",function(){s.eBV(p);const I=s.XpG();return s.Njj(I.clearAllCheckBox(2))}),s.k0s(),s.j41(17,"label",19),s.EFF(18),s.nI1(19,"mytranslate"),s.k0s()(),s.j41(20,"div",20)(21,"input",21),s.bIt("change",function(){s.eBV(p);const I=s.XpG();return s.Njj(I.clearAllCheckBox(3))}),s.k0s(),s.j41(22,"label",22),s.EFF(23),s.nI1(24,"mytranslate"),s.k0s()()()(),s.DNE(25,J,3,4,"div",23)(26,Q,7,7,"div",23),s.k0s()()()(),s.j41(27,"div",24)(28,"button",25),s.bIt("click",function(){s.eBV(p);const I=s.XpG();return s.Njj(I.closeDialog())}),s.EFF(29),s.nI1(30,"mytranslate"),s.k0s(),s.j41(31,"button",26),s.bIt("click",function(){s.eBV(p);const I=s.XpG();return s.Njj(I.savePublishExam("save"))}),s.EFF(32),s.nI1(33,"mytranslate"),s.k0s()()}if(2&u){const p=s.XpG();s.R7$(),s.Y8G("formGroup",p.form),s.R7$(5),s.SpI(" ",s.bMT(7,13,"lang_testbank_test_config_who_tested")," "),s.R7$(5),s.Y8G("value",0),s.R7$(2),s.SpI(" ",s.bMT(14,15,"lang_testbank_test_config_all_people")," "),s.R7$(3),s.Y8G("value",2),s.R7$(2),s.SpI(" ",s.bMT(19,17,"lang_testbank_test_config_assigne_class")," "),s.R7$(3),s.Y8G("value",3),s.R7$(2),s.SpI(" ",s.bMT(24,19,"lang_testbank_test_config_assigne_student")," "),s.R7$(2),s.Y8G("ngIf",2===p.form.controls.whoAllow.value),s.R7$(),s.Y8G("ngIf",3===p.form.controls.whoAllow.value),s.R7$(3),s.SpI(" ",s.bMT(30,21,"lang_auto_huy")," "),s.R7$(2),s.Y8G("disabled",3===p.form.controls.whoAllow.value&&p.form.controls.studentIds.errors||2===p.form.controls.whoAllow.value&&p.form.controls.classroomFormArray.errors),s.R7$(),s.SpI(" ",s.bMT(33,23,"lang_auto_luu")," ")}}let W=(()=>{var u;class v extends c._{clearAllCheckBox(w){1==w?this.isSelectClassroom=!1:2==w&&(this.isSelectClassroom=!0)}closeDialog(w){this.dialogRef.close(w)}savePublishExam(w){this.initStatusObj();let I="publish"===w?1:void 0;var F=this.form.getRawValue();const X=this.sAztClassroomCheckboxService.getClassroomIdsCheckedInGroup(this.form.controls.classroomFormArray);let H=[];if(3==F.whoAllow&&F.studentIds&&F.studentIds.length){let $=this.commonService.arrayToDictionary(F.studentIds,f=>f.classroomId.toString());Object.entries($).forEach(([f,C],b)=>{let y=this.commonService.getFirstOfArray(C)?.classroomId;y&&H?.push({classroomId:y,assignStudentIds:C.map(R=>R.studentId)})})}else H=void 0;let te={whoAllow:F.whoAllow,isPublished:I??void 0,classroomIds:X,assignStudents:H,isSaveConfig:0};var j=this.permissionService.hasEditPermission("exam",this.obj)?this.documentConfigService.apiDocumentConfigSaveExamConfigPost(this.hashId,te):this.documentConfigService.apiDocumentConfigSaveExamDataForConfigClassroomPost(this.hashId,te);this.waitDestroy(j.subscribe($=>{1==$.success?(this.successStatusObj(),this.showSuccessSnack("lang_auto_luu_thanh_cong"),this.closeDialog($.data?.obj)):this.errorStatusObj($.message??"",!0)}))}getExamDataByHashId(w){this.initStatusObj(),this.waitDestroy(this.documentConfigService.apiDocumentConfigGetExamDataForConfigClassroomV2Get(w).subscribe(I=>{if(1==I.success){if(null!=I.data){var X,F=I.data?.examObj;if(!(X=this.castObj(F)))return;X.limitQuestionGroupsParse=this.commonService.myParseJson(F.limitQuestionGroups??""),this.obj=X,this.hashId=this.obj.hashId??"",this.classroomWithGroup=I.data.classroomGroupObjs??new Array,this.classroomObjs=this.commonService.concatMultipleArray(I.data.classroomGroupObjs.map(H=>H.classroomObjs)),this.examClassroomObjs=I.data.examClassroomObjs??[],this.form.patchValue({whoAllow:this.obj.whoAllow}),this.isSelectClassroom=2==this.obj.whoAllow,this.successStatusObj()}}else this.errorStatusObj(I.message??"",!0)}))}ngOnInit(){super.ngOnInit(),this.getExamDataByHashId(this.hashId)}constructor(w,I,F,X,H){super(X,F),this.documentConfigService=w,this.permissionService=I,this.dialogRef=F,this.data=X,this.sAztClassroomCheckboxService=H,this.permissionTypes=d.t,this.checkDialogFastContent=[],this.classroomObjs=[],this.examClassroomObjs=[],this.isSelectClassroom=!1,this.hashId="",this.classroomWithGroup=[],this.hashId=X.hashId,this.form=new r.gE({whoAllow:new r.MJ(0,{nonNullable:!0}),classroomFormArray:new r.Yp([]),studentIds:new r.Yp([])},{validators:[D.j.classroomInGroupCheckBoxValidator,k.H.studentCheckBoxValidator]})}}return(u=v).\u0275fac=function(w){return new(w||u)(s.rXU(M.x),s.rXU(K.p),s.rXU(x.CP,8),s.rXU(x.Vh,8),s.rXU(E.Q))},u.\u0275cmp=s.VBU({type:u,selectors:[["config-online-exam-dialog"]],features:[s.Jv_([{provide:t.$O,useClass:o.fb,deps:[e.Ju,L.ij]},{provide:t.vq,useFactory:U.Yw,deps:[_.F]}]),s.Vt3],decls:6,vars:2,consts:[["doneLoading",""],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body"],["class","loading flex items-center justify-center",4,"ngIf","ngIfElse"],[1,"loading","flex","items-center","justify-center"],[1,"col-md-12","setting"],[3,"formGroup"],[1,"setting-base"],["id","azt-config-who-allow",1,"grid","grid-cols-12","mt-4"],[1,"col-span-12","lg:col-span-3","pr-2"],[1,"mb-0","font-medium","flex","items-center"],[1,"col-span-12","lg:col-span-9"],[1,"flex","flex-col","sm:flex-row"],[1,"form-check","mr-5"],["id","config-who-all","formControlName","whoAllow","type","radio",1,"form-check-input",3,"change","value"],["for","config-who-all",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0","mr-5"],["id","config-who-class","formControlName","whoAllow","type","radio",1,"form-check-input",3,"change","value"],["for","config-who-class",1,"form-check-label"],[1,"form-check","mt-2","sm:mt-0"],["id","config-who-student","formControlName","whoAllow","type","radio",1,"form-check-input",3,"change","value"],["for","config-who-student",1,"form-check-label"],["class","col-span-12 mt-4",4,"ngIf"],[1,"text-right","mt-4"],["azt-track-service","config-exam-classroom-6-a-m4KztM",1,"btn","w-24","btn-secondary","mr-3",3,"click"],["azt-track-service","config-exam-classroom-brv1ZZTsfLY",1,"btn","w-24","btn-primary",3,"click","disabled"],[1,"col-span-12","mt-4"],[1,"azt-list-classroom"],[3,"form","classroomGroupData","examClassroomObjs","permissionName"],[1,"border","border-slate-200/60","dark:border-darkmode-400","rounded-md","pb-1"],[1,"p-3","bg-slate-100","dark:bg-darkmode-400","flex","items-center"],[1,"mr-auto"],[3,"form","classroomGroupData","examStudentObjs","permissionName"]],template:function(w,I){if(1&w&&(s.j41(0,"div",1)(1,"div",2)(2,"div",3),s.DNE(3,q,2,0,"div",4)(4,O,34,25,"ng-template",null,0,s.C5r),s.k0s()()()),2&w){const F=s.sdS(5);s.R7$(3),s.Y8G("ngIf",I.statusObj.loading)("ngIfElse",F)}},dependencies:[G.bT,r.qT,r.me,r.Fm,r.BC,r.cb,r.j4,r.JD,T.t,h.D,A.R,V.M,Z.wp],encapsulation:2}),v})()},9842:(Y,z,n)=>{n.d(z,{M:()=>le});var t=n(10936),r=n(38009),L=n(59640),e=n(48891),x=n(54460),o=n(5502),U=n(74151),c=n(27208),d=n(89163),_=n(33887),D=n(35048);let k=(()=>{var i;class S extends _._{btnCloseDialog(l){if(!l)return this.dialogRef.close();this.dialogRef.close(l)}ngOnInit(){}constructor(l,a){super(a,l),this.dialogRef=l,this.data=a,this.selectAllFormControl=new t.MJ(!1,{nonNullable:!0}),this.showCheckedFormControl=new t.MJ(!1,{nonNullable:!0}),this.studentObjs=[],this.totalStudentsSelected=0,this.totalStudentsShow=0,this.searchContentObj=new c.Z}}return(i=S).\u0275fac=function(l){return new(l||i)(e.rXU(d.CP,8),e.rXU(d.Vh,8))},i.\u0275cmp=e.VBU({type:i,selectors:[["azt-assign-student-dialog"]],features:[e.Vt3],decls:1,vars:1,consts:[[3,"closeBox","data"]],template:function(l,a){1&l&&(e.j41(0,"azt-select-student",0),e.bIt("closeBox",function(P){return a.btnCloseDialog(P)}),e.k0s()),2&l&&e.Y8G("data",a.data)},dependencies:[D.w],encapsulation:2}),S})();var s=n(51913),M=n(3780),K=n(46899),E=n(17818),G=n(45785),T=n(47712),h=n(56551),A=n(15343),V=n(91032),Z=n(32099),q=n(95825),J=n(76975);const Q=(i,S)=>({"classroom-box-in-full-screen-in-mobile":i,"classroom-box-in-full-screen-in-desktop":S}),O=(i,S)=>({"w-85":i,"w-56":S}),W=i=>({"ml-3":i}),u=(i,S)=>({"bg-primary text-white font-medium":i,"hover:bg-slate-100 dark:hover:bg-darkmode-400":S}),v=(i,S)=>({"bg-primary text-white font-medium":i," hover:bg-slate-100 dark:hover:bg-darkmode-400":S}),p=i=>({"grid-column":i}),w=i=>({"text-success font-medium":i});function I(i,S){if(1&i){const m=e.RV6();e.j41(0,"button",45),e.bIt("click",function(){e.eBV(m);const a=e.XpG();return e.Njj(a.selectByGroupId(void 0))}),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()}if(2&i){const m=e.XpG();e.Y8G("ngClass",e.l_i(5,u,0===m.mapClassroomGroupDataToForm.groupIdSelected,0!==m.mapClassroomGroupDataToForm.groupIdSelected)),e.R7$(),e.Lme(" ",e.bMT(2,3,"lang_auto_tat_ca")," (",m.mapClassroomGroupDataToForm.totalAllClassrooms,") ")}}function F(i,S){if(1&i){const m=e.RV6();e.j41(0,"button",48),e.bIt("click",function(){e.eBV(m);const a=e.XpG().$implicit,g=e.XpG(2);return e.Njj(g.selectByGroupId(a.groupObj))}),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()}if(2&i){const m=e.XpG().$implicit,l=e.XpG(2);e.Y8G("ngClass",e.l_i(4,v,l.mapClassroomGroupDataToForm.groupIdSelected===m.groupObj.id,l.mapClassroomGroupDataToForm.groupIdSelected!==m.groupObj.id)),e.R7$(),e.SpI(" ",e.bMT(2,2,m.groupObj.name)+" ("+m.groupObj.totalAllClassrooms+")"," ")}}function X(i,S){if(1&i&&(e.qex(0),e.DNE(1,F,3,7,"button",47),e.bVm()),2&i){const m=S.$implicit;e.R7$(),e.Y8G("ngIf",m.groupObj.isShowGroup)}}function H(i,S){if(1&i&&(e.qex(0),e.DNE(1,X,2,1,"ng-container",46),e.bVm()),2&i){const m=e.XpG();e.R7$(),e.Y8G("ngForOf",m.mapClassroomGroupDataToForm.groupObjs)}}function te(i,S){if(1&i){const m=e.RV6();e.j41(0,"button",49),e.nI1(1,"mytranslate"),e.bIt("click",function(){e.eBV(m);const a=e.XpG();return e.Njj(a.sAztMatDrawerService.openDrawer())}),e.nrm(2,"lucide-icon",50),e.k0s()}2&i&&e.FS9("matTooltip",e.bMT(1,1,"lang_auto_mo_menu"))}function j(i,S){if(1&i){const m=e.RV6();e.j41(0,"button",51),e.nI1(1,"mytranslate"),e.bIt("click",function(){e.eBV(m);const a=e.XpG();return e.Njj(a.sAztMatDrawerService.closeDrawer())}),e.nrm(2,"lucide-icon",52),e.k0s()}2&i&&e.FS9("matTooltip",e.bMT(1,1,"lang_auto_dong_menu"))}function $(i,S){if(1&i&&(e.j41(0,"span",53),e.EFF(1),e.k0s()),2&i){const m=e.XpG();e.R7$(),e.SpI(" ",(m.filterObj.isShowChecked?1:0)+(m.filterObj.isShowNotChecked?1:0)," ")}}function f(i,S){if(1&i&&(e.qex(0),e.j41(1,"span",59),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s(),e.EFF(4),e.nI1(5,"mytranslate"),e.bVm()),2&i){const m=e.XpG().$implicit;e.R7$(2),e.JRh(e.bMT(3,2,m.groupObj.name)),e.R7$(2),e.SpI(" ","("+m.groupObj.totalAllClassrooms+" "+e.bMT(5,4,"lang_testbank_test_list_classes")+")"," ")}}function C(i,S){if(1&i&&(e.j41(0,"span",64),e.EFF(1),e.nI1(2,"slice"),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&i){const m=e.XpG(2).$implicit;e.FS9("matTooltip",m.classroomObj.name),e.R7$(),e.SpI(" ",e.brH(2,4,m.classroomObj.name,0,25)+"..."," "),e.R7$(3),e.Lme("(",m.classroomObj.studentIdsSelected.length,"/",m.classroomObj.countStudents,")")}}function b(i,S){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.j41(2,"span"),e.EFF(3),e.k0s()()),2&i){const m=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",m.classroomObj.name," "),e.R7$(2),e.Lme("(",m.classroomObj.studentIdsSelected.length,"/",m.classroomObj.countStudents,")")}}function y(i,S){1&i&&(e.j41(0,"span",65),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&i&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"lang_testbank_test_config_share")," "))}function R(i,S){if(1&i){const m=e.RV6();e.qex(0),e.j41(1,"div",60),e.bIt("click",function(){e.eBV(m);const a=e.XpG().$implicit,g=e.XpG(2);return e.Njj(g.selectClassroomEvent(a.groupObj,a.classroomObj))}),e.j41(2,"span",22),e.nrm(3,"lucide-icon",61),e.k0s(),e.DNE(4,C,5,8,"span",62)(5,b,4,3,"span",15)(6,y,3,3,"span",63),e.nI1(7,"fullPermission"),e.k0s(),e.bVm()}if(2&i){let m,l;const a=e.XpG().$implicit;e.R7$(),e.Y8G("ngClass",e.eq3(7,w,a.classroomObj.studentIdsSelected.length>0)),e.R7$(3),e.Y8G("ngIf",(null!==(m=null==a.classroomObj.name?null:a.classroomObj.name.length)&&void 0!==m?m:0)>25),e.R7$(),e.Y8G("ngIf",(null!==(l=null==a.classroomObj.name?null:a.classroomObj.name.length)&&void 0!==l?l:0)<=25),e.R7$(),e.Y8G("ngIf",!e.i5U(7,4,a.classroomObj,"classroom"))}}function B(i,S){if(1&i&&(e.j41(0,"div",58),e.DNE(1,f,6,6,"ng-container",15)(2,R,8,9,"ng-container",15),e.k0s()),2&i){const m=S.$implicit;e.Y8G("ngStyle",e.eq3(3,p,"group"==m.type?"span 12 / span 12":"")),e.R7$(),e.Y8G("ngIf","group"==m.type),e.R7$(),e.Y8G("ngIf","classroom"==m.type&&m.classroomObj)}}function ee(i,S){if(1&i&&(e.qex(0),e.j41(1,"ng-scrollbar",54)(2,"cdk-virtual-scroll-viewport",55)(3,"div",56),e.DNE(4,B,3,5,"div",57),e.k0s()()(),e.bVm()),2&i){const m=e.XpG();e.R7$(),e.Y8G("visibility","hover"),e.R7$(3),e.Y8G("cdkVirtualForOf",m.mapClassroomGroupDataToVirtualScroll)}}function ae(i,S){1&i&&(e.j41(0,"div",66),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&i&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"lang_student_classroom_list_class_null")," "))}let oe=(()=>{var i;class S extends L.H{searchByClassroomName(l){this.searchByClassroomContentObj=l,this.checkIsFilter(),this.calculateClassroomInfo()}searchByGroupName(l){this.searchByGroupContentObj=l,this.checkIsFilter(),this.calculateClassroomInfo()}changeFilter(){this.checkIsFilter(),this.calculateClassroomInfo()}clearFilter(){this.filterObj={isShowChecked:!1,isShowNotChecked:!1},this.checkIsFilter(),this.calculateClassroomInfo()}checkIsFilter(){return 0!=this.mapClassroomGroupDataToForm.groupIdSelected||this.filterObj.isShowChecked||this.filterObj.isShowNotChecked||""!=this.searchByClassroomContentObj.searchContent.trim()}selectByGroupId(l){this.mapClassroomGroupDataToForm.groupIdSelected=l?.id??0,this.calculateClassroomInfo(),this.scrollable?.scrollTo({top:0,duration:0}),this.isMobileDevice&&this.sAztMatDrawerService.closeDrawer()}selectClassroomEvent(l,a){this.sAztDialogService.open(k,{data:{classroomId:a.id,classroomName:a.name,studentIdsSelected:this.studentsSelected.find(P=>P.classroomId==a.id)?.studentIdsSelected??[]},width:"1000px",autoFocus:!1}).afterClosed().subscribe(P=>{P&&this.chooseStudentsEvent.emit(P)})}calculateClassroomInfo(){this.doFilterData(),this.countFilterData(),this.calculateVirtualScrollData()}doFilterData(){const l=this.searchByClassroomContentObj.searchContent?this.commonService.convertVietnameseToEnglish(this.searchByClassroomContentObj.searchContent).toLowerCase().trim():"",a=this.searchByGroupContentObj.searchContent?this.commonService.convertVietnameseToEnglish(this.searchByGroupContentObj.searchContent).toLowerCase().trim():"";this.mapClassroomGroupDataToForm.groupObjs.forEach(g=>{const P=this.commonService.convertVietnameseToEnglish(g.groupObj.name??"");g.groupObj.isShowGroup=""==a||P.toLowerCase().trim().includes(a),g.classroomObjs.forEach(N=>{if(N.isShowClassroom=!0,!this.checkIsFilter())return;const ne=this.commonService.convertVietnameseToEnglish(N.name);let re=0==this.mapClassroomGroupDataToForm.groupIdSelected||g.groupObj.id==this.mapClassroomGroupDataToForm.groupIdSelected,ce=""==l||ne.toLowerCase().trim().includes(l);N.isShowClassroom=re&&ce&&(this.filterObj.isShowChecked&&N.studentIdsSelected.length>0||this.filterObj.isShowNotChecked&&N.studentIdsSelected.length<=0||!this.filterObj.isShowChecked&&!this.filterObj.isShowNotChecked)})})}countFilterData(){this.mapClassroomGroupDataToForm.groupObjs.forEach(l=>{l.groupObj.totalAllClassrooms=l.classroomObjs.length,l.groupObj.totalViewClassrooms=l.classroomObjs.filter(a=>a.isShowClassroom).length}),this.mapClassroomGroupDataToForm.totalAllClassrooms=this.mapClassroomGroupDataToForm.groupObjs.reduce((l,a)=>l+a.groupObj.totalAllClassrooms,0),this.mapClassroomGroupDataToForm.totalViewClassrooms=this.mapClassroomGroupDataToForm.groupObjs.reduce((l,a)=>l+a.groupObj.totalViewClassrooms,0)}calculateVirtualScrollData(){var l=[];this.mapClassroomGroupDataToForm.groupObjs.filter(a=>a.groupObj.totalViewClassrooms>0).forEach(a=>{l.push({type:"group",groupObj:a.groupObj,classroomObj:void 0}),a.classroomObjs.filter(g=>g.isShowClassroom).forEach(g=>{l.push({type:"classroom",groupObj:a.groupObj,classroomObj:g})})}),this.mapClassroomGroupDataToVirtualScroll=l}initClassroomData(){this.classroomGroupData=this.classroomGroupData.map(l=>({groupObj:l.groupObj,isOwned:l.isOwned,classroomObjs:l.classroomObjs.filter(a=>null!=a.permissionObj&&this.permissionService.hasCreatePermission(this.listPermissionTypes[this.permissionName],a))})),this.mapClassroomGroupDataToForm.groupObjs=this.classroomGroupData.map(l=>({groupObj:{...l.groupObj,isShowGroup:!0,totalAllClassrooms:0,totalViewClassrooms:0},isOwned:l.isOwned,classroomObjs:l.classroomObjs.map(a=>{let g=this.studentsSelected.find(P=>P.classroomId==a.id)?.studentIdsSelected??[];return{...a,studentIdsSelected:g,isShowClassroom:!0}})})),this.calculateClassroomInfo()}ngOnChanges(){this.initClassroomData()}ngOnInit(){super.ngOnInit(),this.classroomGroupData.forEach(l=>l.classroomObjs.map(a=>a.name=this.commonService.myTranslateInstant(a.name)??"")),this.initClassroomData()}constructor(l,a,g,P){super(),this.sAztMatDrawerService=l,this.permissionService=a,this.sAztClassroomCheckboxService=g,this.sAztDialogService=P,this.permissionName=r.t.exam,this.defaultCssClass="classroom-box-in-single-page",this.chooseStudentsEvent=new e.bkB,this.studentsSelected=[],this.mapClassroomGroupDataToForm={groupObjs:[],groupIdSelected:0,totalAllClassrooms:0,totalViewClassrooms:0},this.mapClassroomGroupDataToVirtualScroll=[],this.listPermissionTypes=r.t,this.searchByClassroomContentObj=new c.Z,this.searchByGroupContentObj=new c.Z,this.filterObj={isShowChecked:!1,isShowNotChecked:!1}}}return(i=S).\u0275fac=function(l){return new(l||i)(e.rXU(U.n),e.rXU(s.p),e.rXU(M.Q),e.rXU(K.i))},i.\u0275cmp=e.VBU({type:i,selectors:[["azt-list-classroom-view-tree"]],viewQuery:function(l,a){if(1&l&&e.GBs(o.Yh,7),2&l){let g;e.mGM(g=e.lsd())&&(a.scrollable=g.first)}},inputs:{classroomGroupData:"classroomGroupData",permissionName:"permissionName",defaultCssClass:"defaultCssClass",studentsSelected:"studentsSelected"},outputs:{chooseStudentsEvent:"chooseStudentsEvent"},features:[e.Jv_([U.n]),e.Vt3,e.OA$],decls:66,vars:55,consts:[["maximize","maximize"],["drawer",""],["menuFilter","matMenu"],["emptyClassroom",""],["maximize","",1,"azt-list-classroom-by-group"],[1,"azt-drawer-container",3,"ngClass","hasBackdrop"],[3,"openedChange","ngClass","mode","opened"],[1,"box","h-full","border","border-slate-200/60","dark:border-darkmode-400"],[1,"flex","rounded-md","border-b","border-slate-200","dark:border-darkmode-400","p-2","text-slate-500",2,"border-bottom-right-radius","0","border-bottom-left-radius","0"],[1,"search-box"],[3,"onSearch","isServerSearch","placeholder","searchContentObj","styleInput"],[2,"height","calc(100% - 50px)"],["track","vertical","pointerEventsMethod","scrollbar",1,"w-full",3,"visibility"],[1,"p-2"],["azt-track-service","azt-list-classroom-checkbox-TUrZzBy9T","class","flex items-center px-3 py-2 rounded-md w-full",3,"ngClass","click",4,"ngIf"],[4,"ngIf"],[1,"azt-drawer-content","h-full",3,"ngClass"],[1,"box","border","border-slate-200","dark:border-darkmode-400","h-full"],[1,"flex","items-center","rounded-md","border-b","border-slate-200","dark:border-darkmode-400","p-2","text-slate-500",2,"border-bottom-right-radius","0","border-bottom-left-radius","0"],["azt-track-service","azt-list-classroom-checkbox-WB1u8XZHUS","class","btn btn-sm mr-2",3,"matTooltip","click",4,"ngIf"],["azt-track-service","azt-list-classroom-checkbox-q2BPTM5lPo","class","btn btn-sm mr-2",3,"matTooltip","click",4,"ngIf"],[1,"flex","ml-auto"],[1,"mr-2"],[1,"filter","mr-2"],[1,"btn","btn-sm",3,"matMenuTriggerFor"],[1,"w-4","h-4","inline-block"],["name","filter","size","18"],[1,"azt-hidden","md:block","ml-2"],["class","p-1 ml-1 items-center justify-center rounded-full text-xs bg-primary text-white cursor-pointer font-medium","style","display: inline-flex; width: 15px; height: 15px; font-size: 10px",4,"ngIf"],[1,"flex","items-center"],[3,"maximize"],[1,"dropdown-menu","show","relative","w-56"],[1,"dropdown-content"],["azt-track-service","azt-list-classroom-checkbox-mJWF3uWTQJ","for","isShowChecked",1,"dropdown-item","cursor-pointer",3,"click"],[1,"form-check","form-switch","ml-auto"],["id","isShowChecked","type","checkbox",1,"show-code","form-check-input","ml-2",3,"change","checked"],["azt-track-service","azt-list-classroom-checkbox-pFWk_nWN9o","for","isShowNotChecked",1,"dropdown-item","cursor-pointer",3,"click"],["id","isShowNotChecked","type","checkbox",1,"show-code","form-check-input","ml-2",3,"change","checked"],[1,"dropdown-divider"],[1,"flex","p-1"],[1,"btn","btn-secondary","py-1","px-2","ml-auto","mr-2"],["azt-track-service","azt-list-classroom-checkbox-3OFGLRY5fa",3,"click"],["azt-track-service","azt-list-classroom-checkbox-iJlkvwO36n",1,"btn","btn-danger","py-1","px-2",3,"click"],[1,"w-full",2,"height","calc(100% - 50px)"],[4,"ngIf","ngIfElse"],["azt-track-service","azt-list-classroom-checkbox-TUrZzBy9T",1,"flex","items-center","px-3","py-2","rounded-md","w-full",3,"click","ngClass"],[4,"ngFor","ngForOf"],["azt-track-service","azt-list-classroom-checkbox-hUXQqnl7px","class","flex items-center px-3 py-2 rounded-md w-full text-left",3,"ngClass","click",4,"ngIf"],["azt-track-service","azt-list-classroom-checkbox-hUXQqnl7px",1,"flex","items-center","px-3","py-2","rounded-md","w-full","text-left",3,"click","ngClass"],["azt-track-service","azt-list-classroom-checkbox-WB1u8XZHUS",1,"btn","btn-sm","mr-2",3,"click","matTooltip"],["name","panel-left-open","size","16"],["azt-track-service","azt-list-classroom-checkbox-q2BPTM5lPo",1,"btn","btn-sm","mr-2",3,"click","matTooltip"],["name","panel-left-close","size","16"],[1,"p-1","ml-1","items-center","justify-center","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium",2,"display","inline-flex","width","15px","height","15px","font-size","10px"],["track","vertical",1,"h-full",3,"visibility"],["scrollViewport","","itemSize","10"],[1,"grid","grid-cols-12","gap-3","p-3","pt-2"],["class","col-span-12 md:col-span-6",3,"ngStyle",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"col-span-12","md:col-span-6",3,"ngStyle"],[1,"font-bold"],["azt-track-service","azt-list-classroom-view-tree-o6QRGuakJ",1,"flex","items-center","clickable","hover:text-primary",3,"click","ngClass"],["name","align-justify","size","16"],[3,"matTooltip",4,"ngIf"],["class","ml-2 py-0.5 px-2 rounded-full text-xs bg-primary text-white cursor-pointer font-medium",4,"ngIf"],[3,"matTooltip"],[1,"ml-2","py-0.5","px-2","rounded-full","text-xs","bg-primary","text-white","cursor-pointer","font-medium"],[1,"flex","items-center","justify-center",2,"height","200px"]],template:function(l,a){if(1&l){const g=e.RV6();e.j41(0,"div",4,0)(2,"mat-drawer-container",5)(3,"mat-drawer",6,1),e.bIt("openedChange",function(N){return e.eBV(g),e.Njj(a.sAztMatDrawerService.openedChange(N))}),e.j41(5,"div",7)(6,"div",8)(7,"div",9)(8,"azt-search-box",10),e.nI1(9,"mytranslate"),e.bIt("onSearch",function(N){return e.eBV(g),e.Njj(a.searchByGroupName(N.searchObj))}),e.k0s()()(),e.j41(10,"div",11)(11,"ng-scrollbar",12)(12,"div",13),e.DNE(13,I,3,8,"button",14)(14,H,2,1,"ng-container",15),e.k0s()()()()(),e.j41(15,"mat-drawer-content")(16,"div",16)(17,"div",17)(18,"div",18),e.DNE(19,te,3,3,"button",19)(20,j,3,3,"button",20),e.j41(21,"div",21)(22,"div",22)(23,"azt-search-box",10),e.nI1(24,"mytranslate"),e.bIt("onSearch",function(N){return e.eBV(g),e.Njj(a.searchByClassroomName(N.searchObj))}),e.k0s()(),e.j41(25,"div",23)(26,"button",24)(27,"span",25),e.nrm(28,"lucide-icon",26),e.k0s(),e.j41(29,"span",27),e.EFF(30),e.nI1(31,"mytranslate"),e.DNE(32,$,2,1,"span",28),e.k0s()()(),e.j41(33,"div",29),e.nrm(34,"azt-maximize-box",30),e.k0s(),e.j41(35,"mat-menu",null,2)(37,"div",31)(38,"ul",32)(39,"li")(40,"label",33),e.bIt("click",function(N){return e.eBV(g),e.Njj(N.stopPropagation())}),e.EFF(41),e.nI1(42,"mytranslate"),e.j41(43,"div",34)(44,"input",35),e.bIt("change",function(){return e.eBV(g),a.filterObj.isShowChecked=!a.filterObj.isShowChecked,e.Njj(a.changeFilter())}),e.k0s()()()(),e.j41(45,"li")(46,"label",36),e.bIt("click",function(N){return e.eBV(g),e.Njj(N.stopPropagation())}),e.EFF(47),e.nI1(48,"mytranslate"),e.j41(49,"div",34)(50,"input",37),e.bIt("change",function(){return e.eBV(g),a.filterObj.isShowNotChecked=!a.filterObj.isShowNotChecked,e.Njj(a.changeFilter())}),e.k0s()()()(),e.j41(51,"li"),e.nrm(52,"hr",38),e.k0s(),e.j41(53,"li")(54,"div",39)(55,"button",40),e.EFF(56),e.nI1(57,"mytranslate"),e.k0s(),e.j41(58,"div",41),e.bIt("click",function(N){return e.eBV(g),e.Njj(N.stopPropagation())}),e.j41(59,"button",42),e.bIt("click",function(){return e.eBV(g),e.Njj(a.clearFilter())}),e.EFF(60),e.nI1(61,"mytranslate"),e.k0s()()()()()()()()(),e.j41(62,"div",43),e.DNE(63,ee,5,2,"ng-container",44)(64,ae,3,3,"ng-template",null,3,e.C5r),e.k0s()()()()()()}if(2&l){const g=e.sdS(1),P=e.sdS(36),N=e.sdS(65);e.R7$(2),e.HbH(a.defaultCssClass),e.Y8G("ngClass",e.l_i(47,Q,a.isMobileDevice,!a.isMobileDevice))("hasBackdrop",a.sAztMatDrawerService.hasBackdrop),e.R7$(),e.FS9("opened",a.sAztMatDrawerService.isOpenSideNav?"true":"false"),e.Y8G("ngClass",e.l_i(50,O,a.isMobileDevice,!a.isMobileDevice))("mode",a.sAztMatDrawerService.mode),e.R7$(5),e.Y8G("isServerSearch",!1)("placeholder",e.bMT(9,33,"lang_azt_search_class_group"))("searchContentObj",a.searchByGroupContentObj)("styleInput","pr-10 py-1"),e.R7$(3),e.Y8G("visibility","hover"),e.R7$(2),e.Y8G("ngIf",!a.searchByGroupContentObj.searchContent),e.R7$(),e.Y8G("ngIf",a.mapClassroomGroupDataToForm.groupObjs.length>1),e.R7$(2),e.Y8G("ngClass",e.eq3(53,W,!a.isMobileDevice&&a.sAztMatDrawerService.isOpenSideNav)),e.R7$(3),e.Y8G("ngIf",!a.sAztMatDrawerService.isOpenSideNav||a.isMobileDevice),e.R7$(),e.Y8G("ngIf",a.sAztMatDrawerService.isOpenSideNav&&!a.isMobileDevice),e.R7$(3),e.Y8G("isServerSearch",!1)("placeholder",e.bMT(24,35,"lang_azt_search_class"))("searchContentObj",a.searchByClassroomContentObj)("styleInput","py-1"),e.R7$(3),e.Y8G("matMenuTriggerFor",P),e.R7$(4),e.SpI(" ",e.bMT(31,37,"lang_testbank_tested_list_sort")," "),e.R7$(2),e.Y8G("ngIf",a.filterObj.isShowChecked||a.filterObj.isShowNotChecked),e.R7$(2),e.Y8G("maximize",g),e.R7$(7),e.SpI(" ",e.bMT(42,39,"lang_azt_selected_classes")," "),e.R7$(3),e.Y8G("checked",a.filterObj.isShowChecked),e.R7$(3),e.SpI(" ",e.bMT(48,41,"lang_azt_unselected_classes")," "),e.R7$(3),e.Y8G("checked",a.filterObj.isShowNotChecked),e.R7$(6),e.JRh(e.bMT(57,43,"lang_button_close")),e.R7$(4),e.JRh(e.bMT(61,45,"lang_button_delete")),e.R7$(3),e.Y8G("ngIf",a.mapClassroomGroupDataToForm.totalViewClassrooms>0)("ngIfElse",N)}},dependencies:[x.YU,x.Sq,x.bT,x.B3,E.kk,E.Cp,G.qe,G.$C,G.$l,T.oV,h.yg,h.E$,h.d6,o.Yh,o.Gl,A.WGl,V.e,Z.W,q.g,x.P9,J.wp,J.gC],encapsulation:2}),S})();function se(i,S){1&i&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&i&&(e.R7$(),e.JRh(e.bMT(2,1,"lang_testbank_test_config_you_not_yet_student")))}function ie(i,S){if(1&i){const m=e.RV6();e.j41(0,"div")(1,"azt-list-classroom-view-tree",1),e.bIt("chooseStudentsEvent",function(a){e.eBV(m);const g=e.XpG();return e.Njj(g.chooseStudentsEvent(a))}),e.k0s(),e.j41(2,"div",2)(3,"div",3),e.DNE(4,se,3,3,"span",0),e.k0s()()()}if(2&i){const m=e.XpG();e.R7$(),e.Y8G("classroomGroupData",m.classroomGroupData)("studentsSelected",m.studentsSelected)("permissionName",m.permissionName),e.R7$(3),e.Y8G("ngIf",m.form.controls.studentIds.errors)}}let le=(()=>{var i;class S extends L.H{chooseStudentsEvent(l){let a=this.form.controls.studentIds.controls.filter(g=>g.controls.classroomId.value!=l.classroomId);this.form.controls.studentIds.clear(),a.forEach(g=>{this.form.controls.studentIds.push(g)}),l.studentIdsSelected.forEach(g=>{this.form.controls.studentIds.push(new t.gE({classroomId:new t.MJ(l.classroomId,{nonNullable:!0}),studentId:new t.MJ(g,{nonNullable:!0})}))}),this.calculateStudentsSelected()}initStudentsControl(){this.form.controls.studentIds.clear(),this.examStudentObjs.forEach(l=>{this.form.controls.studentIds.push(new t.gE({classroomId:new t.MJ(l.classroomId,{nonNullable:!0}),studentId:new t.MJ(l.studentId,{nonNullable:!0})}))}),this.calculateStudentsSelected()}calculateStudentsSelected(){let l=[],a=this.commonService.arrayToDictionary(this.form.controls.studentIds.getRawValue(),g=>g.classroomId.toString());Object.entries(a).forEach(([g,P],N)=>{let ne=this.commonService.getFirstOfArray(P)?.classroomId;ne&&l.push({classroomId:ne,classroomName:"",studentIdsSelected:P.map(re=>re.studentId)})}),this.studentsSelected=l}ngOnInit(){super.ngOnInit(),this.initStudentsControl()}constructor(){super(),this.examStudentObjs=[],this.permissionName=r.t.exam,this.studentsSelected=[]}}return(i=S).\u0275fac=function(l){return new(l||i)},i.\u0275cmp=e.VBU({type:i,selectors:[["list-student-checkbox"]],inputs:{form:"form",classroomGroupData:"classroomGroupData",examStudentObjs:"examStudentObjs",permissionName:"permissionName"},features:[e.Vt3],decls:1,vars:1,consts:[[4,"ngIf"],[3,"chooseStudentsEvent","classroomGroupData","studentsSelected","permissionName"],[1,"mt-2"],[1,"text-xs","font-medium","text-danger"]],template:function(l,a){1&l&&e.DNE(0,ie,5,4,"div",0),2&l&&e.Y8G("ngIf",a.form)},dependencies:[x.bT,oe,J.wp],encapsulation:2}),S})()},92654:(Y,z,n)=>{n.d(z,{x:()=>d});var t=n(51698),r=n(82716),L=n(33860),e=n(57003),x=n(92274),o=n(48891),U=n(62095),c=n(46899);let d=(()=>{var _;class D{doExamAction(s,M){switch(M){case x.$.CONFIG_EXAM_CLASSROOM:return this.showConfigExamClassroomDialog(s);case x.$.SHOW_EXAM_DETAIL:this.showExamDetailDialog(s);break;case x.$.SHARE_OFFLINE_RESULT:this.showOfflineShareDialog(s);break;case x.$.COPY_EXAM_LINK:this.copyExamLink()}return this.returnUndefinedOutput()}copyExamLink(){this.commonService.snackSuccess("lang_auto_sao_chep_thanh_cong")}showConfigExamClassroomDialog(s){return new t.c(M=>{this.sAztDialogService.open(e.Q,{width:"900px",data:{hashId:s.examObj.hashId,examStudents:s.examObj?.examStudents??[]},restoreFocus:!1}).afterClosed().subscribe(E=>{E?(M.next({reloadData:!0}),M.complete()):(M.next(void 0),M.complete())})})}showExamDetailDialog(s){let M={obj:{...s.examObj,countQuestion:0,showFrontend:1,editable:!0,allowStudentView:!0},globalLadingPage:s.globalLadingPage,curCateId:s.categoryId,isOnLib:0,isShow:!0,showDelete:!0};this.sAztDialogService.open(L.c,{width:"800px",maxWidth:"90vw",enterAnimationDuration:"0ms",exitAnimationDuration:"0ms",data:M,restoreFocus:!1}).afterClosed().subscribe(E=>{})}showOfflineShareDialog(s){this.sAztDialogService.open(r.h,{width:"1000px",data:{examHashId:s.examObj.hashId,useDialog:!0},restoreFocus:!1})}returnUndefinedOutput(){return new t.c(s=>{s.next(void 0),s.complete()})}constructor(s,M){this.commonService=s,this.sAztDialogService=M}}return(_=D).\u0275fac=function(s){return new(s||_)(o.KVO(U.R),o.KVO(c.i))},_.\u0275prov=o.jDH({token:_,factory:_.\u0275fac,providedIn:"root"}),D})()},31291:(Y,z,n)=>{n.d(z,{n:()=>e});var t=n(43362),r=n(48891),L=n(62095);let e=(()=>{var x;class o{sortExamByColumn(c,d,_){return d==t.N.BY_NAME?this.sortExamByName(c,_):d==t.N.BY_PUBLISH_STATUS?this.sortExamByPublishStatus(c,_):d==t.N.BY_UPDATED_DATE?this.sortExamByDateUpdated(c,_):d==t.N.BY_ATTENDED?this.sortExamByAttended(c,_):this.sortExamByName(c,_)}sortExamByName(c,d){var _=[...c.rootCategoryObjs??[]],D=[...c.rootDocumentObjs??[]];return 1==d?{categoryObjs:this._sortCateByName(_),documentObjs:this._sortDocumentByName(D)}:{categoryObjs:this._sortCateByName(_).reverse(),documentObjs:this._sortDocumentByName(D).reverse()}}sortExamByPublishStatus(c,d){var _=[...c.rootDocumentObjs??[]];return 1==d?{categoryObjs:c.currentCategoryObjs,documentObjs:this._sortDocumentByPublish(_,_?.length)}:{categoryObjs:c.currentCategoryObjs,documentObjs:this._sortDocumentByPublish(_,_?.length).reverse()}}sortExamByDateUpdated(c,d){var _=this.commonService.castObj(c.rootCategoryObjs),D=this.commonService.castObj(c.rootDocumentObjs);return 1==d?{categoryObjs:this._sortCateByDateUpdateExam(_??[]),documentObjs:this._sortDocumentByUpdateTime(D??[])}:{categoryObjs:this._sortCateByDateUpdateExam(_??[]).reverse(),documentObjs:this._sortDocumentByUpdateTime(D??[]).reverse()}}sortExamByAttended(c,d){var _=this.commonService.castObj(c.rootDocumentObjs);return 1==d?{categoryObjs:c.currentCategoryObjs,documentObjs:this._sortDocumentByAttended(_??[])}:{categoryObjs:c.currentCategoryObjs,documentObjs:this._sortDocumentByAttended(_??[]).reverse()}}_sortCateByName(c){return c?.sort((d,_)=>(d.name?.trim()??"").localeCompare(_.name?.trim()??""))??[]}_sortDocumentByName(c){return c?.sort((d,_)=>(d.name?.trim()??"").localeCompare(_.name?.trim()??""))??[]}_sortDocumentByPublish(c,d){let _=[],D=[];for(let k=0;k<(d??0);k++)0==c?.[k].isPublished&&_.push(c[k]),1==c?.[k].isPublished&&D.push(c[k]);return _.concat(D)}_sortCateByDateUpdateExam(c){return c.sort((d,_)=>Number(new Date(d.updatedAt??""))-Number(new Date(_.updatedAt??""))),c}_sortDocumentByUpdateTime(c){return c?.sort((d,_)=>Number(new Date(d.updatedAt??""))-Number(new Date(_.updatedAt??"")))}_sortDocumentByAttended(c){return c?.sort((d,_)=>Number(d.attended)-Number(_.attended))}constructor(c){this.commonService=c}}return(x=o).\u0275fac=function(c){return new(c||x)(r.KVO(L.R))},x.\u0275prov=r.jDH({token:x,factory:x.\u0275fac,providedIn:"root"}),o})()},92274:(Y,z,n)=>{n.d(z,{$:()=>t});var t=function(r){return r[r.CONFIG_EXAM_CLASSROOM=0]="CONFIG_EXAM_CLASSROOM",r[r.SHOW_EXAM_DETAIL=1]="SHOW_EXAM_DETAIL",r[r.SHARE_OFFLINE_RESULT=2]="SHARE_OFFLINE_RESULT",r[r.COPY_EXAM_LINK=3]="COPY_EXAM_LINK",r}(t||{})},45306:(Y,z,n)=>{n.d(z,{d:()=>t});var t=function(r){return r[r.OFFLINE_CONFIG=0]="OFFLINE_CONFIG",r[r.CONFIG_EXAM=1]="CONFIG_EXAM",r[r.EDIT_EXAM=2]="EDIT_EXAM",r[r.POWER_POINT=3]="POWER_POINT",r[r.STATISTIC=4]="STATISTIC",r[r.TESTED_LIST=5]="TESTED_LIST",r}(t||{})},43362:(Y,z,n)=>{n.d(z,{N:()=>t});var t=function(r){return r[r.BY_NAME=0]="BY_NAME",r[r.BY_PUBLISH_STATUS=1]="BY_PUBLISH_STATUS",r[r.BY_UPDATED_DATE=2]="BY_UPDATED_DATE",r[r.BY_ATTENDED=3]="BY_ATTENDED",r}(t||{})},45168:(Y,z,n)=>{n.d(z,{C:()=>t});var t=function(r){return r[r.multipleChoice=1]="multipleChoice",r[r.essay=3]="essay",r[r.trueFalse=5]="trueFalse",r[r.fill=4]="fill",r}(t||{})},51221:(Y,z,n)=>{n.d(z,{$:()=>t});var t=function(r){return r.COPY="copy",r.CUT="cut",r.DELETE="delete",r}(t||{})},86925:(Y,z,n)=>{n.d(z,{Y:()=>t});var t=function(r){return r[r.EXAM_CATEGORY=0]="EXAM_CATEGORY",r[r.EXAM=1]="EXAM",r}(t||{})},30977:(Y,z,n)=>{n.d(z,{g:()=>e});var t=n(51221),r=n(86925),L=n(48891);let e=(()=>{var x;class o{constructor(){this.clipboardObjs=[]}setActionToClipboard(c,d,_,D){var k={id:c,name:D,type:d,action:_};this.clipboardObjs.filter(M=>M.id==k.id&&M.type==k.type).length>0?this.clipboardObjs.forEach(M=>{M.id==k.id&&M.type==k.type&&(M.action=k.action)}):this.clipboardObjs.push(k)}hasInClipboard(c,d){return this.clipboardObjs.filter(D=>D.id==c&&D.type==d).length>0}hasCopyFolderActionInClipboard(){var c=!1;return this.clipboardObjs.forEach(d=>{d.type==r.Y.EXAM_CATEGORY&&d.action==t.$.COPY&&(c=!0)}),c}getActionOfDocumentObj(c,d){var _=this.clipboardObjs.filter(D=>D.id==c&&D.type==d);if(_&&_.length>0)return _[0].action}removeDocumentInClipboard(c,d){for(var _=0;_<this.clipboardObjs.length;_++)this.clipboardObjs[_].id==c&&this.clipboardObjs[_].type==d&&this.clipboardObjs.splice(_,1)}isPasteToSelfFolder(c){var d=!1;return this.clipboardObjs.forEach(_=>{_.id==c&&_.type==r.Y.EXAM_CATEGORY&&_.action==t.$.COPY&&(d=!0)}),d}getCurrentClipBoard(){return this.clipboardObjs}resetClipBoardAfterPasteOrCancelAllActions(){this.clipboardObjs=[]}}return(x=o).\u0275fac=function(c){return new(c||x)},x.\u0275prov=L.jDH({token:x,factory:x.\u0275fac,providedIn:"root"}),o})()},48485:(Y,z,n)=>{n.d(z,{H:()=>t});class t{static studentCheckBoxValidator(L){const x=L.controls.whoAllow,o=L.controls.studentIds;return x&&o?3!=x.value||t.countCheckBox(o)>=1?(o.setErrors(null),null):(o.setErrors({studentCheckBoxValidator:!0}),{identityRevealed:!0}):null}static countCheckBox(L){return L.getRawValue().length}}},62538:(Y,z,n)=>{n.d(z,{O:()=>K});var t=n(48891),r=n(45168),L=n(59640),e=n(67638),x=n(54460),o=n(76975);const U=["table"],c=()=>[];function d(E,G){if(1&E&&(t.j41(0,"td",6),t.EFF(1),t.nI1(2,"formatOfflineExamHashIdToNumber"),t.k0s()),2&E){const T=G.$implicit,h=G.index;t.BMQ("excelRow",1)("excelColumn",h+1),t.R7$(),t.SpI(" ",t.bMT(2,3,null==T?null:T.offlineMixQuestionHashId)," ")}}function _(E,G){if(1&E&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&E){const T=t.XpG(2).$implicit,h=t.XpG().$implicit;t.R7$(),t.SpI(" ",t.bMT(2,1,T.offlineQuestionObjs[h].answer)," ")}}function D(E,G){1&E&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"mytranslate"),t.k0s()),2&E&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"lang_core_essay_question")," "))}function k(E,G){if(1&E&&(t.j41(0,"span"),t.DNE(1,_,3,3,"span",7)(2,D,3,3,"span",7),t.k0s()),2&E){const T=t.XpG().$implicit,h=t.XpG().$implicit;t.R7$(),t.Y8G("ngIf",!(null!=T.offlineQuestionObjs&&null!=T.offlineQuestionObjs[h]&&T.offlineQuestionObjs[h].isEssay)),t.R7$(),t.Y8G("ngIf",null==T.offlineQuestionObjs||null==T.offlineQuestionObjs[h]?null:T.offlineQuestionObjs[h].isEssay)}}function s(E,G){if(1&E&&(t.j41(0,"td",6),t.DNE(1,k,3,2,"span",7),t.k0s()),2&E){let T;const h=G.$implicit,A=G.index,V=t.XpG().$implicit;t.BMQ("excelRow",V+2)("excelColumn",A+1),t.R7$(),t.Y8G("ngIf",(null!==(T=null==h.offlineQuestionObjs?null:h.offlineQuestionObjs.length)&&void 0!==T?T:0)>V)}}function M(E,G){if(1&E&&(t.j41(0,"tr")(1,"td",3),t.EFF(2),t.k0s(),t.DNE(3,s,2,3,"td",4),t.k0s()),2&E){let T;const h=G.$implicit,A=t.XpG();t.R7$(),t.BMQ("excelRow",h+2)("excelColumn",0),t.R7$(),t.SpI(" ",h+A.startQuestionIndex," "),t.R7$(),t.Y8G("ngForOf",null!==(T=null==A.obj?null:A.obj.offlineMixQuestionObjs)&&void 0!==T?T:t.lJ4(4,c))}}let K=(()=>{var E;class G extends L.H{calculateMaxQuestion(){let h=0;return this.obj.offlineMixQuestionObjs&&this.obj.offlineMixQuestionObjs.forEach(A=>{h<(A.offlineQuestionObjs?.length??0)&&(h=A.offlineQuestionObjs?.length??0)}),h}processData(){for(let h=0;h<this.obj.offlineMixQuestionObjs.length;h++)for(let A=0;A<this.obj.offlineMixQuestionObjs[h].offlineQuestionObjs.length;A++)this.obj.offlineMixQuestionObjs[h].offlineQuestionObjs[A].answerType===this.offlineAnswerType.trueFalse&&(this.obj.offlineMixQuestionObjs[h].offlineQuestionObjs[A].answer=this.convertAnswerTrueFalse(this.obj.offlineMixQuestionObjs[h].offlineQuestionObjs[A].answer))}convertAnswerTrueFalse(h){const A=h.split(","),V=this.commonService.myClone(this.answerChoiceMap),Z=this.commonService.myTranslateInstant("lang_testbank_correct_answer_to_offline_exam"),q=this.commonService.myTranslateInstant("lang_testbank_wrong_answer_to_offline_exam");return V.map(Q=>A.includes(Q)?Z:q).join("")}ngOnChanges(){this.processData(),this.isExported=!1,this.maxQuestionIndex=this.calculateMaxQuestion(),this.totalExamCode=this.obj.offlineMixQuestionObjs?.length??0}ngAfterViewChecked(){0==this.isExported&&(this.isExported=!0,setTimeout(()=>{this.exportDataDone.emit(this.exportExcelService.exportHtmlTableToExcelBlob(this.table,!0))},0))}constructor(h){super(),this.exportExcelService=h,this.startQuestionIndex=1,this.exportDataDone=new t.bkB,this.maxQuestionIndex=0,this.totalExamCode=0,this.isExported=!1,this.offlineAnswerType=r.C,this.answerChoiceMap=["A","B","C","D"]}}return(E=G).\u0275fac=function(h){return new(h||E)(t.rXU(e.x))},E.\u0275cmp=t.VBU({type:E,selectors:[["azt-export-excel-for-answersheet"]],viewQuery:function(h,A){if(1&h&&t.GBs(U,5),2&h){let V;t.mGM(V=t.lsd())&&(A.table=V.first)}},inputs:{obj:"obj",startQuestionIndex:"startQuestionIndex"},outputs:{exportDataDone:"exportDataDone"},features:[t.Vt3,t.OA$],decls:14,vars:16,consts:[["table",""],[1,"table","table-bordered",2,"display","none"],["rowspan","2","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true},"font":{"bold":true}}',1,"text-center","azt-excel-cell"],["class","text-center azt-excel-cell","excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["excelStyle",'{"alignment":{"vertical":"center","horizontal":"center","wrapText":true}}',1,"text-center","azt-excel-cell"],[4,"ngIf"]],template:function(h,A){if(1&h&&(t.j41(0,"table",1,0)(2,"tbody")(3,"tr")(4,"td",2),t.EFF(5),t.nI1(6,"mytranslate"),t.k0s(),t.j41(7,"td",3),t.EFF(8),t.nI1(9,"mytranslate"),t.k0s()(),t.j41(10,"tr"),t.DNE(11,d,3,5,"td",4),t.k0s(),t.DNE(12,M,4,5,"tr",5),t.nI1(13,"createEmptyArray"),t.k0s()()),2&h){let V;t.R7$(4),t.BMQ("excelRow",0)("excelColumn",0),t.R7$(),t.SpI(" ",t.bMT(6,9,"lang_testbank_answersheet_question_title")," "),t.R7$(2),t.BMQ("colspan",A.totalExamCode)("excelRow",0)("excelColumn",1),t.R7$(),t.SpI(" ",t.bMT(9,11,"lang_auto_ma_de_thi")," "),t.R7$(3),t.Y8G("ngForOf",null!==(V=null==A.obj?null:A.obj.offlineMixQuestionObjs)&&void 0!==V?V:t.lJ4(15,c)),t.R7$(),t.Y8G("ngForOf",t.bMT(13,13,A.maxQuestionIndex))}},dependencies:[x.Sq,x.bT,o.wp,o.IX,o.c],encapsulation:2}),G})()},82716:(Y,z,n)=>{n.d(z,{h:()=>Q});var t=n(10936),r=n(89163),L=n(33887),e=n(38009),x=n(80037),o=n(48891),U=n(2145),c=n(3780),d=n(54460),_=n(64160),D=n(15343),k=n(81587),s=n(27985),M=n(52811),K=n(76975);function E(O,W){1&O&&(o.j41(0,"div",9)(1,"span",10),o.nrm(2,"azt-loading-ui"),o.k0s(),o.j41(3,"span",11),o.EFF(4,"Loading..."),o.k0s()())}function G(O,W){if(1&O){const u=o.RV6();o.j41(0,"div",26)(1,"azt-list-classroom-checkbox",27),o.bIt("changeCheckboxEvent",function(p){o.eBV(u);const w=o.XpG(3);return o.Njj(w.changeStatusOfflineShare(p))}),o.k0s()()}if(2&O){const u=o.XpG(3);o.R7$(),o.Y8G("form",u.form)("classroomGroupData",u.classroomWithGroup)("shareClassroomIds",u.shareClassroomIds)("permissionName",u.permissionTypes.exam)("defaultCssClass","classroom-box-in-dialog")}}function T(O,W){if(1&O){const u=o.RV6();o.j41(0,"div",28),o.nrm(1,"input",29),o.j41(2,"button",30),o.bIt("click",function(){o.eBV(u);const p=o.XpG(3);return o.Njj(p.showCopySuccess())}),o.j41(3,"span",31),o.nrm(4,"lucide-icon",32),o.k0s(),o.EFF(5),o.nI1(6,"mytranslate"),o.k0s()()}if(2&O){const u=o.XpG(3);o.R7$(),o.Y8G("value",u.linkCopy),o.R7$(),o.Y8G("cdkCopyToClipboard",u.copyLinkToClipboard()),o.R7$(3),o.SpI(" ",o.bMT(6,3,"lang_auto_sao_chep")," ")}}function h(O,W){1&O&&(o.j41(0,"div",33)(1,"p",34),o.EFF(2),o.nI1(3,"mytranslate"),o.k0s()()),2&O&&(o.R7$(2),o.JRh(o.bMT(3,1,"lang_auto_chua_duoc_cau_hinh_tra_de_thi")))}function A(O,W){if(1&O){const u=o.RV6();o.qex(0),o.j41(1,"div",14)(2,"div",15)(3,"input",16),o.bIt("change",function(){o.eBV(u);const p=o.XpG(2);return o.Njj(p.changeStatusOfflineShare(void 0))}),o.k0s(),o.j41(4,"label",17),o.EFF(5),o.nI1(6,"mytranslate"),o.k0s()(),o.j41(7,"div",18)(8,"input",19),o.bIt("change",function(){o.eBV(u);const p=o.XpG(2);return o.Njj(p.changeStatusOfflineShare(void 0))}),o.k0s(),o.j41(9,"label",20),o.EFF(10),o.nI1(11,"mytranslate"),o.k0s()(),o.j41(12,"div",18)(13,"input",21),o.bIt("change",function(){o.eBV(u);const p=o.XpG(2);return o.Njj(p.changeStatusOfflineShare(void 0))}),o.k0s(),o.j41(14,"label",22),o.EFF(15),o.nI1(16,"mytranslate"),o.k0s()()(),o.DNE(17,G,2,5,"div",23)(18,T,7,5,"div",24)(19,h,4,3,"div",25),o.nI1(20,"fullPermission"),o.bVm()}if(2&O){const u=o.XpG(2);o.R7$(3),o.Y8G("value",0),o.R7$(2),o.JRh(o.bMT(6,9,"lang_auto_khong")),o.R7$(3),o.Y8G("value",1),o.R7$(2),o.JRh(o.bMT(11,11,"lang_auto_tat_ca_cac_lop")),o.R7$(3),o.Y8G("value",2),o.R7$(2),o.JRh(o.bMT(16,13,"lang_auto_tuy_chon_theo_lop")),o.R7$(2),o.Y8G("ngIf",2===u.form.controls.chooseOption.value),o.R7$(),o.Y8G("ngIf",1===u.form.controls.chooseOption.value||2===u.form.controls.chooseOption.value&&!u.form.controls.classroomFormArray.errors),o.R7$(),o.Y8G("ngIf",!o.i5U(20,15,u.examWithPermissionObj,"exam"))}}function V(O,W){1&O&&(o.j41(0,"div",36)(1,"p",34),o.EFF(2),o.nI1(3,"mytranslate"),o.k0s()()),2&O&&(o.R7$(2),o.JRh(o.bMT(3,1,"lang_auto_chua_duoc_cau_hinh_tra_de_thi")))}function Z(O,W){if(1&O&&(o.DNE(0,V,4,3,"div",35),o.nI1(1,"fullPermission")),2&O){const u=o.XpG(2);o.Y8G("ngIf",!o.i5U(1,1,u.examWithPermissionObj,"exam"))}}function q(O,W){if(1&O&&(o.j41(0,"form",12),o.DNE(1,A,21,18,"ng-container",13),o.nI1(2,"fullPermission"),o.DNE(3,Z,2,4,"ng-template",null,1,o.C5r),o.k0s()),2&O){const u=o.sdS(4),v=o.XpG();o.Y8G("formGroup",v.form),o.R7$(),o.Y8G("ngIf",o.i5U(2,3,v.examWithPermissionObj,"exam"))("ngIfElse",u)}}function J(O,W){if(1&O){const u=o.RV6();o.j41(0,"div",37)(1,"button",38),o.bIt("click",function(){o.eBV(u);const p=o.XpG();return o.Njj(p.btnCloseDialog(!1))}),o.EFF(2),o.nI1(3,"mytranslate"),o.k0s()()}2&O&&(o.R7$(2),o.SpI(" ",o.bMT(3,1,"lang_auto_dong")," "))}let Q=(()=>{var O;class W extends L._{btnCloseDialog(v){this.dialogRef.close(v)}copyLinkToClipboard(){let v=this.commonService.getCurrentDomain();return this.linkCopy=`${v}/de-thi/${this.examWithPermissionObj?.hashId}?offline=${this.offlineCode}`,this.linkCopy}showCopySuccess(){this.showSuccessSnack("lang_auto_sao_chep_thanh_cong")}getCodeOfflineShare(){this.initStatusObj(),this.waitDestroy(this.offlineShareService.apiOfflineShareGetObjGet(this.examHashId).subscribe(v=>{1==v.success?(this.offlineCode=v.data?.shareHashId??"",this.shareClassroomIds=v.data?.shareClassroomIds??[],this.examWithPermissionObj=v.data?.examObj,this.classroomWithGroup=[{groupObj:{id:-1,name:this.commonService.myTranslateInstant("lang_testbank_share_offline_default_group")},isOwned:!0,classroomObjs:v.data?.classroomObjs??[]}],this.form.controls.chooseOption.setValue(v.data?.showOfflineResult??0),this.successStatusObj()):this.errorStatusObj(v.message??"",!0)}))}changeStatusOfflineShare(v){if(2==this.form.getRawValue().chooseOption&&this.form.controls.classroomFormArray.errors?.classroomCheckBoxValidatorWithoutWhoAllow)return;let p=this.form.getRawValue().chooseOption;const w=2!=p?[]:this.sAztClassroomCheckboxService.getClassroomIdsCheckedInGroup(this.form.controls.classroomFormArray);this.waitDestroy(this.offlineShareService.apiOfflineShareChangeStatusPost({examHashId:this.examWithPermissionObj?.hashId??"",status:p,classroomIds:w}).subscribe(F=>{1==F.success?this.offlineCode=F.data?.shareHashId??"":this.errorStatusObj(F.message??"",!0)}))}ngAfterContentChecked(){this.changeDetector.detectChanges()}ngOnInit(){super.ngOnInit(),this.getCodeOfflineShare()}constructor(v,p,w,I,F){super(I,w),this.changeDetector=v,this.offlineShareService=p,this.dialogRef=w,this.sAztClassroomCheckboxService=F,this.examHashId="",this.useDialog=!1,this.permissionTypes=e.t,this.offlineCode="",this.linkCopy="",this.examWithPermissionObj=void 0,this.classroomWithGroup=[],this.shareClassroomIds=[],this.examHashId=I.examHashId?I.examHashId:this.examHashId,this.useDialog=I?I.useDialog:this.useDialog,this.form=new t.gE({chooseOption:new t.MJ(0,{nonNullable:!0}),whoAllow:new t.MJ(0,{nonNullable:!0}),classroomFormArray:new t.Yp([])},{validators:[x.j.classroomInGroupCheckBoxValidatorWithoutWhoAllow]})}}return(O=W).\u0275fac=function(v){return new(v||O)(o.rXU(o.gRc),o.rXU(U.i$),o.rXU(r.CP,8),o.rXU(r.Vh,8),o.rXU(c.Q))},O.\u0275cmp=o.VBU({type:O,selectors:[["azt-offline-share"]],inputs:{examHashId:"examHashId",useDialog:"useDialog"},features:[o.Vt3],decls:11,vars:6,consts:[["doneLoading",""],["noFullPermission",""],[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-3"],[1,"text-base","font-medium"],[1,"p-3","pt-0"],["class","flex justify-center items-center",4,"ngIf","ngIfElse"],["class","text-right mt-3",4,"ngIf"],[1,"flex","justify-center","items-center"],[1,"w-4","h-4","inline-block"],[1,"sr-only","ml-2"],[3,"formGroup"],[4,"ngIf","ngIfElse"],[1,"flex","flex-col","sm:flex-row","mb-3"],[1,"form-check","mr-8"],["formControlName","chooseOption","id","notAllow","type","radio",1,"form-check-input",3,"change","value"],["for","notAllow",1,"form-check-label"],[1,"form-check","mr-8","mt-2","sm:mt-0"],["formControlName","chooseOption","id","allAllow","type","radio",1,"form-check-input",3,"change","value"],["for","allAllow",1,"form-check-label"],["formControlName","chooseOption","id","customAllow","type","radio",1,"form-check-input",3,"change","value"],["for","customAllow",1,"form-check-label"],["class","azt-list-classroom",4,"ngIf"],["class","azt-copy relative",4,"ngIf"],["class","mt-0",4,"ngIf"],[1,"azt-list-classroom"],[3,"changeCheckboxEvent","form","classroomGroupData","shareClassroomIds","permissionName","defaultCssClass"],[1,"azt-copy","relative"],["type","text","readonly","",1,"form-control","py-3","px-4","border-transparent","bg-slate-100","pr-10","text-primary",2,"padding-right","120px","cursor","pointer",3,"value"],["azt-track-service","practice-detail-isTsISlyAY",1,"btn","btn-outline-primary","absolute","my-auto","inset-y-0","right-0",2,"border-top-left-radius","0","border-bottom-left-radius","0",3,"click","cdkCopyToClipboard"],[1,"w-4","h-4","inline-block","mr-2"],["name","copy","size","20"],[1,"mt-0"],[1,"note"],["class","text-center",4,"ngIf"],[1,"text-center"],[1,"text-right","mt-3"],["azt-track-service","azt-offline-share-hrBGx7oL2r",1,"btn","w-24","btn-secondary",3,"click"]],template:function(v,p){if(1&v&&(o.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"h3",5),o.EFF(4),o.nI1(5,"mytranslate"),o.k0s()(),o.j41(6,"div",6),o.DNE(7,E,5,0,"div",7)(8,q,5,6,"ng-template",null,0,o.C5r)(10,J,4,3,"div",8),o.k0s()()()),2&v){const w=o.sdS(9);o.R7$(4),o.JRh(o.bMT(5,4,"lang_auto_tra_ket_qua_thi_offline")),o.R7$(3),o.Y8G("ngIf",p.statusObj.loading)("ngIfElse",w),o.R7$(3),o.Y8G("ngIf",p.useDialog)}},dependencies:[d.bT,_.dF,t.qT,t.me,t.Fm,t.BC,t.cb,t.j4,t.JD,D.WGl,k.t,s.D,M.R,K.wp,K.gC],encapsulation:2}),W})()},33860:(Y,z,n)=>{n.d(z,{c:()=>te});var t=n(48891),r=n(89163),L=n(33887),e=n(25539),x=n(18148),o=n(30657),U=n(9280),c=n(10296),d=n(51913),_=n(91513),D=n(24506),k=n(2145),s=n(42032),M=n(54460),K=n(64160),E=n(17818),G=n(47712),T=n(15343),h=n(63958),A=n(52654),V=n(2915),Z=n(62538),q=n(52811),J=n(22783),Q=n(76975);const O=()=>({"mr-1 flex-none":!0});function W(j,$){if(1&j&&(t.j41(0,"a",33),t.nI1(1,"mytranslate"),t.j41(2,"span",23),t.nrm(3,"lucide-icon",34),t.k0s()()),2&j){t.XpG(2);const f=t.sdS(3);t.FS9("matTooltip",t.bMT(1,2,"lang_auto_tai_ve")),t.Y8G("matMenuTriggerFor",f)}}function u(j,$){if(1&j){const f=t.RV6();t.j41(0,"a",35),t.nI1(1,"mytranslate"),t.bIt("click",function(){t.eBV(f);const b=t.XpG(2);return t.Njj(b.showCopySuccess())}),t.j41(2,"span",36),t.nrm(3,"lucide-icon",37),t.k0s(),t.j41(4,"span"),t.EFF(5),t.nI1(6,"mytranslate"),t.k0s()()}if(2&j){const f=t.XpG(2);t.FS9("matTooltip",t.bMT(1,3,"lang_auto_copy_link_de_thi")),t.Y8G("cdkCopyToClipboard",f.copyLinkExam()),t.R7$(5),t.JRh(t.bMT(6,5,"lang_auto_copy_link"))}}function v(j,$){1&j&&(t.j41(0,"div",38)(1,"span",39),t.nrm(2,"azt-loading-ui"),t.k0s(),t.j41(3,"span",40),t.EFF(4),t.nI1(5,"mytranslate"),t.k0s()()),2&j&&(t.R7$(4),t.JRh(t.bMT(5,1,"lang_auto_dang_chuan_bi_tai_lieu_doing")))}function p(j,$){if(1&j&&(t.j41(0,"div",41),t.nrm(1,"div",42),t.nI1(2,"safeNormalHtmlContent"),t.k0s()),2&j){const f=t.XpG(2);t.R7$(),t.Y8G("innerHtml",t.bMT(2,1,f.data.headerContent),t.npT)}}function w(j,$){if(1&j&&t.nrm(0,"azt-loaded-img",43),2&j){const f=t.XpG(2);t.Y8G("imgSrc",f.data.obj.examHeader)}}function I(j,$){if(1&j&&t.nrm(0,"azt-question-standalone-for-preview",45),2&j){const f=t.XpG(),C=f.$implicit,b=f.index,y=t.XpG(2);t.Y8G("examObj",y.examObj)("questionObj",C)("follower",y.followerRenderQuest)("curQuestionIndex",b)("isShowExplain",y.showExplanation)}}function F(j,$){if(1&j&&(t.qex(0),t.DNE(1,I,1,5,"azt-question-standalone-for-preview",44),t.bVm()),2&j){const f=t.XpG(2);t.R7$(),t.Y8G("ngIf",f.examObj)}}function X(j,$){if(1&j){const f=t.RV6();t.qex(0),t.j41(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"div",17),t.DNE(6,W,4,4,"a",18)(7,u,7,7,"a",19),t.j41(8,"button",20),t.bIt("click",function(){t.eBV(f);const b=t.XpG();return t.Njj(b.showAllExplanation())}),t.EFF(9),t.nI1(10,"mytranslate"),t.nI1(11,"mytranslate"),t.k0s()()(),t.j41(12,"div",21)(13,"a",22)(14,"span",23),t.nrm(15,"lucide-icon",24),t.k0s()()()(),t.j41(16,"azt-mat-dialog-content",25),t.DNE(17,v,6,3,"div",26),t.j41(18,"div",27),t.nrm(19,"div",28),t.DNE(20,p,3,3,"div",29)(21,w,1,1,"azt-loaded-img",30)(22,F,2,1,"ng-container",31),t.nrm(23,"div",32),t.k0s()()()(),t.bVm()}if(2&j){const f=t.XpG();t.R7$(6),t.Y8G("ngIf",!(null!=f.data&&f.data.globalLadingPage||f.data.allowHeader)),t.R7$(),t.Y8G("ngIf",0==(null==f.data?null:f.data.isOnLib)&&!(null!=f.data&&f.data.globalLadingPage)),t.R7$(2),t.SpI(" ",f.showExplanation?t.bMT(10,8,"lang_auto_an_giai_thich"):t.bMT(11,10,"lang_auto_xem_giai_thich")," "),t.R7$(7),t.Y8G("defaultHeight",70),t.R7$(),t.Y8G("ngIf",f.statusObj.loading),t.R7$(3),t.Y8G("ngIf",f.data.allowHeader&&!f.statusObj.loading),t.R7$(),t.Y8G("ngIf",null==f.data||null==f.data.obj?null:f.data.obj.examHeader),t.R7$(),t.Y8G("ngForOf",f.questionList)}}function H(j,$){if(1&j){const f=t.RV6();t.j41(0,"azt-export-excel-for-answersheet",46),t.bIt("exportDataDone",function(b){t.eBV(f);const y=t.XpG();return t.Njj(y.exportDataDone(b))}),t.k0s()}if(2&j){let f;const C=t.XpG();t.Y8G("startQuestionIndex",null!==(f=null==C.examObj?null:C.examObj.startQuestionIndex)&&void 0!==f?f:1)("obj",C.exportExcelData)}}let te=(()=>{var j;class $ extends L._{handlerCloseDialog(C){C&&this.dialogRef.close()}copyLinkExam(){return`${this.commonService.getCurrentDomain()}/de-thi/${this.data?.obj?.hashId}`}showCopySuccess(){this.commonService.snackSuccess("lang_auto_sao_chep_thanh_cong")}showAllExplanation(){this.showExplanation=!this.showExplanation}downloadExam(C,b){if(!C||!this.data.obj)return;const y=this.commonService.myTranslateInstant("lang_auto_dang_khoi_tao_du_lieu")??"",R=this.printAddInfo.templateType??0,B={nameSchool:this.printAddInfo.nameSchool??"",nameSubject:this.printAddInfo.nameSubject??""};x.L.openLoadingEffect(`${y}...`),this.data.obj.hideGroupQuestion=0,this.exportSAztDocxService.downloadExam(b,{...this.data.obj,editable:!1,allowStudentView:!0},void 0,void 0,this.cloneQuestionList,B,R,void 0,void 0,void 0,!0).then(()=>{}).catch(ee=>{this.showErrorSnack(ee.message)})}downloadExamAnswer(){this.waitDestroy(this.offlineExamExportService.apiOfflineExamExportExportResultOfRawExamGet(this.examObj?.hashId??"").subscribe(C=>{if(!C.success)return this.errorStatusObj(C.message??"");let b=C.data?.obj;b?.offlineMixQuestionObjs&&b.offlineMixQuestionObjs.length>0&&(this.exportExcelData=this.commonService.myClone(b))}))}exportDataDone(C){const b=this.createNameExam("answerexcel",!1);this.shareFileFlutterService.shareFileWithBlob(C,b)}redirectToDownloadExamPdf(C){window.open(this.commonService.getLocalRouter(`/admin/testbank/export-exam-to-pdf/${this.examObj?.id}?isShowExplain=${C}`),"_blank")}getConfigExam(){const C=this.data?.globalLadingPage?this.documentConfigService.apiDocumentConfigGetGlobalExamConfigDataGet(this.examObj?.hashId??""):this.documentConfigService.apiDocumentConfigGetExamConfigDataV2Get(this.examObj?.hashId??"");this.waitDestroy(C.subscribe(b=>{if(!b.success)return this.errorStatusObj(b.message,!1);let y=0,R=0;this.questionList.forEach((B,ee)=>{B.labelIndex=ee,b.data?.resetQuestionIndex&&B.groupInfo&&B.groupInfo.groupId&&(y!=B.groupInfo.groupId&&(y=B.groupInfo.groupId,R=0),B.labelIndex=R,R++)}),this.successStatusObj()}))}getData(C){this.initStatusObj();const b=this.data?.globalLadingPage?this.examService.apiExamGetGlobalQuestionsIdGet(C?.id??0):this.permissionService.hasViewPermission("exam",C)?this.examService.apiExamGetQuestionsIdGet(C?.id??0):void 0;if(!b)return this.showErrorSnack("lang_auto_ban_khong_co_quyen_thuc_thi_chuc_nang_nay");b.subscribe(y=>{const R=this.commonService.castJsonToClassObjs(e.I,JSON.stringify(y.data?.questionObjs||[]))??[];this.followerRenderQuest.setNumQuest(R.length),R.forEach(B=>{B.isRoleTeacher=!0}),this.cloneQuestionList=this.commonService.myClone(R),this.questionList=R,this.examObj=y.data?.examObj,this.getConfigExam()})}createNameExam(C,b){const y=this.examObj?.name??"";let R;switch(C){case"answersheet":R=this.printAnswersheetService.exportFileNameOfAnswerSheet(0,y,"");break;case"answerexcel":R=this.printAnswersheetService.exportFileNameOfAnswerExcelOffline(0,y,"");break;default:R=this.printAnswersheetService.exportFileNameOfExamOffline(0,y,"",void 0)}return b&&(R=this.commonService.replaceAll(R,"_","-")??""),R+("answersheet"===C?".pdf":"answerexcel"===C?".xlsx":".docx")}ngOnChanges(){this.data?.obj&&this.getData(this.data.obj)}ngOnInit(){super.ngOnInit(),this.data?.obj&&this.getData(this.data.obj)}constructor(C,b,y,R,B,ee,ae,oe,se){super(se,oe),this.documentConfigService=C,this.shareFileFlutterService=b,this.permissionService=y,this.exportSAztDocxService=R,this.examService=B,this.offlineExamExportService=ee,this.printAnswersheetService=ae,this.dialogRef=oe,this.data=se,this.closeDialog=new t.bkB,this.questionList=[],this.cloneQuestionList=[],this.followerRenderQuest=new o.e,this.printAddInfo={},this.showExplanation=!1}}return(j=$).\u0275fac=function(C){return new(C||j)(t.rXU(U.x_),t.rXU(c.R),t.rXU(d.p),t.rXU(_.c),t.rXU(D.R),t.rXU(k.qG),t.rXU(s.Q),t.rXU(r.CP,8),t.rXU(r.Vh,8))},j.\u0275cmp=t.VBU({type:j,selectors:[["azt-preview-exam"]],outputs:{closeDialog:"closeDialog"},features:[t.Vt3,t.OA$],decls:29,vars:35,consts:[["menuDownload","matMenu"],[4,"ngIf"],[1,"dropdown-menu","show","relative","w-72"],[1,"dropdown-content"],[3,"checkAction","closeDialog","vipPackageType","classCSSCustom","isShowBadgeVip","isAction","trackingKey"],["name","file-check","size","16",3,"ngClass"],[1,"mr-3"],["name","file-text","size","16",3,"ngClass"],["azt-track-service","azt-preview-exam-ef7yEq6a3",1,"dropdown-item",3,"click"],["name","file-down","size","16",3,"ngClass"],["azt-track-service","azt-preview-exam--mJB2JKFgNu",1,"dropdown-item",3,"click"],["name","file-spreadsheet","size","16",3,"ngClass"],[3,"startQuestionIndex","obj","exportDataDone",4,"ngIf"],[1,"az-dialog-info"],[1,"box",2,"overflow-x","hidden"],[1,"flex","items-center","p-2","bg-slate-100","dark:bg-darkmode-400"],[1,"mr-auto"],[1,"flex","items-center","mr-2"],["class","btn btn-sm btn-outline-secondary btn-transparent mr-2",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["azt-track-service","azt-preview-exam-dgdyLZO48Hq","class","btn btn-sm btn-outline-secondary btn-transparent mr-2",3,"matTooltip","cdkCopyToClipboard","click",4,"ngIf"],["azt-track-service","azt-preview-exam-WEwBr57UW",1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"click"],[1,"ml-auto"],["azt-track-service","azt-preview-exam-y2xqBN7DlGX",1,"btn","btn-transparent","btn-outline-danger","btn-sm",3,"mat-dialog-close"],[1,"w-4","h-4","flex-none"],["name","x","size","18"],[1,"mt-3",3,"defaultHeight"],["class","flex justify-center items-center h-40",4,"ngIf"],["id","boxContentQuestion",1,"p-2"],[1,"pt-3"],["class","box p-3 mb-3",4,"ngIf"],["style","display: block","class","mt-5",3,"imgSrc",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"py-5"],[1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"matTooltip","matMenuTriggerFor"],["name","download","size","18"],["azt-track-service","azt-preview-exam-dgdyLZO48Hq",1,"btn","btn-sm","btn-outline-secondary","btn-transparent","mr-2",3,"click","matTooltip","cdkCopyToClipboard"],[1,"w-4","h-4","mr-2","flex-none"],["name","copy","size","18"],[1,"flex","justify-center","items-center","h-40"],[1,"w-4","h-4","inline-block"],[1,"sr-only","ml-2"],[1,"box","p-3","mb-3"],[2,"line-height","1.5",3,"innerHtml"],[1,"mt-5",2,"display","block",3,"imgSrc"],[3,"examObj","questionObj","follower","curQuestionIndex","isShowExplain",4,"ngIf"],[3,"examObj","questionObj","follower","curQuestionIndex","isShowExplain"],[3,"exportDataDone","startQuestionIndex","obj"]],template:function(C,b){if(1&C){const y=t.RV6();t.DNE(0,X,24,12,"ng-container",1),t.nI1(1,"viewPermission"),t.j41(2,"mat-menu",null,0)(4,"div",2)(5,"ul",3)(6,"li")(7,"azt-check-vip-account",4),t.bIt("checkAction",function(B){return t.eBV(y),t.Njj(b.downloadExam(B,!1))})("closeDialog",function(B){return t.eBV(y),t.Njj(b.handlerCloseDialog(B))}),t.nrm(8,"lucide-icon",5),t.j41(9,"span",6),t.EFF(10),t.nI1(11,"mytranslate"),t.k0s()()(),t.j41(12,"li")(13,"azt-check-vip-account",4),t.bIt("checkAction",function(B){return t.eBV(y),t.Njj(b.downloadExam(B,!0))})("closeDialog",function(B){return t.eBV(y),t.Njj(b.handlerCloseDialog(B))}),t.nrm(14,"lucide-icon",7),t.j41(15,"span",6),t.EFF(16),t.nI1(17,"mytranslate"),t.k0s()()(),t.j41(18,"li")(19,"a",8),t.bIt("click",function(){return t.eBV(y),t.Njj(b.redirectToDownloadExamPdf(0))}),t.nrm(20,"lucide-icon",9),t.EFF(21),t.nI1(22,"mytranslate"),t.k0s()(),t.j41(23,"li")(24,"a",10),t.bIt("click",function(){return t.eBV(y),t.Njj(b.downloadExamAnswer())}),t.nrm(25,"lucide-icon",11),t.EFF(26),t.nI1(27,"mytranslate"),t.k0s()()()()(),t.DNE(28,H,1,2,"azt-export-excel-for-answersheet",12)}2&C&&(t.Y8G("ngIf",t.i5U(1,20,null==b.data?null:b.data.obj,"exam")||(null==b.data?null:b.data.globalLadingPage)),t.R7$(7),t.Y8G("vipPackageType","VIP_FOR_TEACHER")("classCSSCustom","dropdown-item cursor-pointer")("isShowBadgeVip",!b.isBusinessDomain)("isAction",!0)("trackingKey","DOWNLOAD_EXAM_DOCX_NO_ANSWER"),t.R7$(),t.Y8G("ngClass",t.lJ4(31,O)),t.R7$(2),t.SpI(" ",t.bMT(11,23,"lang_testbank_download_exam_in_docx")," "),t.R7$(3),t.Y8G("vipPackageType","VIP_FOR_TEACHER")("classCSSCustom","dropdown-item cursor-pointer")("isShowBadgeVip",!b.isBusinessDomain)("isAction",!0)("trackingKey","DOWNLOAD_EXAM_DOCX_WITH_ANSWER"),t.R7$(),t.Y8G("ngClass",t.lJ4(32,O)),t.R7$(2),t.SpI(" ",t.bMT(17,25,"lang_azt_download_exam_paper_with_detailed_answers_in_docx")," "),t.R7$(4),t.Y8G("ngClass",t.lJ4(33,O)),t.R7$(),t.SpI(" ",t.bMT(22,27,"lang_auto_tai_xuong_de_thi")+" PDF"," "),t.R7$(4),t.Y8G("ngClass",t.lJ4(34,O)),t.R7$(),t.SpI(" ",t.bMT(27,29,"lang_testbank_download_exam_answer_in_excel")," "),t.R7$(2),t.Y8G("ngIf",null!=b.exportExcelData))},dependencies:[M.YU,M.Sq,M.bT,K.dF,r.tx,E.kk,E.Cp,G.oV,T.WGl,h.H,A.a,V.U,Z.O,q.R,J.F,Q.wp,Q._y,Q.eL],encapsulation:2}),$})()}}]);