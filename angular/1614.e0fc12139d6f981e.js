"use strict";(self.webpackChunkBalacoClient=self.webpackChunkBalacoClient||[]).push([[1614],{43166:(F,S,r)=>{r.d(S,{x:()=>j});var e=r(10936),g=r(48891),L=r(53793);let j=(()=>{var m;class p{filter(a,_){return null==a?[]:a=a.filter(u=>this.removeAllSpecialChars((null!=_?u[_]:u).toString()).includes(this.removeAllSpecialChars(this.searchControl.value)))}mergeSchoolLevel(a){let _=[];return a.forEach(u=>null!=u.schoolLevel&&_.push(u.schoolLevel)),_}removeAllSpecialChars(a){return a=(a=this.commonService.myTranslateInstant(a)??a).toLowerCase().trim(),a=this.commonService.convertVietnameseToEnglish(a),a=this.commonService.removeSpecialStringInSearch(a),(a=this.commonService.removeNonAlphabetic(a)).toLowerCase().trim()}constructor(a){this.commonService=a,this.searchControl=new e.MJ("",{nonNullable:!0})}}return(m=p).\u0275fac=function(a){return new(a||m)(g.rXU(L.R))},m.\u0275dir=g.FsC({type:m,selectors:[["","searchInList",""]],exportAs:["searchInList"]}),p})()},51614:(F,S,r)=>{r.d(S,{X:()=>V});var e=r(48891),g=r(59640),L=r(15255),j=r(39444),m=r(54460),p=r(47426),C=r(95670),a=r(4375),_=r(10936),u=r(44233),O=r(43166),T=r(76975);const y=t=>({grid:t}),k=(t,s)=>({"mt-2":t,"ml-2":s}),D=t=>({width:t});function R(t,s){if(1&t&&e.eu8(0,7),2&t){e.XpG();const l=e.sdS(4);e.Y8G("ngTemplateOutlet",l)}}function B(t,s){if(1&t&&e.eu8(0,7),2&t){e.XpG();const l=e.sdS(6);e.Y8G("ngTemplateOutlet",l)}}function M(t,s){if(1&t&&(e.j41(0,"mat-option",21),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&t){const l=s.$implicit;e.Y8G("value",l.id),e.R7$(),e.SpI(" ",e.bMT(2,2,l.key)," ")}}function $(t,s){if(1&t&&(e.j41(0,"mat-option",21),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&t){const l=s.$implicit;e.Y8G("value",l.id),e.R7$(),e.SpI(" ",e.bMT(2,2,l.key)," ")}}function G(t,s){if(1&t&&(e.qex(0),e.j41(1,"mat-option",21),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s(),e.bVm()),2&t){const l=s.$implicit;e.R7$(),e.Y8G("value",l.id),e.R7$(),e.SpI(" ",e.bMT(3,2,l.title)," ")}}function x(t,s){if(1&t&&(e.j41(0,"div",22)(1,"div",11)(2,"label",23),e.EFF(3),e.nI1(4,"mytranslate"),e.k0s()(),e.j41(5,"mat-form-field",13)(6,"mat-select",14,4)(8,"mat-option"),e.nrm(9,"ngx-mat-select-search",15),e.nI1(10,"mytranslate"),e.nI1(11,"mytranslate"),e.k0s(),e.j41(12,"mat-option",21),e.EFF(13),e.nI1(14,"mytranslate"),e.k0s(),e.DNE(15,G,4,4,"ng-container",24),e.k0s()()()),2&t){const l=e.sdS(7),n=e.XpG(2);e.R7$(3),e.SpI(" ",e.bMT(4,8,"lang_core_sach")," "),e.R7$(3),e.Y8G("formControl",n.form.controls.bookIdFormControl),e.R7$(3),e.FS9("placeholderLabel",e.bMT(10,10,"lang_search_by_name")),e.FS9("noEntriesFoundLabel",e.bMT(11,12,"lang_search_not_found")),e.Y8G("formControl",l.searchControl),e.R7$(3),e.Y8G("value",0),e.R7$(),e.SpI("- ",e.bMT(14,14,"lang_create_tree_category_default_book")," -"),e.R7$(2),e.Y8G("ngForOf",l.filter(n.listBookObjs,"title"))}}function A(t,s){1&t&&(e.j41(0,"div",25)(1,"div",26),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s()()),2&t&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"lang_auto_vui_long_chon_khoi_hoc_va_mon_hoc")," "))}function Y(t,s){if(1&t&&(e.j41(0,"form",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"label",12),e.EFF(5),e.nI1(6,"mytranslate"),e.k0s()(),e.j41(7,"mat-form-field",13)(8,"mat-select",14,2)(10,"mat-option"),e.nrm(11,"ngx-mat-select-search",15),e.nI1(12,"mytranslate"),e.nI1(13,"mytranslate"),e.k0s(),e.j41(14,"mat-option",16),e.EFF(15),e.nI1(16,"mytranslate"),e.k0s(),e.DNE(17,M,3,4,"mat-option",17),e.k0s()()(),e.j41(18,"div",10)(19,"div",11)(20,"label",18),e.EFF(21),e.nI1(22,"mytranslate"),e.k0s()(),e.j41(23,"mat-form-field",13)(24,"mat-select",14,3)(26,"mat-option"),e.nrm(27,"ngx-mat-select-search",15),e.nI1(28,"mytranslate"),e.nI1(29,"mytranslate"),e.k0s(),e.j41(30,"mat-option",16),e.EFF(31),e.nI1(32,"mytranslate"),e.k0s(),e.DNE(33,$,3,4,"mat-option",17),e.k0s()()(),e.DNE(34,x,16,16,"div",19)(35,A,4,3,"div",20),e.k0s()()),2&t){const l=e.sdS(9),n=e.sdS(25),o=e.XpG();e.Y8G("formGroup",o.form),e.R7$(5),e.SpI(" ",e.bMT(6,19,"lang_auto_khoi_hoc")," "),e.R7$(3),e.Y8G("formControl",o.form.controls.schoolLevel),e.R7$(3),e.FS9("placeholderLabel",e.bMT(12,21,"lang_search_by_name")),e.FS9("noEntriesFoundLabel",e.bMT(13,23,"lang_search_not_found")),e.Y8G("formControl",l.searchControl),e.R7$(3),e.Y8G("value",0),e.R7$(),e.SpI("",e.bMT(16,25,"lang_auto_---chon_khoi"),"---"),e.R7$(2),e.Y8G("ngForOf",l.filter(l.mergeSchoolLevel(o.schoolLevelObjs),"key")),e.R7$(4),e.SpI(" ",e.bMT(22,27,"lang_auto_mon_hoc")," "),e.R7$(3),e.Y8G("formControl",o.form.controls.schoolSubject),e.R7$(3),e.FS9("placeholderLabel",e.bMT(28,29,"lang_search_by_name")),e.FS9("noEntriesFoundLabel",e.bMT(29,31,"lang_search_not_found")),e.Y8G("formControl",n.searchControl),e.R7$(3),e.Y8G("value",0),e.R7$(),e.SpI("",e.bMT(32,33,"lang_auto_---chon_mon"),"---"),e.R7$(2),e.Y8G("ngForOf",n.filter(o.schoolSubjectObjs,"key")),e.R7$(),e.Y8G("ngIf",o.form.controls.bookIdFormControl),e.R7$(),e.Y8G("ngIf",o.form.controls.schoolLevel.invalid||o.form.controls.schoolSubject.invalid)}}function P(t,s){if(1&t&&(e.j41(0,"mat-option",21),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&t){const l=s.$implicit;e.Y8G("value",l.id),e.R7$(),e.SpI(" ",e.bMT(2,2,l.key)," ")}}function w(t,s){if(1&t&&(e.j41(0,"mat-option",21),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&t){const l=s.$implicit;e.Y8G("value",l.id),e.R7$(),e.SpI(" ",e.bMT(2,2,l.key)," ")}}function U(t,s){if(1&t&&(e.qex(0),e.j41(1,"mat-option",21),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s(),e.bVm()),2&t){const l=s.$implicit;e.R7$(),e.Y8G("value",l.id),e.R7$(),e.SpI(" ",e.bMT(3,2,l.title)," ")}}function K(t,s){if(1&t&&(e.j41(0,"div",35)(1,"label",36),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s(),e.j41(4,"mat-form-field",30)(5,"mat-select",14,4)(7,"mat-option"),e.nrm(8,"ngx-mat-select-search",15),e.nI1(9,"mytranslate"),e.nI1(10,"mytranslate"),e.k0s(),e.j41(11,"mat-option",21),e.EFF(12),e.nI1(13,"mytranslate"),e.k0s(),e.DNE(14,U,4,4,"ng-container",24),e.k0s()()()),2&t){const l=e.sdS(6),n=e.XpG(2);e.Y8G("ngClass",e.l_i(18,k,n.isMobileDevice,!n.isMobileDevice)),e.R7$(),e.Y8G("ngStyle",e.eq3(21,D,n.isMobileDevice?"54px":"")),e.R7$(),e.SpI(" ",e.bMT(3,10,"lang_core_sach")," "),e.R7$(3),e.Y8G("formControl",n.form.controls.bookIdFormControl),e.R7$(3),e.FS9("placeholderLabel",e.bMT(9,12,"lang_search_by_name")),e.FS9("noEntriesFoundLabel",e.bMT(10,14,"lang_search_not_found")),e.Y8G("formControl",l.searchControl),e.R7$(3),e.Y8G("value",0),e.R7$(),e.SpI("- ",e.bMT(13,16,"lang_create_tree_category_default_book")," -"),e.R7$(2),e.Y8G("ngForOf",l.filter(n.listBookObjs,"title"))}}function N(t,s){1&t&&(e.j41(0,"div",37)(1,"div",26),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s()()),2&t&&(e.R7$(2),e.SpI(" ",e.bMT(3,1,"lang_auto_vui_long_chon_khoi_hoc_va_mon_hoc")," "))}function W(t,s){if(1&t&&(e.j41(0,"form",8)(1,"div",27)(2,"div",28)(3,"label",29),e.EFF(4),e.nI1(5,"mytranslate"),e.k0s(),e.j41(6,"mat-form-field",30)(7,"mat-select",14,2)(9,"mat-option"),e.nrm(10,"ngx-mat-select-search",15),e.nI1(11,"mytranslate"),e.nI1(12,"mytranslate"),e.k0s(),e.j41(13,"mat-option",16),e.EFF(14),e.nI1(15,"mytranslate"),e.k0s(),e.DNE(16,P,3,4,"mat-option",17),e.k0s()()(),e.j41(17,"div",31)(18,"label",32),e.EFF(19),e.nI1(20,"mytranslate"),e.k0s(),e.j41(21,"mat-form-field",30)(22,"mat-select",14,3)(24,"mat-option"),e.nrm(25,"ngx-mat-select-search",15),e.nI1(26,"mytranslate"),e.nI1(27,"mytranslate"),e.k0s(),e.j41(28,"mat-option",16),e.EFF(29),e.nI1(30,"mytranslate"),e.k0s(),e.DNE(31,w,3,4,"mat-option",17),e.k0s()()(),e.DNE(32,K,15,23,"div",33),e.k0s(),e.DNE(33,N,4,3,"div",34),e.k0s()),2&t){const l=e.sdS(8),n=e.sdS(23),o=e.XpG();e.Y8G("formGroup",o.form),e.R7$(),e.Y8G("ngClass",e.eq3(37,y,!o.isMobileDevice)),e.R7$(3),e.SpI(" ",e.bMT(5,21,"lang_auto_khoi_hoc")," "),e.R7$(3),e.Y8G("formControl",o.form.controls.schoolLevel),e.R7$(3),e.FS9("placeholderLabel",e.bMT(11,23,"lang_search_by_name")),e.FS9("noEntriesFoundLabel",e.bMT(12,25,"lang_search_not_found")),e.Y8G("formControl",l.searchControl),e.R7$(3),e.Y8G("value",0),e.R7$(),e.SpI("",e.bMT(15,27,"lang_auto_---chon_khoi"),"---"),e.R7$(2),e.Y8G("ngForOf",l.filter(l.mergeSchoolLevel(o.schoolLevelObjs),"key")),e.R7$(),e.Y8G("ngClass",e.l_i(39,k,o.isMobileDevice,!o.isMobileDevice)),e.R7$(2),e.SpI(" ",e.bMT(20,29,"lang_auto_mon_hoc")," "),e.R7$(3),e.Y8G("formControl",o.form.controls.schoolSubject),e.R7$(3),e.FS9("placeholderLabel",e.bMT(26,31,"lang_search_by_name")),e.FS9("noEntriesFoundLabel",e.bMT(27,33,"lang_search_not_found")),e.Y8G("formControl",n.searchControl),e.R7$(3),e.Y8G("value",0),e.R7$(),e.SpI("",e.bMT(30,35,"lang_auto_---chon_mon"),"---"),e.R7$(2),e.Y8G("ngForOf",n.filter(o.schoolSubjectObjs,"key")),e.R7$(),e.Y8G("ngIf",o.form.controls.bookIdFormControl),e.R7$(),e.Y8G("ngIf",o.form.controls.schoolLevel.invalid||o.form.controls.schoolSubject.invalid)}}let V=(()=>{var t;class s extends g.H{getChangeKey(){let n=this.form.getRawValue();return n.schoolLevel+"_"+n.schoolSubject+"_"+(n.bookIdFormControl??0)}updateLevelAndSubjectToForm(n,o,i){let f=this.commonService.concatMultipleArray(this.schoolLevelObjs.map(c=>c.schoolSubjectObjs)).find(c=>c.id==o)?.key,b=this.schoolLevelObjs.find(c=>c.schoolLevel?.id==n);this.schoolSubjectObjs=b?.schoolSubjectObjs??[];let h=this.schoolSubjectObjs.find(c=>c.id==o||c.key?.toLowerCase()==f?.toLowerCase());n=b?.schoolLevel?.id??0,o=h?.id??0,i=i??0;let v=this.form.getRawValue();v.schoolLevel!=n&&this.form.controls.schoolLevel.setValue(n,{emitEvent:!1}),v.schoolSubject!=o&&this.form.controls.schoolSubject.setValue(o,{emitEvent:!1}),v.bookIdFormControl!=i&&this.form.controls.bookIdFormControl?.setValue(i,{emitEvent:!1}),(0!=n||0!=o||0!=i)&&this.getBookObjs(n,o,i,c=>{let d=this.form.getRawValue();if(d.schoolLevel!=c.schoolLevelId||d.schoolSubject!=c.schoolSubjectId||(d.bookIdFormControl??0)!=c.bookId)return;this.listBookObjs=c.books;let I=this.listBookObjs.find(z=>z.id==i);i=I?.id??0,this.showBookData&&d.bookIdFormControl!=i&&this.form.controls.bookIdFormControl?.setValue(i,{emitEvent:!1});let E=this.getChangeKey();this.lastChangeKey!=E&&(this.lastChangeKey=E,this.changeDataEvent.emit({bookName:I?.title}))})}getBookObjs(n,o,i,f){if(!this.showBookData)return f({schoolLevelId:n,schoolSubjectId:o,bookId:i,books:[]});if(!n||!o)return f({schoolLevelId:n,schoolSubjectId:o,bookId:i,books:[]});let b=this.listBookByLevelSubject.find(h=>h.levelId==n&&h.subjectId==o);if(null!=b)return f({schoolLevelId:n,schoolSubjectId:o,bookId:i,books:b.books});this.isLoadingBook=!0,this.waitDestroy(this.wrapApiResponse(this.aiElearningService.aiApiV1ElearningGetElearningBookGet(n,o)).subscribe(h=>{if(!h.success)return this.isLoadingBook=!1,this.errorStatusObj(h.message,!0),f({schoolLevelId:n,schoolSubjectId:o,bookId:i,books:[]});h.data=h.data?.filter(v=>v.isActive),this.listBookByLevelSubject.push({levelId:n,subjectId:o,books:h.data??[]}),this.isLoadingBook=!1,f({schoolLevelId:n,schoolSubjectId:o,bookId:i,books:h.data??[]})}))}getSubjectAndLevel(){this.initStatusObj(),this.waitDestroy(this.commonListService.apiCommonListSubjectAndLevelsGet(this.commonService.getBusinessDomainUrl()).subscribe(n=>{if(!n.success)return this.errorStatusObj(n.message,!0);if(this.schoolLevelObjs=n.data?.schoolLevelSubjectObjs??[],this.removeLevelSubjectWithOtherName&&(this.schoolLevelObjs=this.schoolLevelObjs.filter(o=>"azt_lang_core_khoi_khac"!=o.schoolLevel?.key),this.schoolLevelObjs.forEach(o=>o.schoolSubjectObjs=o.schoolSubjectObjs.filter(i=>"azt_auto_lang_khac"!=i.key))),this.useExamSchoolLogData&&0==this.form.controls.schoolLevel.value)return this.updateLevelAndSubjectToForm(n.data?.examSchoolLogObj?.lastSchoolLevelId??0,n.data?.examSchoolLogObj?.lastSchoolSubjectId??0,void 0),this.stopStatusObj();if(this.useFirstAsDefault&&0==this.form.controls.schoolLevel.value){let o=this.commonService.getLastOfArray(this.schoolLevelObjs),i=this.commonService.getFirstOfArray(o?.schoolSubjectObjs??[]);if(o&&i)return this.updateLevelAndSubjectToForm(o.schoolLevel?.id??0,i.id,this.form.controls.bookIdFormControl?.value),this.stopStatusObj()}this.updateLevelAndSubjectToForm(this.form.controls.schoolLevel.value,this.form.controls.schoolSubject.value,this.form.controls.bookIdFormControl?.value),this.stopStatusObj()}))}listenChangeLevelSubjectBook(){this.form.controls.schoolLevel.valueChanges.subscribe(n=>{let o=this.form.getRawValue();this.updateLevelAndSubjectToForm(o.schoolLevel,o.schoolSubject,o.bookIdFormControl)}),this.form.controls.schoolSubject.valueChanges.subscribe(n=>{let o=this.form.getRawValue();this.updateLevelAndSubjectToForm(o.schoolLevel,o.schoolSubject,o.bookIdFormControl)}),this.form.controls.bookIdFormControl?.valueChanges.subscribe(n=>{let o=this.form.getRawValue();this.updateLevelAndSubjectToForm(o.schoolLevel,o.schoolSubject,o.bookIdFormControl)})}ngOnInit(){this.listenChangeLevelSubjectBook(),this.getSubjectAndLevel()}constructor(n,o){super(),this.commonListService=n,this.aiElearningService=o,this.removeLevelSubjectWithOtherName=!1,this.showBookData=!1,this.useExamSchoolLogData=!1,this.useFirstAsDefault=!1,this.layout="default",this.changeDataEvent=new e.bkB,this.schoolLevelObjs=[],this.schoolSubjectObjs=[],this.listBookObjs=[],this.lastChangeKey=void 0,this.listBookByLevelSubject=[],this.isLoadingBook=!1}}return(t=s).\u0275fac=function(n){return new(n||t)(e.rXU(L.Nz),e.rXU(j.T5))},t.\u0275cmp=e.VBU({type:t,selectors:[["config-level-subject-book"]],inputs:{form:"form",removeLevelSubjectWithOtherName:"removeLevelSubjectWithOtherName",showBookData:"showBookData",useExamSchoolLogData:"useExamSchoolLogData",useFirstAsDefault:"useFirstAsDefault",layout:"layout"},outputs:{changeDataEvent:"changeDataEvent"},features:[e.Vt3],decls:7,vars:2,consts:[["defaultLayoutTpl",""],["labelInOneLineTpl",""],["searchInListSchoolLevel","searchInList"],["searchInListSchoolSubject","searchInList"],["searchInListBook","searchInList"],[1,"config-level-subject"],[3,"ngTemplateOutlet",4,"ngIf"],[3,"ngTemplateOutlet"],[3,"formGroup"],["id","azt-config-level-subject",1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","lg:col-span-6"],[1,"font-medium"],["for","schoolLevel",1,"form-label","flex","items-center"],["appearance","outline"],["searchInList","",3,"formControl"],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["for","schoolSubject",1,"form-label","flex","items-center"],["class","col-span-12",4,"ngIf"],["class","col-span-12","style","margin-top: -20px",4,"ngIf"],[3,"value"],[1,"col-span-12"],["for","bookSelected",1,"form-label","flex","items-center"],[4,"ngFor","ngForOf"],[1,"col-span-12",2,"margin-top","-20px"],[1,"text-xs","mt-2","text-danger"],["id","azt-config-level-subject",1,"grid-cols-12","gap-4",3,"ngClass"],[1,"col-span-3","flex","items-center"],["for","schoolLevel",1,"mr-1","flex-none","whitespace-nowrap"],["appearance","outline",1,"box",2,"width","100%"],[1,"col-span-4","flex","items-center",3,"ngClass"],["for","schoolSubject",1,"mr-1","whitespace-nowrap","flex-none"],["class","col-span-5 flex items-center",3,"ngClass",4,"ngIf"],["style","margin-top: -20px",4,"ngIf"],[1,"col-span-5","flex","items-center",3,"ngClass"],["for","bookSelected",1,"mr-1","flex-none","whitespace-nowrap",3,"ngStyle"],[2,"margin-top","-20px"]],template:function(n,o){1&n&&(e.j41(0,"div",5),e.DNE(1,R,1,1,"ng-container",6)(2,B,1,1,"ng-container",6),e.k0s(),e.DNE(3,Y,36,35,"ng-template",null,0,e.C5r)(5,W,34,42,"ng-template",null,1,e.C5r)),2&n&&(e.R7$(),e.Y8G("ngIf","default"==o.layout),e.R7$(),e.Y8G("ngIf","label_in_one_line"==o.layout))},dependencies:[m.YU,m.Sq,m.bT,m.T3,m.B3,p.wT,C.rl,a.VO,_.qT,_.BC,_.cb,_.l_,_.j4,u.U9,O.x,T.wp],encapsulation:2}),s})()}}]);