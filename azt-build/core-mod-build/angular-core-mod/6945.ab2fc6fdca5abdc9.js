"use strict";(self.webpackChunkCoreMod=self.webpackChunkCoreMod||[]).push([[6945],{99503:(J,F,d)=>{d.d(F,{fb:()=>N,ij:()=>D});var p=d(81519),i=d(48891),T=d(20381),k=d.n(T),j=d(543);const C=k()||T,D=new i.nKC("MAT_MOMENT_DATE_ADAPTER_OPTIONS",{providedIn:"root",factory:function V(){return{useUtc:!1}}});function L(M,z){const O=Array(M);for(let s=0;s<M;s++)O[s]=z(s);return O}let N=(()=>{var M;class z extends p.$O{constructor(s){super(),this._options=s,this.commonService=(0,i.WQX)(j.R),this._localeData={firstDayOfWeek:0,longMonths:"",shortMonths:"",dates:"",longDaysOfWeek:"",shortDaysOfWeek:"",narrowDaysOfWeek:""},C.locale(),this.setLocale(this.commonService.getCurrentLang()||C.locale())}setLocale(s){super.setLocale(s);const m=C.localeData(s);this._localeData={firstDayOfWeek:m.firstDayOfWeek(),longMonths:m.months(),shortMonths:m.monthsShort(),dates:L(31,_=>this.createDate(2017,0,_+1).format("D")),longDaysOfWeek:m.weekdays(),shortDaysOfWeek:m.weekdaysShort(),narrowDaysOfWeek:m.weekdaysMin()}}getYear(s){return this.clone(s).year()}getMonth(s){return this.clone(s).month()}getDate(s){return this.clone(s).date()}getDayOfWeek(s){return this.clone(s).day()}getMonthNames(s){return"long"===s?this._localeData.longMonths:this._localeData.shortMonths}getDateNames(){return this._localeData.dates}getDayOfWeekNames(s){return"long"===s?this._localeData.longDaysOfWeek:"short"===s?this._localeData.shortDaysOfWeek:this._localeData.narrowDaysOfWeek}getYearName(s){return this.clone(s).format("YYYY")}getFirstDayOfWeek(){return this._localeData.firstDayOfWeek}getNumDaysInMonth(s){return this.clone(s).daysInMonth()}clone(s){return s.clone().locale(this.locale)}createDate(s,m,_){if(m<0||m>11)throw Error(`Invalid month index "${m}". Month index has to be between 0 and 11.`);if(_<1)throw Error(`Invalid date "${_}". Date has to be greater than 0.`);const v=this._createMoment({year:s,month:m,date:_}).locale(this.locale);if(!v.isValid())throw Error(`Invalid date "${_}" for month with index "${m}".`);return v}today(){return this._createMoment().locale(this.locale)}parse(s,m){return s&&"string"==typeof s?this._createMoment(s,m,this.locale):s?this._createMoment(s).locale(this.locale):null}format(s,m){if(s=this.clone(s),!this.isValid(s))throw Error("MomentDateAdapter: Cannot format invalid date.");return s.format(m)}addCalendarYears(s,m){return this.clone(s).add({years:m})}addCalendarMonths(s,m){return this.clone(s).add({months:m})}addCalendarDays(s,m){return this.clone(s).add({days:m})}toIso8601(s){return this.clone(s).format()}deserialize(s){let m;if(s instanceof Date)m=this._createMoment(s).locale(this.locale);else if(this.isDateInstance(s))return this.clone(s);if("string"==typeof s){if(!s)return null;m=this._createMoment(s,C.ISO_8601).locale(this.locale)}return m&&this.isValid(m)?this._createMoment(m).locale(this.locale):super.deserialize(s)}isDateInstance(s){return C.isMoment(s)}isValid(s){return this.clone(s).isValid()}invalid(){return C.invalid()}getHour(s){return s.hours()}getMinute(s){return s.minutes()}getSecond(s){return s.seconds()}setHour(s,m){s.hours(m)}setMinute(s,m){s.minutes(m)}setSecond(s,m){s.seconds(m)}_createMoment(s,m,_){const{strict:v,useUtc:E}=this._options||{};return E?C.utc(s,m,_,v):C(s,m,_,v)}}return(M=z).\u0275fac=function(s){return new(s||M)(i.KVO(D,8))},M.\u0275prov=i.jDH({token:M,factory:M.\u0275fac}),z})()},99203:(J,F,d)=>{d.d(F,{y:()=>Mt});var p=d(54460),i=d(48891),T=d(10936),k=d(65162),j=d(15343),C=d(73014),D=d(86388);const V=["wrapper"],L=["sourceImage"];function N(c,h){if(1&c){const t=i.RV6();i.j41(0,"img",5,1),i.bIt("load",function(){i.eBV(t);const a=i.XpG();return i.Njj(a.imageLoadedInView())})("mousedown",function(a){i.eBV(t);const n=i.XpG();return i.Njj(n.startMove(a,n.moveTypes.Drag))})("touchstart",function(a){i.eBV(t);const n=i.XpG();return i.Njj(n.startMove(a,n.moveTypes.Drag))})("error",function(a){i.eBV(t);const n=i.XpG();return i.Njj(n.loadImageError(a))}),i.k0s()}if(2&c){const t=i.XpG();i.xc7("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),i.AVh("ngx-ic-draggable",!t.disabled&&t.allowMoveImage),i.Y8G("src",t.safeImgDataUrl,i.B4B),i.BMQ("alt",t.imageAltText)}}function M(c,h){if(1&c){const t=i.RV6();i.qex(0),i.j41(1,"span",9),i.bIt("mousedown",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"topleft"))})("touchstart",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"topleft"))}),i.nrm(2,"span",10),i.k0s(),i.j41(3,"span",11),i.nrm(4,"span",10),i.k0s(),i.j41(5,"span",12),i.bIt("mousedown",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"topright"))})("touchstart",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"topright"))}),i.nrm(6,"span",10),i.k0s(),i.j41(7,"span",13),i.nrm(8,"span",10),i.k0s(),i.j41(9,"span",14),i.bIt("mousedown",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"bottomright"))})("touchstart",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"bottomright"))}),i.nrm(10,"span",10),i.k0s(),i.j41(11,"span",15),i.nrm(12,"span",10),i.k0s(),i.j41(13,"span",16),i.bIt("mousedown",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"bottomleft"))})("touchstart",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"bottomleft"))}),i.nrm(14,"span",10),i.k0s(),i.j41(15,"span",17),i.nrm(16,"span",10),i.k0s(),i.j41(17,"span",18),i.bIt("mousedown",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"top"))})("touchstart",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"top"))}),i.k0s(),i.j41(18,"span",19),i.bIt("mousedown",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"right"))})("touchstart",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"right"))}),i.k0s(),i.j41(19,"span",20),i.bIt("mousedown",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"bottom"))})("touchstart",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"bottom"))}),i.k0s(),i.j41(20,"span",21),i.bIt("mousedown",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"left"))})("touchstart",function(a){i.eBV(t);const n=i.XpG(2);return i.Njj(n.startMove(a,n.moveTypes.Resize,"left"))}),i.k0s(),i.bVm()}}function z(c,h){if(1&c){const t=i.RV6();i.j41(0,"div",6),i.bIt("keydown",function(a){i.eBV(t);const n=i.XpG();return i.Njj(n.keyboardAccess(a))}),i.j41(1,"div",7),i.bIt("mousedown",function(a){i.eBV(t);const n=i.XpG();return i.Njj(n.startMove(a,n.moveTypes.Move))})("touchstart",function(a){i.eBV(t);const n=i.XpG();return i.Njj(n.startMove(a,n.moveTypes.Move))}),i.k0s(),i.DNE(2,M,21,0,"ng-container",8),i.k0s()}if(2&c){const t=i.XpG();i.xc7("top",t.cropper.y1,"px")("left",t.cropper.x1,"px")("width",t.cropper.x2-t.cropper.x1,"px")("height",t.cropper.y2-t.cropper.y1,"px")("margin-left","center"===t.alignImage?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),i.AVh("ngx-ic-round",t.roundCropper),i.R7$(2),i.Y8G("ngIf",!t.hideResizeSquares)}}class O{constructor(){this.format="png",this.output="blob",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(h){Object.keys(h).filter(t=>t in this).forEach(t=>this[t]=h[t]),this.validateOptions()}setOptionsFromChanges(h){Object.keys(h).filter(t=>t in this).forEach(t=>this[t]=h[t].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var s=function(c){return c.Drag="drag",c.Move="move",c.Resize="resize",c.Pinch="pinch",c}(s||{});function S(c,h){return c/100*h}let b=(()=>{class c{crop(t,e,a,n,r){const o=this.getImagePosition(t,e,a,n),l=o.x2-o.x1,u=o.y2-o.y1,f=document.createElement("canvas");f.width=l,f.height=u;const g=f.getContext("2d");if(!g)return null;null!=n.backgroundColor&&(g.fillStyle=n.backgroundColor,g.fillRect(0,0,l,u));const x=(n.transform.scale||1)*(n.transform.flipH?-1:1),I=(n.transform.scale||1)*(n.transform.flipV?-1:1),{translateH:A,translateV:B}=this.getCanvasTranslate(t,e,n),R=e.transformed;g.setTransform(x,0,0,I,R.size.width/2+A,R.size.height/2+B),g.translate(-o.x1/x,-o.y1/I),g.rotate((n.transform.rotate||0)*Math.PI/180),g.drawImage(R.image,-R.size.width/2,-R.size.height/2);const w={width:l,height:u,imagePosition:o,cropperPosition:{...a}};n.containWithinAspectRatio&&(w.offsetImagePosition=this.getOffsetImagePosition(t,e,a,n));const y=this.getResizeRatio(l,u,n);return 1!==y&&(w.width=Math.round(l*y),w.height=n.maintainAspectRatio?Math.round(w.width/n.aspectRatio):Math.round(u*y),function E(c,h,t){const e=c.width,a=c.height,n=e/(h=Math.round(h)),r=a/(t=Math.round(t)),o=Math.ceil(n/2),l=Math.ceil(r/2),u=c.getContext("2d");if(u){const f=u.getImageData(0,0,e,a),g=u.createImageData(h,t),x=f.data,I=g.data;for(let A=0;A<t;A++)for(let B=0;B<h;B++){const R=4*(B+A*h),w=A*r;let y=0,P=0,Z=0,q=0,tt=0,et=0,it=0;const At=Math.floor(B*n),yt=Math.floor(A*r);let K=Math.ceil((B+1)*n),$=Math.ceil((A+1)*r);K=Math.min(K,e),$=Math.min($,a);for(let G=yt;G<$;G++){const at=Math.abs(w-G)/l,vt=B*n,bt=at*at;for(let Y=At;Y<K;Y++){const nt=Math.abs(vt-Y)/o,U=Math.sqrt(bt+nt*nt);if(U>=1)continue;y=2*U*U*U-3*U*U+1;const H=4*(Y+G*e);it+=y*x[H+3],Z+=y,x[H+3]<255&&(y=y*x[H+3]/250),q+=y*x[H],tt+=y*x[H+1],et+=y*x[H+2],P+=y}}I[R]=q/P,I[R+1]=tt/P,I[R+2]=et/P,I[R+3]=it/Z}c.width=h,c.height=t,u.putImageData(g,0,0)}}(f,w.width,w.height)),"blob"===r?this.cropToBlob(w,f,n):(w.base64=f.toDataURL("image/"+n.format,this.getQuality(n)),w)}cropToBlob(t,e,a){var n=this;return(0,C.A)(function*(){return t.blob=yield new Promise(r=>e.toBlob(r,"image/"+a.format,n.getQuality(a))),t.blob&&(t.objectUrl=URL.createObjectURL(t.blob)),t})()}getCanvasTranslate(t,e,a){if("px"===a.transform.translateUnit){const n=this.getRatio(t,e);return{translateH:(a.transform.translateH||0)*n,translateV:(a.transform.translateV||0)*n}}return{translateH:a.transform.translateH?S(a.transform.translateH,e.transformed.size.width):0,translateV:a.transform.translateV?S(a.transform.translateV,e.transformed.size.height):0}}getRatio(t,e){return e.transformed.size.width/t.nativeElement.offsetWidth}getImagePosition(t,e,a,n){const r=this.getRatio(t,e),o={x1:Math.round(a.x1*r),y1:Math.round(a.y1*r),x2:Math.round(a.x2*r),y2:Math.round(a.y2*r)};return n.containWithinAspectRatio||(o.x1=Math.max(o.x1,0),o.y1=Math.max(o.y1,0),o.x2=Math.min(o.x2,e.transformed.size.width),o.y2=Math.min(o.y2,e.transformed.size.height)),o}getOffsetImagePosition(t,e,a,n){const l=e.transformed.size.width/t.nativeElement.offsetWidth;let u,f;(n.canvasRotation+e.exifTransform.rotate)%2?(u=(e.transformed.size.width-e.original.size.height)/2,f=(e.transformed.size.height-e.original.size.width)/2):(u=(e.transformed.size.width-e.original.size.width)/2,f=(e.transformed.size.height-e.original.size.height)/2);const g={x1:Math.round(a.x1*l)-u,y1:Math.round(a.y1*l)-f,x2:Math.round(a.x2*l)-u,y2:Math.round(a.y2*l)-f};return n.containWithinAspectRatio||(g.x1=Math.max(g.x1,0),g.y1=Math.max(g.y1,0),g.x2=Math.min(g.x2,e.transformed.size.width),g.y2=Math.min(g.y2,e.transformed.size.height)),g}getResizeRatio(t,e,a){const n=a.resizeToWidth/t,r=a.resizeToHeight/e,o=new Array;a.resizeToWidth>0&&o.push(n),a.resizeToHeight>0&&o.push(r);const l=0===o.length?1:Math.min(...o);return l>1&&!a.onlyScaleDown?l:Math.min(l,1)}getQuality(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275prov=i.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),c})(),X=(()=>{class c{resetCropperPosition(t,e,a){if(!t?.nativeElement)return;const n=t.nativeElement;if(a.cropperStaticHeight&&a.cropperStaticWidth)e.x1=0,e.x2=n.offsetWidth>a.cropperStaticWidth?a.cropperStaticWidth:n.offsetWidth,e.y1=0,e.y2=n.offsetHeight>a.cropperStaticHeight?a.cropperStaticHeight:n.offsetHeight;else{const r=Math.min(a.cropperScaledMaxWidth,n.offsetWidth),o=Math.min(a.cropperScaledMaxHeight,n.offsetHeight);if(a.maintainAspectRatio)if(n.offsetWidth/a.aspectRatio<n.offsetHeight){e.x1=0,e.x2=r;const l=r/a.aspectRatio;e.y1=(n.offsetHeight-l)/2,e.y2=e.y1+l}else{e.y1=0,e.y2=o;const l=o*a.aspectRatio;e.x1=(n.offsetWidth-l)/2,e.x2=e.x1+l}else e.x1=0,e.x2=r,e.y1=0,e.y2=o}}move(t,e,a){const n=this.getClientX(t)-e.clientX,r=this.getClientY(t)-e.clientY;a.x1=e.x1+n,a.y1=e.y1+r,a.x2=e.x2+n,a.y2=e.y2+r}resize(t,e,a,n,r){const o=this.getClientX(t)-e.clientX,l=this.getClientY(t)-e.clientY;switch(e.position){case"left":a.x1=Math.min(Math.max(e.x1+o,a.x2-r.cropperScaledMaxWidth),a.x2-r.cropperScaledMinWidth);break;case"topleft":a.x1=Math.min(Math.max(e.x1+o,a.x2-r.cropperScaledMaxWidth),a.x2-r.cropperScaledMinWidth),a.y1=Math.min(Math.max(e.y1+l,a.y2-r.cropperScaledMaxHeight),a.y2-r.cropperScaledMinHeight);break;case"top":a.y1=Math.min(Math.max(e.y1+l,a.y2-r.cropperScaledMaxHeight),a.y2-r.cropperScaledMinHeight);break;case"topright":a.x2=Math.max(Math.min(e.x2+o,a.x1+r.cropperScaledMaxWidth),a.x1+r.cropperScaledMinWidth),a.y1=Math.min(Math.max(e.y1+l,a.y2-r.cropperScaledMaxHeight),a.y2-r.cropperScaledMinHeight);break;case"right":a.x2=Math.max(Math.min(e.x2+o,a.x1+r.cropperScaledMaxWidth),a.x1+r.cropperScaledMinWidth);break;case"bottomright":a.x2=Math.max(Math.min(e.x2+o,a.x1+r.cropperScaledMaxWidth),a.x1+r.cropperScaledMinWidth),a.y2=Math.max(Math.min(e.y2+l,a.y1+r.cropperScaledMaxHeight),a.y1+r.cropperScaledMinHeight);break;case"bottom":a.y2=Math.max(Math.min(e.y2+l,a.y1+r.cropperScaledMaxHeight),a.y1+r.cropperScaledMinHeight);break;case"bottomleft":a.x1=Math.min(Math.max(e.x1+o,a.x2-r.cropperScaledMaxWidth),a.x2-r.cropperScaledMinWidth),a.y2=Math.max(Math.min(e.y2+l,a.y1+r.cropperScaledMaxHeight),a.y1+r.cropperScaledMinHeight);break;case"center":const u=t.scale,f=Math.min(Math.max(r.cropperScaledMinWidth,Math.abs(e.x2-e.x1)*u),r.cropperScaledMaxWidth),g=Math.min(Math.max(r.cropperScaledMinHeight,Math.abs(e.y2-e.y1)*u),r.cropperScaledMaxHeight);a.x1=e.clientX-f/2,a.x2=e.clientX+f/2,a.y1=e.clientY-g/2,a.y2=e.clientY+g/2,a.x1<0?(a.x2-=a.x1,a.x1=0):a.x2>n.width&&(a.x1-=a.x2-n.width,a.x2=n.width),a.y1<0?(a.y2-=a.y1,a.y1=0):a.y2>n.height&&(a.y1-=a.y2-n.height,a.y2=n.height)}r.maintainAspectRatio&&this.checkAspectRatio(e.position,a,n,r)}checkAspectRatio(t,e,a,n){let r=0,o=0;switch(t){case"top":e.x2=e.x1+(e.y2-e.y1)*n.aspectRatio,r=Math.max(e.x2-a.width,0),o=Math.max(0-e.y1,0),(r>0||o>0)&&(e.x2-=o*n.aspectRatio>r?o*n.aspectRatio:r,e.y1+=o*n.aspectRatio>r?o:r/n.aspectRatio);break;case"bottom":e.x2=e.x1+(e.y2-e.y1)*n.aspectRatio,r=Math.max(e.x2-a.width,0),o=Math.max(e.y2-a.height,0),(r>0||o>0)&&(e.x2-=o*n.aspectRatio>r?o*n.aspectRatio:r,e.y2-=o*n.aspectRatio>r?o:r/n.aspectRatio);break;case"topleft":e.y1=e.y2-(e.x2-e.x1)/n.aspectRatio,r=Math.max(0-e.x1,0),o=Math.max(0-e.y1,0),(r>0||o>0)&&(e.x1+=o*n.aspectRatio>r?o*n.aspectRatio:r,e.y1+=o*n.aspectRatio>r?o:r/n.aspectRatio);break;case"topright":e.y1=e.y2-(e.x2-e.x1)/n.aspectRatio,r=Math.max(e.x2-a.width,0),o=Math.max(0-e.y1,0),(r>0||o>0)&&(e.x2-=o*n.aspectRatio>r?o*n.aspectRatio:r,e.y1+=o*n.aspectRatio>r?o:r/n.aspectRatio);break;case"right":case"bottomright":e.y2=e.y1+(e.x2-e.x1)/n.aspectRatio,r=Math.max(e.x2-a.width,0),o=Math.max(e.y2-a.height,0),(r>0||o>0)&&(e.x2-=o*n.aspectRatio>r?o*n.aspectRatio:r,e.y2-=o*n.aspectRatio>r?o:r/n.aspectRatio);break;case"left":case"bottomleft":e.y2=e.y1+(e.x2-e.x1)/n.aspectRatio,r=Math.max(0-e.x1,0),o=Math.max(e.y2-a.height,0),(r>0||o>0)&&(e.x1+=o*n.aspectRatio>r?o*n.aspectRatio:r,e.y2-=o*n.aspectRatio>r?o:r/n.aspectRatio);break;case"center":e.x2=e.x1+(e.y2-e.y1)*n.aspectRatio,e.y2=e.y1+(e.x2-e.x1)/n.aspectRatio;const l=Math.max(0-e.x1,0),u=Math.max(e.x2-a.width,0),f=Math.max(e.y2-a.height,0),g=Math.max(0-e.y1,0);(l>0||u>0||f>0||g>0)&&(e.x1+=f*n.aspectRatio>l?f*n.aspectRatio:l,e.x2-=g*n.aspectRatio>u?g*n.aspectRatio:u,e.y1+=g*n.aspectRatio>u?g:u/n.aspectRatio,e.y2-=f*n.aspectRatio>l?f:l/n.aspectRatio)}}getClientX(t){return t.touches?.[0].clientX||t.clientX||0}getClientY(t){return t.touches?.[0].clientY||t.clientY||0}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275prov=i.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();let st=(()=>{class c{constructor(){this.autoRotateSupported=function W(){return new Promise(c=>{const h=new Image;h.onload=()=>{c(1===h.width&&2===h.height)},h.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(t,e){return t.arrayBuffer().then(a=>this.checkImageTypeAndLoadImageFromArrayBuffer(a,t.type,e))}checkImageTypeAndLoadImageFromArrayBuffer(t,e,a){return this.isValidImageType(e)?this.loadImageFromArrayBuffer(t,a):Promise.reject(new Error("Invalid image type"))}isValidImageType(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(t)}loadImageFromURL(t,e){return fetch(t).then(a=>a.arrayBuffer()).then(a=>this.loadImageFromArrayBuffer(a,e))}loadBase64Image(t,e){const a=this.base64ToArrayBuffer(t);return this.loadImageFromArrayBuffer(a,e)}base64ToArrayBuffer(t){t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");const e=atob(t),a=e.length,n=new Uint8Array(a);for(let r=0;r<a;r++)n[r]=e.charCodeAt(r);return n.buffer}loadImageFromArrayBuffer(t,e){return new Promise((a,n)=>{const r=new Blob([t]),o=URL.createObjectURL(r),l=new Image;l.onload=()=>a({originalImage:l,originalObjectUrl:o,originalArrayBuffer:t}),l.onerror=n,l.src=o}).then(a=>this.transformImageFromArrayBuffer(a,e))}transformImageFromArrayBuffer(t,e){var a=this;return(0,C.A)(function*(){const n=yield a.autoRotateSupported,r=yield function rt(c){switch("object"==typeof c&&(c=function ot(c){const h=new DataView(c);if(65496!==h.getUint16(0,!1))return-2;const t=h.byteLength;let e=2;for(;e<t;){if(h.getUint16(e+2,!1)<=8)return-1;const a=h.getUint16(e,!1);if(e+=2,65505==a){if(1165519206!==h.getUint32(e+=2,!1))return-1;const n=18761==h.getUint16(e+=6,!1);e+=h.getUint32(e+4,n);const r=h.getUint16(e,n);e+=2;for(let o=0;o<r;o++)if(274==h.getUint16(e+12*o,n))return h.getUint16(e+12*o+8,n)}else{if(65280&~a)break;e+=h.getUint16(e,!1)}}return-1}(c)),c){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(n?-1:t.originalArrayBuffer);return t.originalImage&&t.originalImage.complete?a.transformLoadedImage({original:{objectUrl:t.originalObjectUrl,image:t.originalImage,size:{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:r},e):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(t,e){var a=this;return(0,C.A)(function*(){const n=e.canvasRotation+t.exifTransform.rotate,r={width:t.original.image.naturalWidth,height:t.original.image.naturalHeight};if(0===n&&!t.exifTransform.flip&&!e.containWithinAspectRatio)return{original:{objectUrl:t.original.objectUrl,image:t.original.image,size:{...r}},transformed:{objectUrl:t.original.objectUrl,image:t.original.image,size:{...r}},exifTransform:t.exifTransform};const o=a.getTransformedSize(r,t.exifTransform,e),l=document.createElement("canvas");l.width=o.width,l.height=o.height;const u=l.getContext("2d");u?.setTransform(t.exifTransform.flip?-1:1,0,0,1,l.width/2,l.height/2),u?.rotate(Math.PI*(n/2)),u?.drawImage(t.original.image,-r.width/2,-r.height/2);const f=yield new Promise(I=>l.toBlob(I,e.format));if(!f)throw new Error("Failed to get Blob for transformed image.");const g=URL.createObjectURL(f),x=yield a.loadImageFromObjectUrl(g);return{original:{objectUrl:t.original.objectUrl,image:t.original.image,size:{...r}},transformed:{objectUrl:g,image:x,size:{width:x.width,height:x.height}},exifTransform:t.exifTransform}})()}loadImageFromObjectUrl(t){return new Promise((e,a)=>{const n=new Image;n.onload=()=>e(n),n.onerror=a,n.src=t})}getTransformedSize(t,e,a){const n=a.canvasRotation+e.rotate;if(a.containWithinAspectRatio){if(n%2){const o=t.height/a.aspectRatio;return{width:Math.max(t.height,t.width*a.aspectRatio),height:Math.max(t.width,o)}}{const o=t.width/a.aspectRatio;return{width:Math.max(t.width,t.height*a.aspectRatio),height:Math.max(t.height,o)}}}return n%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275prov=i.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),c})(),ct=(()=>{class c{constructor(t,e,a,n,r,o){this.cropService=t,this.cropperPositionService=e,this.loadImageService=a,this.sanitizer=n,this.cd=r,this.hammerLoader=o,this.settings=new O,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=s,this.imageVisible=!1,this.output=this.settings.output,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new i.bkB,this.startCropImage=new i.bkB,this.imageLoaded=new i.bkB,this.cropperReady=new i.bkB,this.loadImageFailed=new i.bkB,this.transformChange=new i.bkB,this.reset()}ngOnChanges(t){this.onChangesUpdateSettings(t),this.onChangesInputImage(t),this.loadedImage?.original.image.complete&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e)),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),!this.maintainAspectRatio||!this.resetCropOnAspectRatioChange&&this.aspectRatioIsCorrect()||!t.maintainAspectRatio&&!t.aspectRatio?t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()):this.resetCropperPosition(),this.cd.markForCheck()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop(),this.cd.markForCheck()),t.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent?.target?.files?.length>0}setCssTransform(){const t=this.transform?.translateUnit||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${t}, ${this.transform.translateV||0}${t}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(t){this.loadImageService.loadImageFile(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}setLoadedImage(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.objectUrl),this.cd.markForCheck()}loadImageError(t){console.error(t),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){this.loadedImage&&(this.hidden?this.resizedWhileHidden=!0:(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()))}activatePinchGesture(){var t=this;return(0,C.A)(function*(){yield t.hammerLoader?.();const e=window?.Hammer||null;if(e){const a=new e(t.wrapper.nativeElement);a.get("pinch").set({enable:!0}),a.on("pinchmove",t.onPinch.bind(t)),a.on("pinchend",t.pinchStop.bind(t)),a.on("pinchstart",t.startPinch.bind(t))}else(0,i.naY)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")})()}resizeCropperPosition(){const t=this.sourceImage.nativeElement;(this.maxSize.width!==t.offsetWidth||this.maxSize.height!==t.offsetHeight)&&(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){const e=+t.key;e>=1&&e<=9&&(this.settings.stepSize=e)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const a=t.shiftKey?s.Resize:s.Move,n=t.altKey?function _(c){switch(c){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(t.key):function m(c){switch(c){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(t.key),r=function v(c,h){switch(c){case"ArrowUp":return{clientX:0,clientY:-1*h};case"ArrowRight":return{clientX:h,clientY:0};case"ArrowDown":return{clientX:0,clientY:h};default:return{clientX:-1*h,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},a,n),this.moveImg(r),this.moveStop()}startMove(t,e,a=null){this.disabled||this.moveStart?.active&&this.moveStart?.type===s.Pinch||e===s.Drag&&!this.allowMoveImage||(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:e,position:a,transform:{...this.transform},clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t),...this.cropper})}startPinch(t){this.safeImgDataUrl&&(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:s.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}moveImg(t){if(this.moveStart.active){if(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===s.Move)this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===s.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===s.Drag){const e=this.cropperPositionService.getClientX(t)-this.moveStart.clientX,a=this.cropperPositionService.getClientY(t)-this.moveStart.clientY;this.transform={...this.transform,translateH:(this.moveStart.transform?.translateH||0)+e,translateV:(this.moveStart.transform?.translateV||0)+a},this.setCssTransform()}this.cd.detectChanges()}}onPinch(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===s.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){const t=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/t:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/t:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(t=!1){this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.moveStart?.type===s.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(t=this.settings.output){if(null!=this.loadedImage?.transformed?.image){if(this.startCropImage.emit(),"blob"===t)return this.cropToBlob();if("base64"===t)return this.cropToBase64()}return null}cropToBlob(){const t=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings,"blob");return t?Promise.resolve(t).then(e=>(this.imageCropped.emit(e),t)):null}cropToBase64(){const t=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings,"base64");return t?(this.imageCropped.emit(t),t):null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return c.\u0275fac=function(t){return new(t||c)(i.rXU(b),i.rXU(X),i.rXU(st),i.rXU(D.up),i.rXU(i.gRc),i.rXU(D.Bn,8))},c.\u0275cmp=i.VBU({type:c,selectors:[["image-cropper"]],viewQuery:function(t,e){if(1&t&&(i.GBs(V,7),i.GBs(L,5)),2&t){let a;i.mGM(a=i.lsd())&&(e.wrapper=a.first),i.mGM(a=i.lsd())&&(e.sourceImage=a.first)}},hostVars:6,hostBindings:function(t,e){1&t&&i.bIt("resize",function(){return e.onResize()},!1,i.tSv)("mousemove",function(n){return e.moveImg(n)},!1,i.EBC)("touchmove",function(n){return e.moveImg(n)},!1,i.EBC)("mouseup",function(){return e.moveStop()},!1,i.EBC)("touchend",function(){return e.moveStop()},!1,i.EBC),2&t&&(i.xc7("text-align",e.alignImage),i.AVh("disabled",e.disabled)("ngx-ix-hidden",e.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",output:"output",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},features:[i.OA$],decls:5,vars:10,consts:[["wrapper",""],["sourceImage",""],["class","ngx-ic-source-image",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],[1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],[1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],[1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],[1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],[1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,e){1&t&&(i.j41(0,"div",null,0),i.DNE(2,N,2,8,"img",2),i.nrm(3,"div",3),i.DNE(4,z,3,15,"div",4),i.k0s()),2&t&&(i.xc7("background",e.imageVisible&&e.backgroundColor),i.R7$(2),i.Y8G("ngIf",e.safeImgDataUrl),i.R7$(),i.xc7("width",e.maxSize.width,"px")("height",e.maxSize.height,"px")("margin-left","center"===e.alignImage?e.marginLeft:null),i.R7$(),i.Y8G("ngIf",e.imageVisible))},dependencies:[p.bT],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),c})(),ht=(()=>{class c{}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=i.$C({type:c}),c.\u0275inj=i.G2t({imports:[[p.MD]]}),c})();var lt=d(5502),pt=d(21656),mt=d(47348),gt=d(70050),dt=d(64198),ft=d(9516),ut=d(36894);const _t=[[["","btnUpload",""]],[["","btnRemove",""]],[["","body",""]],[["","header",""]]],xt=["[btnUpload]","[btnRemove]","[body]","[header]"];function Ct(c,h){if(1&c){const t=i.RV6();i.j41(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9),i.SdG(4,3),i.k0s(),i.j41(5,"div",10)(6,"div",11)(7,"image-cropper",12),i.bIt("imageCropped",function(a){i.eBV(t);const n=i.XpG();return i.Njj(n.imageCropped(a))}),i.k0s()()(),i.j41(8,"div",13)(9,"button",14),i.bIt("click",function(){i.eBV(t);const a=i.XpG();return i.Njj(a.removeDialog())}),i.EFF(10),i.nI1(11,"mytranslate"),i.k0s(),i.j41(12,"button",15),i.bIt("click",function(){i.eBV(t);const a=i.XpG();return i.Njj(a.submitImage())}),i.EFF(13),i.nI1(14,"mytranslate"),i.k0s()()()()()}if(2&c){const t=i.XpG();i.Y8G("ngClass",t.isMobileWebView?"box-mobile-web-view":"box-web"),i.R7$(7),i.Y8G("imageChangedEvent",t.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",t.aspectRatio)("resizeToWidth",t.widthResize)("cropperMinWidth",128),i.R7$(3),i.JRh(i.bMT(11,8,"lang_auto_huy")),i.R7$(3),i.JRh(i.bMT(14,10,"lang_auto_cap_nhat"))}}let Mt=(()=>{var c;class h extends ft.L{constructor(){super(...arguments),this.aspectRatio=1,this.widthResize=150,this.uploadComplete=new i.bkB,this.imageChangedEvent=void 0,this.imageFileName="",this.hasClicked=!1}checkPermissionCameraAndImagePicker(e){this.hasClicked=!1,this.onOpenFileDictionary();var a=this.commonService.appVersion();this.isMobileWebView&&a?(this.mobileWebviewService.sendSimpleMessage("CHECK_PERMISSION_IMAGE_PICKER"),this.mobileWebviewService.getWebviewPermissionImagePicker().subscribe(n=>{this.hasClicked||(n?.url&&this.uploadComplete.emit({url:n.url}),this.hasClicked=!0)})):e.click()}fileChangeEvent(e){const n=e.target.files;if(n){if((0,dt.hD)(n[0]?.size)>=this.limitSize)return this.showErrorSnack(this.commonService.translateToKeyParam("lang_auto_vui_long_chon_tep_co_kich_thuoc_nho_hon",this.limitSize.toString(),"MB"));this.imageChangedEvent=e,this.imageFileName=n?.length?n[0]?.name:""}}imageCropped(e){fetch(e.objectUrl??"").then(a=>a.blob()).then(a=>{const n=new FileReader;n.onload=()=>{let o=this.b64toFile(n.result,this.imageFileName);this.saveImage=o},n.readAsDataURL(a)}).catch(a=>{console.error(this.commonService.translateToKeyParam("lang_auto_co_loi_xay_ra",a))})}submitImage(){const e=this.imageChangedEvent?.target;e.files=null,this.imageChangedEvent=void 0,this.saveImage&&this.uploadFile(this.saveImage,"").then(a=>{a&&this.uploadComplete.emit(a)})}removeDialog(){const e=this.imageChangedEvent?.target;e.files=null,this.imageChangedEvent=void 0}emitUploadComplete(e){}b64toFile(e,a){e=e.replace("data:image/png;base64,","");let o=window.atob(e),l=[];for(let f=0;f<o.length;f+=512){let g=o.slice(f,f+512),x=new Array(g.length);for(let A=0;A<g.length;A++)x[A]=g.charCodeAt(A);let I=new Uint8Array(x);l.push(I)}return new File(l,a,{type:"image/png"})}}return(c=h).\u0275fac=(()=>{let t;return function(a){return(t||(t=i.xGo(c)))(a||c)}})(),c.\u0275cmp=i.VBU({type:c,selectors:[["azt-upload-image-cropper"]],inputs:{aspectRatio:"aspectRatio",widthResize:"widthResize"},outputs:{uploadComplete:"uploadComplete"},standalone:!0,features:[i.Vt3,i.aNF],ngContentSelectors:xt,decls:10,vars:2,consts:[["formChoseFile",""],[1,"h-full"],["type","file","id","box-left-file-input",1,"form-control","file-input",2,"display","none",3,"change","cancel","accept"],[1,"flex","items-center","ml-0","sm:ml-3"],[1,"cursor-pointer",3,"click"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-body",2,"max-height","430px","overflow-y","auto"],[1,"img-container"],[3,"imageCropped","imageChangedEvent","maintainAspectRatio","aspectRatio","resizeToWidth","cropperMinWidth"],[1,"modal-footer"],["control-id","ControlID-2",1,"btn","btn-secondary","w-24","mr-2",3,"click"],["id","crop-button","control-id","ControlID-3",1,"btn","btn-primary","w-24",3,"click"]],template:function(e,a){if(1&e){const n=i.RV6();i.NAR(_t),i.j41(0,"div",1)(1,"input",2,0),i.bIt("change",function(o){return i.eBV(n),i.Njj(a.fileChangeEvent(o))})("cancel",function(o){return i.eBV(n),i.Njj(a.onCancelSelect(o))}),i.k0s(),i.j41(3,"div",3)(4,"div",4),i.bIt("click",function(){i.eBV(n);const o=i.sdS(2);return i.Njj(a.checkPermissionCameraAndImagePicker(o))}),i.SdG(5),i.k0s(),i.SdG(6,1),i.k0s(),i.j41(7,"div",4),i.bIt("click",function(){i.eBV(n);const o=i.sdS(2);return i.Njj(a.checkPermissionCameraAndImagePicker(o))}),i.SdG(8,2),i.k0s()(),i.DNE(9,Ct,15,12,"div",5)}2&e&&(i.R7$(),i.FS9("accept",a.fileType),i.R7$(8),i.Y8G("ngIf",a.imageChangedEvent))},dependencies:[ht,ct,p.MD,p.YU,p.bT,T.X1,k.iI,T.YN,mt.wp,pt.s,j.flO,gt.L,lt.Id,ut.k],styles:[".source-image{margin:auto!important}.modal-dialog[_ngcontent-%COMP%]{max-width:500px;margin:auto}.box-web[_ngcontent-%COMP%]{position:fixed;left:0;top:0;z-index:9999;background:#303030b0;width:100%;height:100%;padding:20px}.box-mobile-web-view[_ngcontent-%COMP%]{position:fixed;left:0;top:0;z-index:9999;background:#303030b0;width:100%;height:100%;padding:20px;display:flex;align-items:center;justify-content:center}"]}),h})()},20013:(J,F,d)=>{d.d(F,{T:()=>m});var p=d(48891),i=d(9516),T=d(52811),k=d(54460),j=d(10936),C=d(65162),D=d(21656),V=d(15343),L=d(70050),N=d(5502),M=d(36894);const z=["*"];function O(_,v){1&_&&p.SdG(0,0,["*ngIf","!isUploadFile"])}function s(_,v){1&_&&(p.j41(0,"span",5),p.nrm(1,"azt-loading-ui"),p.k0s())}let m=(()=>{var _;class v extends i.L{constructor(){super(...arguments),this.uploadComplete=new p.bkB}emitUploadComplete(S){S.length>0&&this.uploadComplete.emit(S[0])}}return(_=v).\u0275fac=(()=>{let E;return function(b){return(E||(E=p.xGo(_)))(b||_)}})(),_.\u0275cmp=p.VBU({type:_,selectors:[["azt-upload-single-box"]],outputs:{uploadComplete:"uploadComplete"},standalone:!0,features:[p.Vt3,p.aNF],ngContentSelectors:z,decls:6,vars:4,consts:[["formChoseFile",""],[3,"click"],["type","file","id","box-left-file-input",1,"form-control","file-input",2,"display","none",3,"change","cancel","accept"],[4,"ngIf"],["class","w-4 h-4 inline-block",4,"ngIf"],[1,"w-4","h-4","inline-block"]],template:function(S,b){if(1&S){const X=p.RV6();p.NAR(),p.j41(0,"div",1),p.bIt("click",function(){p.eBV(X);const W=p.sdS(2);return p.Njj(b.onOpenFileDictionary()&&W.click())}),p.j41(1,"input",2,0),p.bIt("change",function(W){return p.eBV(X),p.Njj(b.onFileSelected(W))})("cancel",function(W){return p.eBV(X),p.Njj(b.onCancelSelect(W))}),p.k0s(),p.DNE(3,O,1,0,"ng-content",3),p.j41(4,"div"),p.DNE(5,s,2,0,"span",4),p.k0s()()}2&S&&(p.BMQ("class",b.containerClass),p.R7$(),p.FS9("accept",b.fileType),p.R7$(2),p.Y8G("ngIf",!b.isUploadFile),p.R7$(2),p.Y8G("ngIf",b.isUploadFile))},dependencies:[T.R,k.MD,k.bT,j.X1,C.iI,j.YN,D.s,V.flO,L.L,N.Id,M.k],encapsulation:2}),v})()}}]);