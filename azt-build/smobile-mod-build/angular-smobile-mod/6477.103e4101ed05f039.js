"use strict";(self.webpackChunkSmobileMod=self.webpackChunkSmobileMod||[]).push([[6477],{34068:(M,P,l)=>{l.d(P,{F:()=>p});var s=l(48891);let p=(()=>{var z;class c{constructor(){this.fileDrop=new s.bkB,this.preventBodyDrop=!0,this.active=!1}onDrop(f){f.preventDefault(),this.active=!1;const{dataTransfer:D}=f;if(D?.items){const B=[];for(let A=0;A<D.items.length;A++)"file"===D.items[A].kind&&D.items[A].getAsFile()&&B.push(D.items[A].getAsFile());D.items.clear(),Array.isArray(B)&&this.fileDrop.emit(this.removeNullFile(B))}else{const B=D?.files;D?.clearData(),B&&this.fileDrop.emit(Array.from(B))}}removeNullFile(f){for(var D=[],B=0;B<f.length;B++)f[B]&&D.push(f[B]);return D}onDragOver(f){f.stopPropagation(),f.preventDefault(),this.active=!0}onDragLeave(f){this.active=!1}onBodyDragOver(f){this.preventBodyDrop&&(f.preventDefault(),f.stopPropagation())}onBodyDrop(f){this.preventBodyDrop&&f.preventDefault()}}return(z=c).\u0275fac=function(f){return new(f||z)},z.\u0275dir=s.FsC({type:z,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(f,D){1&f&&s.bIt("drop",function(A){return D.onDrop(A)})("dragover",function(A){return D.onDragOver(A)})("dragleave",function(A){return D.onDragLeave(A)})("dragover",function(A){return D.onBodyDragOver(A)},!1,s.N_X)("drop",function(A){return D.onBodyDrop(A)},!1,s.N_X),2&f&&s.AVh("drop-zone-active",D.active)},inputs:{preventBodyDrop:"preventBodyDrop"},outputs:{fileDrop:"appDropZone"}}),c})()},37157:(M,P,l)=>{l.d(P,{Z:()=>I});var s=l(51698),p=l(11787),z=l(27035),c=l(17178),T=l(48915),f=l(63016),D=l(47947),B=l(81215),A=l(15351);const R=(v,g)=>(v.push(g),v);var j=l(48891);let I=(()=>{var v;class g{processObservables(u,O,m){return new s.c(d=>{this.processMultipleObservables(u,O,m).subscribe({next:e=>{d.next(e),d.complete()},error:e=>{d.next(O.map(C=>null)),d.complete()}})})}processMultipleObservables(u,O,m){return(0,p.H)(O).pipe((0,z.Z)((d,e)=>d.pipe((0,c.W)(C=>(console.error("Error in observable:",C),m?(0,T.$)(()=>C):(0,f.of)(null))),(0,D.T)(C=>({result:C,index:e}))),u),function U(){return(0,A.N)((v,g)=>{(0,B.T)(R,[])(v).subscribe(g)})}(),(0,D.T)(d=>d.sort((e,C)=>e.index-C.index).map(e=>e.result)))}}return(v=g).\u0275fac=function(u){return new(u||v)},v.\u0275prov=j.jDH({token:v,factory:v.\u0275fac,providedIn:"root"}),g})()},75421:(M,P,l)=>{l.d(P,{u:()=>U});var s=l(10936),p=l(89163),z=l(33887),c=l(48891),T=l(54460),f=l(15343),D=l(76975);const B=()=>({"mr-2 text-danger":!0});function A(j,I){if(1&j&&c.nrm(0,"lucide-icon",10),2&j){const v=c.XpG();c.Y8G("name",v.data.iconName)("ngClass",c.lJ4(2,B))}}function R(j,I){if(1&j&&(c.j41(0,"div",11)(1,"div",3)(2,"span"),c.EFF(3),c.nI1(4,"mytranslate"),c.k0s(),c.j41(5,"b"),c.EFF(6),c.k0s(),c.j41(7,"span"),c.EFF(8),c.nI1(9,"mytranslate"),c.k0s()(),c.j41(10,"div",12),c.nrm(11,"input",13),c.k0s()()),2&j){const v=c.XpG();c.R7$(3),c.JRh(c.bMT(4,4,"lang_azt_enter")+" "),c.R7$(3),c.JRh('"'+v.data.textConfirm+'" '),c.R7$(2),c.JRh(c.bMT(9,6,"lang_azt_for_delete_data")),c.R7$(3),c.Y8G("formControl",v.confirmValue)}}let U=(()=>{var j;class I extends z._{btnCloseDialog(){this.dialogRef.close(!1)}confirmDialog(){this.dialogRef.close(!0)}constructor(g,_){super(_,g),this.dialogRef=g,this.data=_,this.confirmValue=new s.MJ("",{nonNullable:!0})}}return(j=I).\u0275fac=function(g){return new(g||j)(c.rXU(p.CP,8),c.rXU(p.Vh,8))},j.\u0275cmp=c.VBU({type:j,selectors:[["azt-dialog-danger"]],features:[c.Vt3],decls:14,vars:10,consts:[[1,"box"],[1,"border-b","border-slate-200/60","dark:border-darkmode-400"],[1,"p-5"],[1,"text-md"],["size","24",3,"name","ngClass",4,"ngIf"],[1,"text-md",3,"innerHtml"],["class","mt-3",4,"ngIf"],[1,"p-3","text-right"],["azt-track-service","azt-dialog-danger-9EJYp6jGzr",1,"btn","w-24","btn-secondary","mr-2",3,"click"],["azt-track-service","azt-dialog-danger-ffMh3NrPRC",1,"btn","w-24","btn-danger",3,"click","disabled"],["size","24",3,"name","ngClass"],[1,"mt-3"],[1,"mt-2"],["type","text",1,"form-control",3,"formControl"]],template:function(g,_){1&g&&(c.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),c.DNE(4,A,1,3,"lucide-icon",4),c.nrm(5,"span",5),c.k0s(),c.DNE(6,R,12,8,"div",6),c.k0s()(),c.j41(7,"div",7)(8,"button",8),c.bIt("click",function(){return _.btnCloseDialog()}),c.EFF(9),c.nI1(10,"mytranslate"),c.k0s(),c.j41(11,"button",9),c.bIt("click",function(){return _.confirmDialog()}),c.EFF(12),c.nI1(13,"mytranslate"),c.k0s()()()),2&g&&(c.R7$(4),c.Y8G("ngIf",_.data.iconName),c.R7$(),c.Y8G("innerHtml",_.data.content,c.npT),c.R7$(),c.Y8G("ngIf",_.data.textConfirm),c.R7$(3),c.SpI(" ",c.bMT(10,6,"lang_auto_huy")," "),c.R7$(2),c.Y8G("disabled",_.data.textConfirm&&_.data.textConfirm!==_.confirmValue.value),c.R7$(),c.SpI(" ",c.bMT(13,8,"lang_auto_xac_nhan")," "))},dependencies:[T.YU,T.bT,s.me,s.BC,s.l_,f.WGl,D.wp],encapsulation:2}),I})()},63349:(M,P,l)=>{l.d(P,{V:()=>j});var s=l(48891),p=l(9516),z=l(54460),c=l(52811),T=l(34068);const f=["*"];function D(I,v){1&I&&s.SdG(0,0,["*ngIf","!isUploadFile"])}function B(I,v){if(1&I&&(s.j41(0,"div",8)(1,"h5",9),s.EFF(2),s.k0s(),s.j41(3,"div",10),s.nrm(4,"progress",11),s.k0s()()),2&I){const g=v.$implicit;s.R7$(2),s.JRh(g.fileName),s.R7$(2),s.FS9("value",g.uploadProgress)}}function A(I,v){if(1&I&&(s.qex(0),s.j41(1,"span",6),s.nrm(2,"azt-loading-ui"),s.k0s(),s.DNE(3,B,5,2,"div",7),s.bVm()),2&I){const g=s.XpG(2);s.R7$(3),s.Y8G("ngForOf",g.fileUploadQueue)}}function R(I,v){1&I&&(s.j41(0,"span",6),s.nrm(1,"azt-loading-ui"),s.k0s())}function U(I,v){if(1&I&&(s.j41(0,"div"),s.DNE(1,A,4,1,"ng-container",5)(2,R,2,0,"ng-template",null,1,s.C5r),s.k0s()),2&I){const g=s.sdS(3),_=s.XpG();s.R7$(),s.Y8G("ngIf",_.showProgress)("ngIfElse",g)}}let j=(()=>{var I;class v extends p.L{constructor(){super(...arguments),this.uploadComplete=new s.bkB}emitUploadComplete(_){this.uploadComplete.emit(_)}ngOnInit(){this.files&&this.files.length>0&&this.emitFile(this.files)}}return(I=v).\u0275fac=(()=>{let g;return function(u){return(g||(g=s.xGo(I)))(u||I)}})(),I.\u0275cmp=s.VBU({type:I,selectors:[["azt-upload-multiple-box"]],inputs:{files:"files"},outputs:{uploadComplete:"uploadComplete"},features:[s.Vt3],ngContentSelectors:f,decls:5,vars:3,consts:[["formChoseFile",""],["notShowProgress",""],[1,"flex","items-center","justify-center","h-full",3,"appDropZone","click"],["type","file","id","box-left-file-input","multiple","",1,"form-control","file-input",2,"display","none",3,"change","cancel","accept"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"w-4","h-4","inline-block","mr-2"],["class","w-48",4,"ngFor","ngForOf"],[1,"w-48"],[1,"text-md","font-medium","truncate"],[1,"progress-container"],["max","100",2,"width","100%","background-color","#1e40af",3,"value"]],template:function(_,u){if(1&_){const O=s.RV6();s.NAR(),s.j41(0,"div",2),s.bIt("appDropZone",function(d){return s.eBV(O),s.Njj(u.onDrop(d))})("click",function(){s.eBV(O);const d=s.sdS(2);return s.Njj(d.click())}),s.j41(1,"input",3,0),s.bIt("change",function(d){return s.eBV(O),s.Njj(u.onFileSelected(d))})("cancel",function(d){return s.eBV(O),s.Njj(u.onCancelSelect(d))})("cancel",function(d){return s.eBV(O),s.Njj(u.onCancelSelect(d))}),s.k0s(),s.DNE(3,D,1,0,"ng-content",4)(4,U,4,2,"div",4),s.k0s()}2&_&&(s.R7$(),s.FS9("accept",u.fileType),s.R7$(2),s.Y8G("ngIf",!u.isUploadFile),s.R7$(),s.Y8G("ngIf",u.isUploadFile))},dependencies:[z.Sq,z.bT,c.R,T.F],styles:['.progress-container[_ngcontent-%COMP%]{position:relative;display:block;background:#eee;height:10px;border-radius:6px;overflow:hidden}.progress-container[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;background:#1e40af}progress[_ngcontent-%COMP%]{accent-color:#1e40af}[_ngcontent-%COMP%]::-webkit-progress-value{background-color:#1e40af}[_ngcontent-%COMP%]::-moz-progress-bar{background-color:#1e40af}']}),v})()},9516:(M,P,l)=>{l.d(P,{L:()=>U});var s=l(73014),p=l(27691),z=l(48891),c=l(59640),T=l(64198),f=l(39712),D=l(52509),B=l(41426),A=l(63709),R=l(52909);let U=(()=>{var j;class I extends c.H{uploadFile(g,_){return new Promise(u=>{this.checkCompressImage(g,O=>{this.fileUploadQueue=[],this.showProgress?this.apiUploadService.commonUploadFileProgress(this.uploadToCdnMenu,O,this.qrUploadHashCode).subscribe(m=>{if(m.type!==p.hv.UploadProgress)if(1===m.success){const d={...m.data};u(d)}else this.showErrorSnack(this.commonService.translateToKeyParam("lang_auto_khong_upload_duoc_tep_tin_vui_long_thu_lai_sau",m.message??"none")),u(null);else{let d=(m.loaded??0)/(m.total??1)*100,e=this.fileUploadQueue.find(C=>C.uuid==_);e?e.uploadProgress=d:this.fileUploadQueue.push({uuid:_,uploadProgress:0,fileName:g.name})}}):this.apiUploadService.commonUploadFile(this.uploadToCdnMenu,O,this.qrUploadHashCode).subscribe(m=>{if(m.type!==p.hv.UploadProgress)if(1===m.success){const d={...m.data};u(d)}else this.showErrorSnack(this.commonService.translateToKeyParam("lang_auto_khong_upload_duoc_tep_tin_vui_long_thu_lai_sau",m.message??"none")),u(null)})})})}onOpenFileDictionary(){return this.uploadActionsEvent.emit("SELECT_FILE"),!0}onFileSelected(g){this.uploadActionsEvent.emit("SELECTED");const _=g.target,u=_.files;u&&(this.emitFile(u),_.files=null)}onCancelSelect(g){this.uploadActionsEvent.emit("SELECTED")}onDrop(g){this.emitFile(g)}emitFile(g){return this.isDisabled?(this.limitSize=this.limitSize>200?200:this.limitSize,Array.from(g).find(O=>(0,T.hD)(O.size)>=this.limitSize)?this.showErrorSnack(this.commonService.translateToKeyParam("lang_auto_vui_long_chon_tep_co_kich_thuoc_nho_hon",this.limitSize.toString(),"MB")):Array.from(g).find(O=>this.isNotSupportedFile(O))?this.showErrorSnack(this.commonService.translateToKeyParam("lang_auto_chua_ho_tro_dinh_dang",this.notSupportedFile)):(this.isUploadFile=!0,this.isUploading.emit(this.isUploadFile),void this.checkConvertPdfToImages(Array.from(g),O=>{const m=O.map(d=>this.uploadFile(d,this.uuidService.getUuid()));Promise.all(m).then(d=>{this.isUploadFile=!1,this.isUploading.emit(this.isUploadFile);let e=d.filter(this.commonService.notEmpty);this.emitUploadComplete(e)})}))):this.showErrorSnack(this.commonService.translateString("lang_auto_ban_khong_co_quyen_thuc_hien_hanh_dong_nay"))}checkConvertPdfToImages(g,_){if(!this.convertPdfToImages)return _(g);this.convertAllPdfToImages(g).then(u=>{_(u)})}convertAllPdfToImages(g){var _=this;return new Promise(function(){var u=(0,s.A)(function*(O,m){let d=[];for(let e of g)if((0,T.Ev)(e.type))try{const C=1e3*_.convertPdfTimeout;let E=yield _.withTimeout(_.myPdfService.getImageWithPdf(e),C);d.push(...E)}catch{_.showErrorSnack("lang_common_convert_pdf_to_image_timeout"),O([])}else d.push(e);O(d)});return function(O,m){return u.apply(this,arguments)}}())}checkCompressImage(g,_){this.allowCompressImage?(0,T.w4)(g).then(u=>{_(u)}):_(g)}isNotSupportedFile(g){const _=[this.notSupportedFile],u=g.name.split(".").pop()?.toLowerCase();return _.includes(`.${u}`)}withTimeout(g,_){return new Promise((u,O)=>{const m=setTimeout(()=>{O(new Error("Operation timed out"))},_);g.then(d=>{clearTimeout(m),u(d)}).catch(d=>{clearTimeout(m),O(d)})})}constructor(g,_,u,O){super(),this.mobileWebviewService=g,this.apiUploadService=_,this.myPdfService=u,this.uuidService=O,this.convertPdfTimeout=30,this.isDisabled=!0,this.notSupportedFile=f.Ym.NONE,this.limitSize=200,this.allowCompressImage=!0,this.convertPdfToImages=!1,this.qrUploadHashCode="",this.showProgress=!1,this.isUploading=new z.bkB,this.uploadActionsEvent=new z.bkB,this.isUploadFile=!1,this.fileUploadQueue=[]}}return(j=I).\u0275fac=function(g){return new(g||j)(z.rXU(D.f),z.rXU(B.T),z.rXU(A.C),z.rXU(R.D))},j.\u0275cmp=z.VBU({type:j,selectors:[["ng-component"]],inputs:{convertPdfTimeout:"convertPdfTimeout",fileType:"fileType",uploadToCdnMenu:"uploadToCdnMenu",isDisabled:"isDisabled",notSupportedFile:"notSupportedFile",limitSize:"limitSize",allowCompressImage:"allowCompressImage",convertPdfToImages:"convertPdfToImages",qrUploadHashCode:"qrUploadHashCode",showProgress:"showProgress"},outputs:{isUploading:"isUploading",uploadActionsEvent:"uploadActionsEvent"},features:[z.Vt3],decls:0,vars:0,template:function(g,_){},encapsulation:2}),I})()},12145:(M,P,l)=>{l.d(P,{Y:()=>g});var s=l(73014),p=l(27691),z=l(48891),c=l(56325),T=l(86425),f=l(85710),D=l(51698),B=l(41426),A=l(79767),R=l(76975),U=l(21973),j=l(53793),I=l(52909),v=l(39712);let g=(()=>{var _;class u{constructor(){this.subscriptions=new f.yU,this.sAztBase64Service=(0,z.WQX)(U.D),this.ocrService=(0,z.WQX)(c.so),this.commonService=(0,z.WQX)(j.R),this.sAztUuidService=(0,z.WQX)(I.D),this.digitalizedBookPageService=(0,z.WQX)(T.gI),this.apiUploadService=(0,z.WQX)(B.T)}runRemoveBackgroundNoise(m,d,e){return new D.c(C=>{this.removeBackgroundNoise(m.oldImageUrl,d,(E,S)=>{if(null==E||S)return e(S??""),C.next(void 0),void C.complete();this.apiUploadService.commonUploadFile(v.b8.ADMIN_DIGITALIZE,this.sAztBase64Service.base64ToFile(E,"digitalized-file.png"),"").subscribe(F=>{F.type!=p.hv.UploadProgress&&(1===F.success&&F.data?.url?(C.next({...m,newImageUrl:F.data.url}),C.complete()):(e(F.message??""),C.next(void 0),C.complete()))})})})}removeBackgroundNoise(m,d,e){this.sAztBase64Service.convertImageUrlToBase64(m,C=>{if(!C)return e(void 0,"Error to get base64 from url");this.sAztBase64Service.convertFileToUint8Array(this.sAztBase64Service.base64ToFile(C),E=>{if(!E)return e(void 0,"Error to get Uint8Array from base64");this.loadScriptHandleImage(()=>{this.imageUtils.removeNoise(E,d).then(S=>e(this.sAztBase64Service.uint8ArrayToBase64(new Uint8Array(S.image)),void 0)).catch(S=>e(void 0,"Error when call imageUtils.detectImage"))})})})}callChangeBookPageDataApi(m,d,e,C,E){this.subscriptions.add(this.digitalizedBookPageService.apiDigitalizedBookPageUpdateOcrPost({bookId:m,bookPageId:d,ocrContent:e,originOcrContent:C}).subscribe(F=>{if(!F.success)return E(!1,F.message);E(!0,"")}))}digitalizeOneImage(m,d,e,C){return new D.c(E=>{d("lang_digitalize_call_ocr_api"),this.subscriptions.add(this.commonService.wrapApiResponse(this.ocrService.aiApiV1OcrImageToTextPost({imageUrl:m})).subscribe(S=>{if(!S.success||!S.data)return e(S.message),E.next(!1),void E.complete();C(this.replaceOrcData(S.data)),E.next(!0),E.complete()}))})}replaceOrcData(m){let d=m.data,e=this.sAztUuidService.getUuid();return d=this.commonService.convertLatexTagToAztMathTag(d,e),d=(new R.bt).transform((new R.UN).transform(d)),d=this.commonService.replaceAll(d,"<table>","<table class='table table-bordered'>")??d,d=d.replace(new RegExp(e,"g"),"\n"),{htmlResult:d,originOcrData:m.data}}extractImageByOrcUtil(m,d){this.sAztBase64Service.convertImageUrlToBase64(m,e=>{if(!e)return d(void 0,[],"Error to get base64 from url");this.sAztBase64Service.getImageDimensions(e,C=>{this.sAztBase64Service.convertFileToUint8Array(this.sAztBase64Service.base64ToFile(e),E=>{if(!E)return d(void 0,[],"Error to get Uint8Array from base64");let S={base64:this.sAztBase64Service.removePrefixOfBase64(e),x:0,y:0,width:C.width,height:C.height,extension:"png"};this.loadScriptHandleImage(()=>{this.imageUtils.detectImage(E).then(F=>d(S,F.images.map(w=>({base64:this.sAztBase64Service.uint8ArrayToBase64(new Uint8Array(w.content)),x:w.x,y:w.y,width:w.width,height:w.height,extension:w.extension})),void 0)).catch(F=>d(S,[],"Error when call imageUtils.detectImage"))})})})})}waitAnswerSheetInitDone(m){if(A.A.azotaScanAnswerSheet)return m();setTimeout(()=>{this.waitAnswerSheetInitDone(m)},100)}loadScriptHandleImage(m){var d=this;if(this.imageUtils)return m();this.commonService.loadAnswerSheetJs().then((0,s.A)(function*(){d.waitAnswerSheetInitDone((0,s.A)(function*(){d.imageUtils=yield A.A.azotaScanAnswerSheet.imageUtils(),m()}))})).catch(e=>{this.commonService.snackError("lang_auto_tai_thu_vien_that_bao_vui_long_load_lai_trang_de_thu_lai"),m()})}ngOnDestroy(){this.subscriptions.unsubscribe()}}return(_=u).\u0275fac=function(m){return new(m||_)},_.\u0275prov=z.jDH({token:_,factory:_.\u0275fac,providedIn:"root"}),u})()},86477:(M,P,l)=>{l.r(P),l.d(P,{AzotaDigitalizeModule:()=>_t});var s=l(54460),p=l(10936),z=l(65162),c=l(69223),T=l(62067),f=l(15343),D=l(10123),B=l(44233),A=l(5502),R=l(21656),U=l(70050),j=l(7050),I=l(35143),v=l(43234),g=l(1133),_=l(89121),u=l(37714),O=l(72888),m=l(59640),d=l(37497),e=l(48891),C=l(86425),E=l(51113),S=l(12145),F=l(37157),w=l(36484),V=l(18718),te=l(22613),N=l(61224),L=l(46899),ie=l(53043);const oe=["*"];let $=(()=>{var o;class r extends m.H{constructor(){super(...arguments),this.imageUrl="",this.sAztDialogService=(0,e.WQX)(L.i)}previewImage(){this.sAztDialogService.open(ie.V,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{fileOption:{url:this.imageUrl,mimes:"image/jpeg"},viewFullImageWithScroll:!0},restoreFocus:!1})}}return(o=r).\u0275fac=(()=>{let n;return function(i){return(n||(n=e.xGo(o)))(i||o)}})(),o.\u0275cmp=e.VBU({type:o,selectors:[["azt-preview-image-tag"]],inputs:{imageUrl:"imageUrl"},features:[e.Vt3],ngContentSelectors:oe,decls:2,vars:0,consts:[[3,"click"]],template:function(t,i){1&t&&(e.NAR(),e.j41(0,"span",0),e.bIt("click",function(){return i.previewImage()}),e.SdG(1),e.k0s())},encapsulation:2}),r})();var y=l(76975);const Z=()=>({"flex-none":!0,"mr-1":!0});function ne(o,r){if(1&o){const n=e.RV6();e.qex(0),e.j41(1,"span",10),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.editBookPage(i.obj))}),e.nrm(2,"lucide-icon",11),e.EFF(3),e.nI1(4,"mytranslate"),e.k0s(),e.EFF(5," | "),e.j41(6,"span",12),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.callAgainOcrBookPageEvent.emit(i.obj))}),e.nrm(7,"lucide-icon",13),e.EFF(8),e.nI1(9,"mytranslate"),e.k0s(),e.bVm()}2&o&&(e.R7$(2),e.Y8G("ngClass",e.lJ4(8,Z)),e.R7$(),e.SpI(" ",e.bMT(4,4,"lang_cms_admin_digitalized_edit_content")," "),e.R7$(4),e.Y8G("ngClass",e.lJ4(9,Z)),e.R7$(),e.SpI(" ",e.bMT(9,6,"lang_cms_admin_digitalized_re_digitalized_again")," "))}function ae(o,r){if(1&o&&(e.j41(0,"div",14),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&o){const n=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,n.obj.logMessage))}}function le(o,r){if(1&o&&(e.j41(0,"div"),e.nrm(1,"div",15),e.nI1(2,"mathJaxContent"),e.nI1(3,"async"),e.nI1(4,"safeNormalHtmlContent"),e.k0s()),2&o){let n;const t=e.XpG();e.R7$(),e.Y8G("innerHTML",e.bMT(4,5,e.bMT(3,3,e.bMT(2,1,null!==(n=t.obj.ocrContent)&&void 0!==n?n:""))),e.npT)}}let se=(()=>{var o;class r extends m.H{constructor(){super(...arguments),this.changeBookPageStatusEvent=new e.bkB,this.callAgainOcrBookPageEvent=new e.bkB}editBookPage(t){t.currentStatus="show_edit_form",this.changeBookPageStatusEvent.emit(t)}}return(o=r).\u0275fac=(()=>{let n;return function(i){return(n||(n=e.xGo(o)))(i||o)}})(),o.\u0275cmp=e.VBU({type:o,selectors:[["app-digitalized-view-book-page"]],inputs:{obj:"obj"},outputs:{changeBookPageStatusEvent:"changeBookPageStatusEvent",callAgainOcrBookPageEvent:"callAgainOcrBookPageEvent"},features:[e.Vt3],decls:13,vars:9,consts:[[1,"p-3","bg-slate-100","flex","items-center"],[1,"mr-3","w-full"],[1,"mr-2"],[1,"flex-none","items-center"],[4,"ngIf"],[1,"p-3"],[1,"clickable",3,"imageUrl"],["width","50px","height","50px",3,"src"],[1,"mb-3","mt-3"],["class","mb-3 text-pending",4,"ngIf"],[1,"text-primary","clickable","mr-2",3,"click"],["name","pencil","size","16",3,"ngClass"],[1,"text-primary","clickable","ml-2",3,"click"],["name","refresh-cw","size","16",3,"ngClass"],[1,"mb-3","text-pending"],[3,"innerHTML"]],template:function(t,i){1&t&&(e.j41(0,"div",0)(1,"span",1)(2,"b",2),e.EFF(3),e.nI1(4,"mytranslate"),e.k0s()(),e.j41(5,"div",3),e.DNE(6,ne,10,10,"ng-container",4),e.k0s()(),e.j41(7,"div",5)(8,"azt-preview-image-tag",6),e.nrm(9,"img",7),e.k0s(),e.nrm(10,"hr",8),e.DNE(11,ae,3,3,"div",9)(12,le,5,7,"div",4),e.k0s()),2&t&&(e.R7$(3),e.Lme("",e.bMT(4,7,"lang_cms_admin_digitalized_page"),": ",i.obj.currentPage,""),e.R7$(3),e.Y8G("ngIf",i.obj.isOrc),e.R7$(2),e.Y8G("imageUrl",i.obj.imageLink),e.R7$(),e.Y8G("src",i.obj.imageLink,e.B4B),e.R7$(2),e.Y8G("ngIf",i.obj.logMessage),e.R7$(),e.Y8G("ngIf",i.obj.isOrc))},dependencies:[s.YU,s.bT,$,f.WGl,s.Jj,y.wp,y.km,y._y],encapsulation:2}),r})();var Y=l(52811);let re=(()=>{var o;class r extends m.H{}return(o=r).\u0275fac=(()=>{let n;return function(i){return(n||(n=e.xGo(o)))(i||o)}})(),o.\u0275cmp=e.VBU({type:o,selectors:[["app-digitalized-processing-book-page"]],inputs:{obj:"obj"},features:[e.Vt3],decls:13,vars:9,consts:[[1,"p-3","bg-slate-100","flex","items-center"],[1,"mr-3","w-full"],[1,"mr-2"],[1,"p-3"],[1,"clickable",3,"imageUrl"],["width","50px","height","50px",3,"src"],[1,"mb-3","mt-3"],[1,"flex","items-center"],[1,"mr-1"]],template:function(t,i){if(1&t&&(e.j41(0,"div",0)(1,"span",1)(2,"b",2),e.EFF(3),e.nI1(4,"mytranslate"),e.k0s()()(),e.j41(5,"div",3)(6,"azt-preview-image-tag",4),e.nrm(7,"img",5),e.k0s(),e.nrm(8,"hr",6),e.j41(9,"div",7),e.nrm(10,"azt-loading-ui",8),e.EFF(11),e.nI1(12,"mytranslate"),e.k0s()()),2&t){let a;e.R7$(3),e.Lme("",e.bMT(4,5,"lang_cms_admin_digitalized_page"),": ",i.obj.currentPage,""),e.R7$(3),e.Y8G("imageUrl",i.obj.imageLink),e.R7$(),e.Y8G("src",i.obj.imageLink,e.B4B),e.R7$(4),e.SpI(" ",e.bMT(12,7,null!==(a=i.obj.logMessage)&&void 0!==a?a:"lang_lang_cms_admin_digitalized_is_waiting_to_process")," ")}},dependencies:[Y.R,$,y.wp],encapsulation:2}),r})();var W=l(21973),X=l(73014),K=l(89163),ce=l(33887);const de=["angularCropper"];function ge(o,r){if(1&o){const n=e.RV6();e.qex(0),e.j41(1,"img",11),e.nI1(2,"addBase64Extension"),e.bIt("click",function(){const i=e.eBV(n).$implicit,a=e.XpG(2);return e.Njj(a.chooseImage(i))}),e.k0s(),e.bVm()}if(2&o){const n=r.$implicit;e.R7$(),e.FS9("src",e.i5U(2,1,n.base64,"png"),e.B4B)}}function me(o,r){if(1&o&&(e.j41(0,"div",9),e.DNE(1,ge,3,4,"ng-container",10),e.k0s()),2&o){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",n.base64Images)}}function _e(o,r){if(1&o&&(e.nrm(0,"angular-cropper",12,0),e.nI1(2,"addBase64Extension")),2&o){const n=e.XpG();e.Y8G("cropperOptions",n.cropperOptions)("imageUrl",e.i5U(2,2,n.currentBase64Image.base64,"png"))}}let pe=(()=>{var o;class r extends ce._{chooseImage(t){this.currentBase64Image=t}cropImage(t){var i=this;return(0,X.A)(function*(){i.angularCropper?.cropper.getCroppedCanvas().toBlob(a=>{a&&i.sAztBase64Service.convertBlobToBase64(a,function(){var b=(0,X.A)(function*(h){let k=i.angularCropper?.cropper.getCropBoxData(),G=k?.width,x=k?.height;!G||!x||(i.base64Images.push({base64:h,x:0,y:0,width:G,height:x,extension:"png"}),yield i.sAztBase64Service.copyBase64ToClipBoard(h),i.showSuccessSnack("lang_cms_copy_success"),t&&i.dialogRef.close(i.base64Images))});return function(h){return b.apply(this,arguments)}}())})})()}closeDialog(){this.dialogRef.close(this.base64Images)}constructor(t,i){super(i,t),this.dialogRef=t,this.data=i,this.sAztBase64Service=(0,e.WQX)(W.D),this.base64Images=[],this.cropperOptions={movable:!0,scalable:!1,zoomable:!1,data:{width:240,height:90}},this.base64Images=i.base64Images,this.currentBase64Image=this.commonService.getFirstOfArray(this.base64Images)}}return(o=r).\u0275fac=function(t){return new(t||o)(e.rXU(K.CP,8),e.rXU(K.Vh,8))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-coazt-image-editor"]],viewQuery:function(t,i){if(1&t&&e.GBs(de,5),2&t){let a;e.mGM(a=e.lsd())&&(i.angularCropper=a.first)}},features:[e.Vt3],decls:14,vars:11,consts:[["angularCropper",""],[1,"box","p-3"],["class","list-base640-images mb-3",4,"ngIf"],[1,"text-center","mb-3"],[1,"btn","btn-primary","mr-2",3,"click"],[1,"btn","btn-info","mr-2",3,"click"],[1,"btn","btn-secondary","mr-2","w-32",3,"click"],[2,"height","calc(100vh - 120px)","overflow-x","hidden","overflow-y","scroll"],[3,"cropperOptions","imageUrl",4,"ngIf"],[1,"list-base640-images","mb-3"],[4,"ngFor","ngForOf"],[1,"box","mr-2","mb-2","clickable",3,"click","src"],[3,"cropperOptions","imageUrl"]],template:function(t,i){1&t&&(e.j41(0,"div",1),e.DNE(1,me,2,1,"div",2),e.j41(2,"div",3)(3,"span",4),e.bIt("click",function(){return i.cropImage(!0)}),e.EFF(4),e.nI1(5,"mytranslate"),e.k0s(),e.j41(6,"span",5),e.bIt("click",function(){return i.cropImage(!1)}),e.EFF(7),e.nI1(8,"mytranslate"),e.k0s(),e.j41(9,"span",6),e.bIt("click",function(){return i.closeDialog()}),e.EFF(10),e.nI1(11,"mytranslate"),e.k0s()(),e.j41(12,"div",7),e.DNE(13,_e,3,5,"angular-cropper",8),e.k0s()()),2&t&&(e.R7$(),e.Y8G("ngIf",i.base64Images.length>0),e.R7$(3),e.JRh(e.bMT(5,5,"lang_button_crop_and_close")),e.R7$(3),e.JRh(e.bMT(8,7,"lang_button_crop")),e.R7$(3),e.JRh(e.bMT(11,9,"lang_button_close")),e.R7$(3),e.Y8G("ngIf",i.currentBase64Image))},dependencies:[s.Sq,s.bT,T.TJ,y.wp,y.t4],styles:[".list-base640-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ccc;height:50px;width:50px}"]}),r})();function ue(o,r){if(1&o){const n=e.RV6();e.qex(0),e.j41(1,"img",6),e.nI1(2,"addBase64Extension"),e.bIt("click",function(){const i=e.eBV(n).$implicit,a=e.XpG(2);return e.Njj(a.copyImage(i))}),e.k0s(),e.bVm()}if(2&o){const n=r.$implicit;e.R7$(),e.FS9("src",e.i5U(2,1,n.base64,n.extension),e.B4B)}}function be(o,r){if(1&o&&(e.j41(0,"div",4),e.DNE(1,ue,3,4,"ng-container",5),e.k0s()),2&o){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",n.base64Images)}}let he=(()=>{var o;class r extends m.H{constructor(){super(...arguments),this.replaceImageEvent=new e.bkB,this.sAztDialogService=(0,e.WQX)(L.i),this.sAztDigitalizeService=(0,e.WQX)(S.Y),this.sAztBase64Service=(0,e.WQX)(W.D),this.base64Images=[]}copyImage(t){var i=this;return(0,X.A)(function*(){yield i.sAztBase64Service.copyBase64ToClipBoard(t.base64),i.showSuccessSnack("lang_cms_copy_and_replace_success"),i.replaceImageEvent.emit(t)})()}cropImageDialog(){this.sAztDialogService.open(pe,{data:{base64Images:this.base64Images},restoreFocus:!1,width:"100vw",maxWidth:"100vw",height:"100vh",backdropClass:"azt-backdrop-full-width-height",disableClose:!0}).afterClosed().subscribe(i=>{null!=i&&(this.base64Images=i)})}ngOnChanges(){this.initStatusObj(),this.sAztDigitalizeService.extractImageByOrcUtil(this.imageUrl,(t,i,a)=>{if(a)return this.errorStatusObj(a,!0);let b=[];t&&b.push(t),i.forEach(h=>b.push(h)),this.base64Images=b,this.stopStatusObj()})}}return(o=r).\u0275fac=(()=>{let n;return function(i){return(n||(n=e.xGo(o)))(i||o)}})(),o.\u0275cmp=e.VBU({type:o,selectors:[["app-digitalized-list-digitalized-images"]],inputs:{imageUrl:"imageUrl"},outputs:{replaceImageEvent:"replaceImageEvent"},features:[e.Vt3,e.OA$],decls:6,vars:4,consts:[[2,"height","228px","overflow-x","scroll","overflow-y","hidden"],["class","list-base640-images",4,"ngIf"],[1,"mb-3","mt-3"],[1,"text-primary","clickable",3,"click"],[1,"list-base640-images"],[4,"ngFor","ngForOf"],[1,"box","mr-2","mb-2","clickable",3,"click","src"]],template:function(t,i){1&t&&(e.j41(0,"div",0),e.DNE(1,be,2,1,"div",1),e.k0s(),e.j41(2,"div",2)(3,"span",3),e.bIt("click",function(){return i.cropImageDialog()}),e.EFF(4),e.nI1(5,"mytranslate"),e.k0s()()),2&t&&(e.R7$(),e.Y8G("ngIf",i.base64Images.length>0),e.R7$(3),e.JRh(e.bMT(5,2,"lang_button_crop")))},dependencies:[s.Sq,s.bT,y.wp,y.t4],styles:[".list-base640-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid #ccc;max-height:200px}"]}),r})();const fe=()=>({"flex-none":!0,"mr-1":!0});function ze(o,r){1&o&&e.nrm(0,"azt-loading-ui",13)}function ve(o,r){1&o&&e.nrm(0,"azt-loading-ui",13)}let Ce=(()=>{var o;class r extends m.H{saveAllObjs(){this.saveAllContentEvent.emit()}saveObj(){this.initStatusObj();let t=this.obj.htmlContentFormControl.value;this.sAztDigitalizeService.callChangeBookPageDataApi(this.bookObj.id,this.obj.id,t,void 0,(i,a)=>{if(!i)return this.errorStatusObj(a,!0);this.obj.ocrContent=t,this.changeBookPageStatusEvent.emit(this.obj),this.successStatusObj("lang_cms_update_success",!0)})}cancelObj(){this.showSuccessSnack("lang_cms_cancel_success"),this.obj.htmlContentFormControl.setValue(this.obj.ocrContent??"")}replaceImage(t){let i=this.obj.htmlContentFormControl.value.replace("<img>",`<img src='${this.sAztBase64Service.generateBase64Prefix(t.extension)+t.base64}'/>`);this.obj.htmlContentFormControl.setValue(i)}ngOnChanges(){this.obj.htmlContentFormControl.setValue(this.obj.ocrContent??"")}ngOnInit(){super.ngOnInit()}constructor(){super(),this.sAztDigitalizeService=(0,e.WQX)(S.Y),this.sAztBase64Service=(0,e.WQX)(W.D),this.changeBookPageStatusEvent=new e.bkB,this.callAgainOcrBookPageEvent=new e.bkB,this.saveAllContentEvent=new e.bkB}}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-digitalized-edit-book-page"]],inputs:{bookObj:"bookObj",obj:"obj"},outputs:{changeBookPageStatusEvent:"changeBookPageStatusEvent",callAgainOcrBookPageEvent:"callAgainOcrBookPageEvent",saveAllContentEvent:"saveAllContentEvent"},features:[e.Vt3,e.OA$],decls:26,vars:29,consts:[[1,"p-3","bg-slate-100","flex","items-center"],[1,"mr-3","w-full"],[1,"mr-2"],[1,"text-primary","clickable","ml-2",3,"click"],["name","refresh-cw","size","16",3,"ngClass"],[1,"p-3"],[3,"replaceImageEvent","imageUrl"],[3,"formControl","apiKey","init"],[1,"flex-none","items-center","text-right","mt-3"],[1,"btn","btn-secondary","mr-3",3,"click"],[1,"btn","btn-primary-soft","mr-3",3,"click"],["class","mr-1",4,"ngIf"],[1,"btn","btn-primary",3,"click"],[1,"mr-1"]],template:function(t,i){1&t&&(e.j41(0,"div",0)(1,"span",1)(2,"b",2),e.EFF(3),e.nI1(4,"mytranslate"),e.k0s(),e.j41(5,"span",3),e.bIt("click",function(){return i.callAgainOcrBookPageEvent.emit(i.obj)}),e.nrm(6,"lucide-icon",4),e.EFF(7),e.nI1(8,"mytranslate"),e.k0s()()(),e.j41(9,"div",5)(10,"app-digitalized-list-digitalized-images",6),e.bIt("replaceImageEvent",function(b){return i.replaceImage(b)}),e.k0s(),e.nrm(11,"editor",7),e.nI1(12,"getTinyMceKey"),e.nI1(13,"getTinyMceConfig"),e.j41(14,"div",8)(15,"button",9),e.bIt("click",function(){return i.cancelObj()}),e.EFF(16),e.nI1(17,"mytranslate"),e.k0s(),e.j41(18,"button",10),e.bIt("click",function(){return i.saveObj()}),e.DNE(19,ze,1,0,"azt-loading-ui",11),e.EFF(20),e.nI1(21,"mytranslate"),e.k0s(),e.j41(22,"button",12),e.bIt("click",function(){return i.saveAllObjs()}),e.DNE(23,ve,1,0,"azt-loading-ui",11),e.EFF(24),e.nI1(25,"mytranslate"),e.k0s()()()),2&t&&(e.R7$(3),e.Lme("",e.bMT(4,14,"lang_cms_admin_digitalized_page"),": ",i.obj.currentPage,""),e.R7$(3),e.Y8G("ngClass",e.lJ4(28,fe)),e.R7$(),e.SpI(" ",e.bMT(8,16,"lang_cms_admin_digitalized_re_digitalized_again")," "),e.R7$(3),e.Y8G("imageUrl",i.obj.imageLink),e.R7$(),e.FS9("apiKey",e.bMT(12,18,"")),e.Y8G("formControl",i.obj.htmlContentFormControl)("init",e.bMT(13,20,"admin_for_digitalized")),e.BMQ("style","width: 100%;min-height:500px;",e.$dS),e.R7$(5),e.JRh(e.bMT(17,22,"lang_auto_huy")),e.R7$(3),e.Y8G("ngIf",i.statusObj.loading),e.R7$(),e.SpI(" ",e.bMT(21,24,"lang_digitalized_save_one")," "),e.R7$(3),e.Y8G("ngIf",i.statusObj.loading),e.R7$(),e.SpI(" ",e.bMT(25,26,"lang_digitalized_save_all")," "))},dependencies:[s.YU,s.bT,p.BC,c.xn,p.l_,Y.R,f.WGl,he,y.wp,y.Hw,y.yc],encapsulation:2}),r})();function ke(o,r){if(1&o&&e.nrm(0,"azt-loading-effect",3),2&o){const n=e.XpG();e.Y8G("currentStatusObj",n.statusObj)}}function Ie(o,r){if(1&o){const n=e.RV6();e.j41(0,"app-digitalized-view-book-page",18),e.bIt("changeBookPageStatusEvent",function(i){e.eBV(n);const a=e.XpG(5);return e.Njj(a.changeBookPageStatus(i))})("callAgainOcrBookPageEvent",function(i){e.eBV(n);const a=e.XpG(5);return e.Njj(a.reDigitalizedOneObj(i))}),e.k0s()}if(2&o){const n=e.XpG(2).$implicit;e.Y8G("obj",n)}}function De(o,r){if(1&o){const n=e.RV6();e.j41(0,"app-digitalized-edit-book-page",19),e.bIt("changeBookPageStatusEvent",function(i){e.eBV(n);const a=e.XpG(5);return e.Njj(a.changeBookPageStatus(i))})("callAgainOcrBookPageEvent",function(i){e.eBV(n);const a=e.XpG(5);return e.Njj(a.reDigitalizedOneObj(i))})("saveAllContentEvent",function(){e.eBV(n);const i=e.XpG(5);return e.Njj(i.saveAllContent())}),e.k0s()}if(2&o){const n=e.XpG(2).$implicit,t=e.XpG(3);e.Y8G("bookObj",t.bookObj)("obj",n)}}function Oe(o,r){if(1&o&&e.nrm(0,"app-digitalized-processing-book-page",20),2&o){const n=e.XpG(2).$implicit;e.Y8G("obj",n)}}function Be(o,r){if(1&o&&(e.j41(0,"div"),e.DNE(1,Ie,1,1,"app-digitalized-view-book-page",15)(2,De,1,2,"app-digitalized-edit-book-page",16)(3,Oe,1,1,"app-digitalized-processing-book-page",17),e.k0s()),2&o){const n=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf","none"==n.currentStatus),e.R7$(),e.Y8G("ngIf","show_edit_form"==n.currentStatus),e.R7$(),e.Y8G("ngIf","calling_ocr_api"==n.currentStatus)}}function Ae(o,r){if(1&o&&(e.qex(0),e.DNE(1,Be,4,3,"div",14),e.bVm()),2&o){const n=r.$implicit;e.R7$(),e.Y8G("ngIf",n.isShow)}}function je(o,r){if(1&o){const n=e.RV6();e.j41(0,"div",5)(1,"div",6)(2,"button",7),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.digitalizedAll())}),e.EFF(3),e.nI1(4,"mytranslate"),e.k0s(),e.j41(5,"button",7),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.runDigitalizedCurrentPage())}),e.EFF(6),e.nI1(7,"mytranslate"),e.k0s(),e.j41(8,"button",8),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.exportData("html"))}),e.EFF(9),e.nI1(10,"mytranslate"),e.k0s(),e.j41(11,"button",8),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.exportData("docx"))}),e.EFF(12),e.nI1(13,"mytranslate"),e.k0s(),e.j41(14,"button",8),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.exportData("txt"))}),e.EFF(15),e.nI1(16,"mytranslate"),e.k0s()(),e.j41(17,"div",9),e.DNE(18,Ae,2,1,"ng-container",10),e.k0s(),e.j41(19,"div",11)(20,"div",12)(21,"azt-paging",13),e.bIt("goToPaginationPage",function(i){e.eBV(n);const a=e.XpG(2);return e.Njj(a.goToPage(i))}),e.k0s()()()()}if(2&o){const n=e.XpG(2);e.R7$(3),e.E5c("",e.bMT(4,10,"lang_cms_admin_digitalized_digitalized_all")," (",n.bookObj.totalDone," / ",n.bookObj.totalPage,")"),e.R7$(3),e.Lme("",e.bMT(7,12,"lang_cms_admin_digitalized_digitalized_current_page")," (",n.totalCurrentItems,")"),e.R7$(3),e.JRh(e.bMT(10,14,"lang_cms_admin_digitalized_digitalized_export_html")),e.R7$(3),e.JRh(e.bMT(13,16,"lang_cms_admin_digitalized_digitalized_export_docx")),e.R7$(3),e.JRh(e.bMT(16,18,"lang_cms_admin_digitalized_digitalized_export_txt")),e.R7$(3),e.Y8G("ngForOf",n.objs),e.R7$(3),e.Y8G("pageObj",n.pageObj)}}function Ee(o,r){if(1&o&&e.DNE(0,je,22,20,"div",4),2&o){const n=e.XpG();e.Y8G("ngIf",n.bookObj)}}let Se=(()=>{var o;class r extends m.H{digitalizedAll(){this.digitalizedObjs(this.objs.filter(t=>"none"==t.currentStatus&&1!=t.isOrc))}runDigitalizedCurrentPage(){this.digitalizedObjs(this.objs.filter(t=>t.isShow&&"none"==t.currentStatus&&1!=t.isOrc))}reDigitalizedOneObj(t){this.digitalizedObjs([t])}digitalizedObjs(t){this.showSuccessSnack(this.commonService.myTranslateInstant("lang_cms_admin_digitalized_for_total_object")+": "+t.length);let i=t.map(b=>b.id);this.objs.forEach(b=>!!i.includes(b.id)&&Object.assign(b,{...b,currentStatus:"calling_ocr_api"}));let a=[];t.forEach(b=>a.push(this.runDigitalizeOneImage(b))),this.waitDestroy(this.sAztConcurrencyApiService.processObservables(1,a,!1).subscribe(b=>{}))}runDigitalizeOneImage(t){return this.sAztDigitalizeService.digitalizeOneImage(t.imageLink,i=>{console.log(`Digitalized for: Id: ${t.id} | Link: ${t.imageLink}`),this.objs.forEach(a=>a.id==t.id&&Object.assign(a,{...a,logMessage:i}))},i=>{console.log(`Digitalized error: Id: ${t.id} | Link: ${t.imageLink} | message: ${i}`),this.objs.forEach(a=>a.id==t.id&&Object.assign(a,{...a,logMessage:i,currentStatus:"none"}))},i=>{this.sAztDigitalizeService.callChangeBookPageDataApi(this.bookId,t.id,i.htmlResult,i.originOcrData,(a,b)=>{if(!a)return console.log(`Digitalized error: Id: ${t.id} | Link: ${t.imageLink} | message: ${b}`),void this.objs.forEach(h=>h.id==t.id&&Object.assign(h,{...h,logMessage:b,currentStatus:"none"}));this.objs.forEach(h=>h.id==t.id&&Object.assign(h,{...h,logMessage:"",currentStatus:"show_edit_form",ocrContent:i.htmlResult,originOcrContent:i.originOcrData,isOrc:1})),this.bookObj.totalDone=this.objs.filter(h=>h.isOrc).length,console.log(`Digitalized success: Id: ${t.id} | Link: ${t.imageLink}`)})})}saveAllContent(){this.initStatusObj();let t=this.objs.filter(a=>1==a.isOrc).map(a=>({bookPageId:a.id,ocrContent:a.htmlContentFormControl.value}));this.waitDestroy(this.digitalizedBookPageService.apiDigitalizedBookPageUpdateOcrObjsPost({bookId:this.bookId,objs:t}).subscribe(a=>{if(!a.success)return this.errorStatusObj(a.message,!0);this.objs.forEach(b=>{let h=t.find(k=>k.bookPageId==b.id);h&&(b.ocrContent=h.ocrContent)}),this.successStatusObj("lang_cms_update_success",!0)}))}changeBookPageStatus(t){this.objs.forEach(i=>i.id==t.id&&Object.assign(i,{...t}))}exportData(t){let i=new Date;if("txt"==t){let k="";this.objs.forEach(pt=>k+=pt.originOcrContent+"\n");let G=`azota-digitalize-book-${i.getDate()}${i.getMonth()+1}${i.getFullYear()}-${i.getTime()}.txt`;const x=new Blob([k],{type:"text/plain"});return void(x&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(x),G))}let a="";if(this.objs.forEach(k=>a+=`<page [page]='${k.currentPage}'/>`+(k.ocrContent??"")),a=this.commonService.decodeHtmlEntities(a),"html"==t){a=this.commonService.convertMathTagToLatex(a),a+=(0,O.A3)("PHNjcmlwdD4KCWZ1bmN0aW9uIGdldFNlbGVjdGlvbkh0bWwoKSB7CgkJdmFyIHNlbGVjdGlvbiA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpOwoJCWlmIChzZWxlY3Rpb24ucmFuZ2VDb3VudCA8PSAwKSByZXR1cm4gJyc7CgoJCXZhciByYW5nZSA9IHNlbGVjdGlvbi5nZXRSYW5nZUF0KDApOwoJCXZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKCQljb250YWluZXIuYXBwZW5kQ2hpbGQocmFuZ2UuY2xvbmVDb250ZW50cygpKTsKCQlyZXR1cm4gY29udGFpbmVyLmlubmVySFRNTDsKCX0KCWZ1bmN0aW9uIHNob3dTbmFjayhpc1N1Y2Nlc3MsIG1lc3NhZ2UpIHsKCQkvLyBTdGVwIDE6IENyZWF0ZSB0aGUgc25hY2sgZWxlbWVudAoJCXZhciBzbmFjayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoJCXNuYWNrLnRleHRDb250ZW50ID0gbWVzc2FnZTsKCgkJLy8gU3RlcCAyOiBTdHlsZSB0aGUgc25hY2sgZm9yIHRvcCBsZWZ0IGNlbnRlciBwb3NpdGlvbmluZwoJCXNuYWNrLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJzsKCQlzbmFjay5zdHlsZS50b3AgPSAnMjBweCc7CgkJc25hY2suc3R5bGUubGVmdCA9ICc1MCUnOwoJCXNuYWNrLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC01MCUpJzsgLy8gQ2VudGVyIGhvcml6b250YWxseQoJCXNuYWNrLnN0eWxlLndpZHRoID0gJzQwMHB4JzsKCQlzbmFjay5zdHlsZS5wYWRkaW5nID0gJzEwcHggMjBweCc7CgkJc25hY2suc3R5bGUuYmFja2dyb3VuZENvbG9yID0gaXNTdWNjZXNzID8gJyM0Q0FGNTAnIDogJ3JlZCc7IC8vIEdyZWVuIGJhY2tncm91bmQgZm9yIHN1Y2Nlc3MKCQlzbmFjay5zdHlsZS5jb2xvciA9ICd3aGl0ZSc7CgkJc25hY2suc3R5bGUuYm9yZGVyUmFkaXVzID0gJzVweCc7CgkJc25hY2suc3R5bGUuYm94U2hhZG93ID0gJzBweCAwcHggMTBweCByZ2JhKDAsIDAsIDAsIDAuMSknOwoJCXNuYWNrLnN0eWxlLnpJbmRleCA9ICcxMDAwJzsgLy8gRW5zdXJlIGl0J3Mgb24gdG9wIG9mIG90aGVyIGVsZW1lbnRzCgkJc25hY2suc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7IC8vIENlbnRlciB0ZXh0IGhvcml6b250YWxseQoKCQkvLyBTdGVwIDM6IEFwcGVuZCB0aGUgc25hY2sgdG8gdGhlIGJvZHkKCQlkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNuYWNrKTsKCgkJLy8gU3RlcCA0OiBSZW1vdmUgdGhlIHNuYWNrIGFmdGVyIDYgc2Vjb25kcwoJCXNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CgkJCXNuYWNrLnJlbW92ZSgpOwoJCX0sIDEwMDApOyAvLyAxMDAwIG1pbGxpc2Vjb25kcyA9IDEgc2Vjb25kcwoJfQoJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc2VsZWN0aW9uY2hhbmdlJywgZnVuY3Rpb24oKSB7CgkJdmFyIHNlbGVjdGlvbiA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpOwoJCWlmICghc2VsZWN0aW9uIHx8IHNlbGVjdGlvbi5yYW5nZUNvdW50IDw9IDApIHJldHVybjsKCQlkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZnVuY3Rpb24oKSB7CgkJCXZhciBodG1sU291cmNlID0gZ2V0U2VsZWN0aW9uSHRtbCgpOwoJCQlpZiAoIWh0bWxTb3VyY2UpIHJldHVybjsKCgkJCW5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGh0bWxTb3VyY2UpLnRoZW4oZnVuY3Rpb24oKSB7CgkJCQlzaG93U25hY2sodHJ1ZSwgJ0NvcHkgdGjDoG5oIGPDtG5nIScpOwoJCQl9KS5jYXRjaChmdW5jdGlvbihlcnIpIHsKCQkJCXNob3dTbmFjayhmYWxzZSwgJ0NvcHkgbOG7l2k6ICcgKyBlcnIpOwoJCQl9KTsKCQl9LCB7CgkJCW9uY2U6IHRydWUKCQl9KTsKCX0pOwo8L3NjcmlwdD4=");let G=`azota-digitalize-book-${i.getDate()}${i.getMonth()+1}${i.getFullYear()}-${i.getTime()}.html`;const x=new Blob([a],{type:"text/plain"});return void(x&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(x),G))}let b=this.userService.getUserObj(),h=v.c.azt_ai_base_api;this.commonService.loadAzotaDocxJs().then(()=>{(0,u.w)().textToDocxBinary(a,"Bearer "+b.rememberToken,h,null).then(k=>{let G=`azota-digitalize-book-${i.getDate()}${i.getMonth()+1}${i.getFullYear()}-${i.getTime()}.docx`;const x=new Blob([k],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});x&&this.commonService.downloadFileByUrl(window.URL.createObjectURL(x),G)}).catch(k=>{this.showErrorSnack(k)})}).catch(k=>{this.showErrorSnack(k)})}goToPage(t){this.myNavigation(`/azota-digitalized/digitalized-one-book/${this.bookId}/${t}`),this.pageObj.setTotalPages(this.objs.length),this.pageObj.setPageNumber(t);let i=this.pageObj.getViewObjsOfCurrentPage(this.objs).map(a=>a.id);this.objs.forEach(a=>a.isShow=!!i.includes(a.id)),this.totalCurrentItems=this.objs.filter(a=>a.isShow).length}initData(){this.initStatusObj(),this.waitDestroy(this.digitalizedBookPageService.apiDigitalizedBookPageGetObjsGet(this.bookId).subscribe(t=>{if(!t.success||!t.data)return this.errorStatusObj(t.message,!0);this.bookObj=t.data.bookObj,this.objs=t.data.bookPageObjs.map((i,a)=>({...i,isShow:!1,currentPage:a+1,ocrContent:i.ocrContent?this.sAztZipDataService.decodeContentGzip(i.ocrContent):void 0,originOcrContent:i.originOcrContent?this.sAztZipDataService.decodeContentGzip(i.originOcrContent):void 0,logMessage:i.isOrc?void 0:"lang_cms_admin_digitalized_not_call_ocr_status",currentStatus:i.isOrc?"show_edit_form":"none",base64Images:[],htmlContentFormControl:new p.MJ("",{nonNullable:!0})}))??[],this.goToPage(Number(this.commonService.getMyParam(this.activeRoute,"page")??0)),this.stopStatusObj()}))}ngOnInit(){super.ngOnInit(),this.commonService.translateMetaData({title:"lang_cms_admin_digitalized_one_book_title",description:"lang_cms_admin_digitalized_one_book_title",image:"lang_cms_test_image"}),this.bookId=Number(this.commonService.getMyParam(this.activeRoute,"bookId")??0),this.initData()}constructor(t,i,a,b,h,k){super(),this.digitalizedBookPageService=t,this.activeRoute=i,this.sAztZipDataService=a,this.sAztDigitalizeService=b,this.sAztConcurrencyApiService=h,this.userService=k,this.objs=[],this.bookId=0,this.backTo="/azota-digitalized/list-books",this.pageObj=new d.d(10),this.totalCurrentItems=0}}return(o=r).\u0275fac=function(t){return new(t||o)(e.rXU(C.gI),e.rXU(z.nX),e.rXU(E.j),e.rXU(S.Y),e.rXU(F.Z),e.rXU(w.R))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-digitalized-digitalized-one-book"]],features:[e.Vt3],decls:4,vars:3,consts:[["doneLoading",""],[3,"headerBackToLink"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],[3,"currentStatusObj"],["class","mt-5",4,"ngIf"],[1,"mt-5"],[1,"flex","items-center","mb-3","pb-3",2,"border-bottom","1px solid #ccc"],[1,"btn","btn-primary","mr-3",3,"click"],[1,"btn","btn-success","mr-3",3,"click"],[1,"box"],[4,"ngFor","ngForOf"],[1,"col-span-12","flex","flex-wrap","sm:flex-row","sm:flex-nowrap","items-center","mt-3"],[1,"w-full","sm:w-auto","sm:mr-auto"],[3,"goToPaginationPage","pageObj"],[4,"ngIf"],[3,"obj","changeBookPageStatusEvent","callAgainOcrBookPageEvent",4,"ngIf"],[3,"bookObj","obj","changeBookPageStatusEvent","callAgainOcrBookPageEvent","saveAllContentEvent",4,"ngIf"],[3,"obj",4,"ngIf"],[3,"changeBookPageStatusEvent","callAgainOcrBookPageEvent","obj"],[3,"changeBookPageStatusEvent","callAgainOcrBookPageEvent","saveAllContentEvent","bookObj","obj"],[3,"obj"]],template:function(t,i){if(1&t&&(e.j41(0,"teacher-layout",1),e.DNE(1,ke,1,1,"azt-loading-effect",2)(2,Ee,1,1,"ng-template",null,0,e.C5r),e.k0s()),2&t){const a=e.sdS(3);e.Y8G("headerBackToLink",i.backTo),e.R7$(),e.Y8G("ngIf",i.statusObj.loading)("ngIfElse",a)}},dependencies:[s.Sq,s.bT,V.K,te.q,N.Q,se,re,Ce,y.wp],encapsulation:2}),r})();var Te=l(52909);class ye{static validBookPage(r){const n=r;return n.controls.filter(i=>i.controls.isShow.value).length>0?(r.setErrors(null),null):(n.setErrors({validBookPage:!0}),{identityRevealed:!0})}}var Pe=l(15766),H=l(39712);let Q=(()=>{var o;class r extends m.H{removeBackgroundNoise(t){this.initStatusObj();let a=this.form.controls.bookPageFormArray.getRawValue().filter(b=>(!!t||b.isSelected)&&b.isShow).map(b=>this.sAztDigitalizeService.runRemoveBackgroundNoise({uuid:b.randomUuid,oldImageUrl:b.imageLink,newImageUrl:""},this.defaultThreshold,h=>console.log("Remove noise error",h)));this.waitDestroy(this.sAztConcurrencyApiService.processObservables(20,a,!1).subscribe(b=>{let h=this.form.controls.bookPageFormArray.getRawValue();h.forEach(k=>{let G=b.find(x=>x?.uuid==x?.uuid)?.newImageUrl;G&&(k.imageLink=G,k.needUpdate=!0)}),this.form.controls.bookPageFormArray.patchValue(h),this.stopStatusObj()}))}selectAll(t){this.form.controls.bookPageFormArray.controls.map(i=>i.controls.isSelected.setValue(t))}deleteAllSelected(){this.form.controls.bookPageFormArray.controls.forEach(t=>{t.controls.isSelected.value&&t.controls.isShow.setValue(!1)})}countSelected(){this.totalPage=this.form.controls.bookPageFormArray.getRawValue().filter(t=>t.isShow).length,this.totalSelectedPage=this.form.controls.bookPageFormArray.getRawValue().filter(t=>t.isShow&&t.isSelected).length}cancel(){this.commonService.myNavigation(this.backTo)}handleUploadComplete(t){t.forEach(i=>{i.url&&this.form.controls.bookPageFormArray.push(new p.gE({id:new p.MJ(0,{nonNullable:!0}),randomUuid:new p.MJ(this.sAztUuidService.getUuid(),{nonNullable:!0}),name:new p.MJ(i.name??"",{nonNullable:!0}),imageLink:new p.MJ(i.url,{nonNullable:!0}),isShow:new p.MJ(!0,{nonNullable:!0}),isSelected:new p.MJ(!1,{nonNullable:!0}),needUpdate:new p.MJ(!1,{nonNullable:!0})}))}),this.form.controls.bookPageFormArray.updateValueAndValidity()}removeBookPageObj(t){let i=this.form.controls.bookPageFormArray.controls.find(a=>a.controls.randomUuid.value==t);i?.controls.isShow.setValue(!1),this.form.controls.bookPageFormArray.updateValueAndValidity()}constructor(){super(),this.sAztUuidService=(0,e.WQX)(Te.D),this.sAztDigitalizeService=(0,e.WQX)(S.Y),this.sAztConcurrencyApiService=(0,e.WQX)(F.Z),this.backTo="",this.allUploadToCdnMenuTypes=H.b8,this.allUploadFileTypes=H.PO,this.totalSelectedPage=0,this.totalPage=0,this.defaultThreshold=230,this.form=new p.gE({name:new p.MJ("",{nonNullable:!0,validators:[Pe.M.noWhiteSpace]}),bookPageFormArray:new p.Yp([],{validators:[ye.validBookPage]})}),this.form.valueChanges.subscribe(t=>this.countSelected())}}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-base-create-or-update-book"]],features:[e.Vt3],decls:0,vars:0,template:function(t,i){},encapsulation:2}),r})();var Fe=l(92091),xe=l(64168),q=l(63349);const Re=o=>({"error-border":o}),Ue=(o,r)=>[o,r];function Ge(o,r){if(1&o&&e.nrm(0,"azt-loading-effect",4),2&o){const n=e.XpG();e.Y8G("currentStatusObj",n.statusObj)}}function we(o,r){if(1&o){const n=e.RV6();e.j41(0,"div",14)(1,"div",15)(2,"azt-upload-multiple-box",27),e.bIt("uploadComplete",function(i){e.eBV(n);const a=e.XpG(2);return e.Njj(a.handleUploadComplete(i))}),e.j41(3,"div",28),e.nrm(4,"lucide-icon",29),e.EFF(5),e.nI1(6,"mytranslate"),e.k0s()()()()}if(2&o){const n=e.XpG(2);e.R7$(2),e.Y8G("uploadToCdnMenu",n.allUploadToCdnMenuTypes.ADMIN_DIGITALIZE)("fileType",e.l_i(8,Ue,n.allUploadFileTypes.IMAGE,n.allUploadFileTypes.PDF))("convertPdfTimeout",600)("convertPdfToImages",!0)("showProgress",!0),e.R7$(3),e.SpI(" ",e.bMT(6,6,"lang_cms_admin_digitalized_upload_pdf_or_image_files")," ")}}function Me(o,r){if(1&o){const n=e.RV6();e.j41(0,"span"),e.EFF(1," | "),e.j41(2,"span",22),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.removeBackgroundNoise(!1))}),e.EFF(3),e.nI1(4,"mytranslate"),e.k0s(),e.EFF(5," | "),e.j41(6,"span",30),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.deleteAllSelected())}),e.EFF(7),e.nI1(8,"mytranslate"),e.k0s()()}if(2&o){const n=e.XpG(2);e.R7$(3),e.E5c("",e.bMT(4,6,"lang_digitalized_remove_background_noise_of_selections")," (",n.totalSelectedPage,"/",n.totalPage,")"),e.R7$(4),e.E5c("",e.bMT(8,8,"lang_auto_xoa")," (",n.totalSelectedPage,"/",n.totalPage,")")}}function Ve(o,r){1&o&&(e.j41(0,"div"),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&o&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"lang_cms_admin_digitalized_upload_image_to_create_book")," "))}function Ne(o,r){if(1&o&&(e.qex(0),e.j41(1,"div",33)(2,"azt-preview-image-tag",34),e.nrm(3,"img",35),e.k0s(),e.j41(4,"div",8)(5,"span",36),e.EFF(6),e.k0s(),e.nrm(7,"input",37),e.k0s()(),e.bVm()),2&o){const n=r.$implicit,t=r.index;e.R7$(),e.Y8G("hidden",!n.controls.isShow.value),e.R7$(),e.Y8G("imageUrl",n.controls.imageLink.value),e.R7$(),e.Y8G("src",n.controls.imageLink.value,e.B4B),e.R7$(3),e.JRh(t+1),e.R7$(),e.Y8G("formControl",n.controls.isSelected)}}function $e(o,r){if(1&o&&(e.j41(0,"div",31),e.DNE(1,Ne,8,5,"ng-container",32),e.k0s()),2&o){const n=e.XpG(2);e.R7$(),e.Y8G("ngForOf",n.form.controls.bookPageFormArray.controls)}}function Le(o,r){if(1&o){const n=e.RV6();e.j41(0,"div",5)(1,"form",6)(2,"div",7)(3,"div",8)(4,"h3",9),e.EFF(5),e.nI1(6,"mytranslate"),e.k0s(),e.j41(7,"div",10)(8,"button",11),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(9),e.nI1(10,"mytranslate"),e.k0s(),e.j41(11,"button",12),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.saveObj())}),e.EFF(12),e.nI1(13,"mytranslate"),e.k0s()()(),e.j41(14,"div",13)(15,"div",14)(16,"div",15)(17,"label",16),e.EFF(18),e.nI1(19,"mytranslate"),e.k0s()(),e.j41(20,"div",15)(21,"div",17),e.nrm(22,"input",18),e.k0s()()(),e.DNE(23,we,7,11,"div",19),e.nrm(24,"hr",20),e.j41(25,"span",21),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.selectAll(i.totalSelectedPage!=i.totalPage))}),e.EFF(26),e.nI1(27,"mytranslate"),e.j41(28,"span",22),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.removeBackgroundNoise(!0))}),e.EFF(29),e.nI1(30,"mytranslate"),e.k0s()(),e.DNE(31,Me,9,10,"span",23),e.j41(32,"div",24),e.DNE(33,Ve,3,3,"div",25)(34,$e,2,1,"ng-template",null,1,e.C5r),e.k0s()(),e.j41(36,"div",26)(37,"button",11),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(38),e.nI1(39,"mytranslate"),e.k0s(),e.j41(40,"button",12),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.saveObj())}),e.EFF(41),e.nI1(42,"mytranslate"),e.k0s()()()()()}if(2&o){const n=e.sdS(35),t=e.XpG();e.R7$(),e.Y8G("formGroup",t.form),e.R7$(4),e.SpI(" ",e.bMT(6,19,t.bookId?"lang_cms_admin_edit_book_title":"lang_cms_admin_create_book_title")," "),e.R7$(4),e.JRh(e.bMT(10,21,"lang_auto_huy")),e.R7$(2),e.Y8G("disabled",t.form.invalid),e.R7$(),e.JRh(e.bMT(13,23,"lang_auto_luu")),e.R7$(6),e.SpI(" ",e.bMT(19,25,"lang_cms_admin_create_book_name")," "),e.R7$(4),e.Y8G("formControl",t.form.controls.name)("ngClass",e.eq3(35,Re,t.form.controls.name.invalid)),e.R7$(),e.Y8G("ngIf",!t.bookId),e.R7$(3),e.E5c(" ",e.bMT(27,27,t.totalSelectedPage!=t.totalPage?"lang_select_all":"lang_remove_all")," (",t.totalSelectedPage,"/",t.totalPage,") | "),e.R7$(3),e.JRh(e.bMT(30,29,"lang_digitalized_remove_background_noise_of_all")),e.R7$(2),e.Y8G("ngIf",t.totalSelectedPage>0),e.R7$(2),e.Y8G("ngIf",t.form.controls.bookPageFormArray.controls.length<=0)("ngIfElse",n),e.R7$(5),e.JRh(e.bMT(39,31,"lang_auto_huy")),e.R7$(2),e.Y8G("disabled",t.form.invalid),e.R7$(),e.JRh(e.bMT(42,33,"lang_auto_luu"))}}let Ye=(()=>{var o;class r extends Q{initForm(){}initData(){}saveObj(){this.initStatusObj();let t=this.form.getRawValue();this.waitDestroy(this.digitalizedBookService.apiDigitalizedBookAddObjPost({name:t.name}).subscribe(a=>{if(!a.success||!a.data?.obj)return this.errorStatusObj(a.message,!0);let b={bookId:a.data.obj.id,bookPageObjs:[]};t.bookPageFormArray.filter(h=>h.isShow).forEach(h=>{b.bookPageObjs.push({name:h.name,imageLink:h.imageLink})}),this.waitDestroy(this.digitalizedBookPageService.apiDigitalizedBookPageAddObjsPost(b).subscribe(h=>{if(!h.success)return this.errorStatusObj(h.message,!0);this.successStatusObj("lang_cms_add_success",!0),this.cancel()}))}))}ngOnInit(){super.ngOnInit(),this.commonService.translateMetaData({title:"lang_cms_admin_create_book_title",description:"lang_cms_admin_create_book_title",image:"lang_cms_test_image"}),this.backTo="/azota-digitalized/list-books",this.initData()}constructor(t,i){super(),this.digitalizedBookService=t,this.digitalizedBookPageService=i,this.bookId=0}}return(o=r).\u0275fac=function(t){return new(t||o)(e.rXU(Fe.Z),e.rXU(xe.g))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-digitalized-create-book"]],features:[e.Vt3],decls:4,vars:3,consts:[["doneLoading",""],["viewBookPageTpl",""],[3,"headerBackToLink"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],[3,"currentStatusObj"],[1,"mt-5"],[3,"formGroup"],[1,"azt-config-document"],[1,"flex","items-center"],[1,"text-md","uppercase","font-medium","w-full"],[1,"flex-none","items-center"],[1,"btn","w-24","btn-secondary","mr-3",3,"click"],[1,"btn","btn-primary-soft","w-24",3,"click","disabled"],[1,"box","mt-4","p-5"],[1,"grid","grid-cols-12","mb-3"],[1,"col-span-12","lg:col-span-12"],[1,"form-label","mb-0","font-medium","flex","items-center"],[1,"setting-input"],["type","text",1,"form-control",3,"formControl","ngClass"],["class","grid grid-cols-12 mb-3",4,"ngIf"],[1,"mb-3"],[1,"clickable","link-color","mr-2",3,"click"],[1,"clickable","text-primary","mr-2","ml-2",3,"click"],[4,"ngIf"],[1,"mt-3","mb-3"],[4,"ngIf","ngIfElse"],[1,"text-right","mt-5"],[3,"uploadComplete","uploadToCdnMenu","fileType","convertPdfTimeout","convertPdfToImages","showProgress"],[1,"h-full","w-full","cursor-pointer","text-primary"],["name","cloud-upload","size","24"],[1,"clickable","text-danger","mr-2","ml-2",3,"click"],[1,"sml-3","smr-3"],[4,"ngFor","ngForOf"],[1,"ml-3","mr-3","mb-3","p-3","bg-slate-100","box","inline-block",3,"hidden"],[1,"clickable",3,"imageUrl"],[1,"clickable",2,"width","250px","height","120px",3,"src"],[1,"w-full","text-pending","font-medium"],["type","checkbox",1,"form-check-input","mt-1",3,"formControl"]],template:function(t,i){if(1&t&&(e.j41(0,"teacher-layout",2),e.DNE(1,Ge,1,1,"azt-loading-effect",3)(2,Le,43,37,"ng-template",null,0,e.C5r),e.k0s()),2&t){const a=e.sdS(3);e.Y8G("headerBackToLink",i.backTo),e.R7$(),e.Y8G("ngIf",1==i.statusObj.loading)("ngIfElse",a)}},dependencies:[s.YU,s.Sq,s.bT,p.qT,p.me,p.Zm,p.BC,p.cb,p.l_,p.j4,V.K,q.V,$,N.Q,f.WGl,y.wp],encapsulation:2}),r})();const We=o=>({"error-border":o}),Xe=(o,r)=>[o,r];function Je(o,r){if(1&o&&e.nrm(0,"azt-loading-effect",4),2&o){const n=e.XpG();e.Y8G("currentStatusObj",n.statusObj)}}function Ze(o,r){if(1&o){const n=e.RV6();e.j41(0,"div",14)(1,"div",15)(2,"azt-upload-multiple-box",27),e.bIt("uploadComplete",function(i){e.eBV(n);const a=e.XpG(2);return e.Njj(a.handleUploadComplete(i))}),e.j41(3,"div",28),e.nrm(4,"lucide-icon",29),e.EFF(5),e.nI1(6,"mytranslate"),e.k0s()()()()}if(2&o){const n=e.XpG(2);e.R7$(2),e.Y8G("uploadToCdnMenu",n.allUploadToCdnMenuTypes.ADMIN_DIGITALIZE)("fileType",e.l_i(8,Xe,n.allUploadFileTypes.IMAGE,n.allUploadFileTypes.PDF))("convertPdfTimeout",600)("convertPdfToImages",!0)("showProgress",!0),e.R7$(3),e.SpI(" ",e.bMT(6,6,"lang_cms_admin_digitalized_upload_pdf_or_image_files")," ")}}function Ke(o,r){if(1&o){const n=e.RV6();e.j41(0,"span"),e.EFF(1," | "),e.j41(2,"span",22),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.removeBackgroundNoise(!1))}),e.EFF(3),e.nI1(4,"mytranslate"),e.k0s(),e.EFF(5," | "),e.j41(6,"span",30),e.bIt("click",function(){e.eBV(n);const i=e.XpG(2);return e.Njj(i.deleteAllSelected())}),e.EFF(7),e.nI1(8,"mytranslate"),e.k0s()()}if(2&o){const n=e.XpG(2);e.R7$(3),e.E5c("",e.bMT(4,6,"lang_digitalized_remove_background_noise_of_selections")," (",n.totalSelectedPage,"/",n.totalPage,")"),e.R7$(4),e.E5c("",e.bMT(8,8,"lang_auto_xoa")," (",n.totalSelectedPage,"/",n.totalPage,")")}}function He(o,r){1&o&&(e.j41(0,"div"),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&o&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"lang_cms_admin_digitalized_upload_image_to_create_book")," "))}function Qe(o,r){if(1&o&&(e.qex(0),e.j41(1,"div",33)(2,"azt-preview-image-tag",34),e.nrm(3,"img",35),e.k0s(),e.j41(4,"div",8)(5,"span",36),e.EFF(6),e.k0s(),e.nrm(7,"input",37),e.k0s()(),e.bVm()),2&o){const n=r.$implicit,t=r.index;e.R7$(),e.Y8G("hidden",!n.controls.isShow.value),e.R7$(),e.Y8G("imageUrl",n.controls.imageLink.value),e.R7$(),e.Y8G("src",n.controls.imageLink.value,e.B4B),e.R7$(3),e.JRh(t+1),e.R7$(),e.Y8G("formControl",n.controls.isSelected)}}function qe(o,r){if(1&o&&(e.j41(0,"div",31),e.DNE(1,Qe,8,5,"ng-container",32),e.k0s()),2&o){const n=e.XpG(2);e.R7$(),e.Y8G("ngForOf",n.form.controls.bookPageFormArray.controls)}}function et(o,r){if(1&o){const n=e.RV6();e.j41(0,"div",5)(1,"form",6)(2,"div",7)(3,"div",8)(4,"h3",9),e.EFF(5),e.nI1(6,"mytranslate"),e.k0s(),e.j41(7,"div",10)(8,"button",11),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(9),e.nI1(10,"mytranslate"),e.k0s(),e.j41(11,"button",12),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.saveObj())}),e.EFF(12),e.nI1(13,"mytranslate"),e.k0s()()(),e.j41(14,"div",13)(15,"div",14)(16,"div",15)(17,"label",16),e.EFF(18),e.nI1(19,"mytranslate"),e.k0s()(),e.j41(20,"div",15)(21,"div",17),e.nrm(22,"input",18),e.k0s()()(),e.DNE(23,Ze,7,11,"div",19),e.nrm(24,"hr",20),e.j41(25,"span",21),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.selectAll(i.totalSelectedPage!=i.totalPage))}),e.EFF(26),e.nI1(27,"mytranslate"),e.j41(28,"span",22),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.removeBackgroundNoise(!0))}),e.EFF(29),e.nI1(30,"mytranslate"),e.k0s()(),e.DNE(31,Ke,9,10,"span",23),e.j41(32,"div",24),e.DNE(33,He,3,3,"div",25)(34,qe,2,1,"ng-template",null,1,e.C5r),e.k0s()(),e.j41(36,"div",26)(37,"button",11),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(38),e.nI1(39,"mytranslate"),e.k0s(),e.j41(40,"button",12),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.saveObj())}),e.EFF(41),e.nI1(42,"mytranslate"),e.k0s()()()()()}if(2&o){const n=e.sdS(35),t=e.XpG();e.R7$(),e.Y8G("formGroup",t.form),e.R7$(4),e.SpI(" ",e.bMT(6,19,t.bookId?"lang_cms_admin_edit_book_title":"lang_cms_admin_create_book_title")," "),e.R7$(4),e.JRh(e.bMT(10,21,"lang_auto_huy")),e.R7$(2),e.Y8G("disabled",t.form.invalid),e.R7$(),e.JRh(e.bMT(13,23,"lang_auto_luu")),e.R7$(6),e.SpI(" ",e.bMT(19,25,"lang_cms_admin_create_book_name")," "),e.R7$(4),e.Y8G("formControl",t.form.controls.name)("ngClass",e.eq3(35,We,t.form.controls.name.invalid)),e.R7$(),e.Y8G("ngIf",!t.bookId),e.R7$(3),e.E5c(" ",e.bMT(27,27,t.totalSelectedPage!=t.totalPage?"lang_select_all":"lang_remove_all")," (",t.totalSelectedPage,"/",t.totalPage,") | "),e.R7$(3),e.JRh(e.bMT(30,29,"lang_digitalized_remove_background_noise_of_all")),e.R7$(2),e.Y8G("ngIf",t.totalSelectedPage>0),e.R7$(2),e.Y8G("ngIf",t.form.controls.bookPageFormArray.controls.length<=0)("ngIfElse",n),e.R7$(5),e.JRh(e.bMT(39,31,"lang_auto_huy")),e.R7$(2),e.Y8G("disabled",t.form.invalid),e.R7$(),e.JRh(e.bMT(42,33,"lang_auto_luu"))}}let tt=(()=>{var o;class r extends Q{initForm(t){this.form.controls.name.setValue(t.bookObj.name),t.bookPageObjs.forEach(i=>{this.form.controls.bookPageFormArray.push(new p.gE({id:new p.MJ(i.id,{nonNullable:!0}),randomUuid:new p.MJ(i.id.toString(),{nonNullable:!0}),name:new p.MJ(i.name,{nonNullable:!0}),imageLink:new p.MJ(i.imageLink,{nonNullable:!0}),isShow:new p.MJ(!0,{nonNullable:!0}),isSelected:new p.MJ(!1,{nonNullable:!0}),needUpdate:new p.MJ(!1,{nonNullable:!0})}))})}initData(){this.initStatusObj(),this.waitDestroy(this.digitalizedBookService.apiDigitalizedBookGetObjGet(this.bookId).subscribe(t=>{if(!t.success||!t.data)return this.errorStatusObj(t.message,!0);this.initForm(t.data),this.stopStatusObj()}))}saveObj(){this.initStatusObj();let t=this.form.getRawValue();this.waitDestroy(this.digitalizedBookService.apiDigitalizedBookUpdateObjPost({id:this.bookId,name:t.name}).subscribe(a=>{if(!a.success)return this.errorStatusObj(a.message,!0);let b={bookId:this.bookId,objs:t.bookPageFormArray.filter(k=>k.needUpdate&&k.id).map(k=>({bookPageId:k.id,imageLink:k.imageLink}))},h={bookId:this.bookId,ids:t.bookPageFormArray.filter(k=>!k.isShow&&k.id).map(k=>k.id)};if(b.objs.length<=0)return this.processDeleteImages(h);this.waitDestroy(this.digitalizedBookPageService.apiDigitalizedBookPageUpdateImagesPost(b).subscribe(k=>{this.processDeleteImages(h)}))}))}processDeleteImages(t){t.ids.length>0?this.waitDestroy(this.digitalizedBookPageService.apiDigitalizedBookPageDeleteObjPost(t).subscribe(i=>{if(!i.success)return this.errorStatusObj(i.message,!0);this.successStatusObj("lang_cms_update_success",!0),this.cancel()})):(this.successStatusObj("lang_cms_update_success",!0),this.cancel())}ngOnInit(){super.ngOnInit(),this.commonService.translateMetaData({title:"lang_cms_admin_edit_book_title",description:"lang_cms_admin_edit_book_title",image:"lang_cms_test_image"}),this.bookId=Number(this.commonService.getMyParam(this.activeRoute,"bookId")??0),this.backTo="/azota-digitalized/list-books",this.initData()}constructor(t,i,a){super(),this.digitalizedBookService=t,this.digitalizedBookPageService=i,this.activeRoute=a,this.bookId=0}}return(o=r).\u0275fac=function(t){return new(t||o)(e.rXU(C.ZD),e.rXU(C.gI),e.rXU(z.nX))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-digitalized-update-book"]],features:[e.Vt3],decls:4,vars:3,consts:[["doneLoading",""],["viewBookPageTpl",""],[3,"headerBackToLink"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],[3,"currentStatusObj"],[1,"mt-5"],[3,"formGroup"],[1,"azt-config-document"],[1,"flex","items-center"],[1,"text-md","uppercase","font-medium","w-full"],[1,"flex-none","items-center"],[1,"btn","w-24","btn-secondary","mr-3",3,"click"],[1,"btn","btn-primary-soft","w-24",3,"click","disabled"],[1,"box","mt-4","p-5"],[1,"grid","grid-cols-12","mb-3"],[1,"col-span-12","lg:col-span-12"],[1,"form-label","mb-0","font-medium","flex","items-center"],[1,"setting-input"],["type","text",1,"form-control",3,"formControl","ngClass"],["class","grid grid-cols-12 mb-3",4,"ngIf"],[1,"mb-3"],[1,"clickable","link-color","mr-2",3,"click"],[1,"clickable","text-primary","mr-2","ml-2",3,"click"],[4,"ngIf"],[1,"mt-3","mb-3"],[4,"ngIf","ngIfElse"],[1,"text-right","mt-5"],[3,"uploadComplete","uploadToCdnMenu","fileType","convertPdfTimeout","convertPdfToImages","showProgress"],[1,"h-full","w-full","cursor-pointer","text-primary"],["name","cloud-upload","size","24"],[1,"clickable","text-danger","mr-2","ml-2",3,"click"],[1,"sml-3","smr-3"],[4,"ngFor","ngForOf"],[1,"ml-3","mr-3","mb-3","p-3","bg-slate-100","box","inline-block",3,"hidden"],[1,"clickable",3,"imageUrl"],[1,"clickable",2,"width","250px","height","120px",3,"src"],[1,"w-full","text-pending","font-medium"],["type","checkbox",1,"form-check-input","mt-1",3,"formControl"]],template:function(t,i){if(1&t&&(e.j41(0,"teacher-layout",2),e.DNE(1,Je,1,1,"azt-loading-effect",3)(2,et,43,37,"ng-template",null,0,e.C5r),e.k0s()),2&t){const a=e.sdS(3);e.Y8G("headerBackToLink",i.backTo),e.R7$(),e.Y8G("ngIf",1==i.statusObj.loading)("ngIfElse",a)}},dependencies:[s.YU,s.Sq,s.bT,p.qT,p.me,p.Zm,p.BC,p.cb,p.l_,p.j4,V.K,q.V,$,N.Q,f.WGl,y.wp],encapsulation:2}),r})();var it=l(75421),ee=l(25329);const ot=o=>[o],J=()=>({"mr-1":!0});function nt(o,r){if(1&o&&e.nrm(0,"azt-loading-effect",5),2&o){const n=e.XpG();e.Y8G("currentStatusObj",n.statusObj)}}function at(o,r){1&o&&(e.j41(0,"span",25),e.nrm(1,"azt-loading-ui"),e.k0s())}function lt(o,r){if(1&o){const n=e.RV6();e.qex(0),e.j41(1,"mat-card",13)(2,"mat-card-content",14)(3,"div",15)(4,"div",7)(5,"b"),e.EFF(6),e.k0s(),e.EFF(7),e.k0s(),e.j41(8,"div",16)(9,"button",17),e.nI1(10,"navigationLocalize"),e.nrm(11,"lucide-icon",18),e.j41(12,"span",19),e.EFF(13),e.nI1(14,"mytranslate"),e.k0s()(),e.j41(15,"a",20),e.nI1(16,"navigationLocalize"),e.nrm(17,"lucide-icon",21),e.EFF(18),e.nI1(19,"mytranslate"),e.k0s(),e.j41(20,"button",22),e.bIt("click",function(){const i=e.eBV(n).$implicit,a=e.XpG(3);return e.Njj(a.deleteObj(i))}),e.DNE(21,at,2,0,"span",23),e.nrm(22,"lucide-icon",24),e.j41(23,"span",19),e.EFF(24),e.nI1(25,"mytranslate"),e.k0s()()()()()(),e.bVm()}if(2&o){const n=r.$implicit,t=r.index,i=e.XpG(3);e.R7$(6),e.SpI("",t+1,"."),e.R7$(),e.E5c(" ",n.name," (",n.totalDone," / ",n.totalPage,") "),e.R7$(2),e.Y8G("routerLink",e.bMT(10,13,"/azota-digitalized/digitalized-one-book/"+n.id+"/1")),e.R7$(2),e.Y8G("ngClass",e.lJ4(23,J)),e.R7$(2),e.JRh(e.bMT(14,15,"lang_cms_admin_digitalized_digitalized_btn")),e.R7$(2),e.Y8G("routerLink",e.bMT(16,17,"/azota-digitalized/edit-book/"+n.id)),e.R7$(2),e.Y8G("ngClass",e.lJ4(24,J)),e.R7$(),e.SpI(" ",e.bMT(19,19,"lang_auto_sua")," "),e.R7$(3),e.Y8G("ngIf",i.deletingId==n.id),e.R7$(),e.Y8G("ngClass",e.lJ4(25,J)),e.R7$(2),e.JRh(e.bMT(25,21,"lang_auto_xoa"))}}function st(o,r){if(1&o&&(e.qex(0),e.j41(1,"div",10)(2,"div",11),e.DNE(3,lt,26,26,"ng-container",12),e.k0s()(),e.bVm()),2&o){const n=e.XpG(2);e.R7$(3),e.Y8G("ngForOf",n.objs)}}function rt(o,r){1&o&&(e.j41(0,"div",26),e.EFF(1),e.nI1(2,"mytranslate"),e.k0s()),2&o&&(e.R7$(),e.JRh(e.bMT(2,1,"lang_cms_admin_digitalized_there_is_no_book")))}function ct(o,r){if(1&o&&(e.j41(0,"div",6)(1,"span",7),e.EFF(2),e.nI1(3,"mytranslate"),e.k0s(),e.j41(4,"a",8),e.nI1(5,"navigationLocalize"),e.EFF(6),e.nI1(7,"mytranslate"),e.k0s()(),e.DNE(8,st,4,1,"ng-container",9)(9,rt,3,3,"ng-template",null,1,e.C5r)),2&o){const n=e.sdS(10),t=e.XpG();e.R7$(2),e.JRh(e.bMT(3,5,"lang_cms_admin_common_digitalize_list_book")),e.R7$(2),e.Y8G("routerLink",e.eq3(11,ot,e.bMT(5,7,"/azota-digitalized/create-book"))),e.R7$(2),e.JRh(e.bMT(7,9,"lang_common_create")),e.R7$(2),e.Y8G("ngIf",t.objs.length>0)("ngIfElse",n)}}const gt=[{path:"",component:_.z,children:[{path:"list-books",component:(()=>{var o;class r extends m.H{deleteObj(t){const i=this.commonService.myTranslateInstant("lang_cms_admin_digitalized_are_your_sure_to_delete_this_book")+`: <b>${t.name}<b/>?`;this.sAztDialogService.open(it.u,{data:{content:i},restoreFocus:!1,width:"500px"}).afterClosed().subscribe(a=>{a&&(this.deletingId=t.id,this.waitDestroy(this.digitalizedBookService.apiDigitalizedBookDeleteObjPost({ids:[t.id]}).subscribe(b=>{if(this.deletingId=void 0,!b.success)return this.errorStatusObj(b.message,!0);this.objs=this.objs.filter(h=>h.id!=t.id)})))})}getData(){this.initStatusObj(),this.waitDestroy(this.digitalizedBookService.apiDigitalizedBookGetObjsGet().subscribe(t=>{if(!t.success)return this.errorStatusObj(t.message,!0);this.objs=t.data?.objs??[],this.stopStatusObj()}))}ngOnInit(){super.ngOnInit(),this.getData(),this.commonService.translateMetaData({title:"lang_cms_admin_common_digitalize_list_book",description:"lang_cms_admin_common_digitalize_list_book",image:"lang_cms_test_image"}),this.headerBackTo=this.commonService.getMyQueryParam("backTo")??"/super-role/admin-tool"}constructor(t,i){super(),this.digitalizedBookService=t,this.sAztDialogService=i,this.headerBackTo="",this.objs=[]}}return(o=r).\u0275fac=function(t){return new(t||o)(e.rXU(C.ZD),e.rXU(L.i))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-digitalized-list-books"]],features:[e.Vt3],decls:5,vars:3,consts:[["doneLoading",""],["emptyList",""],[3,"headerBackToLink"],[1,"container-fluid","component-wrap","centerBoth","hasBg","mt-3"],[3,"currentStatusObj",4,"ngIf","ngIfElse"],[3,"currentStatusObj"],[1,"flex","items-center","mb-3"],[1,"w-full"],[1,"flex-none","btn","btn-primary",3,"routerLink"],[4,"ngIf","ngIfElse"],[1,"card"],[1,"card-body"],[4,"ngFor","ngForOf"],["appearance","outlined",1,"mb-2",2,"background-color","#fff","border","none"],[1,"form-control",2,"overflow-y","auto"],[1,"flex","align-items-center"],[1,"flex-none","items-center"],[1,"btn","btn-sm","btn-success-soft","mr-2",3,"routerLink"],["name","eye","size","18",3,"ngClass"],[1,"azt-hidden","md:inline-block"],[1,"btn","btn-sm","btn-primary-soft","mr-2",3,"routerLink"],["name","square-pen","size","18",3,"ngClass"],[1,"btn","btn-sm","btn-danger-soft",3,"click"],["class","w-4 h-4 flex mr-1",4,"ngIf"],["name","trash-2","size","18",3,"ngClass"],[1,"w-4","h-4","flex","mr-1"],[1,"text-center"]],template:function(t,i){if(1&t&&(e.j41(0,"teacher-layout",2)(1,"div",3),e.DNE(2,nt,1,1,"azt-loading-effect",4)(3,ct,11,13,"ng-template",null,0,e.C5r),e.k0s()()),2&t){const a=e.sdS(4);e.Y8G("headerBackToLink",i.headerBackTo),e.R7$(2),e.Y8G("ngIf",i.statusObj.loading)("ngIfElse",a)}},dependencies:[z.Wk,s.YU,s.Sq,s.bT,ee.RN,ee.m2,V.K,Y.R,N.Q,f.WGl,y.F2,y.wp],encapsulation:2}),r})()},{path:"create-book",component:Ye},{path:"edit-book/:bookId",component:tt},{path:"digitalized-one-book/:bookId/:page",component:Se}]}];let mt=(()=>{var o;class r{}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[z.iI.forChild(gt),z.iI,g.XE]}),r})(),_t=(()=>{var o;class r{}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({providers:[{provide:c.vn,useValue:v.c.azt_tiny_mce_script_src}],imports:[z.iI,s.MD,p.YN,c.sv,R.s,p.X1,mt,I.Q,U.L,A.Id,j.b,f.flO.pick(f.Ptg),D.AC,T.DL,B.An]}),r})()}}]);